{
  "version": 3,
  "sources": ["../node_modules/requires-port/index.js", "../node_modules/querystringify/index.js", "../node_modules/url-parse/index.js", "../node_modules/path-posix/index.js", "../node_modules/crypt/crypt.js", "../node_modules/charenc/charenc.js", "../node_modules/is-buffer/index.js", "../node_modules/md5/md5.js", "../node_modules/base-64/base64.js", "../node_modules/web-streams-polyfill/src/utils.ts", "../node_modules/web-streams-polyfill/src/lib/helpers/miscellaneous.ts", "../node_modules/web-streams-polyfill/src/lib/helpers/webidl.ts", "../node_modules/web-streams-polyfill/src/lib/simple-queue.ts", "../node_modules/web-streams-polyfill/src/lib/abstract-ops/internal-methods.ts", "../node_modules/web-streams-polyfill/src/lib/readable-stream/generic-reader.ts", "../node_modules/web-streams-polyfill/src/stub/number-isfinite.ts", "../node_modules/web-streams-polyfill/src/stub/math-trunc.ts", "../node_modules/web-streams-polyfill/src/lib/validators/basic.ts", "../node_modules/web-streams-polyfill/src/lib/validators/readable-stream.ts", "../node_modules/web-streams-polyfill/src/lib/readable-stream/default-reader.ts", "../node_modules/web-streams-polyfill/src/target/es2018/stub/async-iterator-prototype.ts", "../node_modules/web-streams-polyfill/src/lib/readable-stream/async-iterator.ts", "../node_modules/web-streams-polyfill/src/stub/number-isnan.ts", "../node_modules/web-streams-polyfill/src/lib/abstract-ops/ecmascript.ts", "../node_modules/web-streams-polyfill/src/lib/abstract-ops/miscellaneous.ts", "../node_modules/web-streams-polyfill/src/lib/abstract-ops/queue-with-sizes.ts", "../node_modules/web-streams-polyfill/src/lib/helpers/array-buffer-view.ts", "../node_modules/web-streams-polyfill/src/lib/readable-stream/byte-stream-controller.ts", "../node_modules/web-streams-polyfill/src/lib/validators/reader-options.ts", "../node_modules/web-streams-polyfill/src/lib/readable-stream/byob-reader.ts", "../node_modules/web-streams-polyfill/src/lib/abstract-ops/queuing-strategy.ts", "../node_modules/web-streams-polyfill/src/lib/validators/queuing-strategy.ts", "../node_modules/web-streams-polyfill/src/lib/validators/underlying-sink.ts", "../node_modules/web-streams-polyfill/src/lib/validators/writable-stream.ts", "../node_modules/web-streams-polyfill/src/lib/abort-signal.ts", "../node_modules/web-streams-polyfill/src/lib/writable-stream.ts", "../node_modules/web-streams-polyfill/src/globals.ts", "../node_modules/web-streams-polyfill/src/stub/dom-exception.ts", "../node_modules/web-streams-polyfill/src/lib/readable-stream/pipe.ts", "../node_modules/web-streams-polyfill/src/lib/readable-stream/default-controller.ts", "../node_modules/web-streams-polyfill/src/lib/readable-stream/tee.ts", "../node_modules/web-streams-polyfill/src/lib/readable-stream/readable-stream-like.ts", "../node_modules/web-streams-polyfill/src/lib/readable-stream/from.ts", "../node_modules/web-streams-polyfill/src/lib/validators/underlying-source.ts", "../node_modules/web-streams-polyfill/src/lib/validators/iterator-options.ts", "../node_modules/web-streams-polyfill/src/lib/validators/pipe-options.ts", "../node_modules/web-streams-polyfill/src/lib/validators/readable-writable-pair.ts", "../node_modules/web-streams-polyfill/src/lib/readable-stream.ts", "../node_modules/web-streams-polyfill/src/lib/validators/queuing-strategy-init.ts", "../node_modules/web-streams-polyfill/src/lib/byte-length-queuing-strategy.ts", "../node_modules/web-streams-polyfill/src/lib/count-queuing-strategy.ts", "../node_modules/web-streams-polyfill/src/lib/validators/transformer.ts", "../node_modules/web-streams-polyfill/src/lib/transform-stream.ts", "../node_modules/fetch-blob/streams.cjs", "../node_modules/fetch-blob/index.js", "../node_modules/fetch-blob/file.js", "../node_modules/formdata-polyfill/esm.min.js", "../node_modules/node-domexception/index.js", "../node_modules/fetch-blob/from.js", "../node_modules/node-fetch/src/utils/multipart-parser.js", "../node_modules/balanced-match/index.js", "../node_modules/brace-expansion/index.js", "../node_modules/fast-xml-parser/src/util.js", "../node_modules/fast-xml-parser/src/validator.js", "../node_modules/fast-xml-parser/src/xmlparser/OptionsBuilder.js", "../node_modules/fast-xml-parser/src/xmlparser/xmlNode.js", "../node_modules/fast-xml-parser/src/xmlparser/DocTypeReader.js", "../node_modules/strnum/strnum.js", "../node_modules/fast-xml-parser/src/ignoreAttributes.js", "../node_modules/fast-xml-parser/src/xmlparser/OrderedObjParser.js", "../node_modules/fast-xml-parser/src/xmlparser/node2json.js", "../node_modules/fast-xml-parser/src/xmlparser/XMLParser.js", "../node_modules/fast-xml-parser/src/xmlbuilder/orderedJs2Xml.js", "../node_modules/fast-xml-parser/src/xmlbuilder/json2xml.js", "../node_modules/fast-xml-parser/src/fxp.js", "../node_modules/nested-property/dist/nested-property.js", "../node_modules/byte-length/src/index.ts", "../src/main.ts", "../src/WebDAVSettingTab.ts", "../src/WebDAVExplorerView.ts", "../src/types.ts", "../node_modules/webdav/dist/node/tools/url.js", "../node_modules/layerr/dist/error.js", "../node_modules/layerr/dist/global.js", "../node_modules/layerr/dist/tools.js", "../node_modules/layerr/dist/layerr.js", "../node_modules/url-join/lib/url-join.js", "../node_modules/webdav/dist/node/tools/path.js", "../node_modules/webdav/dist/node/auth/digest.js", "../node_modules/webdav/dist/node/tools/crypto.js", "../node_modules/webdav/dist/node/tools/encode.js", "../node_modules/entities/src/decode-codepoint.ts", "../node_modules/entities/src/decode.ts", "../node_modules/entities/src/escape.ts", "../node_modules/entities/src/index.ts", "../node_modules/webdav/dist/node/compat/env.js", "../node_modules/webdav/dist/node/auth/basic.js", "../node_modules/webdav/dist/node/auth/oauth.js", "../node_modules/node-fetch/src/index.js", "../node_modules/data-uri-to-buffer/src/index.ts", "../node_modules/node-fetch/src/body.js", "../node_modules/node-fetch/src/errors/base.js", "../node_modules/node-fetch/src/errors/fetch-error.js", "../node_modules/node-fetch/src/utils/is.js", "../node_modules/node-fetch/src/headers.js", "../node_modules/node-fetch/src/utils/is-redirect.js", "../node_modules/node-fetch/src/response.js", "../node_modules/node-fetch/src/request.js", "../node_modules/node-fetch/src/utils/get-search.js", "../node_modules/node-fetch/src/utils/referrer.js", "../node_modules/node-fetch/src/errors/abort-error.js", "../node_modules/webdav/dist/node/types.js", "../node_modules/webdav/dist/node/auth/index.js", "../node_modules/webdav/dist/node/request.js", "../node_modules/hot-patcher/dist/functions.js", "../node_modules/hot-patcher/dist/patcher.js", "../node_modules/webdav/dist/node/compat/patcher.js", "../node_modules/webdav/dist/node/tools/merge.js", "../node_modules/webdav/dist/node/tools/headers.js", "../node_modules/webdav/dist/node/tools/body.js", "../node_modules/webdav/dist/node/compat/arrayBuffer.js", "../node_modules/webdav/dist/node/compat/buffer.js", "../node_modules/minimatch/src/index.ts", "../node_modules/minimatch/src/assert-valid-pattern.ts", "../node_modules/minimatch/src/brace-expressions.ts", "../node_modules/minimatch/src/unescape.ts", "../node_modules/minimatch/src/ast.ts", "../node_modules/minimatch/src/escape.ts", "../node_modules/webdav/dist/node/response.js", "../node_modules/webdav/dist/node/operations/copyFile.js", "../node_modules/webdav/dist/node/tools/dav.js", "../node_modules/webdav/dist/node/operations/stat.js", "../node_modules/webdav/dist/node/operations/createDirectory.js", "../node_modules/webdav/dist/node/operations/createStream.js", "../node_modules/webdav/dist/node/operations/customRequest.js", "../node_modules/webdav/dist/node/operations/deleteFile.js", "../node_modules/webdav/dist/node/operations/exists.js", "../node_modules/webdav/dist/node/operations/directoryContents.js", "../node_modules/webdav/dist/node/operations/getFileContents.js", "../node_modules/webdav/dist/node/operations/lock.js", "../node_modules/webdav/dist/node/tools/xml.js", "../node_modules/webdav/dist/node/tools/quota.js", "../node_modules/webdav/dist/node/operations/getQuota.js", "../node_modules/webdav/dist/node/operations/search.js", "../node_modules/webdav/dist/node/operations/moveFile.js", "../node_modules/webdav/dist/node/operations/putFileContents.js", "../node_modules/webdav/dist/node/tools/size.js", "../node_modules/webdav/dist/node/operations/getDAVCompliance.js", "../node_modules/webdav/dist/node/operations/partialUpdateFileContents.js", "../node_modules/webdav/dist/node/factory.js", "../src/i18n.ts"],
  "sourcesContent": ["'use strict';\r\n\r\n/**\r\n * Check if we're required to add a port number.\r\n *\r\n * @see https://url.spec.whatwg.org/#default-port\r\n * @param {Number|String} port Port number we need to check\r\n * @param {String} protocol Protocol we need to check against.\r\n * @returns {Boolean} Is it a default port for the given protocol\r\n * @api private\r\n */\r\nmodule.exports = function required(port, protocol) {\r\n  protocol = protocol.split(':')[0];\r\n  port = +port;\r\n\r\n  if (!port) return false;\r\n\r\n  switch (protocol) {\r\n    case 'http':\r\n    case 'ws':\r\n    return port !== 80;\r\n\r\n    case 'https':\r\n    case 'wss':\r\n    return port !== 443;\r\n\r\n    case 'ftp':\r\n    return port !== 21;\r\n\r\n    case 'gopher':\r\n    return port !== 70;\r\n\r\n    case 'file':\r\n    return false;\r\n  }\r\n\r\n  return port !== 0;\r\n};\r\n", "'use strict';\r\n\r\nvar has = Object.prototype.hasOwnProperty\r\n  , undef;\r\n\r\n/**\r\n * Decode a URI encoded string.\r\n *\r\n * @param {String} input The URI encoded string.\r\n * @returns {String|Null} The decoded string.\r\n * @api private\r\n */\r\nfunction decode(input) {\r\n  try {\r\n    return decodeURIComponent(input.replace(/\\+/g, ' '));\r\n  } catch (e) {\r\n    return null;\r\n  }\r\n}\r\n\r\n/**\r\n * Attempts to encode a given input.\r\n *\r\n * @param {String} input The string that needs to be encoded.\r\n * @returns {String|Null} The encoded string.\r\n * @api private\r\n */\r\nfunction encode(input) {\r\n  try {\r\n    return encodeURIComponent(input);\r\n  } catch (e) {\r\n    return null;\r\n  }\r\n}\r\n\r\n/**\r\n * Simple query string parser.\r\n *\r\n * @param {String} query The query string that needs to be parsed.\r\n * @returns {Object}\r\n * @api public\r\n */\r\nfunction querystring(query) {\r\n  var parser = /([^=?#&]+)=?([^&]*)/g\r\n    , result = {}\r\n    , part;\r\n\r\n  while (part = parser.exec(query)) {\r\n    var key = decode(part[1])\r\n      , value = decode(part[2]);\r\n\r\n    //\r\n    // Prevent overriding of existing properties. This ensures that build-in\r\n    // methods like `toString` or __proto__ are not overriden by malicious\r\n    // querystrings.\r\n    //\r\n    // In the case if failed decoding, we want to omit the key/value pairs\r\n    // from the result.\r\n    //\r\n    if (key === null || value === null || key in result) continue;\r\n    result[key] = value;\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\n/**\r\n * Transform a query string to an object.\r\n *\r\n * @param {Object} obj Object that should be transformed.\r\n * @param {String} prefix Optional prefix.\r\n * @returns {String}\r\n * @api public\r\n */\r\nfunction querystringify(obj, prefix) {\r\n  prefix = prefix || '';\r\n\r\n  var pairs = []\r\n    , value\r\n    , key;\r\n\r\n  //\r\n  // Optionally prefix with a '?' if needed\r\n  //\r\n  if ('string' !== typeof prefix) prefix = '?';\r\n\r\n  for (key in obj) {\r\n    if (has.call(obj, key)) {\r\n      value = obj[key];\r\n\r\n      //\r\n      // Edge cases where we actually want to encode the value to an empty\r\n      // string instead of the stringified value.\r\n      //\r\n      if (!value && (value === null || value === undef || isNaN(value))) {\r\n        value = '';\r\n      }\r\n\r\n      key = encode(key);\r\n      value = encode(value);\r\n\r\n      //\r\n      // If we failed to encode the strings, we should bail out as we don't\r\n      // want to add invalid strings to the query.\r\n      //\r\n      if (key === null || value === null) continue;\r\n      pairs.push(key +'='+ value);\r\n    }\r\n  }\r\n\r\n  return pairs.length ? prefix + pairs.join('&') : '';\r\n}\r\n\r\n//\r\n// Expose the module.\r\n//\r\nexports.stringify = querystringify;\r\nexports.parse = querystring;\r\n", "'use strict';\r\n\r\nvar required = require('requires-port')\r\n  , qs = require('querystringify')\r\n  , controlOrWhitespace = /^[\\x00-\\x20\\u00a0\\u1680\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000\\ufeff]+/\r\n  , CRHTLF = /[\\n\\r\\t]/g\r\n  , slashes = /^[A-Za-z][A-Za-z0-9+-.]*:\\/\\//\r\n  , port = /:\\d+$/\r\n  , protocolre = /^([a-z][a-z0-9.+-]*:)?(\\/\\/)?([\\\\/]+)?([\\S\\s]*)/i\r\n  , windowsDriveLetter = /^[a-zA-Z]:/;\r\n\r\n/**\r\n * Remove control characters and whitespace from the beginning of a string.\r\n *\r\n * @param {Object|String} str String to trim.\r\n * @returns {String} A new string representing `str` stripped of control\r\n *     characters and whitespace from its beginning.\r\n * @public\r\n */\r\nfunction trimLeft(str) {\r\n  return (str ? str : '').toString().replace(controlOrWhitespace, '');\r\n}\r\n\r\n/**\r\n * These are the parse rules for the URL parser, it informs the parser\r\n * about:\r\n *\r\n * 0. The char it Needs to parse, if it's a string it should be done using\r\n *    indexOf, RegExp using exec and NaN means set as current value.\r\n * 1. The property we should set when parsing this value.\r\n * 2. Indication if it's backwards or forward parsing, when set as number it's\r\n *    the value of extra chars that should be split off.\r\n * 3. Inherit from location if non existing in the parser.\r\n * 4. `toLowerCase` the resulting value.\r\n */\r\nvar rules = [\r\n  ['#', 'hash'],                        // Extract from the back.\r\n  ['?', 'query'],                       // Extract from the back.\r\n  function sanitize(address, url) {     // Sanitize what is left of the address\r\n    return isSpecial(url.protocol) ? address.replace(/\\\\/g, '/') : address;\r\n  },\r\n  ['/', 'pathname'],                    // Extract from the back.\r\n  ['@', 'auth', 1],                     // Extract from the front.\r\n  [NaN, 'host', undefined, 1, 1],       // Set left over value.\r\n  [/:(\\d*)$/, 'port', undefined, 1],    // RegExp the back.\r\n  [NaN, 'hostname', undefined, 1, 1]    // Set left over.\r\n];\r\n\r\n/**\r\n * These properties should not be copied or inherited from. This is only needed\r\n * for all non blob URL's as a blob URL does not include a hash, only the\r\n * origin.\r\n *\r\n * @type {Object}\r\n * @private\r\n */\r\nvar ignore = { hash: 1, query: 1 };\r\n\r\n/**\r\n * The location object differs when your code is loaded through a normal page,\r\n * Worker or through a worker using a blob. And with the blobble begins the\r\n * trouble as the location object will contain the URL of the blob, not the\r\n * location of the page where our code is loaded in. The actual origin is\r\n * encoded in the `pathname` so we can thankfully generate a good \"default\"\r\n * location from it so we can generate proper relative URL's again.\r\n *\r\n * @param {Object|String} loc Optional default location object.\r\n * @returns {Object} lolcation object.\r\n * @public\r\n */\r\nfunction lolcation(loc) {\r\n  var globalVar;\r\n\r\n  if (typeof window !== 'undefined') globalVar = window;\r\n  else if (typeof global !== 'undefined') globalVar = global;\r\n  else if (typeof self !== 'undefined') globalVar = self;\r\n  else globalVar = {};\r\n\r\n  var location = globalVar.location || {};\r\n  loc = loc || location;\r\n\r\n  var finaldestination = {}\r\n    , type = typeof loc\r\n    , key;\r\n\r\n  if ('blob:' === loc.protocol) {\r\n    finaldestination = new Url(unescape(loc.pathname), {});\r\n  } else if ('string' === type) {\r\n    finaldestination = new Url(loc, {});\r\n    for (key in ignore) delete finaldestination[key];\r\n  } else if ('object' === type) {\r\n    for (key in loc) {\r\n      if (key in ignore) continue;\r\n      finaldestination[key] = loc[key];\r\n    }\r\n\r\n    if (finaldestination.slashes === undefined) {\r\n      finaldestination.slashes = slashes.test(loc.href);\r\n    }\r\n  }\r\n\r\n  return finaldestination;\r\n}\r\n\r\n/**\r\n * Check whether a protocol scheme is special.\r\n *\r\n * @param {String} The protocol scheme of the URL\r\n * @return {Boolean} `true` if the protocol scheme is special, else `false`\r\n * @private\r\n */\r\nfunction isSpecial(scheme) {\r\n  return (\r\n    scheme === 'file:' ||\r\n    scheme === 'ftp:' ||\r\n    scheme === 'http:' ||\r\n    scheme === 'https:' ||\r\n    scheme === 'ws:' ||\r\n    scheme === 'wss:'\r\n  );\r\n}\r\n\r\n/**\r\n * @typedef ProtocolExtract\r\n * @type Object\r\n * @property {String} protocol Protocol matched in the URL, in lowercase.\r\n * @property {Boolean} slashes `true` if protocol is followed by \"//\", else `false`.\r\n * @property {String} rest Rest of the URL that is not part of the protocol.\r\n */\r\n\r\n/**\r\n * Extract protocol information from a URL with/without double slash (\"//\").\r\n *\r\n * @param {String} address URL we want to extract from.\r\n * @param {Object} location\r\n * @return {ProtocolExtract} Extracted information.\r\n * @private\r\n */\r\nfunction extractProtocol(address, location) {\r\n  address = trimLeft(address);\r\n  address = address.replace(CRHTLF, '');\r\n  location = location || {};\r\n\r\n  var match = protocolre.exec(address);\r\n  var protocol = match[1] ? match[1].toLowerCase() : '';\r\n  var forwardSlashes = !!match[2];\r\n  var otherSlashes = !!match[3];\r\n  var slashesCount = 0;\r\n  var rest;\r\n\r\n  if (forwardSlashes) {\r\n    if (otherSlashes) {\r\n      rest = match[2] + match[3] + match[4];\r\n      slashesCount = match[2].length + match[3].length;\r\n    } else {\r\n      rest = match[2] + match[4];\r\n      slashesCount = match[2].length;\r\n    }\r\n  } else {\r\n    if (otherSlashes) {\r\n      rest = match[3] + match[4];\r\n      slashesCount = match[3].length;\r\n    } else {\r\n      rest = match[4]\r\n    }\r\n  }\r\n\r\n  if (protocol === 'file:') {\r\n    if (slashesCount >= 2) {\r\n      rest = rest.slice(2);\r\n    }\r\n  } else if (isSpecial(protocol)) {\r\n    rest = match[4];\r\n  } else if (protocol) {\r\n    if (forwardSlashes) {\r\n      rest = rest.slice(2);\r\n    }\r\n  } else if (slashesCount >= 2 && isSpecial(location.protocol)) {\r\n    rest = match[4];\r\n  }\r\n\r\n  return {\r\n    protocol: protocol,\r\n    slashes: forwardSlashes || isSpecial(protocol),\r\n    slashesCount: slashesCount,\r\n    rest: rest\r\n  };\r\n}\r\n\r\n/**\r\n * Resolve a relative URL pathname against a base URL pathname.\r\n *\r\n * @param {String} relative Pathname of the relative URL.\r\n * @param {String} base Pathname of the base URL.\r\n * @return {String} Resolved pathname.\r\n * @private\r\n */\r\nfunction resolve(relative, base) {\r\n  if (relative === '') return base;\r\n\r\n  var path = (base || '/').split('/').slice(0, -1).concat(relative.split('/'))\r\n    , i = path.length\r\n    , last = path[i - 1]\r\n    , unshift = false\r\n    , up = 0;\r\n\r\n  while (i--) {\r\n    if (path[i] === '.') {\r\n      path.splice(i, 1);\r\n    } else if (path[i] === '..') {\r\n      path.splice(i, 1);\r\n      up++;\r\n    } else if (up) {\r\n      if (i === 0) unshift = true;\r\n      path.splice(i, 1);\r\n      up--;\r\n    }\r\n  }\r\n\r\n  if (unshift) path.unshift('');\r\n  if (last === '.' || last === '..') path.push('');\r\n\r\n  return path.join('/');\r\n}\r\n\r\n/**\r\n * The actual URL instance. Instead of returning an object we've opted-in to\r\n * create an actual constructor as it's much more memory efficient and\r\n * faster and it pleases my OCD.\r\n *\r\n * It is worth noting that we should not use `URL` as class name to prevent\r\n * clashes with the global URL instance that got introduced in browsers.\r\n *\r\n * @constructor\r\n * @param {String} address URL we want to parse.\r\n * @param {Object|String} [location] Location defaults for relative paths.\r\n * @param {Boolean|Function} [parser] Parser for the query string.\r\n * @private\r\n */\r\nfunction Url(address, location, parser) {\r\n  address = trimLeft(address);\r\n  address = address.replace(CRHTLF, '');\r\n\r\n  if (!(this instanceof Url)) {\r\n    return new Url(address, location, parser);\r\n  }\r\n\r\n  var relative, extracted, parse, instruction, index, key\r\n    , instructions = rules.slice()\r\n    , type = typeof location\r\n    , url = this\r\n    , i = 0;\r\n\r\n  //\r\n  // The following if statements allows this module two have compatibility with\r\n  // 2 different API:\r\n  //\r\n  // 1. Node.js's `url.parse` api which accepts a URL, boolean as arguments\r\n  //    where the boolean indicates that the query string should also be parsed.\r\n  //\r\n  // 2. The `URL` interface of the browser which accepts a URL, object as\r\n  //    arguments. The supplied object will be used as default values / fall-back\r\n  //    for relative paths.\r\n  //\r\n  if ('object' !== type && 'string' !== type) {\r\n    parser = location;\r\n    location = null;\r\n  }\r\n\r\n  if (parser && 'function' !== typeof parser) parser = qs.parse;\r\n\r\n  location = lolcation(location);\r\n\r\n  //\r\n  // Extract protocol information before running the instructions.\r\n  //\r\n  extracted = extractProtocol(address || '', location);\r\n  relative = !extracted.protocol && !extracted.slashes;\r\n  url.slashes = extracted.slashes || relative && location.slashes;\r\n  url.protocol = extracted.protocol || location.protocol || '';\r\n  address = extracted.rest;\r\n\r\n  //\r\n  // When the authority component is absent the URL starts with a path\r\n  // component.\r\n  //\r\n  if (\r\n    extracted.protocol === 'file:' && (\r\n      extracted.slashesCount !== 2 || windowsDriveLetter.test(address)) ||\r\n    (!extracted.slashes &&\r\n      (extracted.protocol ||\r\n        extracted.slashesCount < 2 ||\r\n        !isSpecial(url.protocol)))\r\n  ) {\r\n    instructions[3] = [/(.*)/, 'pathname'];\r\n  }\r\n\r\n  for (; i < instructions.length; i++) {\r\n    instruction = instructions[i];\r\n\r\n    if (typeof instruction === 'function') {\r\n      address = instruction(address, url);\r\n      continue;\r\n    }\r\n\r\n    parse = instruction[0];\r\n    key = instruction[1];\r\n\r\n    if (parse !== parse) {\r\n      url[key] = address;\r\n    } else if ('string' === typeof parse) {\r\n      index = parse === '@'\r\n        ? address.lastIndexOf(parse)\r\n        : address.indexOf(parse);\r\n\r\n      if (~index) {\r\n        if ('number' === typeof instruction[2]) {\r\n          url[key] = address.slice(0, index);\r\n          address = address.slice(index + instruction[2]);\r\n        } else {\r\n          url[key] = address.slice(index);\r\n          address = address.slice(0, index);\r\n        }\r\n      }\r\n    } else if ((index = parse.exec(address))) {\r\n      url[key] = index[1];\r\n      address = address.slice(0, index.index);\r\n    }\r\n\r\n    url[key] = url[key] || (\r\n      relative && instruction[3] ? location[key] || '' : ''\r\n    );\r\n\r\n    //\r\n    // Hostname, host and protocol should be lowercased so they can be used to\r\n    // create a proper `origin`.\r\n    //\r\n    if (instruction[4]) url[key] = url[key].toLowerCase();\r\n  }\r\n\r\n  //\r\n  // Also parse the supplied query string in to an object. If we're supplied\r\n  // with a custom parser as function use that instead of the default build-in\r\n  // parser.\r\n  //\r\n  if (parser) url.query = parser(url.query);\r\n\r\n  //\r\n  // If the URL is relative, resolve the pathname against the base URL.\r\n  //\r\n  if (\r\n      relative\r\n    && location.slashes\r\n    && url.pathname.charAt(0) !== '/'\r\n    && (url.pathname !== '' || location.pathname !== '')\r\n  ) {\r\n    url.pathname = resolve(url.pathname, location.pathname);\r\n  }\r\n\r\n  //\r\n  // Default to a / for pathname if none exists. This normalizes the URL\r\n  // to always have a /\r\n  //\r\n  if (url.pathname.charAt(0) !== '/' && isSpecial(url.protocol)) {\r\n    url.pathname = '/' + url.pathname;\r\n  }\r\n\r\n  //\r\n  // We should not add port numbers if they are already the default port number\r\n  // for a given protocol. As the host also contains the port number we're going\r\n  // override it with the hostname which contains no port number.\r\n  //\r\n  if (!required(url.port, url.protocol)) {\r\n    url.host = url.hostname;\r\n    url.port = '';\r\n  }\r\n\r\n  //\r\n  // Parse down the `auth` for the username and password.\r\n  //\r\n  url.username = url.password = '';\r\n\r\n  if (url.auth) {\r\n    index = url.auth.indexOf(':');\r\n\r\n    if (~index) {\r\n      url.username = url.auth.slice(0, index);\r\n      url.username = encodeURIComponent(decodeURIComponent(url.username));\r\n\r\n      url.password = url.auth.slice(index + 1);\r\n      url.password = encodeURIComponent(decodeURIComponent(url.password))\r\n    } else {\r\n      url.username = encodeURIComponent(decodeURIComponent(url.auth));\r\n    }\r\n\r\n    url.auth = url.password ? url.username +':'+ url.password : url.username;\r\n  }\r\n\r\n  url.origin = url.protocol !== 'file:' && isSpecial(url.protocol) && url.host\r\n    ? url.protocol +'//'+ url.host\r\n    : 'null';\r\n\r\n  //\r\n  // The href is just the compiled result.\r\n  //\r\n  url.href = url.toString();\r\n}\r\n\r\n/**\r\n * This is convenience method for changing properties in the URL instance to\r\n * insure that they all propagate correctly.\r\n *\r\n * @param {String} part          Property we need to adjust.\r\n * @param {Mixed} value          The newly assigned value.\r\n * @param {Boolean|Function} fn  When setting the query, it will be the function\r\n *                               used to parse the query.\r\n *                               When setting the protocol, double slash will be\r\n *                               removed from the final url if it is true.\r\n * @returns {URL} URL instance for chaining.\r\n * @public\r\n */\r\nfunction set(part, value, fn) {\r\n  var url = this;\r\n\r\n  switch (part) {\r\n    case 'query':\r\n      if ('string' === typeof value && value.length) {\r\n        value = (fn || qs.parse)(value);\r\n      }\r\n\r\n      url[part] = value;\r\n      break;\r\n\r\n    case 'port':\r\n      url[part] = value;\r\n\r\n      if (!required(value, url.protocol)) {\r\n        url.host = url.hostname;\r\n        url[part] = '';\r\n      } else if (value) {\r\n        url.host = url.hostname +':'+ value;\r\n      }\r\n\r\n      break;\r\n\r\n    case 'hostname':\r\n      url[part] = value;\r\n\r\n      if (url.port) value += ':'+ url.port;\r\n      url.host = value;\r\n      break;\r\n\r\n    case 'host':\r\n      url[part] = value;\r\n\r\n      if (port.test(value)) {\r\n        value = value.split(':');\r\n        url.port = value.pop();\r\n        url.hostname = value.join(':');\r\n      } else {\r\n        url.hostname = value;\r\n        url.port = '';\r\n      }\r\n\r\n      break;\r\n\r\n    case 'protocol':\r\n      url.protocol = value.toLowerCase();\r\n      url.slashes = !fn;\r\n      break;\r\n\r\n    case 'pathname':\r\n    case 'hash':\r\n      if (value) {\r\n        var char = part === 'pathname' ? '/' : '#';\r\n        url[part] = value.charAt(0) !== char ? char + value : value;\r\n      } else {\r\n        url[part] = value;\r\n      }\r\n      break;\r\n\r\n    case 'username':\r\n    case 'password':\r\n      url[part] = encodeURIComponent(value);\r\n      break;\r\n\r\n    case 'auth':\r\n      var index = value.indexOf(':');\r\n\r\n      if (~index) {\r\n        url.username = value.slice(0, index);\r\n        url.username = encodeURIComponent(decodeURIComponent(url.username));\r\n\r\n        url.password = value.slice(index + 1);\r\n        url.password = encodeURIComponent(decodeURIComponent(url.password));\r\n      } else {\r\n        url.username = encodeURIComponent(decodeURIComponent(value));\r\n      }\r\n  }\r\n\r\n  for (var i = 0; i < rules.length; i++) {\r\n    var ins = rules[i];\r\n\r\n    if (ins[4]) url[ins[1]] = url[ins[1]].toLowerCase();\r\n  }\r\n\r\n  url.auth = url.password ? url.username +':'+ url.password : url.username;\r\n\r\n  url.origin = url.protocol !== 'file:' && isSpecial(url.protocol) && url.host\r\n    ? url.protocol +'//'+ url.host\r\n    : 'null';\r\n\r\n  url.href = url.toString();\r\n\r\n  return url;\r\n}\r\n\r\n/**\r\n * Transform the properties back in to a valid and full URL string.\r\n *\r\n * @param {Function} stringify Optional query stringify function.\r\n * @returns {String} Compiled version of the URL.\r\n * @public\r\n */\r\nfunction toString(stringify) {\r\n  if (!stringify || 'function' !== typeof stringify) stringify = qs.stringify;\r\n\r\n  var query\r\n    , url = this\r\n    , host = url.host\r\n    , protocol = url.protocol;\r\n\r\n  if (protocol && protocol.charAt(protocol.length - 1) !== ':') protocol += ':';\r\n\r\n  var result =\r\n    protocol +\r\n    ((url.protocol && url.slashes) || isSpecial(url.protocol) ? '//' : '');\r\n\r\n  if (url.username) {\r\n    result += url.username;\r\n    if (url.password) result += ':'+ url.password;\r\n    result += '@';\r\n  } else if (url.password) {\r\n    result += ':'+ url.password;\r\n    result += '@';\r\n  } else if (\r\n    url.protocol !== 'file:' &&\r\n    isSpecial(url.protocol) &&\r\n    !host &&\r\n    url.pathname !== '/'\r\n  ) {\r\n    //\r\n    // Add back the empty userinfo, otherwise the original invalid URL\r\n    // might be transformed into a valid one with `url.pathname` as host.\r\n    //\r\n    result += '@';\r\n  }\r\n\r\n  //\r\n  // Trailing colon is removed from `url.host` when it is parsed. If it still\r\n  // ends with a colon, then add back the trailing colon that was removed. This\r\n  // prevents an invalid URL from being transformed into a valid one.\r\n  //\r\n  if (host[host.length - 1] === ':' || (port.test(url.hostname) && !url.port)) {\r\n    host += ':';\r\n  }\r\n\r\n  result += host + url.pathname;\r\n\r\n  query = 'object' === typeof url.query ? stringify(url.query) : url.query;\r\n  if (query) result += '?' !== query.charAt(0) ? '?'+ query : query;\r\n\r\n  if (url.hash) result += url.hash;\r\n\r\n  return result;\r\n}\r\n\r\nUrl.prototype = { set: set, toString: toString };\r\n\r\n//\r\n// Expose the URL parser and some additional properties that might be useful for\r\n// others or testing.\r\n//\r\nUrl.extractProtocol = extractProtocol;\r\nUrl.location = lolcation;\r\nUrl.trimLeft = trimLeft;\r\nUrl.qs = qs;\r\n\r\nmodule.exports = Url;\r\n", "// Copyright Joyent, Inc. and other Node contributors.\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining a\r\n// copy of this software and associated documentation files (the\r\n// \"Software\"), to deal in the Software without restriction, including\r\n// without limitation the rights to use, copy, modify, merge, publish,\r\n// distribute, sublicense, and/or sell copies of the Software, and to permit\r\n// persons to whom the Software is furnished to do so, subject to the\r\n// following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be included\r\n// in all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\r\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\r\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\r\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\r\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\r\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n\r\n'use strict';\r\nvar util = require('util');\r\nvar isString = function (x) {\r\n  return typeof x === 'string';\r\n};\r\n\r\n\r\n// resolves . and .. elements in a path array with directory names there\r\n// must be no slashes or device names (c:\\) in the array\r\n// (so also no leading and trailing slashes - it does not distinguish\r\n// relative and absolute paths)\r\nfunction normalizeArray(parts, allowAboveRoot) {\r\n  var res = [];\r\n  for (var i = 0; i < parts.length; i++) {\r\n    var p = parts[i];\r\n\r\n    // ignore empty parts\r\n    if (!p || p === '.')\r\n      continue;\r\n\r\n    if (p === '..') {\r\n      if (res.length && res[res.length - 1] !== '..') {\r\n        res.pop();\r\n      } else if (allowAboveRoot) {\r\n        res.push('..');\r\n      }\r\n    } else {\r\n      res.push(p);\r\n    }\r\n  }\r\n\r\n  return res;\r\n}\r\n\r\n// Split a filename into [root, dir, basename, ext], unix version\r\n// 'root' is just a slash, or nothing.\r\nvar splitPathRe =\r\n    /^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?|)(\\.[^.\\/]*|))(?:[\\/]*)$/;\r\nvar posix = {};\r\n\r\n\r\nfunction posixSplitPath(filename) {\r\n  return splitPathRe.exec(filename).slice(1);\r\n}\r\n\r\n\r\n// path.resolve([from ...], to)\r\n// posix version\r\nposix.resolve = function() {\r\n  var resolvedPath = '',\r\n      resolvedAbsolute = false;\r\n\r\n  for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\r\n    var path = (i >= 0) ? arguments[i] : process.cwd();\r\n\r\n    // Skip empty and invalid entries\r\n    if (!isString(path)) {\r\n      throw new TypeError('Arguments to path.resolve must be strings');\r\n    } else if (!path) {\r\n      continue;\r\n    }\r\n\r\n    resolvedPath = path + '/' + resolvedPath;\r\n    resolvedAbsolute = path.charAt(0) === '/';\r\n  }\r\n\r\n  // At this point the path should be resolved to a full absolute path, but\r\n  // handle relative paths to be safe (might happen when process.cwd() fails)\r\n\r\n  // Normalize the path\r\n  resolvedPath = normalizeArray(resolvedPath.split('/'),\r\n                                !resolvedAbsolute).join('/');\r\n\r\n  return ((resolvedAbsolute ? '/' : '') + resolvedPath) || '.';\r\n};\r\n\r\n// path.normalize(path)\r\n// posix version\r\nposix.normalize = function(path) {\r\n  var isAbsolute = posix.isAbsolute(path),\r\n      trailingSlash = path.substr(-1) === '/';\r\n\r\n  // Normalize the path\r\n  path = normalizeArray(path.split('/'), !isAbsolute).join('/');\r\n\r\n  if (!path && !isAbsolute) {\r\n    path = '.';\r\n  }\r\n  if (path && trailingSlash) {\r\n    path += '/';\r\n  }\r\n\r\n  return (isAbsolute ? '/' : '') + path;\r\n};\r\n\r\n// posix version\r\nposix.isAbsolute = function(path) {\r\n  return path.charAt(0) === '/';\r\n};\r\n\r\n// posix version\r\nposix.join = function() {\r\n  var path = '';\r\n  for (var i = 0; i < arguments.length; i++) {\r\n    var segment = arguments[i];\r\n    if (!isString(segment)) {\r\n      throw new TypeError('Arguments to path.join must be strings');\r\n    }\r\n    if (segment) {\r\n      if (!path) {\r\n        path += segment;\r\n      } else {\r\n        path += '/' + segment;\r\n      }\r\n    }\r\n  }\r\n  return posix.normalize(path);\r\n};\r\n\r\n\r\n// path.relative(from, to)\r\n// posix version\r\nposix.relative = function(from, to) {\r\n  from = posix.resolve(from).substr(1);\r\n  to = posix.resolve(to).substr(1);\r\n\r\n  function trim(arr) {\r\n    var start = 0;\r\n    for (; start < arr.length; start++) {\r\n      if (arr[start] !== '') break;\r\n    }\r\n\r\n    var end = arr.length - 1;\r\n    for (; end >= 0; end--) {\r\n      if (arr[end] !== '') break;\r\n    }\r\n\r\n    if (start > end) return [];\r\n    return arr.slice(start, end + 1);\r\n  }\r\n\r\n  var fromParts = trim(from.split('/'));\r\n  var toParts = trim(to.split('/'));\r\n\r\n  var length = Math.min(fromParts.length, toParts.length);\r\n  var samePartsLength = length;\r\n  for (var i = 0; i < length; i++) {\r\n    if (fromParts[i] !== toParts[i]) {\r\n      samePartsLength = i;\r\n      break;\r\n    }\r\n  }\r\n\r\n  var outputParts = [];\r\n  for (var i = samePartsLength; i < fromParts.length; i++) {\r\n    outputParts.push('..');\r\n  }\r\n\r\n  outputParts = outputParts.concat(toParts.slice(samePartsLength));\r\n\r\n  return outputParts.join('/');\r\n};\r\n\r\n\r\nposix._makeLong = function(path) {\r\n  return path;\r\n};\r\n\r\n\r\nposix.dirname = function(path) {\r\n  var result = posixSplitPath(path),\r\n      root = result[0],\r\n      dir = result[1];\r\n\r\n  if (!root && !dir) {\r\n    // No dirname whatsoever\r\n    return '.';\r\n  }\r\n\r\n  if (dir) {\r\n    // It has a dirname, strip trailing slash\r\n    dir = dir.substr(0, dir.length - 1);\r\n  }\r\n\r\n  return root + dir;\r\n};\r\n\r\n\r\nposix.basename = function(path, ext) {\r\n  var f = posixSplitPath(path)[2];\r\n  // TODO: make this comparison case-insensitive on windows?\r\n  if (ext && f.substr(-1 * ext.length) === ext) {\r\n    f = f.substr(0, f.length - ext.length);\r\n  }\r\n  return f;\r\n};\r\n\r\n\r\nposix.extname = function(path) {\r\n  return posixSplitPath(path)[3];\r\n};\r\n\r\n\r\nposix.format = function(pathObject) {\r\n  if (!util.isObject(pathObject)) {\r\n    throw new TypeError(\r\n        \"Parameter 'pathObject' must be an object, not \" + typeof pathObject\r\n    );\r\n  }\r\n\r\n  var root = pathObject.root || '';\r\n\r\n  if (!isString(root)) {\r\n    throw new TypeError(\r\n        \"'pathObject.root' must be a string or undefined, not \" +\r\n        typeof pathObject.root\r\n    );\r\n  }\r\n\r\n  var dir = pathObject.dir ? pathObject.dir + posix.sep : '';\r\n  var base = pathObject.base || '';\r\n  return dir + base;\r\n};\r\n\r\n\r\nposix.parse = function(pathString) {\r\n  if (!isString(pathString)) {\r\n    throw new TypeError(\r\n        \"Parameter 'pathString' must be a string, not \" + typeof pathString\r\n    );\r\n  }\r\n  var allParts = posixSplitPath(pathString);\r\n  if (!allParts || allParts.length !== 4) {\r\n    throw new TypeError(\"Invalid path '\" + pathString + \"'\");\r\n  }\r\n  allParts[1] = allParts[1] || '';\r\n  allParts[2] = allParts[2] || '';\r\n  allParts[3] = allParts[3] || '';\r\n\r\n  return {\r\n    root: allParts[0],\r\n    dir: allParts[0] + allParts[1].slice(0, allParts[1].length - 1),\r\n    base: allParts[2],\r\n    ext: allParts[3],\r\n    name: allParts[2].slice(0, allParts[2].length - allParts[3].length)\r\n  };\r\n};\r\n\r\n\r\nposix.sep = '/';\r\nposix.delimiter = ':';\r\n\r\n  module.exports = posix;\r\n", "(function() {\r\n  var base64map\r\n      = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',\r\n\r\n  crypt = {\r\n    // Bit-wise rotation left\r\n    rotl: function(n, b) {\r\n      return (n << b) | (n >>> (32 - b));\r\n    },\r\n\r\n    // Bit-wise rotation right\r\n    rotr: function(n, b) {\r\n      return (n << (32 - b)) | (n >>> b);\r\n    },\r\n\r\n    // Swap big-endian to little-endian and vice versa\r\n    endian: function(n) {\r\n      // If number given, swap endian\r\n      if (n.constructor == Number) {\r\n        return crypt.rotl(n, 8) & 0x00FF00FF | crypt.rotl(n, 24) & 0xFF00FF00;\r\n      }\r\n\r\n      // Else, assume array and swap all items\r\n      for (var i = 0; i < n.length; i++)\r\n        n[i] = crypt.endian(n[i]);\r\n      return n;\r\n    },\r\n\r\n    // Generate an array of any length of random bytes\r\n    randomBytes: function(n) {\r\n      for (var bytes = []; n > 0; n--)\r\n        bytes.push(Math.floor(Math.random() * 256));\r\n      return bytes;\r\n    },\r\n\r\n    // Convert a byte array to big-endian 32-bit words\r\n    bytesToWords: function(bytes) {\r\n      for (var words = [], i = 0, b = 0; i < bytes.length; i++, b += 8)\r\n        words[b >>> 5] |= bytes[i] << (24 - b % 32);\r\n      return words;\r\n    },\r\n\r\n    // Convert big-endian 32-bit words to a byte array\r\n    wordsToBytes: function(words) {\r\n      for (var bytes = [], b = 0; b < words.length * 32; b += 8)\r\n        bytes.push((words[b >>> 5] >>> (24 - b % 32)) & 0xFF);\r\n      return bytes;\r\n    },\r\n\r\n    // Convert a byte array to a hex string\r\n    bytesToHex: function(bytes) {\r\n      for (var hex = [], i = 0; i < bytes.length; i++) {\r\n        hex.push((bytes[i] >>> 4).toString(16));\r\n        hex.push((bytes[i] & 0xF).toString(16));\r\n      }\r\n      return hex.join('');\r\n    },\r\n\r\n    // Convert a hex string to a byte array\r\n    hexToBytes: function(hex) {\r\n      for (var bytes = [], c = 0; c < hex.length; c += 2)\r\n        bytes.push(parseInt(hex.substr(c, 2), 16));\r\n      return bytes;\r\n    },\r\n\r\n    // Convert a byte array to a base-64 string\r\n    bytesToBase64: function(bytes) {\r\n      for (var base64 = [], i = 0; i < bytes.length; i += 3) {\r\n        var triplet = (bytes[i] << 16) | (bytes[i + 1] << 8) | bytes[i + 2];\r\n        for (var j = 0; j < 4; j++)\r\n          if (i * 8 + j * 6 <= bytes.length * 8)\r\n            base64.push(base64map.charAt((triplet >>> 6 * (3 - j)) & 0x3F));\r\n          else\r\n            base64.push('=');\r\n      }\r\n      return base64.join('');\r\n    },\r\n\r\n    // Convert a base-64 string to a byte array\r\n    base64ToBytes: function(base64) {\r\n      // Remove non-base-64 characters\r\n      base64 = base64.replace(/[^A-Z0-9+\\/]/ig, '');\r\n\r\n      for (var bytes = [], i = 0, imod4 = 0; i < base64.length;\r\n          imod4 = ++i % 4) {\r\n        if (imod4 == 0) continue;\r\n        bytes.push(((base64map.indexOf(base64.charAt(i - 1))\r\n            & (Math.pow(2, -2 * imod4 + 8) - 1)) << (imod4 * 2))\r\n            | (base64map.indexOf(base64.charAt(i)) >>> (6 - imod4 * 2)));\r\n      }\r\n      return bytes;\r\n    }\r\n  };\r\n\r\n  module.exports = crypt;\r\n})();\r\n", "var charenc = {\r\n  // UTF-8 encoding\r\n  utf8: {\r\n    // Convert a string to a byte array\r\n    stringToBytes: function(str) {\r\n      return charenc.bin.stringToBytes(unescape(encodeURIComponent(str)));\r\n    },\r\n\r\n    // Convert a byte array to a string\r\n    bytesToString: function(bytes) {\r\n      return decodeURIComponent(escape(charenc.bin.bytesToString(bytes)));\r\n    }\r\n  },\r\n\r\n  // Binary encoding\r\n  bin: {\r\n    // Convert a string to a byte array\r\n    stringToBytes: function(str) {\r\n      for (var bytes = [], i = 0; i < str.length; i++)\r\n        bytes.push(str.charCodeAt(i) & 0xFF);\r\n      return bytes;\r\n    },\r\n\r\n    // Convert a byte array to a string\r\n    bytesToString: function(bytes) {\r\n      for (var str = [], i = 0; i < bytes.length; i++)\r\n        str.push(String.fromCharCode(bytes[i]));\r\n      return str.join('');\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = charenc;\r\n", "/*!\r\n * Determine if an object is a Buffer\r\n *\r\n * @author   Feross Aboukhadijeh <https://feross.org>\r\n * @license  MIT\r\n */\r\n\r\n// The _isBuffer check is for Safari 5-7 support, because it's missing\r\n// Object.prototype.constructor. Remove this eventually\r\nmodule.exports = function (obj) {\r\n  return obj != null && (isBuffer(obj) || isSlowBuffer(obj) || !!obj._isBuffer)\r\n}\r\n\r\nfunction isBuffer (obj) {\r\n  return !!obj.constructor && typeof obj.constructor.isBuffer === 'function' && obj.constructor.isBuffer(obj)\r\n}\r\n\r\n// For Node v0.10 support. Remove this eventually.\r\nfunction isSlowBuffer (obj) {\r\n  return typeof obj.readFloatLE === 'function' && typeof obj.slice === 'function' && isBuffer(obj.slice(0, 0))\r\n}\r\n", "(function(){\r\n  var crypt = require('crypt'),\r\n      utf8 = require('charenc').utf8,\r\n      isBuffer = require('is-buffer'),\r\n      bin = require('charenc').bin,\r\n\r\n  // The core\r\n  md5 = function (message, options) {\r\n    // Convert to byte array\r\n    if (message.constructor == String)\r\n      if (options && options.encoding === 'binary')\r\n        message = bin.stringToBytes(message);\r\n      else\r\n        message = utf8.stringToBytes(message);\r\n    else if (isBuffer(message))\r\n      message = Array.prototype.slice.call(message, 0);\r\n    else if (!Array.isArray(message) && message.constructor !== Uint8Array)\r\n      message = message.toString();\r\n    // else, assume byte array already\r\n\r\n    var m = crypt.bytesToWords(message),\r\n        l = message.length * 8,\r\n        a =  1732584193,\r\n        b = -271733879,\r\n        c = -1732584194,\r\n        d =  271733878;\r\n\r\n    // Swap endian\r\n    for (var i = 0; i < m.length; i++) {\r\n      m[i] = ((m[i] <<  8) | (m[i] >>> 24)) & 0x00FF00FF |\r\n             ((m[i] << 24) | (m[i] >>>  8)) & 0xFF00FF00;\r\n    }\r\n\r\n    // Padding\r\n    m[l >>> 5] |= 0x80 << (l % 32);\r\n    m[(((l + 64) >>> 9) << 4) + 14] = l;\r\n\r\n    // Method shortcuts\r\n    var FF = md5._ff,\r\n        GG = md5._gg,\r\n        HH = md5._hh,\r\n        II = md5._ii;\r\n\r\n    for (var i = 0; i < m.length; i += 16) {\r\n\r\n      var aa = a,\r\n          bb = b,\r\n          cc = c,\r\n          dd = d;\r\n\r\n      a = FF(a, b, c, d, m[i+ 0],  7, -680876936);\r\n      d = FF(d, a, b, c, m[i+ 1], 12, -389564586);\r\n      c = FF(c, d, a, b, m[i+ 2], 17,  606105819);\r\n      b = FF(b, c, d, a, m[i+ 3], 22, -1044525330);\r\n      a = FF(a, b, c, d, m[i+ 4],  7, -176418897);\r\n      d = FF(d, a, b, c, m[i+ 5], 12,  1200080426);\r\n      c = FF(c, d, a, b, m[i+ 6], 17, -1473231341);\r\n      b = FF(b, c, d, a, m[i+ 7], 22, -45705983);\r\n      a = FF(a, b, c, d, m[i+ 8],  7,  1770035416);\r\n      d = FF(d, a, b, c, m[i+ 9], 12, -1958414417);\r\n      c = FF(c, d, a, b, m[i+10], 17, -42063);\r\n      b = FF(b, c, d, a, m[i+11], 22, -1990404162);\r\n      a = FF(a, b, c, d, m[i+12],  7,  1804603682);\r\n      d = FF(d, a, b, c, m[i+13], 12, -40341101);\r\n      c = FF(c, d, a, b, m[i+14], 17, -1502002290);\r\n      b = FF(b, c, d, a, m[i+15], 22,  1236535329);\r\n\r\n      a = GG(a, b, c, d, m[i+ 1],  5, -165796510);\r\n      d = GG(d, a, b, c, m[i+ 6],  9, -1069501632);\r\n      c = GG(c, d, a, b, m[i+11], 14,  643717713);\r\n      b = GG(b, c, d, a, m[i+ 0], 20, -373897302);\r\n      a = GG(a, b, c, d, m[i+ 5],  5, -701558691);\r\n      d = GG(d, a, b, c, m[i+10],  9,  38016083);\r\n      c = GG(c, d, a, b, m[i+15], 14, -660478335);\r\n      b = GG(b, c, d, a, m[i+ 4], 20, -405537848);\r\n      a = GG(a, b, c, d, m[i+ 9],  5,  568446438);\r\n      d = GG(d, a, b, c, m[i+14],  9, -1019803690);\r\n      c = GG(c, d, a, b, m[i+ 3], 14, -187363961);\r\n      b = GG(b, c, d, a, m[i+ 8], 20,  1163531501);\r\n      a = GG(a, b, c, d, m[i+13],  5, -1444681467);\r\n      d = GG(d, a, b, c, m[i+ 2],  9, -51403784);\r\n      c = GG(c, d, a, b, m[i+ 7], 14,  1735328473);\r\n      b = GG(b, c, d, a, m[i+12], 20, -1926607734);\r\n\r\n      a = HH(a, b, c, d, m[i+ 5],  4, -378558);\r\n      d = HH(d, a, b, c, m[i+ 8], 11, -2022574463);\r\n      c = HH(c, d, a, b, m[i+11], 16,  1839030562);\r\n      b = HH(b, c, d, a, m[i+14], 23, -35309556);\r\n      a = HH(a, b, c, d, m[i+ 1],  4, -1530992060);\r\n      d = HH(d, a, b, c, m[i+ 4], 11,  1272893353);\r\n      c = HH(c, d, a, b, m[i+ 7], 16, -155497632);\r\n      b = HH(b, c, d, a, m[i+10], 23, -1094730640);\r\n      a = HH(a, b, c, d, m[i+13],  4,  681279174);\r\n      d = HH(d, a, b, c, m[i+ 0], 11, -358537222);\r\n      c = HH(c, d, a, b, m[i+ 3], 16, -722521979);\r\n      b = HH(b, c, d, a, m[i+ 6], 23,  76029189);\r\n      a = HH(a, b, c, d, m[i+ 9],  4, -640364487);\r\n      d = HH(d, a, b, c, m[i+12], 11, -421815835);\r\n      c = HH(c, d, a, b, m[i+15], 16,  530742520);\r\n      b = HH(b, c, d, a, m[i+ 2], 23, -995338651);\r\n\r\n      a = II(a, b, c, d, m[i+ 0],  6, -198630844);\r\n      d = II(d, a, b, c, m[i+ 7], 10,  1126891415);\r\n      c = II(c, d, a, b, m[i+14], 15, -1416354905);\r\n      b = II(b, c, d, a, m[i+ 5], 21, -57434055);\r\n      a = II(a, b, c, d, m[i+12],  6,  1700485571);\r\n      d = II(d, a, b, c, m[i+ 3], 10, -1894986606);\r\n      c = II(c, d, a, b, m[i+10], 15, -1051523);\r\n      b = II(b, c, d, a, m[i+ 1], 21, -2054922799);\r\n      a = II(a, b, c, d, m[i+ 8],  6,  1873313359);\r\n      d = II(d, a, b, c, m[i+15], 10, -30611744);\r\n      c = II(c, d, a, b, m[i+ 6], 15, -1560198380);\r\n      b = II(b, c, d, a, m[i+13], 21,  1309151649);\r\n      a = II(a, b, c, d, m[i+ 4],  6, -145523070);\r\n      d = II(d, a, b, c, m[i+11], 10, -1120210379);\r\n      c = II(c, d, a, b, m[i+ 2], 15,  718787259);\r\n      b = II(b, c, d, a, m[i+ 9], 21, -343485551);\r\n\r\n      a = (a + aa) >>> 0;\r\n      b = (b + bb) >>> 0;\r\n      c = (c + cc) >>> 0;\r\n      d = (d + dd) >>> 0;\r\n    }\r\n\r\n    return crypt.endian([a, b, c, d]);\r\n  };\r\n\r\n  // Auxiliary functions\r\n  md5._ff  = function (a, b, c, d, x, s, t) {\r\n    var n = a + (b & c | ~b & d) + (x >>> 0) + t;\r\n    return ((n << s) | (n >>> (32 - s))) + b;\r\n  };\r\n  md5._gg  = function (a, b, c, d, x, s, t) {\r\n    var n = a + (b & d | c & ~d) + (x >>> 0) + t;\r\n    return ((n << s) | (n >>> (32 - s))) + b;\r\n  };\r\n  md5._hh  = function (a, b, c, d, x, s, t) {\r\n    var n = a + (b ^ c ^ d) + (x >>> 0) + t;\r\n    return ((n << s) | (n >>> (32 - s))) + b;\r\n  };\r\n  md5._ii  = function (a, b, c, d, x, s, t) {\r\n    var n = a + (c ^ (b | ~d)) + (x >>> 0) + t;\r\n    return ((n << s) | (n >>> (32 - s))) + b;\r\n  };\r\n\r\n  // Package private blocksize\r\n  md5._blocksize = 16;\r\n  md5._digestsize = 16;\r\n\r\n  module.exports = function (message, options) {\r\n    if (message === undefined || message === null)\r\n      throw new Error('Illegal argument ' + message);\r\n\r\n    var digestbytes = crypt.wordsToBytes(md5(message, options));\r\n    return options && options.asBytes ? digestbytes :\r\n        options && options.asString ? bin.bytesToString(digestbytes) :\r\n        crypt.bytesToHex(digestbytes);\r\n  };\r\n\r\n})();\r\n", "/*! https://mths.be/base64 v1.0.0 by @mathias | MIT license */\r\n;(function(root) {\r\n\r\n\t// Detect free variables `exports`.\r\n\tvar freeExports = typeof exports == 'object' && exports;\r\n\r\n\t// Detect free variable `module`.\r\n\tvar freeModule = typeof module == 'object' && module &&\r\n\t\tmodule.exports == freeExports && module;\r\n\r\n\t// Detect free variable `global`, from Node.js or Browserified code, and use\r\n\t// it as `root`.\r\n\tvar freeGlobal = typeof global == 'object' && global;\r\n\tif (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal) {\r\n\t\troot = freeGlobal;\r\n\t}\r\n\r\n\t/*--------------------------------------------------------------------------*/\r\n\r\n\tvar InvalidCharacterError = function(message) {\r\n\t\tthis.message = message;\r\n\t};\r\n\tInvalidCharacterError.prototype = new Error;\r\n\tInvalidCharacterError.prototype.name = 'InvalidCharacterError';\r\n\r\n\tvar error = function(message) {\r\n\t\t// Note: the error messages used throughout this file match those used by\r\n\t\t// the native `atob`/`btoa` implementation in Chromium.\r\n\t\tthrow new InvalidCharacterError(message);\r\n\t};\r\n\r\n\tvar TABLE = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\r\n\t// http://whatwg.org/html/common-microsyntaxes.html#space-character\r\n\tvar REGEX_SPACE_CHARACTERS = /[\\t\\n\\f\\r ]/g;\r\n\r\n\t// `decode` is designed to be fully compatible with `atob` as described in the\r\n\t// HTML Standard. http://whatwg.org/html/webappapis.html#dom-windowbase64-atob\r\n\t// The optimized base64-decoding algorithm used is based on @atk\u2019s excellent\r\n\t// implementation. https://gist.github.com/atk/1020396\r\n\tvar decode = function(input) {\r\n\t\tinput = String(input)\r\n\t\t\t.replace(REGEX_SPACE_CHARACTERS, '');\r\n\t\tvar length = input.length;\r\n\t\tif (length % 4 == 0) {\r\n\t\t\tinput = input.replace(/==?$/, '');\r\n\t\t\tlength = input.length;\r\n\t\t}\r\n\t\tif (\r\n\t\t\tlength % 4 == 1 ||\r\n\t\t\t// http://whatwg.org/C#alphanumeric-ascii-characters\r\n\t\t\t/[^+a-zA-Z0-9/]/.test(input)\r\n\t\t) {\r\n\t\t\terror(\r\n\t\t\t\t'Invalid character: the string to be decoded is not correctly encoded.'\r\n\t\t\t);\r\n\t\t}\r\n\t\tvar bitCounter = 0;\r\n\t\tvar bitStorage;\r\n\t\tvar buffer;\r\n\t\tvar output = '';\r\n\t\tvar position = -1;\r\n\t\twhile (++position < length) {\r\n\t\t\tbuffer = TABLE.indexOf(input.charAt(position));\r\n\t\t\tbitStorage = bitCounter % 4 ? bitStorage * 64 + buffer : buffer;\r\n\t\t\t// Unless this is the first of a group of 4 characters\u2026\r\n\t\t\tif (bitCounter++ % 4) {\r\n\t\t\t\t// \u2026convert the first 8 bits to a single ASCII character.\r\n\t\t\t\toutput += String.fromCharCode(\r\n\t\t\t\t\t0xFF & bitStorage >> (-2 * bitCounter & 6)\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn output;\r\n\t};\r\n\r\n\t// `encode` is designed to be fully compatible with `btoa` as described in the\r\n\t// HTML Standard: http://whatwg.org/html/webappapis.html#dom-windowbase64-btoa\r\n\tvar encode = function(input) {\r\n\t\tinput = String(input);\r\n\t\tif (/[^\\0-\\xFF]/.test(input)) {\r\n\t\t\t// Note: no need to special-case astral symbols here, as surrogates are\r\n\t\t\t// matched, and the input is supposed to only contain ASCII anyway.\r\n\t\t\terror(\r\n\t\t\t\t'The string to be encoded contains characters outside of the ' +\r\n\t\t\t\t'Latin1 range.'\r\n\t\t\t);\r\n\t\t}\r\n\t\tvar padding = input.length % 3;\r\n\t\tvar output = '';\r\n\t\tvar position = -1;\r\n\t\tvar a;\r\n\t\tvar b;\r\n\t\tvar c;\r\n\t\tvar buffer;\r\n\t\t// Make sure any padding is handled outside of the loop.\r\n\t\tvar length = input.length - padding;\r\n\r\n\t\twhile (++position < length) {\r\n\t\t\t// Read three bytes, i.e. 24 bits.\r\n\t\t\ta = input.charCodeAt(position) << 16;\r\n\t\t\tb = input.charCodeAt(++position) << 8;\r\n\t\t\tc = input.charCodeAt(++position);\r\n\t\t\tbuffer = a + b + c;\r\n\t\t\t// Turn the 24 bits into four chunks of 6 bits each, and append the\r\n\t\t\t// matching character for each of them to the output.\r\n\t\t\toutput += (\r\n\t\t\t\tTABLE.charAt(buffer >> 18 & 0x3F) +\r\n\t\t\t\tTABLE.charAt(buffer >> 12 & 0x3F) +\r\n\t\t\t\tTABLE.charAt(buffer >> 6 & 0x3F) +\r\n\t\t\t\tTABLE.charAt(buffer & 0x3F)\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tif (padding == 2) {\r\n\t\t\ta = input.charCodeAt(position) << 8;\r\n\t\t\tb = input.charCodeAt(++position);\r\n\t\t\tbuffer = a + b;\r\n\t\t\toutput += (\r\n\t\t\t\tTABLE.charAt(buffer >> 10) +\r\n\t\t\t\tTABLE.charAt((buffer >> 4) & 0x3F) +\r\n\t\t\t\tTABLE.charAt((buffer << 2) & 0x3F) +\r\n\t\t\t\t'='\r\n\t\t\t);\r\n\t\t} else if (padding == 1) {\r\n\t\t\tbuffer = input.charCodeAt(position);\r\n\t\t\toutput += (\r\n\t\t\t\tTABLE.charAt(buffer >> 2) +\r\n\t\t\t\tTABLE.charAt((buffer << 4) & 0x3F) +\r\n\t\t\t\t'=='\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn output;\r\n\t};\r\n\r\n\tvar base64 = {\r\n\t\t'encode': encode,\r\n\t\t'decode': decode,\r\n\t\t'version': '1.0.0'\r\n\t};\r\n\r\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\r\n\t// like the following:\r\n\tif (\r\n\t\ttypeof define == 'function' &&\r\n\t\ttypeof define.amd == 'object' &&\r\n\t\tdefine.amd\r\n\t) {\r\n\t\tdefine(function() {\r\n\t\t\treturn base64;\r\n\t\t});\r\n\t}\telse if (freeExports && !freeExports.nodeType) {\r\n\t\tif (freeModule) { // in Node.js or RingoJS v0.8.0+\r\n\t\t\tfreeModule.exports = base64;\r\n\t\t} else { // in Narwhal or RingoJS v0.7.0-\r\n\t\t\tfor (var key in base64) {\r\n\t\t\t\tbase64.hasOwnProperty(key) && (freeExports[key] = base64[key]);\r\n\t\t\t}\r\n\t\t}\r\n\t} else { // in Rhino or a web browser\r\n\t\troot.base64 = base64;\r\n\t}\r\n\r\n}(this));\r\n", "export function noop(): undefined {\n  return undefined;\n}\n", "import { noop } from '../../utils';\nimport { AssertionError } from '../../stub/assert';\n\nexport function typeIsObject(x: any): x is object {\n  return (typeof x === 'object' && x !== null) || typeof x === 'function';\n}\n\nexport const rethrowAssertionErrorRejection: (e: any) => void =\n  DEBUG ? e => {\n    // Used throughout the reference implementation, as `.catch(rethrowAssertionErrorRejection)`, to ensure any errors\n    // get shown. There are places in the spec where we do promise transformations and purposefully ignore or don't\n    // expect any errors, but assertion errors are always problematic.\n    if (e && e instanceof AssertionError) {\n      setTimeout(() => {\n        throw e;\n      }, 0);\n    }\n  } : noop;\n\nexport function setFunctionName(fn: Function, name: string): void {\n  try {\n    Object.defineProperty(fn, 'name', {\n      value: name,\n      configurable: true\n    });\n  } catch {\n    // This property is non-configurable in older browsers, so ignore if this throws.\n    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/name#browser_compatibility\n  }\n}\n", "import { rethrowAssertionErrorRejection } from './miscellaneous';\nimport assert from '../../stub/assert';\n\nconst originalPromise = Promise;\nconst originalPromiseThen = Promise.prototype.then;\nconst originalPromiseReject = Promise.reject.bind(originalPromise);\n\n// https://webidl.spec.whatwg.org/#a-new-promise\nexport function newPromise<T>(executor: (\n  resolve: (value: T | PromiseLike<T>) => void,\n  reject: (reason?: any) => void\n) => void): Promise<T> {\n  return new originalPromise(executor);\n}\n\n// https://webidl.spec.whatwg.org/#a-promise-resolved-with\nexport function promiseResolvedWith<T>(value: T | PromiseLike<T>): Promise<T> {\n  return newPromise(resolve => resolve(value));\n}\n\n// https://webidl.spec.whatwg.org/#a-promise-rejected-with\nexport function promiseRejectedWith<T = never>(reason: any): Promise<T> {\n  return originalPromiseReject(reason);\n}\n\nexport function PerformPromiseThen<T, TResult1 = T, TResult2 = never>(\n  promise: Promise<T>,\n  onFulfilled?: (value: T) => TResult1 | PromiseLike<TResult1>,\n  onRejected?: (reason: any) => TResult2 | PromiseLike<TResult2>): Promise<TResult1 | TResult2> {\n  // There doesn't appear to be any way to correctly emulate the behaviour from JavaScript, so this is just an\n  // approximation.\n  return originalPromiseThen.call(promise, onFulfilled, onRejected) as Promise<TResult1 | TResult2>;\n}\n\n// Bluebird logs a warning when a promise is created within a fulfillment handler, but then isn't returned\n// from that handler. To prevent this, return null instead of void from all handlers.\n// http://bluebirdjs.com/docs/warning-explanations.html#warning-a-promise-was-created-in-a-handler-but-was-not-returned-from-it\nexport function uponPromise<T>(\n  promise: Promise<T>,\n  onFulfilled?: (value: T) => null | PromiseLike<null>,\n  onRejected?: (reason: any) => null | PromiseLike<null>): void {\n  PerformPromiseThen(\n    PerformPromiseThen(promise, onFulfilled, onRejected),\n    undefined,\n    rethrowAssertionErrorRejection\n  );\n}\n\nexport function uponFulfillment<T>(promise: Promise<T>, onFulfilled: (value: T) => null | PromiseLike<null>): void {\n  uponPromise(promise, onFulfilled);\n}\n\nexport function uponRejection(promise: Promise<unknown>, onRejected: (reason: any) => null | PromiseLike<null>): void {\n  uponPromise(promise, undefined, onRejected);\n}\n\nexport function transformPromiseWith<T, TResult1 = T, TResult2 = never>(\n  promise: Promise<T>,\n  fulfillmentHandler?: (value: T) => TResult1 | PromiseLike<TResult1>,\n  rejectionHandler?: (reason: any) => TResult2 | PromiseLike<TResult2>): Promise<TResult1 | TResult2> {\n  return PerformPromiseThen(promise, fulfillmentHandler, rejectionHandler);\n}\n\nexport function setPromiseIsHandledToTrue(promise: Promise<unknown>): void {\n  PerformPromiseThen(promise, undefined, rethrowAssertionErrorRejection);\n}\n\nlet _queueMicrotask: (callback: () => void) => void = callback => {\n  if (typeof queueMicrotask === 'function') {\n    _queueMicrotask = queueMicrotask;\n  } else {\n    const resolvedPromise = promiseResolvedWith(undefined);\n    _queueMicrotask = cb => PerformPromiseThen(resolvedPromise, cb);\n  }\n  return _queueMicrotask(callback);\n};\n\nexport { _queueMicrotask as queueMicrotask };\n\nexport function reflectCall<T, A extends any[], R>(F: (this: T, ...fnArgs: A) => R, V: T, args: A): R {\n  if (typeof F !== 'function') {\n    throw new TypeError('Argument is not a function');\n  }\n  return Function.prototype.apply.call(F, V, args);\n}\n\nexport function promiseCall<T, A extends any[], R>(F: (this: T, ...fnArgs: A) => R | PromiseLike<R>,\n                                                   V: T,\n                                                   args: A): Promise<R> {\n  assert(typeof F === 'function');\n  assert(V !== undefined);\n  assert(Array.isArray(args));\n  try {\n    return promiseResolvedWith(reflectCall(F, V, args));\n  } catch (value) {\n    return promiseRejectedWith(value);\n  }\n}\n", "import assert from '../stub/assert';\n\n// Original from Chromium\n// https://chromium.googlesource.com/chromium/src/+/0aee4434a4dba42a42abaea9bfbc0cd196a63bc1/third_party/blink/renderer/core/streams/SimpleQueue.js\n\nconst QUEUE_MAX_ARRAY_SIZE = 16384;\n\ninterface Node<T> {\n  _elements: T[];\n  _next: Node<T> | undefined;\n}\n\n/**\n * Simple queue structure.\n *\n * Avoids scalability issues with using a packed array directly by using\n * multiple arrays in a linked list and keeping the array size bounded.\n */\nexport class SimpleQueue<T> {\n  private _front: Node<T>;\n  private _back: Node<T>;\n  private _cursor = 0;\n  private _size = 0;\n\n  constructor() {\n    // _front and _back are always defined.\n    this._front = {\n      _elements: [],\n      _next: undefined\n    };\n    this._back = this._front;\n    // The cursor is used to avoid calling Array.shift().\n    // It contains the index of the front element of the array inside the\n    // front-most node. It is always in the range [0, QUEUE_MAX_ARRAY_SIZE).\n    this._cursor = 0;\n    // When there is only one node, size === elements.length - cursor.\n    this._size = 0;\n  }\n\n  get length(): number {\n    return this._size;\n  }\n\n  // For exception safety, this method is structured in order:\n  // 1. Read state\n  // 2. Calculate required state mutations\n  // 3. Perform state mutations\n  push(element: T): void {\n    const oldBack = this._back;\n    let newBack = oldBack;\n    assert(oldBack._next === undefined);\n    if (oldBack._elements.length === QUEUE_MAX_ARRAY_SIZE - 1) {\n      newBack = {\n        _elements: [],\n        _next: undefined\n      };\n    }\n\n    // push() is the mutation most likely to throw an exception, so it\n    // goes first.\n    oldBack._elements.push(element);\n    if (newBack !== oldBack) {\n      this._back = newBack;\n      oldBack._next = newBack;\n    }\n    ++this._size;\n  }\n\n  // Like push(), shift() follows the read -> calculate -> mutate pattern for\n  // exception safety.\n  shift(): T {\n    assert(this._size > 0); // must not be called on an empty queue\n\n    const oldFront = this._front;\n    let newFront = oldFront;\n    const oldCursor = this._cursor;\n    let newCursor = oldCursor + 1;\n\n    const elements = oldFront._elements;\n    const element = elements[oldCursor];\n\n    if (newCursor === QUEUE_MAX_ARRAY_SIZE) {\n      assert(elements.length === QUEUE_MAX_ARRAY_SIZE);\n      assert(oldFront._next !== undefined);\n      newFront = oldFront._next!;\n      newCursor = 0;\n    }\n\n    // No mutations before this point.\n    --this._size;\n    this._cursor = newCursor;\n    if (oldFront !== newFront) {\n      this._front = newFront;\n    }\n\n    // Permit shifted element to be garbage collected.\n    elements[oldCursor] = undefined!;\n\n    return element;\n  }\n\n  // The tricky thing about forEach() is that it can be called\n  // re-entrantly. The queue may be mutated inside the callback. It is easy to\n  // see that push() within the callback has no negative effects since the end\n  // of the queue is checked for on every iteration. If shift() is called\n  // repeatedly within the callback then the next iteration may return an\n  // element that has been removed. In this case the callback will be called\n  // with undefined values until we either \"catch up\" with elements that still\n  // exist or reach the back of the queue.\n  forEach(callback: (element: T) => void): void {\n    let i = this._cursor;\n    let node = this._front;\n    let elements = node._elements;\n    while (i !== elements.length || node._next !== undefined) {\n      if (i === elements.length) {\n        assert(node._next !== undefined);\n        assert(i === QUEUE_MAX_ARRAY_SIZE);\n        node = node._next!;\n        elements = node._elements;\n        i = 0;\n        if (elements.length === 0) {\n          break;\n        }\n      }\n      callback(elements[i]);\n      ++i;\n    }\n  }\n\n  // Return the element that would be returned if shift() was called now,\n  // without modifying the queue.\n  peek(): T {\n    assert(this._size > 0); // must not be called on an empty queue\n\n    const front = this._front;\n    const cursor = this._cursor;\n    return front._elements[cursor];\n  }\n}\n", "export const AbortSteps = Symbol('[[AbortSteps]]');\nexport const ErrorSteps = Symbol('[[ErrorSteps]]');\nexport const CancelSteps = Symbol('[[CancelSteps]]');\nexport const PullSteps = Symbol('[[PullSteps]]');\nexport const ReleaseSteps = Symbol('[[ReleaseSteps]]');\n", "import assert from '../../stub/assert';\nimport { ReadableStream, ReadableStreamCancel, type ReadableStreamReader } from '../readable-stream';\nimport { newPromise, setPromiseIsHandledToTrue } from '../helpers/webidl';\nimport { ReleaseSteps } from '../abstract-ops/internal-methods';\n\nexport function ReadableStreamReaderGenericInitialize<R>(reader: ReadableStreamReader<R>, stream: ReadableStream<R>) {\n  reader._ownerReadableStream = stream;\n  stream._reader = reader;\n\n  if (stream._state === 'readable') {\n    defaultReaderClosedPromiseInitialize(reader);\n  } else if (stream._state === 'closed') {\n    defaultReaderClosedPromiseInitializeAsResolved(reader);\n  } else {\n    assert(stream._state === 'errored');\n\n    defaultReaderClosedPromiseInitializeAsRejected(reader, stream._storedError);\n  }\n}\n\n// A client of ReadableStreamDefaultReader and ReadableStreamBYOBReader may use these functions directly to bypass state\n// check.\n\nexport function ReadableStreamReaderGenericCancel(reader: ReadableStreamReader<any>, reason: any): Promise<undefined> {\n  const stream = reader._ownerReadableStream;\n  assert(stream !== undefined);\n  return ReadableStreamCancel(stream, reason);\n}\n\nexport function ReadableStreamReaderGenericRelease(reader: ReadableStreamReader<any>) {\n  const stream = reader._ownerReadableStream;\n  assert(stream !== undefined);\n  assert(stream._reader === reader);\n\n  if (stream._state === 'readable') {\n    defaultReaderClosedPromiseReject(\n      reader,\n      new TypeError(`Reader was released and can no longer be used to monitor the stream's closedness`));\n  } else {\n    defaultReaderClosedPromiseResetToRejected(\n      reader,\n      new TypeError(`Reader was released and can no longer be used to monitor the stream's closedness`));\n  }\n\n  stream._readableStreamController[ReleaseSteps]();\n\n  stream._reader = undefined;\n  reader._ownerReadableStream = undefined!;\n}\n\n// Helper functions for the readers.\n\nexport function readerLockException(name: string): TypeError {\n  return new TypeError('Cannot ' + name + ' a stream using a released reader');\n}\n\n// Helper functions for the ReadableStreamDefaultReader.\n\nexport function defaultReaderClosedPromiseInitialize(reader: ReadableStreamReader<any>) {\n  reader._closedPromise = newPromise((resolve, reject) => {\n    reader._closedPromise_resolve = resolve;\n    reader._closedPromise_reject = reject;\n  });\n}\n\nexport function defaultReaderClosedPromiseInitializeAsRejected(reader: ReadableStreamReader<any>, reason: any) {\n  defaultReaderClosedPromiseInitialize(reader);\n  defaultReaderClosedPromiseReject(reader, reason);\n}\n\nexport function defaultReaderClosedPromiseInitializeAsResolved(reader: ReadableStreamReader<any>) {\n  defaultReaderClosedPromiseInitialize(reader);\n  defaultReaderClosedPromiseResolve(reader);\n}\n\nexport function defaultReaderClosedPromiseReject(reader: ReadableStreamReader<any>, reason: any) {\n  if (reader._closedPromise_reject === undefined) {\n    return;\n  }\n\n  setPromiseIsHandledToTrue(reader._closedPromise);\n  reader._closedPromise_reject(reason);\n  reader._closedPromise_resolve = undefined;\n  reader._closedPromise_reject = undefined;\n}\n\nexport function defaultReaderClosedPromiseResetToRejected(reader: ReadableStreamReader<any>, reason: any) {\n  assert(reader._closedPromise_resolve === undefined);\n  assert(reader._closedPromise_reject === undefined);\n\n  defaultReaderClosedPromiseInitializeAsRejected(reader, reason);\n}\n\nexport function defaultReaderClosedPromiseResolve(reader: ReadableStreamReader<any>) {\n  if (reader._closedPromise_resolve === undefined) {\n    return;\n  }\n\n  reader._closedPromise_resolve(undefined);\n  reader._closedPromise_resolve = undefined;\n  reader._closedPromise_reject = undefined;\n}\n", "/// <reference lib=\"es2015.core\" />\n\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isFinite#Polyfill\nconst NumberIsFinite: typeof Number.isFinite = Number.isFinite || function (x) {\n  return typeof x === 'number' && isFinite(x);\n};\n\nexport default NumberIsFinite;\n", "/// <reference lib=\"es2015.core\" />\n\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/trunc#Polyfill\nconst MathTrunc: typeof Math.trunc = Math.trunc || function (v) {\n  return v < 0 ? Math.ceil(v) : Math.floor(v);\n};\n\nexport default MathTrunc;\n", "import NumberIsFinite from '../../stub/number-isfinite';\nimport MathTrunc from '../../stub/math-trunc';\n\n// https://heycam.github.io/webidl/#idl-dictionaries\nexport function isDictionary(x: any): x is object | null {\n  return typeof x === 'object' || typeof x === 'function';\n}\n\nexport function assertDictionary(obj: unknown,\n                                 context: string): asserts obj is object | null | undefined {\n  if (obj !== undefined && !isDictionary(obj)) {\n    throw new TypeError(`${context} is not an object.`);\n  }\n}\n\nexport type AnyFunction = (...args: any[]) => any;\n\n// https://heycam.github.io/webidl/#idl-callback-functions\nexport function assertFunction(x: unknown, context: string): asserts x is AnyFunction {\n  if (typeof x !== 'function') {\n    throw new TypeError(`${context} is not a function.`);\n  }\n}\n\n// https://heycam.github.io/webidl/#idl-object\nexport function isObject(x: any): x is object {\n  return (typeof x === 'object' && x !== null) || typeof x === 'function';\n}\n\nexport function assertObject(x: unknown,\n                             context: string): asserts x is object {\n  if (!isObject(x)) {\n    throw new TypeError(`${context} is not an object.`);\n  }\n}\n\nexport function assertRequiredArgument<T>(x: T | undefined,\n                                          position: number,\n                                          context: string): asserts x is T {\n  if (x === undefined) {\n    throw new TypeError(`Parameter ${position} is required in '${context}'.`);\n  }\n}\n\nexport function assertRequiredField<T>(x: T | undefined,\n                                       field: string,\n                                       context: string): asserts x is T {\n  if (x === undefined) {\n    throw new TypeError(`${field} is required in '${context}'.`);\n  }\n}\n\n// https://heycam.github.io/webidl/#idl-unrestricted-double\nexport function convertUnrestrictedDouble(value: unknown): number {\n  return Number(value);\n}\n\nfunction censorNegativeZero(x: number): number {\n  return x === 0 ? 0 : x;\n}\n\nfunction integerPart(x: number): number {\n  return censorNegativeZero(MathTrunc(x));\n}\n\n// https://heycam.github.io/webidl/#idl-unsigned-long-long\nexport function convertUnsignedLongLongWithEnforceRange(value: unknown, context: string): number {\n  const lowerBound = 0;\n  const upperBound = Number.MAX_SAFE_INTEGER;\n\n  let x = Number(value);\n  x = censorNegativeZero(x);\n\n  if (!NumberIsFinite(x)) {\n    throw new TypeError(`${context} is not a finite number`);\n  }\n\n  x = integerPart(x);\n\n  if (x < lowerBound || x > upperBound) {\n    throw new TypeError(`${context} is outside the accepted range of ${lowerBound} to ${upperBound}, inclusive`);\n  }\n\n  if (!NumberIsFinite(x) || x === 0) {\n    return 0;\n  }\n\n  // TODO Use BigInt if supported?\n  // let xBigInt = BigInt(integerPart(x));\n  // xBigInt = BigInt.asUintN(64, xBigInt);\n  // return Number(xBigInt);\n\n  return x;\n}\n", "import { IsReadableStream, ReadableStream } from '../readable-stream';\n\nexport function assertReadableStream(x: unknown, context: string): asserts x is ReadableStream {\n  if (!IsReadableStream(x)) {\n    throw new TypeError(`${context} is not a ReadableStream.`);\n  }\n}\n", "import assert from '../../stub/assert';\nimport { SimpleQueue } from '../simple-queue';\nimport {\n  ReadableStreamReaderGenericCancel,\n  ReadableStreamReaderGenericInitialize,\n  ReadableStreamReaderGenericRelease,\n  readerLockException\n} from './generic-reader';\nimport { IsReadableStreamLocked, ReadableStream } from '../readable-stream';\nimport { setFunctionName, typeIsObject } from '../helpers/miscellaneous';\nimport { PullSteps } from '../abstract-ops/internal-methods';\nimport { newPromise, promiseRejectedWith } from '../helpers/webidl';\nimport { assertRequiredArgument } from '../validators/basic';\nimport { assertReadableStream } from '../validators/readable-stream';\n\n/**\n * A result returned by {@link ReadableStreamDefaultReader.read}.\n *\n * @public\n */\nexport type ReadableStreamDefaultReadResult<T> = {\n  done: false;\n  value: T;\n} | {\n  done: true;\n  value?: undefined;\n}\n\n// Abstract operations for the ReadableStream.\n\nexport function AcquireReadableStreamDefaultReader<R>(stream: ReadableStream): ReadableStreamDefaultReader<R> {\n  return new ReadableStreamDefaultReader(stream);\n}\n\n// ReadableStream API exposed for controllers.\n\nexport function ReadableStreamAddReadRequest<R>(stream: ReadableStream<R>,\n                                                readRequest: ReadRequest<R>): void {\n  assert(IsReadableStreamDefaultReader(stream._reader));\n  assert(stream._state === 'readable');\n\n  (stream._reader! as ReadableStreamDefaultReader<R>)._readRequests.push(readRequest);\n}\n\nexport function ReadableStreamFulfillReadRequest<R>(stream: ReadableStream<R>, chunk: R | undefined, done: boolean) {\n  const reader = stream._reader as ReadableStreamDefaultReader<R>;\n\n  assert(reader._readRequests.length > 0);\n\n  const readRequest = reader._readRequests.shift()!;\n  if (done) {\n    readRequest._closeSteps();\n  } else {\n    readRequest._chunkSteps(chunk!);\n  }\n}\n\nexport function ReadableStreamGetNumReadRequests<R>(stream: ReadableStream<R>): number {\n  return (stream._reader as ReadableStreamDefaultReader<R>)._readRequests.length;\n}\n\nexport function ReadableStreamHasDefaultReader(stream: ReadableStream): boolean {\n  const reader = stream._reader;\n\n  if (reader === undefined) {\n    return false;\n  }\n\n  if (!IsReadableStreamDefaultReader(reader)) {\n    return false;\n  }\n\n  return true;\n}\n\n// Readers\n\nexport interface ReadRequest<R> {\n  _chunkSteps(chunk: R): void;\n\n  _closeSteps(): void;\n\n  _errorSteps(e: any): void;\n}\n\n/**\n * A default reader vended by a {@link ReadableStream}.\n *\n * @public\n */\nexport class ReadableStreamDefaultReader<R = any> {\n  /** @internal */\n  _ownerReadableStream!: ReadableStream<R>;\n  /** @internal */\n  _closedPromise!: Promise<undefined>;\n  /** @internal */\n  _closedPromise_resolve?: (value?: undefined) => void;\n  /** @internal */\n  _closedPromise_reject?: (reason: any) => void;\n  /** @internal */\n  _readRequests: SimpleQueue<ReadRequest<R>>;\n\n  constructor(stream: ReadableStream<R>) {\n    assertRequiredArgument(stream, 1, 'ReadableStreamDefaultReader');\n    assertReadableStream(stream, 'First parameter');\n\n    if (IsReadableStreamLocked(stream)) {\n      throw new TypeError('This stream has already been locked for exclusive reading by another reader');\n    }\n\n    ReadableStreamReaderGenericInitialize(this, stream);\n\n    this._readRequests = new SimpleQueue();\n  }\n\n  /**\n   * Returns a promise that will be fulfilled when the stream becomes closed,\n   * or rejected if the stream ever errors or the reader's lock is released before the stream finishes closing.\n   */\n  get closed(): Promise<undefined> {\n    if (!IsReadableStreamDefaultReader(this)) {\n      return promiseRejectedWith(defaultReaderBrandCheckException('closed'));\n    }\n\n    return this._closedPromise;\n  }\n\n  /**\n   * If the reader is active, behaves the same as {@link ReadableStream.cancel | stream.cancel(reason)}.\n   */\n  cancel(reason: any = undefined): Promise<void> {\n    if (!IsReadableStreamDefaultReader(this)) {\n      return promiseRejectedWith(defaultReaderBrandCheckException('cancel'));\n    }\n\n    if (this._ownerReadableStream === undefined) {\n      return promiseRejectedWith(readerLockException('cancel'));\n    }\n\n    return ReadableStreamReaderGenericCancel(this, reason);\n  }\n\n  /**\n   * Returns a promise that allows access to the next chunk from the stream's internal queue, if available.\n   *\n   * If reading a chunk causes the queue to become empty, more data will be pulled from the underlying source.\n   */\n  read(): Promise<ReadableStreamDefaultReadResult<R>> {\n    if (!IsReadableStreamDefaultReader(this)) {\n      return promiseRejectedWith(defaultReaderBrandCheckException('read'));\n    }\n\n    if (this._ownerReadableStream === undefined) {\n      return promiseRejectedWith(readerLockException('read from'));\n    }\n\n    let resolvePromise!: (result: ReadableStreamDefaultReadResult<R>) => void;\n    let rejectPromise!: (reason: any) => void;\n    const promise = newPromise<ReadableStreamDefaultReadResult<R>>((resolve, reject) => {\n      resolvePromise = resolve;\n      rejectPromise = reject;\n    });\n    const readRequest: ReadRequest<R> = {\n      _chunkSteps: chunk => resolvePromise({ value: chunk, done: false }),\n      _closeSteps: () => resolvePromise({ value: undefined, done: true }),\n      _errorSteps: e => rejectPromise(e)\n    };\n    ReadableStreamDefaultReaderRead(this, readRequest);\n    return promise;\n  }\n\n  /**\n   * Releases the reader's lock on the corresponding stream. After the lock is released, the reader is no longer active.\n   * If the associated stream is errored when the lock is released, the reader will appear errored in the same way\n   * from now on; otherwise, the reader will appear closed.\n   *\n   * A reader's lock cannot be released while it still has a pending read request, i.e., if a promise returned by\n   * the reader's {@link ReadableStreamDefaultReader.read | read()} method has not yet been settled. Attempting to\n   * do so will throw a `TypeError` and leave the reader locked to the stream.\n   */\n  releaseLock(): void {\n    if (!IsReadableStreamDefaultReader(this)) {\n      throw defaultReaderBrandCheckException('releaseLock');\n    }\n\n    if (this._ownerReadableStream === undefined) {\n      return;\n    }\n\n    ReadableStreamDefaultReaderRelease(this);\n  }\n}\n\nObject.defineProperties(ReadableStreamDefaultReader.prototype, {\n  cancel: { enumerable: true },\n  read: { enumerable: true },\n  releaseLock: { enumerable: true },\n  closed: { enumerable: true }\n});\nsetFunctionName(ReadableStreamDefaultReader.prototype.cancel, 'cancel');\nsetFunctionName(ReadableStreamDefaultReader.prototype.read, 'read');\nsetFunctionName(ReadableStreamDefaultReader.prototype.releaseLock, 'releaseLock');\nif (typeof Symbol.toStringTag === 'symbol') {\n  Object.defineProperty(ReadableStreamDefaultReader.prototype, Symbol.toStringTag, {\n    value: 'ReadableStreamDefaultReader',\n    configurable: true\n  });\n}\n\n// Abstract operations for the readers.\n\nexport function IsReadableStreamDefaultReader<R = any>(x: any): x is ReadableStreamDefaultReader<R> {\n  if (!typeIsObject(x)) {\n    return false;\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(x, '_readRequests')) {\n    return false;\n  }\n\n  return x instanceof ReadableStreamDefaultReader;\n}\n\nexport function ReadableStreamDefaultReaderRead<R>(reader: ReadableStreamDefaultReader<R>,\n                                                   readRequest: ReadRequest<R>): void {\n  const stream = reader._ownerReadableStream;\n\n  assert(stream !== undefined);\n\n  stream._disturbed = true;\n\n  if (stream._state === 'closed') {\n    readRequest._closeSteps();\n  } else if (stream._state === 'errored') {\n    readRequest._errorSteps(stream._storedError);\n  } else {\n    assert(stream._state === 'readable');\n    stream._readableStreamController[PullSteps](readRequest as ReadRequest<any>);\n  }\n}\n\nexport function ReadableStreamDefaultReaderRelease(reader: ReadableStreamDefaultReader) {\n  ReadableStreamReaderGenericRelease(reader);\n  const e = new TypeError('Reader was released');\n  ReadableStreamDefaultReaderErrorReadRequests(reader, e);\n}\n\nexport function ReadableStreamDefaultReaderErrorReadRequests(reader: ReadableStreamDefaultReader, e: any) {\n  const readRequests = reader._readRequests;\n  reader._readRequests = new SimpleQueue();\n  readRequests.forEach(readRequest => {\n    readRequest._errorSteps(e);\n  });\n}\n\n// Helper functions for the ReadableStreamDefaultReader.\n\nfunction defaultReaderBrandCheckException(name: string): TypeError {\n  return new TypeError(\n    `ReadableStreamDefaultReader.prototype.${name} can only be used on a ReadableStreamDefaultReader`);\n}\n", "/// <reference lib=\"es2018.asynciterable\" />\n\n/* eslint-disable @typescript-eslint/no-empty-function */\nexport const AsyncIteratorPrototype: AsyncIterable<any> =\n  Object.getPrototypeOf(Object.getPrototypeOf(async function* (): AsyncIterableIterator<any> {}).prototype);\n", "/// <reference lib=\"es2018.asynciterable\" />\n\nimport { ReadableStream } from '../readable-stream';\nimport {\n  AcquireReadableStreamDefaultReader,\n  ReadableStreamDefaultReader,\n  ReadableStreamDefaultReaderRead,\n  type ReadableStreamDefaultReadResult,\n  type ReadRequest\n} from './default-reader';\nimport { ReadableStreamReaderGenericCancel, ReadableStreamReaderGenericRelease } from './generic-reader';\nimport assert from '../../stub/assert';\nimport { AsyncIteratorPrototype } from '@@target/stub/async-iterator-prototype';\nimport { typeIsObject } from '../helpers/miscellaneous';\nimport {\n  newPromise,\n  promiseRejectedWith,\n  promiseResolvedWith,\n  queueMicrotask,\n  transformPromiseWith\n} from '../helpers/webidl';\n\n/**\n * An async iterator returned by {@link ReadableStream.values}.\n *\n * @public\n */\nexport interface ReadableStreamAsyncIterator<R> extends AsyncIterableIterator<R> {\n  next(): Promise<IteratorResult<R, undefined>>;\n\n  return(value?: any): Promise<IteratorResult<any>>;\n}\n\nexport class ReadableStreamAsyncIteratorImpl<R> {\n  private readonly _reader: ReadableStreamDefaultReader<R>;\n  private readonly _preventCancel: boolean;\n  private _ongoingPromise: Promise<ReadableStreamDefaultReadResult<R>> | undefined = undefined;\n  private _isFinished = false;\n\n  constructor(reader: ReadableStreamDefaultReader<R>, preventCancel: boolean) {\n    this._reader = reader;\n    this._preventCancel = preventCancel;\n  }\n\n  next(): Promise<ReadableStreamDefaultReadResult<R>> {\n    const nextSteps = () => this._nextSteps();\n    this._ongoingPromise = this._ongoingPromise ?\n      transformPromiseWith(this._ongoingPromise, nextSteps, nextSteps) :\n      nextSteps();\n    return this._ongoingPromise;\n  }\n\n  return(value: any): Promise<ReadableStreamDefaultReadResult<any>> {\n    const returnSteps = () => this._returnSteps(value);\n    return this._ongoingPromise ?\n      transformPromiseWith(this._ongoingPromise, returnSteps, returnSteps) :\n      returnSteps();\n  }\n\n  private _nextSteps(): Promise<ReadableStreamDefaultReadResult<R>> {\n    if (this._isFinished) {\n      return Promise.resolve({ value: undefined, done: true });\n    }\n\n    const reader = this._reader;\n    assert(reader._ownerReadableStream !== undefined);\n\n    let resolvePromise!: (result: ReadableStreamDefaultReadResult<R>) => void;\n    let rejectPromise!: (reason: any) => void;\n    const promise = newPromise<ReadableStreamDefaultReadResult<R>>((resolve, reject) => {\n      resolvePromise = resolve;\n      rejectPromise = reject;\n    });\n    const readRequest: ReadRequest<R> = {\n      _chunkSteps: chunk => {\n        this._ongoingPromise = undefined;\n        // This needs to be delayed by one microtask, otherwise we stop pulling too early which breaks a test.\n        // FIXME Is this a bug in the specification, or in the test?\n        queueMicrotask(() => resolvePromise({ value: chunk, done: false }));\n      },\n      _closeSteps: () => {\n        this._ongoingPromise = undefined;\n        this._isFinished = true;\n        ReadableStreamReaderGenericRelease(reader);\n        resolvePromise({ value: undefined, done: true });\n      },\n      _errorSteps: reason => {\n        this._ongoingPromise = undefined;\n        this._isFinished = true;\n        ReadableStreamReaderGenericRelease(reader);\n        rejectPromise(reason);\n      }\n    };\n    ReadableStreamDefaultReaderRead(reader, readRequest);\n    return promise;\n  }\n\n  private _returnSteps(value: any): Promise<ReadableStreamDefaultReadResult<any>> {\n    if (this._isFinished) {\n      return Promise.resolve({ value, done: true });\n    }\n    this._isFinished = true;\n\n    const reader = this._reader;\n    assert(reader._ownerReadableStream !== undefined);\n    assert(reader._readRequests.length === 0);\n\n    if (!this._preventCancel) {\n      const result = ReadableStreamReaderGenericCancel(reader, value);\n      ReadableStreamReaderGenericRelease(reader);\n      return transformPromiseWith(result, () => ({ value, done: true }));\n    }\n\n    ReadableStreamReaderGenericRelease(reader);\n    return promiseResolvedWith({ value, done: true });\n  }\n}\n\ninterface ReadableStreamAsyncIteratorInstance<R> extends ReadableStreamAsyncIterator<R> {\n  /** @interal */\n  _asyncIteratorImpl: ReadableStreamAsyncIteratorImpl<R>;\n\n  next(): Promise<IteratorResult<R, undefined>>;\n\n  return(value?: any): Promise<IteratorResult<any>>;\n}\n\nconst ReadableStreamAsyncIteratorPrototype: ReadableStreamAsyncIteratorInstance<any> = {\n  next(this: ReadableStreamAsyncIteratorInstance<any>): Promise<ReadableStreamDefaultReadResult<any>> {\n    if (!IsReadableStreamAsyncIterator(this)) {\n      return promiseRejectedWith(streamAsyncIteratorBrandCheckException('next'));\n    }\n    return this._asyncIteratorImpl.next();\n  },\n\n  return(this: ReadableStreamAsyncIteratorInstance<any>, value: any): Promise<ReadableStreamDefaultReadResult<any>> {\n    if (!IsReadableStreamAsyncIterator(this)) {\n      return promiseRejectedWith(streamAsyncIteratorBrandCheckException('return'));\n    }\n    return this._asyncIteratorImpl.return(value);\n  }\n} as any;\nObject.setPrototypeOf(ReadableStreamAsyncIteratorPrototype, AsyncIteratorPrototype);\n\n// Abstract operations for the ReadableStream.\n\nexport function AcquireReadableStreamAsyncIterator<R>(stream: ReadableStream<R>,\n                                                      preventCancel: boolean): ReadableStreamAsyncIterator<R> {\n  const reader = AcquireReadableStreamDefaultReader<R>(stream);\n  const impl = new ReadableStreamAsyncIteratorImpl(reader, preventCancel);\n  const iterator: ReadableStreamAsyncIteratorInstance<R> = Object.create(ReadableStreamAsyncIteratorPrototype);\n  iterator._asyncIteratorImpl = impl;\n  return iterator;\n}\n\nfunction IsReadableStreamAsyncIterator<R = any>(x: any): x is ReadableStreamAsyncIterator<R> {\n  if (!typeIsObject(x)) {\n    return false;\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(x, '_asyncIteratorImpl')) {\n    return false;\n  }\n\n  try {\n    // noinspection SuspiciousTypeOfGuard\n    return (x as ReadableStreamAsyncIteratorInstance<any>)._asyncIteratorImpl instanceof\n      ReadableStreamAsyncIteratorImpl;\n  } catch {\n    return false;\n  }\n}\n\n// Helper functions for the ReadableStream.\n\nfunction streamAsyncIteratorBrandCheckException(name: string): TypeError {\n  return new TypeError(`ReadableStreamAsyncIterator.${name} can only be used on a ReadableSteamAsyncIterator`);\n}\n", "/// <reference lib=\"es2015.core\" />\n\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isNaN#Polyfill\nconst NumberIsNaN: typeof Number.isNaN = Number.isNaN || function (x) {\n  // eslint-disable-next-line no-self-compare\n  return x !== x;\n};\n\nexport default NumberIsNaN;\n", "import { reflectCall } from 'lib/helpers/webidl';\nimport { typeIsObject } from '../helpers/miscellaneous';\nimport assert from '../../stub/assert';\n\ndeclare global {\n  interface ArrayBuffer {\n    readonly detached: boolean;\n\n    transfer(): ArrayBuffer;\n  }\n\n  function structuredClone<T>(value: T, options: { transfer: ArrayBuffer[] }): T;\n}\n\nexport function CreateArrayFromList<T extends any[]>(elements: T): T {\n  // We use arrays to represent lists, so this is basically a no-op.\n  // Do a slice though just in case we happen to depend on the unique-ness.\n  return elements.slice() as T;\n}\n\nexport function CopyDataBlockBytes(dest: ArrayBuffer,\n                                   destOffset: number,\n                                   src: ArrayBuffer,\n                                   srcOffset: number,\n                                   n: number) {\n  new Uint8Array(dest).set(new Uint8Array(src, srcOffset, n), destOffset);\n}\n\nexport let TransferArrayBuffer = (O: ArrayBuffer): ArrayBuffer => {\n  if (typeof O.transfer === 'function') {\n    TransferArrayBuffer = buffer => buffer.transfer();\n  } else if (typeof structuredClone === 'function') {\n    TransferArrayBuffer = buffer => structuredClone(buffer, { transfer: [buffer] });\n  } else {\n    // Not implemented correctly\n    TransferArrayBuffer = buffer => buffer;\n  }\n  return TransferArrayBuffer(O);\n};\n\nexport function CanTransferArrayBuffer(O: ArrayBuffer): boolean {\n  return !IsDetachedBuffer(O);\n}\n\nexport let IsDetachedBuffer = (O: ArrayBuffer): boolean => {\n  if (typeof O.detached === 'boolean') {\n    IsDetachedBuffer = buffer => buffer.detached;\n  } else {\n    // Not implemented correctly\n    IsDetachedBuffer = buffer => buffer.byteLength === 0;\n  }\n  return IsDetachedBuffer(O);\n};\n\nexport function ArrayBufferSlice(buffer: ArrayBuffer, begin: number, end: number): ArrayBuffer {\n  // ArrayBuffer.prototype.slice is not available on IE10\n  // https://www.caniuse.com/mdn-javascript_builtins_arraybuffer_slice\n  if (buffer.slice) {\n    return buffer.slice(begin, end);\n  }\n  const length = end - begin;\n  const slice = new ArrayBuffer(length);\n  CopyDataBlockBytes(slice, 0, buffer, begin, length);\n  return slice;\n}\n\nexport type MethodName<T> = {\n  [P in keyof T]: T[P] extends Function | undefined ? P : never;\n}[keyof T];\n\nexport function GetMethod<T, K extends MethodName<T>>(receiver: T, prop: K): T[K] | undefined {\n  const func = receiver[prop];\n  if (func === undefined || func === null) {\n    return undefined;\n  }\n  if (typeof func !== 'function') {\n    throw new TypeError(`${String(prop)} is not a function`);\n  }\n  return func;\n}\n\nexport interface SyncIteratorRecord<T> {\n  iterator: Iterator<T>,\n  nextMethod: Iterator<T>['next'],\n  done: boolean;\n}\n\nexport interface AsyncIteratorRecord<T> {\n  iterator: AsyncIterator<T>,\n  nextMethod: AsyncIterator<T>['next'],\n  done: boolean;\n}\n\nexport type SyncOrAsyncIteratorRecord<T> = SyncIteratorRecord<T> | AsyncIteratorRecord<T>;\n\nexport function CreateAsyncFromSyncIterator<T>(syncIteratorRecord: SyncIteratorRecord<T>): AsyncIteratorRecord<T> {\n  // Instead of re-implementing CreateAsyncFromSyncIterator and %AsyncFromSyncIteratorPrototype%,\n  // we use yield* inside an async generator function to achieve the same result.\n\n  // Wrap the sync iterator inside a sync iterable, so we can use it with yield*.\n  const syncIterable = {\n    [Symbol.iterator]: () => syncIteratorRecord.iterator\n  };\n  // Create an async generator function and immediately invoke it.\n  const asyncIterator = (async function* () {\n    return yield* syncIterable;\n  }());\n  // Return as an async iterator record.\n  const nextMethod = asyncIterator.next;\n  return { iterator: asyncIterator, nextMethod, done: false };\n}\n\n// Aligns with core-js/modules/es.symbol.async-iterator.js\nexport const SymbolAsyncIterator: (typeof Symbol)['asyncIterator'] =\n  Symbol.asyncIterator ??\n  Symbol.for?.('Symbol.asyncIterator') ??\n  '@@asyncIterator';\n\nexport type SyncOrAsyncIterable<T> = Iterable<T> | AsyncIterable<T>;\nexport type SyncOrAsyncIteratorMethod<T> = () => (Iterator<T> | AsyncIterator<T>);\n\nfunction GetIterator<T>(\n  obj: SyncOrAsyncIterable<T>,\n  hint: 'async',\n  method?: SyncOrAsyncIteratorMethod<T>\n): AsyncIteratorRecord<T>;\nfunction GetIterator<T>(\n  obj: Iterable<T>,\n  hint: 'sync',\n  method?: SyncOrAsyncIteratorMethod<T>\n): SyncIteratorRecord<T>;\nfunction GetIterator<T>(\n  obj: SyncOrAsyncIterable<T>,\n  hint = 'sync',\n  method?: SyncOrAsyncIteratorMethod<T>\n): SyncOrAsyncIteratorRecord<T> {\n  assert(hint === 'sync' || hint === 'async');\n  if (method === undefined) {\n    if (hint === 'async') {\n      method = GetMethod(obj as AsyncIterable<T>, SymbolAsyncIterator);\n      if (method === undefined) {\n        const syncMethod = GetMethod(obj as Iterable<T>, Symbol.iterator);\n        const syncIteratorRecord = GetIterator(obj as Iterable<T>, 'sync', syncMethod);\n        return CreateAsyncFromSyncIterator(syncIteratorRecord);\n      }\n    } else {\n      method = GetMethod(obj as Iterable<T>, Symbol.iterator);\n    }\n  }\n  if (method === undefined) {\n    throw new TypeError('The object is not iterable');\n  }\n  const iterator = reflectCall(method, obj, []);\n  if (!typeIsObject(iterator)) {\n    throw new TypeError('The iterator method must return an object');\n  }\n  const nextMethod = iterator.next;\n  return { iterator, nextMethod, done: false } as SyncOrAsyncIteratorRecord<T>;\n}\n\nexport { GetIterator };\n\nexport function IteratorNext<T>(iteratorRecord: AsyncIteratorRecord<T>): Promise<IteratorResult<T>> {\n  const result = reflectCall(iteratorRecord.nextMethod, iteratorRecord.iterator, []);\n  if (!typeIsObject(result)) {\n    throw new TypeError('The iterator.next() method must return an object');\n  }\n  return result;\n}\n\nexport function IteratorComplete<TReturn>(\n  iterResult: IteratorResult<unknown, TReturn>\n): iterResult is IteratorReturnResult<TReturn> {\n  assert(typeIsObject(iterResult));\n  return Boolean(iterResult.done);\n}\n\nexport function IteratorValue<T>(iterResult: IteratorYieldResult<T>): T {\n  assert(typeIsObject(iterResult));\n  return iterResult.value;\n}\n", "import NumberIsNaN from '../../stub/number-isnan';\nimport { ArrayBufferSlice } from './ecmascript';\nimport type { NonShared } from '../helpers/array-buffer-view';\n\nexport function IsNonNegativeNumber(v: number): boolean {\n  if (typeof v !== 'number') {\n    return false;\n  }\n\n  if (NumberIsNaN(v)) {\n    return false;\n  }\n\n  if (v < 0) {\n    return false;\n  }\n\n  return true;\n}\n\nexport function CloneAsUint8Array(O: NonShared<ArrayBufferView>): NonShared<Uint8Array> {\n  const buffer = ArrayBufferSlice(O.buffer, O.byteOffset, O.byteOffset + O.byteLength);\n  return new Uint8Array(buffer) as NonShared<Uint8Array>;\n}\n", "import assert from '../../stub/assert';\nimport { SimpleQueue } from '../simple-queue';\nimport { IsNonNegativeNumber } from './miscellaneous';\n\nexport interface QueueContainer<T> {\n  _queue: SimpleQueue<T>;\n  _queueTotalSize: number;\n}\n\nexport interface QueuePair<T> {\n  value: T;\n  size: number;\n}\n\nexport function DequeueValue<T>(container: QueueContainer<QueuePair<T>>): T {\n  assert('_queue' in container && '_queueTotalSize' in container);\n  assert(container._queue.length > 0);\n\n  const pair = container._queue.shift()!;\n  container._queueTotalSize -= pair.size;\n  if (container._queueTotalSize < 0) {\n    container._queueTotalSize = 0;\n  }\n\n  return pair.value;\n}\n\nexport function EnqueueValueWithSize<T>(container: QueueContainer<QueuePair<T>>, value: T, size: number) {\n  assert('_queue' in container && '_queueTotalSize' in container);\n\n  if (!IsNonNegativeNumber(size) || size === Infinity) {\n    throw new RangeError('Size must be a finite, non-NaN, non-negative number.');\n  }\n\n  container._queue.push({ value, size });\n  container._queueTotalSize += size;\n}\n\nexport function PeekQueueValue<T>(container: QueueContainer<QueuePair<T>>): T {\n  assert('_queue' in container && '_queueTotalSize' in container);\n  assert(container._queue.length > 0);\n\n  const pair = container._queue.peek();\n  return pair.value;\n}\n\nexport function ResetQueue<T>(container: QueueContainer<T>) {\n  assert('_queue' in container && '_queueTotalSize' in container);\n\n  container._queue = new SimpleQueue<T>();\n  container._queueTotalSize = 0;\n}\n", "export type TypedArray =\n  | Int8Array\n  | Uint8Array\n  | Uint8ClampedArray\n  | Int16Array\n  | Uint16Array\n  | Int32Array\n  | Uint32Array\n  | Float32Array\n  | Float64Array;\n\nexport type NonShared<T extends ArrayBufferView> = T & {\n  buffer: ArrayBuffer;\n}\n\nexport interface ArrayBufferViewConstructor<T extends ArrayBufferView = ArrayBufferView> {\n  new(buffer: ArrayBuffer, byteOffset: number, length?: number): T;\n\n  readonly prototype: T;\n}\n\nexport interface TypedArrayConstructor<T extends TypedArray = TypedArray> extends ArrayBufferViewConstructor<T> {\n  readonly BYTES_PER_ELEMENT: number;\n}\n\nexport type DataViewConstructor = ArrayBufferViewConstructor<DataView>;\n\nfunction isDataViewConstructor(ctor: Function): ctor is DataViewConstructor {\n  return ctor === DataView;\n}\n\nexport function isDataView(view: ArrayBufferView): view is DataView {\n  return isDataViewConstructor(view.constructor);\n}\n\nexport function arrayBufferViewElementSize<T extends ArrayBufferView>(ctor: ArrayBufferViewConstructor<T>): number {\n  if (isDataViewConstructor(ctor)) {\n    return 1;\n  }\n  return (ctor as unknown as TypedArrayConstructor).BYTES_PER_ELEMENT;\n}\n", "import assert from '../../stub/assert';\nimport { SimpleQueue } from '../simple-queue';\nimport { ResetQueue } from '../abstract-ops/queue-with-sizes';\nimport {\n  IsReadableStreamDefaultReader,\n  ReadableStreamAddReadRequest,\n  ReadableStreamFulfillReadRequest,\n  ReadableStreamGetNumReadRequests,\n  ReadableStreamHasDefaultReader,\n  type ReadRequest\n} from './default-reader';\nimport {\n  ReadableStreamAddReadIntoRequest,\n  ReadableStreamFulfillReadIntoRequest,\n  ReadableStreamGetNumReadIntoRequests,\n  ReadableStreamHasBYOBReader,\n  type ReadIntoRequest\n} from './byob-reader';\nimport NumberIsInteger from '../../stub/number-isinteger';\nimport {\n  IsReadableStreamLocked,\n  type ReadableByteStream,\n  ReadableStreamClose,\n  ReadableStreamError\n} from '../readable-stream';\nimport type { ValidatedUnderlyingByteSource } from './underlying-source';\nimport { setFunctionName, typeIsObject } from '../helpers/miscellaneous';\nimport {\n  ArrayBufferSlice,\n  CanTransferArrayBuffer,\n  CopyDataBlockBytes,\n  IsDetachedBuffer,\n  TransferArrayBuffer\n} from '../abstract-ops/ecmascript';\nimport { CancelSteps, PullSteps, ReleaseSteps } from '../abstract-ops/internal-methods';\nimport { promiseResolvedWith, uponPromise } from '../helpers/webidl';\nimport { assertRequiredArgument, convertUnsignedLongLongWithEnforceRange } from '../validators/basic';\nimport {\n  type ArrayBufferViewConstructor,\n  arrayBufferViewElementSize,\n  type NonShared,\n  type TypedArrayConstructor\n} from '../helpers/array-buffer-view';\n\n/**\n * A pull-into request in a {@link ReadableByteStreamController}.\n *\n * @public\n */\nexport class ReadableStreamBYOBRequest {\n  /** @internal */\n  _associatedReadableByteStreamController!: ReadableByteStreamController;\n  /** @internal */\n  _view!: NonShared<ArrayBufferView> | null;\n\n  private constructor() {\n    throw new TypeError('Illegal constructor');\n  }\n\n  /**\n   * Returns the view for writing in to, or `null` if the BYOB request has already been responded to.\n   */\n  get view(): ArrayBufferView | null {\n    if (!IsReadableStreamBYOBRequest(this)) {\n      throw byobRequestBrandCheckException('view');\n    }\n\n    return this._view;\n  }\n\n  /**\n   * Indicates to the associated readable byte stream that `bytesWritten` bytes were written into\n   * {@link ReadableStreamBYOBRequest.view | view}, causing the result be surfaced to the consumer.\n   *\n   * After this method is called, {@link ReadableStreamBYOBRequest.view | view} will be transferred and no longer\n   * modifiable.\n   */\n  respond(bytesWritten: number): void;\n  respond(bytesWritten: number | undefined): void {\n    if (!IsReadableStreamBYOBRequest(this)) {\n      throw byobRequestBrandCheckException('respond');\n    }\n    assertRequiredArgument(bytesWritten, 1, 'respond');\n    bytesWritten = convertUnsignedLongLongWithEnforceRange(bytesWritten, 'First parameter');\n\n    if (this._associatedReadableByteStreamController === undefined) {\n      throw new TypeError('This BYOB request has been invalidated');\n    }\n\n    if (IsDetachedBuffer(this._view!.buffer)) {\n      throw new TypeError(`The BYOB request's buffer has been detached and so cannot be used as a response`);\n    }\n\n    assert(this._view!.byteLength > 0);\n    assert(this._view!.buffer.byteLength > 0);\n\n    ReadableByteStreamControllerRespond(this._associatedReadableByteStreamController, bytesWritten);\n  }\n\n  /**\n   * Indicates to the associated readable byte stream that instead of writing into\n   * {@link ReadableStreamBYOBRequest.view | view}, the underlying byte source is providing a new `ArrayBufferView`,\n   * which will be given to the consumer of the readable byte stream.\n   *\n   * After this method is called, `view` will be transferred and no longer modifiable.\n   */\n  respondWithNewView(view: ArrayBufferView): void;\n  respondWithNewView(view: NonShared<ArrayBufferView>): void {\n    if (!IsReadableStreamBYOBRequest(this)) {\n      throw byobRequestBrandCheckException('respondWithNewView');\n    }\n    assertRequiredArgument(view, 1, 'respondWithNewView');\n\n    if (!ArrayBuffer.isView(view)) {\n      throw new TypeError('You can only respond with array buffer views');\n    }\n\n    if (this._associatedReadableByteStreamController === undefined) {\n      throw new TypeError('This BYOB request has been invalidated');\n    }\n\n    if (IsDetachedBuffer(view.buffer)) {\n      throw new TypeError('The given view\\'s buffer has been detached and so cannot be used as a response');\n    }\n\n    ReadableByteStreamControllerRespondWithNewView(this._associatedReadableByteStreamController, view);\n  }\n}\n\nObject.defineProperties(ReadableStreamBYOBRequest.prototype, {\n  respond: { enumerable: true },\n  respondWithNewView: { enumerable: true },\n  view: { enumerable: true }\n});\nsetFunctionName(ReadableStreamBYOBRequest.prototype.respond, 'respond');\nsetFunctionName(ReadableStreamBYOBRequest.prototype.respondWithNewView, 'respondWithNewView');\nif (typeof Symbol.toStringTag === 'symbol') {\n  Object.defineProperty(ReadableStreamBYOBRequest.prototype, Symbol.toStringTag, {\n    value: 'ReadableStreamBYOBRequest',\n    configurable: true\n  });\n}\n\ninterface ByteQueueElement {\n  buffer: ArrayBuffer;\n  byteOffset: number;\n  byteLength: number;\n}\n\ntype PullIntoDescriptor<T extends NonShared<ArrayBufferView> = NonShared<ArrayBufferView>> =\n  DefaultPullIntoDescriptor\n  | BYOBPullIntoDescriptor<T>;\n\ninterface DefaultPullIntoDescriptor {\n  buffer: ArrayBuffer;\n  bufferByteLength: number;\n  byteOffset: number;\n  byteLength: number;\n  bytesFilled: number;\n  minimumFill: number;\n  elementSize: number;\n  viewConstructor: TypedArrayConstructor<Uint8Array>;\n  readerType: 'default' | 'none';\n}\n\ninterface BYOBPullIntoDescriptor<T extends NonShared<ArrayBufferView> = NonShared<ArrayBufferView>> {\n  buffer: ArrayBuffer;\n  bufferByteLength: number;\n  byteOffset: number;\n  byteLength: number;\n  bytesFilled: number;\n  minimumFill: number;\n  elementSize: number;\n  viewConstructor: ArrayBufferViewConstructor<T>;\n  readerType: 'byob' | 'none';\n}\n\n/**\n * Allows control of a {@link ReadableStream | readable byte stream}'s state and internal queue.\n *\n * @public\n */\nexport class ReadableByteStreamController {\n  /** @internal */\n  _controlledReadableByteStream!: ReadableByteStream;\n  /** @internal */\n  _queue!: SimpleQueue<ByteQueueElement>;\n  /** @internal */\n  _queueTotalSize!: number;\n  /** @internal */\n  _started!: boolean;\n  /** @internal */\n  _closeRequested!: boolean;\n  /** @internal */\n  _pullAgain!: boolean;\n  /** @internal */\n  _pulling !: boolean;\n  /** @internal */\n  _strategyHWM!: number;\n  /** @internal */\n  _pullAlgorithm!: () => Promise<void>;\n  /** @internal */\n  _cancelAlgorithm!: (reason: any) => Promise<void>;\n  /** @internal */\n  _autoAllocateChunkSize: number | undefined;\n  /** @internal */\n  _byobRequest: ReadableStreamBYOBRequest | null;\n  /** @internal */\n  _pendingPullIntos!: SimpleQueue<PullIntoDescriptor>;\n\n  private constructor() {\n    throw new TypeError('Illegal constructor');\n  }\n\n  /**\n   * Returns the current BYOB pull request, or `null` if there isn't one.\n   */\n  get byobRequest(): ReadableStreamBYOBRequest | null {\n    if (!IsReadableByteStreamController(this)) {\n      throw byteStreamControllerBrandCheckException('byobRequest');\n    }\n\n    return ReadableByteStreamControllerGetBYOBRequest(this);\n  }\n\n  /**\n   * Returns the desired size to fill the controlled stream's internal queue. It can be negative, if the queue is\n   * over-full. An underlying byte source ought to use this information to determine when and how to apply backpressure.\n   */\n  get desiredSize(): number | null {\n    if (!IsReadableByteStreamController(this)) {\n      throw byteStreamControllerBrandCheckException('desiredSize');\n    }\n\n    return ReadableByteStreamControllerGetDesiredSize(this);\n  }\n\n  /**\n   * Closes the controlled readable stream. Consumers will still be able to read any previously-enqueued chunks from\n   * the stream, but once those are read, the stream will become closed.\n   */\n  close(): void {\n    if (!IsReadableByteStreamController(this)) {\n      throw byteStreamControllerBrandCheckException('close');\n    }\n\n    if (this._closeRequested) {\n      throw new TypeError('The stream has already been closed; do not close it again!');\n    }\n\n    const state = this._controlledReadableByteStream._state;\n    if (state !== 'readable') {\n      throw new TypeError(`The stream (in ${state} state) is not in the readable state and cannot be closed`);\n    }\n\n    ReadableByteStreamControllerClose(this);\n  }\n\n  /**\n   * Enqueues the given chunk chunk in the controlled readable stream.\n   * The chunk has to be an `ArrayBufferView` instance, or else a `TypeError` will be thrown.\n   */\n  enqueue(chunk: ArrayBufferView): void;\n  enqueue(chunk: NonShared<ArrayBufferView>): void {\n    if (!IsReadableByteStreamController(this)) {\n      throw byteStreamControllerBrandCheckException('enqueue');\n    }\n\n    assertRequiredArgument(chunk, 1, 'enqueue');\n    if (!ArrayBuffer.isView(chunk)) {\n      throw new TypeError('chunk must be an array buffer view');\n    }\n    if (chunk.byteLength === 0) {\n      throw new TypeError('chunk must have non-zero byteLength');\n    }\n    if (chunk.buffer.byteLength === 0) {\n      throw new TypeError(`chunk's buffer must have non-zero byteLength`);\n    }\n\n    if (this._closeRequested) {\n      throw new TypeError('stream is closed or draining');\n    }\n\n    const state = this._controlledReadableByteStream._state;\n    if (state !== 'readable') {\n      throw new TypeError(`The stream (in ${state} state) is not in the readable state and cannot be enqueued to`);\n    }\n\n    ReadableByteStreamControllerEnqueue(this, chunk);\n  }\n\n  /**\n   * Errors the controlled readable stream, making all future interactions with it fail with the given error `e`.\n   */\n  error(e: any = undefined): void {\n    if (!IsReadableByteStreamController(this)) {\n      throw byteStreamControllerBrandCheckException('error');\n    }\n\n    ReadableByteStreamControllerError(this, e);\n  }\n\n  /** @internal */\n  [CancelSteps](reason: any): Promise<void> {\n    ReadableByteStreamControllerClearPendingPullIntos(this);\n\n    ResetQueue(this);\n\n    const result = this._cancelAlgorithm(reason);\n    ReadableByteStreamControllerClearAlgorithms(this);\n    return result;\n  }\n\n  /** @internal */\n  [PullSteps](readRequest: ReadRequest<NonShared<Uint8Array>>): void {\n    const stream = this._controlledReadableByteStream;\n    assert(ReadableStreamHasDefaultReader(stream));\n\n    if (this._queueTotalSize > 0) {\n      assert(ReadableStreamGetNumReadRequests(stream) === 0);\n\n      ReadableByteStreamControllerFillReadRequestFromQueue(this, readRequest);\n      return;\n    }\n\n    const autoAllocateChunkSize = this._autoAllocateChunkSize;\n    if (autoAllocateChunkSize !== undefined) {\n      let buffer: ArrayBuffer;\n      try {\n        buffer = new ArrayBuffer(autoAllocateChunkSize);\n      } catch (bufferE) {\n        readRequest._errorSteps(bufferE);\n        return;\n      }\n\n      const pullIntoDescriptor: DefaultPullIntoDescriptor = {\n        buffer,\n        bufferByteLength: autoAllocateChunkSize,\n        byteOffset: 0,\n        byteLength: autoAllocateChunkSize,\n        bytesFilled: 0,\n        minimumFill: 1,\n        elementSize: 1,\n        viewConstructor: Uint8Array,\n        readerType: 'default'\n      };\n\n      this._pendingPullIntos.push(pullIntoDescriptor);\n    }\n\n    ReadableStreamAddReadRequest(stream, readRequest);\n    ReadableByteStreamControllerCallPullIfNeeded(this);\n  }\n\n  /** @internal */\n  [ReleaseSteps](): void {\n    if (this._pendingPullIntos.length > 0) {\n      const firstPullInto = this._pendingPullIntos.peek();\n      firstPullInto.readerType = 'none';\n\n      this._pendingPullIntos = new SimpleQueue();\n      this._pendingPullIntos.push(firstPullInto);\n    }\n  }\n}\n\nObject.defineProperties(ReadableByteStreamController.prototype, {\n  close: { enumerable: true },\n  enqueue: { enumerable: true },\n  error: { enumerable: true },\n  byobRequest: { enumerable: true },\n  desiredSize: { enumerable: true }\n});\nsetFunctionName(ReadableByteStreamController.prototype.close, 'close');\nsetFunctionName(ReadableByteStreamController.prototype.enqueue, 'enqueue');\nsetFunctionName(ReadableByteStreamController.prototype.error, 'error');\nif (typeof Symbol.toStringTag === 'symbol') {\n  Object.defineProperty(ReadableByteStreamController.prototype, Symbol.toStringTag, {\n    value: 'ReadableByteStreamController',\n    configurable: true\n  });\n}\n\n// Abstract operations for the ReadableByteStreamController.\n\nexport function IsReadableByteStreamController(x: any): x is ReadableByteStreamController {\n  if (!typeIsObject(x)) {\n    return false;\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(x, '_controlledReadableByteStream')) {\n    return false;\n  }\n\n  return x instanceof ReadableByteStreamController;\n}\n\nfunction IsReadableStreamBYOBRequest(x: any): x is ReadableStreamBYOBRequest {\n  if (!typeIsObject(x)) {\n    return false;\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(x, '_associatedReadableByteStreamController')) {\n    return false;\n  }\n\n  return x instanceof ReadableStreamBYOBRequest;\n}\n\nfunction ReadableByteStreamControllerCallPullIfNeeded(controller: ReadableByteStreamController): void {\n  const shouldPull = ReadableByteStreamControllerShouldCallPull(controller);\n  if (!shouldPull) {\n    return;\n  }\n\n  if (controller._pulling) {\n    controller._pullAgain = true;\n    return;\n  }\n\n  assert(!controller._pullAgain);\n\n  controller._pulling = true;\n\n  // TODO: Test controller argument\n  const pullPromise = controller._pullAlgorithm();\n  uponPromise(\n    pullPromise,\n    () => {\n      controller._pulling = false;\n\n      if (controller._pullAgain) {\n        controller._pullAgain = false;\n        ReadableByteStreamControllerCallPullIfNeeded(controller);\n      }\n\n      return null;\n    },\n    e => {\n      ReadableByteStreamControllerError(controller, e);\n      return null;\n    }\n  );\n}\n\nfunction ReadableByteStreamControllerClearPendingPullIntos(controller: ReadableByteStreamController) {\n  ReadableByteStreamControllerInvalidateBYOBRequest(controller);\n  controller._pendingPullIntos = new SimpleQueue();\n}\n\nfunction ReadableByteStreamControllerCommitPullIntoDescriptor<T extends NonShared<ArrayBufferView>>(\n  stream: ReadableByteStream,\n  pullIntoDescriptor: PullIntoDescriptor<T>\n) {\n  assert(stream._state !== 'errored');\n  assert(pullIntoDescriptor.readerType !== 'none');\n\n  let done = false;\n  if (stream._state === 'closed') {\n    assert(pullIntoDescriptor.bytesFilled % pullIntoDescriptor.elementSize === 0);\n    done = true;\n  }\n\n  const filledView = ReadableByteStreamControllerConvertPullIntoDescriptor<T>(pullIntoDescriptor);\n  if (pullIntoDescriptor.readerType === 'default') {\n    ReadableStreamFulfillReadRequest(stream, filledView as unknown as NonShared<Uint8Array>, done);\n  } else {\n    assert(pullIntoDescriptor.readerType === 'byob');\n    ReadableStreamFulfillReadIntoRequest(stream, filledView, done);\n  }\n}\n\nfunction ReadableByteStreamControllerConvertPullIntoDescriptor<T extends NonShared<ArrayBufferView>>(\n  pullIntoDescriptor: PullIntoDescriptor<T>\n): T {\n  const bytesFilled = pullIntoDescriptor.bytesFilled;\n  const elementSize = pullIntoDescriptor.elementSize;\n\n  assert(bytesFilled <= pullIntoDescriptor.byteLength);\n  assert(bytesFilled % elementSize === 0);\n\n  return new pullIntoDescriptor.viewConstructor(\n    pullIntoDescriptor.buffer, pullIntoDescriptor.byteOffset, bytesFilled / elementSize) as T;\n}\n\nfunction ReadableByteStreamControllerEnqueueChunkToQueue(controller: ReadableByteStreamController,\n                                                         buffer: ArrayBuffer,\n                                                         byteOffset: number,\n                                                         byteLength: number) {\n  controller._queue.push({ buffer, byteOffset, byteLength });\n  controller._queueTotalSize += byteLength;\n}\n\nfunction ReadableByteStreamControllerEnqueueClonedChunkToQueue(controller: ReadableByteStreamController,\n                                                               buffer: ArrayBuffer,\n                                                               byteOffset: number,\n                                                               byteLength: number) {\n  let clonedChunk;\n  try {\n    clonedChunk = ArrayBufferSlice(buffer, byteOffset, byteOffset + byteLength);\n  } catch (cloneE) {\n    ReadableByteStreamControllerError(controller, cloneE);\n    throw cloneE;\n  }\n  ReadableByteStreamControllerEnqueueChunkToQueue(controller, clonedChunk, 0, byteLength);\n}\n\nfunction ReadableByteStreamControllerEnqueueDetachedPullIntoToQueue(controller: ReadableByteStreamController,\n                                                                    firstDescriptor: PullIntoDescriptor) {\n  assert(firstDescriptor.readerType === 'none');\n  if (firstDescriptor.bytesFilled > 0) {\n    ReadableByteStreamControllerEnqueueClonedChunkToQueue(\n      controller,\n      firstDescriptor.buffer,\n      firstDescriptor.byteOffset,\n      firstDescriptor.bytesFilled\n    );\n  }\n  ReadableByteStreamControllerShiftPendingPullInto(controller);\n}\n\nfunction ReadableByteStreamControllerFillPullIntoDescriptorFromQueue(controller: ReadableByteStreamController,\n                                                                     pullIntoDescriptor: PullIntoDescriptor) {\n  const maxBytesToCopy = Math.min(controller._queueTotalSize,\n                                  pullIntoDescriptor.byteLength - pullIntoDescriptor.bytesFilled);\n  const maxBytesFilled = pullIntoDescriptor.bytesFilled + maxBytesToCopy;\n\n  let totalBytesToCopyRemaining = maxBytesToCopy;\n  let ready = false;\n  assert(pullIntoDescriptor.bytesFilled < pullIntoDescriptor.minimumFill);\n  const remainderBytes = maxBytesFilled % pullIntoDescriptor.elementSize;\n  const maxAlignedBytes = maxBytesFilled - remainderBytes;\n  // A descriptor for a read() request that is not yet filled up to its minimum length will stay at the head\n  // of the queue, so the underlying source can keep filling it.\n  if (maxAlignedBytes >= pullIntoDescriptor.minimumFill) {\n    totalBytesToCopyRemaining = maxAlignedBytes - pullIntoDescriptor.bytesFilled;\n    ready = true;\n  }\n\n  const queue = controller._queue;\n\n  while (totalBytesToCopyRemaining > 0) {\n    const headOfQueue = queue.peek();\n\n    const bytesToCopy = Math.min(totalBytesToCopyRemaining, headOfQueue.byteLength);\n\n    const destStart = pullIntoDescriptor.byteOffset + pullIntoDescriptor.bytesFilled;\n    CopyDataBlockBytes(pullIntoDescriptor.buffer, destStart, headOfQueue.buffer, headOfQueue.byteOffset, bytesToCopy);\n\n    if (headOfQueue.byteLength === bytesToCopy) {\n      queue.shift();\n    } else {\n      headOfQueue.byteOffset += bytesToCopy;\n      headOfQueue.byteLength -= bytesToCopy;\n    }\n    controller._queueTotalSize -= bytesToCopy;\n\n    ReadableByteStreamControllerFillHeadPullIntoDescriptor(controller, bytesToCopy, pullIntoDescriptor);\n\n    totalBytesToCopyRemaining -= bytesToCopy;\n  }\n\n  if (!ready) {\n    assert(controller._queueTotalSize === 0);\n    assert(pullIntoDescriptor.bytesFilled > 0);\n    assert(pullIntoDescriptor.bytesFilled < pullIntoDescriptor.minimumFill);\n  }\n\n  return ready;\n}\n\nfunction ReadableByteStreamControllerFillHeadPullIntoDescriptor(controller: ReadableByteStreamController,\n                                                                size: number,\n                                                                pullIntoDescriptor: PullIntoDescriptor) {\n  assert(controller._pendingPullIntos.length === 0 || controller._pendingPullIntos.peek() === pullIntoDescriptor);\n  assert(controller._byobRequest === null);\n  pullIntoDescriptor.bytesFilled += size;\n}\n\nfunction ReadableByteStreamControllerHandleQueueDrain(controller: ReadableByteStreamController) {\n  assert(controller._controlledReadableByteStream._state === 'readable');\n\n  if (controller._queueTotalSize === 0 && controller._closeRequested) {\n    ReadableByteStreamControllerClearAlgorithms(controller);\n    ReadableStreamClose(controller._controlledReadableByteStream);\n  } else {\n    ReadableByteStreamControllerCallPullIfNeeded(controller);\n  }\n}\n\nfunction ReadableByteStreamControllerInvalidateBYOBRequest(controller: ReadableByteStreamController) {\n  if (controller._byobRequest === null) {\n    return;\n  }\n\n  controller._byobRequest._associatedReadableByteStreamController = undefined!;\n  controller._byobRequest._view = null!;\n  controller._byobRequest = null;\n}\n\nfunction ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue(controller: ReadableByteStreamController) {\n  assert(!controller._closeRequested);\n\n  while (controller._pendingPullIntos.length > 0) {\n    if (controller._queueTotalSize === 0) {\n      return;\n    }\n\n    const pullIntoDescriptor = controller._pendingPullIntos.peek();\n    assert(pullIntoDescriptor.readerType !== 'none');\n\n    if (ReadableByteStreamControllerFillPullIntoDescriptorFromQueue(controller, pullIntoDescriptor)) {\n      ReadableByteStreamControllerShiftPendingPullInto(controller);\n\n      ReadableByteStreamControllerCommitPullIntoDescriptor(\n        controller._controlledReadableByteStream,\n        pullIntoDescriptor\n      );\n    }\n  }\n}\n\nfunction ReadableByteStreamControllerProcessReadRequestsUsingQueue(controller: ReadableByteStreamController) {\n  const reader = controller._controlledReadableByteStream._reader;\n  assert(IsReadableStreamDefaultReader(reader));\n  while (reader._readRequests.length > 0) {\n    if (controller._queueTotalSize === 0) {\n      return;\n    }\n    const readRequest = reader._readRequests.shift();\n    ReadableByteStreamControllerFillReadRequestFromQueue(controller, readRequest);\n  }\n}\n\nexport function ReadableByteStreamControllerPullInto<T extends NonShared<ArrayBufferView>>(\n  controller: ReadableByteStreamController,\n  view: T,\n  min: number,\n  readIntoRequest: ReadIntoRequest<T>\n): void {\n  const stream = controller._controlledReadableByteStream;\n\n  const ctor = view.constructor as ArrayBufferViewConstructor<T>;\n  const elementSize = arrayBufferViewElementSize(ctor);\n\n  const { byteOffset, byteLength } = view;\n\n  const minimumFill = min * elementSize;\n  assert(minimumFill >= elementSize && minimumFill <= byteLength);\n  assert(minimumFill % elementSize === 0);\n\n  let buffer: ArrayBuffer;\n  try {\n    buffer = TransferArrayBuffer(view.buffer);\n  } catch (e) {\n    readIntoRequest._errorSteps(e);\n    return;\n  }\n\n  const pullIntoDescriptor: BYOBPullIntoDescriptor<T> = {\n    buffer,\n    bufferByteLength: buffer.byteLength,\n    byteOffset,\n    byteLength,\n    bytesFilled: 0,\n    minimumFill,\n    elementSize,\n    viewConstructor: ctor,\n    readerType: 'byob'\n  };\n\n  if (controller._pendingPullIntos.length > 0) {\n    controller._pendingPullIntos.push(pullIntoDescriptor);\n\n    // No ReadableByteStreamControllerCallPullIfNeeded() call since:\n    // - No change happens on desiredSize\n    // - The source has already been notified of that there's at least 1 pending read(view)\n\n    ReadableStreamAddReadIntoRequest(stream, readIntoRequest);\n    return;\n  }\n\n  if (stream._state === 'closed') {\n    const emptyView = new ctor(pullIntoDescriptor.buffer, pullIntoDescriptor.byteOffset, 0);\n    readIntoRequest._closeSteps(emptyView);\n    return;\n  }\n\n  if (controller._queueTotalSize > 0) {\n    if (ReadableByteStreamControllerFillPullIntoDescriptorFromQueue(controller, pullIntoDescriptor)) {\n      const filledView = ReadableByteStreamControllerConvertPullIntoDescriptor<T>(pullIntoDescriptor);\n\n      ReadableByteStreamControllerHandleQueueDrain(controller);\n\n      readIntoRequest._chunkSteps(filledView);\n      return;\n    }\n\n    if (controller._closeRequested) {\n      const e = new TypeError('Insufficient bytes to fill elements in the given buffer');\n      ReadableByteStreamControllerError(controller, e);\n\n      readIntoRequest._errorSteps(e);\n      return;\n    }\n  }\n\n  controller._pendingPullIntos.push(pullIntoDescriptor);\n\n  ReadableStreamAddReadIntoRequest<T>(stream, readIntoRequest);\n  ReadableByteStreamControllerCallPullIfNeeded(controller);\n}\n\nfunction ReadableByteStreamControllerRespondInClosedState(controller: ReadableByteStreamController,\n                                                          firstDescriptor: PullIntoDescriptor) {\n  assert(firstDescriptor.bytesFilled % firstDescriptor.elementSize === 0);\n\n  if (firstDescriptor.readerType === 'none') {\n    ReadableByteStreamControllerShiftPendingPullInto(controller);\n  }\n\n  const stream = controller._controlledReadableByteStream;\n  if (ReadableStreamHasBYOBReader(stream)) {\n    while (ReadableStreamGetNumReadIntoRequests(stream) > 0) {\n      const pullIntoDescriptor = ReadableByteStreamControllerShiftPendingPullInto(controller);\n      ReadableByteStreamControllerCommitPullIntoDescriptor(stream, pullIntoDescriptor);\n    }\n  }\n}\n\nfunction ReadableByteStreamControllerRespondInReadableState(controller: ReadableByteStreamController,\n                                                            bytesWritten: number,\n                                                            pullIntoDescriptor: PullIntoDescriptor) {\n  assert(pullIntoDescriptor.bytesFilled + bytesWritten <= pullIntoDescriptor.byteLength);\n\n  ReadableByteStreamControllerFillHeadPullIntoDescriptor(controller, bytesWritten, pullIntoDescriptor);\n\n  if (pullIntoDescriptor.readerType === 'none') {\n    ReadableByteStreamControllerEnqueueDetachedPullIntoToQueue(controller, pullIntoDescriptor);\n    ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue(controller);\n    return;\n  }\n\n  if (pullIntoDescriptor.bytesFilled < pullIntoDescriptor.minimumFill) {\n    // A descriptor for a read() request that is not yet filled up to its minimum length will stay at the head\n    // of the queue, so the underlying source can keep filling it.\n    return;\n  }\n\n  ReadableByteStreamControllerShiftPendingPullInto(controller);\n\n  const remainderSize = pullIntoDescriptor.bytesFilled % pullIntoDescriptor.elementSize;\n  if (remainderSize > 0) {\n    const end = pullIntoDescriptor.byteOffset + pullIntoDescriptor.bytesFilled;\n    ReadableByteStreamControllerEnqueueClonedChunkToQueue(\n      controller,\n      pullIntoDescriptor.buffer,\n      end - remainderSize,\n      remainderSize\n    );\n  }\n\n  pullIntoDescriptor.bytesFilled -= remainderSize;\n  ReadableByteStreamControllerCommitPullIntoDescriptor(controller._controlledReadableByteStream, pullIntoDescriptor);\n\n  ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue(controller);\n}\n\nfunction ReadableByteStreamControllerRespondInternal(controller: ReadableByteStreamController, bytesWritten: number) {\n  const firstDescriptor = controller._pendingPullIntos.peek();\n  assert(CanTransferArrayBuffer(firstDescriptor.buffer));\n\n  ReadableByteStreamControllerInvalidateBYOBRequest(controller);\n\n  const state = controller._controlledReadableByteStream._state;\n  if (state === 'closed') {\n    assert(bytesWritten === 0);\n    ReadableByteStreamControllerRespondInClosedState(controller, firstDescriptor);\n  } else {\n    assert(state === 'readable');\n    assert(bytesWritten > 0);\n    ReadableByteStreamControllerRespondInReadableState(controller, bytesWritten, firstDescriptor);\n  }\n\n  ReadableByteStreamControllerCallPullIfNeeded(controller);\n}\n\nfunction ReadableByteStreamControllerShiftPendingPullInto(\n  controller: ReadableByteStreamController\n): PullIntoDescriptor {\n  assert(controller._byobRequest === null);\n  const descriptor = controller._pendingPullIntos.shift()!;\n  return descriptor;\n}\n\nfunction ReadableByteStreamControllerShouldCallPull(controller: ReadableByteStreamController): boolean {\n  const stream = controller._controlledReadableByteStream;\n\n  if (stream._state !== 'readable') {\n    return false;\n  }\n\n  if (controller._closeRequested) {\n    return false;\n  }\n\n  if (!controller._started) {\n    return false;\n  }\n\n  if (ReadableStreamHasDefaultReader(stream) && ReadableStreamGetNumReadRequests(stream) > 0) {\n    return true;\n  }\n\n  if (ReadableStreamHasBYOBReader(stream) && ReadableStreamGetNumReadIntoRequests(stream) > 0) {\n    return true;\n  }\n\n  const desiredSize = ReadableByteStreamControllerGetDesiredSize(controller);\n  assert(desiredSize !== null);\n  if (desiredSize! > 0) {\n    return true;\n  }\n\n  return false;\n}\n\nfunction ReadableByteStreamControllerClearAlgorithms(controller: ReadableByteStreamController) {\n  controller._pullAlgorithm = undefined!;\n  controller._cancelAlgorithm = undefined!;\n}\n\n// A client of ReadableByteStreamController may use these functions directly to bypass state check.\n\nexport function ReadableByteStreamControllerClose(controller: ReadableByteStreamController) {\n  const stream = controller._controlledReadableByteStream;\n\n  if (controller._closeRequested || stream._state !== 'readable') {\n    return;\n  }\n\n  if (controller._queueTotalSize > 0) {\n    controller._closeRequested = true;\n\n    return;\n  }\n\n  if (controller._pendingPullIntos.length > 0) {\n    const firstPendingPullInto = controller._pendingPullIntos.peek();\n    if (firstPendingPullInto.bytesFilled % firstPendingPullInto.elementSize !== 0) {\n      const e = new TypeError('Insufficient bytes to fill elements in the given buffer');\n      ReadableByteStreamControllerError(controller, e);\n\n      throw e;\n    }\n  }\n\n  ReadableByteStreamControllerClearAlgorithms(controller);\n  ReadableStreamClose(stream);\n}\n\nexport function ReadableByteStreamControllerEnqueue(\n  controller: ReadableByteStreamController,\n  chunk: NonShared<ArrayBufferView>\n) {\n  const stream = controller._controlledReadableByteStream;\n\n  if (controller._closeRequested || stream._state !== 'readable') {\n    return;\n  }\n\n  const { buffer, byteOffset, byteLength } = chunk;\n  if (IsDetachedBuffer(buffer)) {\n    throw new TypeError('chunk\\'s buffer is detached and so cannot be enqueued');\n  }\n  const transferredBuffer = TransferArrayBuffer(buffer);\n\n  if (controller._pendingPullIntos.length > 0) {\n    const firstPendingPullInto = controller._pendingPullIntos.peek();\n    if (IsDetachedBuffer(firstPendingPullInto.buffer)) {\n      throw new TypeError(\n        'The BYOB request\\'s buffer has been detached and so cannot be filled with an enqueued chunk'\n      );\n    }\n    ReadableByteStreamControllerInvalidateBYOBRequest(controller);\n    firstPendingPullInto.buffer = TransferArrayBuffer(firstPendingPullInto.buffer);\n    if (firstPendingPullInto.readerType === 'none') {\n      ReadableByteStreamControllerEnqueueDetachedPullIntoToQueue(controller, firstPendingPullInto);\n    }\n  }\n\n  if (ReadableStreamHasDefaultReader(stream)) {\n    ReadableByteStreamControllerProcessReadRequestsUsingQueue(controller);\n    if (ReadableStreamGetNumReadRequests(stream) === 0) {\n      assert(controller._pendingPullIntos.length === 0);\n      ReadableByteStreamControllerEnqueueChunkToQueue(controller, transferredBuffer, byteOffset, byteLength);\n    } else {\n      assert(controller._queue.length === 0);\n      if (controller._pendingPullIntos.length > 0) {\n        assert(controller._pendingPullIntos.peek().readerType === 'default');\n        ReadableByteStreamControllerShiftPendingPullInto(controller);\n      }\n      const transferredView = new Uint8Array(transferredBuffer, byteOffset, byteLength);\n      ReadableStreamFulfillReadRequest(stream, transferredView as NonShared<Uint8Array>, false);\n    }\n  } else if (ReadableStreamHasBYOBReader(stream)) {\n    // TODO: Ideally in this branch detaching should happen only if the buffer is not consumed fully.\n    ReadableByteStreamControllerEnqueueChunkToQueue(controller, transferredBuffer, byteOffset, byteLength);\n    ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue(controller);\n  } else {\n    assert(!IsReadableStreamLocked(stream));\n    ReadableByteStreamControllerEnqueueChunkToQueue(controller, transferredBuffer, byteOffset, byteLength);\n  }\n\n  ReadableByteStreamControllerCallPullIfNeeded(controller);\n}\n\nexport function ReadableByteStreamControllerError(controller: ReadableByteStreamController, e: any) {\n  const stream = controller._controlledReadableByteStream;\n\n  if (stream._state !== 'readable') {\n    return;\n  }\n\n  ReadableByteStreamControllerClearPendingPullIntos(controller);\n\n  ResetQueue(controller);\n  ReadableByteStreamControllerClearAlgorithms(controller);\n  ReadableStreamError(stream, e);\n}\n\nexport function ReadableByteStreamControllerFillReadRequestFromQueue(\n  controller: ReadableByteStreamController,\n  readRequest: ReadRequest<NonShared<Uint8Array>>\n) {\n  assert(controller._queueTotalSize > 0);\n\n  const entry = controller._queue.shift();\n  controller._queueTotalSize -= entry.byteLength;\n\n  ReadableByteStreamControllerHandleQueueDrain(controller);\n\n  const view = new Uint8Array(entry.buffer, entry.byteOffset, entry.byteLength);\n  readRequest._chunkSteps(view as NonShared<Uint8Array>);\n}\n\nexport function ReadableByteStreamControllerGetBYOBRequest(\n  controller: ReadableByteStreamController\n): ReadableStreamBYOBRequest | null {\n  if (controller._byobRequest === null && controller._pendingPullIntos.length > 0) {\n    const firstDescriptor = controller._pendingPullIntos.peek();\n    const view = new Uint8Array(firstDescriptor.buffer,\n                                firstDescriptor.byteOffset + firstDescriptor.bytesFilled,\n                                firstDescriptor.byteLength - firstDescriptor.bytesFilled);\n\n    const byobRequest: ReadableStreamBYOBRequest = Object.create(ReadableStreamBYOBRequest.prototype);\n    SetUpReadableStreamBYOBRequest(byobRequest, controller, view as NonShared<Uint8Array>);\n    controller._byobRequest = byobRequest;\n  }\n  return controller._byobRequest;\n}\n\nfunction ReadableByteStreamControllerGetDesiredSize(controller: ReadableByteStreamController): number | null {\n  const state = controller._controlledReadableByteStream._state;\n\n  if (state === 'errored') {\n    return null;\n  }\n  if (state === 'closed') {\n    return 0;\n  }\n\n  return controller._strategyHWM - controller._queueTotalSize;\n}\n\nexport function ReadableByteStreamControllerRespond(controller: ReadableByteStreamController, bytesWritten: number) {\n  assert(controller._pendingPullIntos.length > 0);\n\n  const firstDescriptor = controller._pendingPullIntos.peek();\n  const state = controller._controlledReadableByteStream._state;\n\n  if (state === 'closed') {\n    if (bytesWritten !== 0) {\n      throw new TypeError('bytesWritten must be 0 when calling respond() on a closed stream');\n    }\n  } else {\n    assert(state === 'readable');\n    if (bytesWritten === 0) {\n      throw new TypeError('bytesWritten must be greater than 0 when calling respond() on a readable stream');\n    }\n    if (firstDescriptor.bytesFilled + bytesWritten > firstDescriptor.byteLength) {\n      throw new RangeError('bytesWritten out of range');\n    }\n  }\n\n  firstDescriptor.buffer = TransferArrayBuffer(firstDescriptor.buffer);\n\n  ReadableByteStreamControllerRespondInternal(controller, bytesWritten);\n}\n\nexport function ReadableByteStreamControllerRespondWithNewView(controller: ReadableByteStreamController,\n                                                               view: NonShared<ArrayBufferView>) {\n  assert(controller._pendingPullIntos.length > 0);\n  assert(!IsDetachedBuffer(view.buffer));\n\n  const firstDescriptor = controller._pendingPullIntos.peek();\n  const state = controller._controlledReadableByteStream._state;\n\n  if (state === 'closed') {\n    if (view.byteLength !== 0) {\n      throw new TypeError('The view\\'s length must be 0 when calling respondWithNewView() on a closed stream');\n    }\n  } else {\n    assert(state === 'readable');\n    if (view.byteLength === 0) {\n      throw new TypeError(\n        'The view\\'s length must be greater than 0 when calling respondWithNewView() on a readable stream'\n      );\n    }\n  }\n\n  if (firstDescriptor.byteOffset + firstDescriptor.bytesFilled !== view.byteOffset) {\n    throw new RangeError('The region specified by view does not match byobRequest');\n  }\n  if (firstDescriptor.bufferByteLength !== view.buffer.byteLength) {\n    throw new RangeError('The buffer of view has different capacity than byobRequest');\n  }\n  if (firstDescriptor.bytesFilled + view.byteLength > firstDescriptor.byteLength) {\n    throw new RangeError('The region specified by view is larger than byobRequest');\n  }\n\n  const viewByteLength = view.byteLength;\n  firstDescriptor.buffer = TransferArrayBuffer(view.buffer);\n  ReadableByteStreamControllerRespondInternal(controller, viewByteLength);\n}\n\nexport function SetUpReadableByteStreamController(stream: ReadableByteStream,\n                                                  controller: ReadableByteStreamController,\n                                                  startAlgorithm: () => void | PromiseLike<void>,\n                                                  pullAlgorithm: () => Promise<void>,\n                                                  cancelAlgorithm: (reason: any) => Promise<void>,\n                                                  highWaterMark: number,\n                                                  autoAllocateChunkSize: number | undefined) {\n  assert(stream._readableStreamController === undefined);\n  if (autoAllocateChunkSize !== undefined) {\n    assert(NumberIsInteger(autoAllocateChunkSize));\n    assert(autoAllocateChunkSize > 0);\n  }\n\n  controller._controlledReadableByteStream = stream;\n\n  controller._pullAgain = false;\n  controller._pulling = false;\n\n  controller._byobRequest = null;\n\n  // Need to set the slots so that the assert doesn't fire. In the spec the slots already exist implicitly.\n  controller._queue = controller._queueTotalSize = undefined!;\n  ResetQueue(controller);\n\n  controller._closeRequested = false;\n  controller._started = false;\n\n  controller._strategyHWM = highWaterMark;\n\n  controller._pullAlgorithm = pullAlgorithm;\n  controller._cancelAlgorithm = cancelAlgorithm;\n\n  controller._autoAllocateChunkSize = autoAllocateChunkSize;\n\n  controller._pendingPullIntos = new SimpleQueue();\n\n  stream._readableStreamController = controller;\n\n  const startResult = startAlgorithm();\n  uponPromise(\n    promiseResolvedWith(startResult),\n    () => {\n      controller._started = true;\n\n      assert(!controller._pulling);\n      assert(!controller._pullAgain);\n\n      ReadableByteStreamControllerCallPullIfNeeded(controller);\n      return null;\n    },\n    r => {\n      ReadableByteStreamControllerError(controller, r);\n      return null;\n    }\n  );\n}\n\nexport function SetUpReadableByteStreamControllerFromUnderlyingSource(\n  stream: ReadableByteStream,\n  underlyingByteSource: ValidatedUnderlyingByteSource,\n  highWaterMark: number\n) {\n  const controller: ReadableByteStreamController = Object.create(ReadableByteStreamController.prototype);\n\n  let startAlgorithm: () => void | PromiseLike<void>;\n  let pullAlgorithm: () => Promise<void>;\n  let cancelAlgorithm: (reason: any) => Promise<void>;\n\n  if (underlyingByteSource.start !== undefined) {\n    startAlgorithm = () => underlyingByteSource.start!(controller);\n  } else {\n    startAlgorithm = () => undefined;\n  }\n  if (underlyingByteSource.pull !== undefined) {\n    pullAlgorithm = () => underlyingByteSource.pull!(controller);\n  } else {\n    pullAlgorithm = () => promiseResolvedWith(undefined);\n  }\n  if (underlyingByteSource.cancel !== undefined) {\n    cancelAlgorithm = reason => underlyingByteSource.cancel!(reason);\n  } else {\n    cancelAlgorithm = () => promiseResolvedWith(undefined);\n  }\n\n  const autoAllocateChunkSize = underlyingByteSource.autoAllocateChunkSize;\n  if (autoAllocateChunkSize === 0) {\n    throw new TypeError('autoAllocateChunkSize must be greater than 0');\n  }\n\n  SetUpReadableByteStreamController(\n    stream, controller, startAlgorithm, pullAlgorithm, cancelAlgorithm, highWaterMark, autoAllocateChunkSize\n  );\n}\n\nfunction SetUpReadableStreamBYOBRequest(request: ReadableStreamBYOBRequest,\n                                        controller: ReadableByteStreamController,\n                                        view: NonShared<ArrayBufferView>) {\n  assert(IsReadableByteStreamController(controller));\n  assert(typeof view === 'object');\n  assert(ArrayBuffer.isView(view));\n  assert(!IsDetachedBuffer(view.buffer));\n  request._associatedReadableByteStreamController = controller;\n  request._view = view;\n}\n\n// Helper functions for the ReadableStreamBYOBRequest.\n\nfunction byobRequestBrandCheckException(name: string): TypeError {\n  return new TypeError(\n    `ReadableStreamBYOBRequest.prototype.${name} can only be used on a ReadableStreamBYOBRequest`);\n}\n\n// Helper functions for the ReadableByteStreamController.\n\nfunction byteStreamControllerBrandCheckException(name: string): TypeError {\n  return new TypeError(\n    `ReadableByteStreamController.prototype.${name} can only be used on a ReadableByteStreamController`);\n}\n", "import { assertDictionary, convertUnsignedLongLongWithEnforceRange } from './basic';\nimport type {\n  ReadableStreamBYOBReaderReadOptions,\n  ReadableStreamGetReaderOptions,\n  ValidatedReadableStreamBYOBReaderReadOptions\n} from '../readable-stream/reader-options';\n\nexport function convertReaderOptions(options: ReadableStreamGetReaderOptions | null | undefined,\n                                     context: string): ReadableStreamGetReaderOptions {\n  assertDictionary(options, context);\n  const mode = options?.mode;\n  return {\n    mode: mode === undefined ? undefined : convertReadableStreamReaderMode(mode, `${context} has member 'mode' that`)\n  };\n}\n\nfunction convertReadableStreamReaderMode(mode: string, context: string): 'byob' {\n  mode = `${mode}`;\n  if (mode !== 'byob') {\n    throw new TypeError(`${context} '${mode}' is not a valid enumeration value for ReadableStreamReaderMode`);\n  }\n  return mode;\n}\n\nexport function convertByobReadOptions(\n  options: ReadableStreamBYOBReaderReadOptions | null | undefined,\n  context: string\n): ValidatedReadableStreamBYOBReaderReadOptions {\n  assertDictionary(options, context);\n  const min = options?.min ?? 1;\n  return {\n    min: convertUnsignedLongLongWithEnforceRange(\n      min,\n      `${context} has member 'min' that`\n    )\n  };\n}\n", "import assert from '../../stub/assert';\nimport { SimpleQueue } from '../simple-queue';\nimport {\n  ReadableStreamReaderGenericCancel,\n  ReadableStreamReaderGenericInitialize,\n  ReadableStreamReaderGenericRelease,\n  readerLockException\n} from './generic-reader';\nimport { IsReadableStreamLocked, type ReadableByteStream, type ReadableStream } from '../readable-stream';\nimport {\n  IsReadableByteStreamController,\n  ReadableByteStreamController,\n  ReadableByteStreamControllerPullInto\n} from './byte-stream-controller';\nimport { setFunctionName, typeIsObject } from '../helpers/miscellaneous';\nimport { newPromise, promiseRejectedWith } from '../helpers/webidl';\nimport { assertRequiredArgument } from '../validators/basic';\nimport { assertReadableStream } from '../validators/readable-stream';\nimport { IsDetachedBuffer } from '../abstract-ops/ecmascript';\nimport type {\n  ReadableStreamBYOBReaderReadOptions,\n  ValidatedReadableStreamBYOBReaderReadOptions\n} from './reader-options';\nimport { convertByobReadOptions } from '../validators/reader-options';\nimport { isDataView, type NonShared, type TypedArray } from '../helpers/array-buffer-view';\n\n/**\n * A result returned by {@link ReadableStreamBYOBReader.read}.\n *\n * @public\n */\nexport type ReadableStreamBYOBReadResult<T extends ArrayBufferView> = {\n  done: false;\n  value: T;\n} | {\n  done: true;\n  value: T | undefined;\n};\n\n// Abstract operations for the ReadableStream.\n\nexport function AcquireReadableStreamBYOBReader(stream: ReadableByteStream): ReadableStreamBYOBReader {\n  return new ReadableStreamBYOBReader(stream as ReadableStream<Uint8Array>);\n}\n\n// ReadableStream API exposed for controllers.\n\nexport function ReadableStreamAddReadIntoRequest<T extends NonShared<ArrayBufferView>>(\n  stream: ReadableByteStream,\n  readIntoRequest: ReadIntoRequest<T>\n): void {\n  assert(IsReadableStreamBYOBReader(stream._reader));\n  assert(stream._state === 'readable' || stream._state === 'closed');\n\n  (stream._reader! as ReadableStreamBYOBReader)._readIntoRequests.push(readIntoRequest);\n}\n\nexport function ReadableStreamFulfillReadIntoRequest(stream: ReadableByteStream,\n                                                     chunk: ArrayBufferView,\n                                                     done: boolean) {\n  const reader = stream._reader as ReadableStreamBYOBReader;\n\n  assert(reader._readIntoRequests.length > 0);\n\n  const readIntoRequest = reader._readIntoRequests.shift()!;\n  if (done) {\n    readIntoRequest._closeSteps(chunk);\n  } else {\n    readIntoRequest._chunkSteps(chunk);\n  }\n}\n\nexport function ReadableStreamGetNumReadIntoRequests(stream: ReadableByteStream): number {\n  return (stream._reader as ReadableStreamBYOBReader)._readIntoRequests.length;\n}\n\nexport function ReadableStreamHasBYOBReader(stream: ReadableByteStream): boolean {\n  const reader = stream._reader;\n\n  if (reader === undefined) {\n    return false;\n  }\n\n  if (!IsReadableStreamBYOBReader(reader)) {\n    return false;\n  }\n\n  return true;\n}\n\n// Readers\n\nexport interface ReadIntoRequest<T extends NonShared<ArrayBufferView>> {\n  _chunkSteps(chunk: T): void;\n\n  _closeSteps(chunk: T | undefined): void;\n\n  _errorSteps(e: any): void;\n}\n\n/**\n * A BYOB reader vended by a {@link ReadableStream}.\n *\n * @public\n */\nexport class ReadableStreamBYOBReader {\n  /** @internal */\n  _ownerReadableStream!: ReadableByteStream;\n  /** @internal */\n  _closedPromise!: Promise<undefined>;\n  /** @internal */\n  _closedPromise_resolve?: (value?: undefined) => void;\n  /** @internal */\n  _closedPromise_reject?: (reason: any) => void;\n  /** @internal */\n  _readIntoRequests: SimpleQueue<ReadIntoRequest<any>>;\n\n  constructor(stream: ReadableStream<Uint8Array>) {\n    assertRequiredArgument(stream, 1, 'ReadableStreamBYOBReader');\n    assertReadableStream(stream, 'First parameter');\n\n    if (IsReadableStreamLocked(stream)) {\n      throw new TypeError('This stream has already been locked for exclusive reading by another reader');\n    }\n\n    if (!IsReadableByteStreamController(stream._readableStreamController)) {\n      throw new TypeError('Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte ' +\n        'source');\n    }\n\n    ReadableStreamReaderGenericInitialize(this, stream);\n\n    this._readIntoRequests = new SimpleQueue();\n  }\n\n  /**\n   * Returns a promise that will be fulfilled when the stream becomes closed, or rejected if the stream ever errors or\n   * the reader's lock is released before the stream finishes closing.\n   */\n  get closed(): Promise<undefined> {\n    if (!IsReadableStreamBYOBReader(this)) {\n      return promiseRejectedWith(byobReaderBrandCheckException('closed'));\n    }\n\n    return this._closedPromise;\n  }\n\n  /**\n   * If the reader is active, behaves the same as {@link ReadableStream.cancel | stream.cancel(reason)}.\n   */\n  cancel(reason: any = undefined): Promise<void> {\n    if (!IsReadableStreamBYOBReader(this)) {\n      return promiseRejectedWith(byobReaderBrandCheckException('cancel'));\n    }\n\n    if (this._ownerReadableStream === undefined) {\n      return promiseRejectedWith(readerLockException('cancel'));\n    }\n\n    return ReadableStreamReaderGenericCancel(this, reason);\n  }\n\n  /**\n   * Attempts to reads bytes into view, and returns a promise resolved with the result.\n   *\n   * If reading a chunk causes the queue to become empty, more data will be pulled from the underlying source.\n   */\n  read<T extends ArrayBufferView>(\n    view: T,\n    options?: ReadableStreamBYOBReaderReadOptions\n  ): Promise<ReadableStreamBYOBReadResult<T>>;\n  read<T extends NonShared<ArrayBufferView>>(\n    view: T,\n    rawOptions: ReadableStreamBYOBReaderReadOptions | null | undefined = {}\n  ): Promise<ReadableStreamBYOBReadResult<T>> {\n    if (!IsReadableStreamBYOBReader(this)) {\n      return promiseRejectedWith(byobReaderBrandCheckException('read'));\n    }\n\n    if (!ArrayBuffer.isView(view)) {\n      return promiseRejectedWith(new TypeError('view must be an array buffer view'));\n    }\n    if (view.byteLength === 0) {\n      return promiseRejectedWith(new TypeError('view must have non-zero byteLength'));\n    }\n    if (view.buffer.byteLength === 0) {\n      return promiseRejectedWith(new TypeError(`view's buffer must have non-zero byteLength`));\n    }\n    if (IsDetachedBuffer(view.buffer)) {\n      return promiseRejectedWith(new TypeError('view\\'s buffer has been detached'));\n    }\n\n    let options: ValidatedReadableStreamBYOBReaderReadOptions;\n    try {\n      options = convertByobReadOptions(rawOptions, 'options');\n    } catch (e) {\n      return promiseRejectedWith(e);\n    }\n    const min = options.min;\n    if (min === 0) {\n      return promiseRejectedWith(new TypeError('options.min must be greater than 0'));\n    }\n    if (!isDataView(view)) {\n      if (min > (view as unknown as TypedArray).length) {\n        return promiseRejectedWith(new RangeError('options.min must be less than or equal to view\\'s length'));\n      }\n    } else if (min > view.byteLength) {\n      return promiseRejectedWith(new RangeError('options.min must be less than or equal to view\\'s byteLength'));\n    }\n\n    if (this._ownerReadableStream === undefined) {\n      return promiseRejectedWith(readerLockException('read from'));\n    }\n\n    let resolvePromise!: (result: ReadableStreamBYOBReadResult<T>) => void;\n    let rejectPromise!: (reason: any) => void;\n    const promise = newPromise<ReadableStreamBYOBReadResult<T>>((resolve, reject) => {\n      resolvePromise = resolve;\n      rejectPromise = reject;\n    });\n    const readIntoRequest: ReadIntoRequest<T> = {\n      _chunkSteps: chunk => resolvePromise({ value: chunk, done: false }),\n      _closeSteps: chunk => resolvePromise({ value: chunk, done: true }),\n      _errorSteps: e => rejectPromise(e)\n    };\n    ReadableStreamBYOBReaderRead(this, view, min, readIntoRequest);\n    return promise;\n  }\n\n  /**\n   * Releases the reader's lock on the corresponding stream. After the lock is released, the reader is no longer active.\n   * If the associated stream is errored when the lock is released, the reader will appear errored in the same way\n   * from now on; otherwise, the reader will appear closed.\n   *\n   * A reader's lock cannot be released while it still has a pending read request, i.e., if a promise returned by\n   * the reader's {@link ReadableStreamBYOBReader.read | read()} method has not yet been settled. Attempting to\n   * do so will throw a `TypeError` and leave the reader locked to the stream.\n   */\n  releaseLock(): void {\n    if (!IsReadableStreamBYOBReader(this)) {\n      throw byobReaderBrandCheckException('releaseLock');\n    }\n\n    if (this._ownerReadableStream === undefined) {\n      return;\n    }\n\n    ReadableStreamBYOBReaderRelease(this);\n  }\n}\n\nObject.defineProperties(ReadableStreamBYOBReader.prototype, {\n  cancel: { enumerable: true },\n  read: { enumerable: true },\n  releaseLock: { enumerable: true },\n  closed: { enumerable: true }\n});\nsetFunctionName(ReadableStreamBYOBReader.prototype.cancel, 'cancel');\nsetFunctionName(ReadableStreamBYOBReader.prototype.read, 'read');\nsetFunctionName(ReadableStreamBYOBReader.prototype.releaseLock, 'releaseLock');\nif (typeof Symbol.toStringTag === 'symbol') {\n  Object.defineProperty(ReadableStreamBYOBReader.prototype, Symbol.toStringTag, {\n    value: 'ReadableStreamBYOBReader',\n    configurable: true\n  });\n}\n\n// Abstract operations for the readers.\n\nexport function IsReadableStreamBYOBReader(x: any): x is ReadableStreamBYOBReader {\n  if (!typeIsObject(x)) {\n    return false;\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(x, '_readIntoRequests')) {\n    return false;\n  }\n\n  return x instanceof ReadableStreamBYOBReader;\n}\n\nexport function ReadableStreamBYOBReaderRead<T extends NonShared<ArrayBufferView>>(\n  reader: ReadableStreamBYOBReader,\n  view: T,\n  min: number,\n  readIntoRequest: ReadIntoRequest<T>\n): void {\n  const stream = reader._ownerReadableStream;\n\n  assert(stream !== undefined);\n\n  stream._disturbed = true;\n\n  if (stream._state === 'errored') {\n    readIntoRequest._errorSteps(stream._storedError);\n  } else {\n    ReadableByteStreamControllerPullInto(\n      stream._readableStreamController as ReadableByteStreamController,\n      view,\n      min,\n      readIntoRequest\n    );\n  }\n}\n\nexport function ReadableStreamBYOBReaderRelease(reader: ReadableStreamBYOBReader) {\n  ReadableStreamReaderGenericRelease(reader);\n  const e = new TypeError('Reader was released');\n  ReadableStreamBYOBReaderErrorReadIntoRequests(reader, e);\n}\n\nexport function ReadableStreamBYOBReaderErrorReadIntoRequests(reader: ReadableStreamBYOBReader, e: any) {\n  const readIntoRequests = reader._readIntoRequests;\n  reader._readIntoRequests = new SimpleQueue();\n  readIntoRequests.forEach(readIntoRequest => {\n    readIntoRequest._errorSteps(e);\n  });\n}\n\n// Helper functions for the ReadableStreamBYOBReader.\n\nfunction byobReaderBrandCheckException(name: string): TypeError {\n  return new TypeError(\n    `ReadableStreamBYOBReader.prototype.${name} can only be used on a ReadableStreamBYOBReader`);\n}\n", "import type { QueuingStrategy, QueuingStrategySizeCallback } from '../queuing-strategy';\nimport NumberIsNaN from '../../stub/number-isnan';\n\nexport function ExtractHighWaterMark(strategy: QueuingStrategy, defaultHWM: number): number {\n  const { highWaterMark } = strategy;\n\n  if (highWaterMark === undefined) {\n    return defaultHWM;\n  }\n\n  if (NumberIsNaN(highWaterMark) || highWaterMark < 0) {\n    throw new RangeError('Invalid highWaterMark');\n  }\n\n  return highWaterMark;\n}\n\nexport function ExtractSizeAlgorithm<T>(strategy: QueuingStrategy<T>): QueuingStrategySizeCallback<T> {\n  const { size } = strategy;\n\n  if (!size) {\n    return () => 1;\n  }\n\n  return size;\n}\n", "import type { QueuingStrategy, QueuingStrategySizeCallback } from '../queuing-strategy';\nimport { assertDictionary, assertFunction, convertUnrestrictedDouble } from './basic';\n\nexport function convertQueuingStrategy<T>(init: QueuingStrategy<T> | null | undefined,\n                                          context: string): QueuingStrategy<T> {\n  assertDictionary(init, context);\n  const highWaterMark = init?.highWaterMark;\n  const size = init?.size;\n  return {\n    highWaterMark: highWaterMark === undefined ? undefined : convertUnrestrictedDouble(highWaterMark),\n    size: size === undefined ? undefined : convertQueuingStrategySize(size, `${context} has member 'size' that`)\n  };\n}\n\nfunction convertQueuingStrategySize<T>(fn: QueuingStrategySizeCallback<T>,\n                                       context: string): QueuingStrategySizeCallback<T> {\n  assertFunction(fn, context);\n  return chunk => convertUnrestrictedDouble(fn(chunk));\n}\n", "import { assertDictionary, assertFunction } from './basic';\nimport { promiseCall, reflectCall } from '../helpers/webidl';\nimport type {\n  UnderlyingSink,\n  UnderlyingSinkAbortCallback,\n  UnderlyingSinkCloseCallback,\n  UnderlyingSinkStartCallback,\n  UnderlyingSinkWriteCallback,\n  ValidatedUnderlyingSink\n} from '../writable-stream/underlying-sink';\nimport { WritableStreamDefaultController } from '../writable-stream';\n\nexport function convertUnderlyingSink<W>(original: UnderlyingSink<W> | null,\n                                         context: string): ValidatedUnderlyingSink<W> {\n  assertDictionary(original, context);\n  const abort = original?.abort;\n  const close = original?.close;\n  const start = original?.start;\n  const type = original?.type;\n  const write = original?.write;\n  return {\n    abort: abort === undefined ?\n      undefined :\n      convertUnderlyingSinkAbortCallback(abort, original!, `${context} has member 'abort' that`),\n    close: close === undefined ?\n      undefined :\n      convertUnderlyingSinkCloseCallback(close, original!, `${context} has member 'close' that`),\n    start: start === undefined ?\n      undefined :\n      convertUnderlyingSinkStartCallback(start, original!, `${context} has member 'start' that`),\n    write: write === undefined ?\n      undefined :\n      convertUnderlyingSinkWriteCallback(write, original!, `${context} has member 'write' that`),\n    type\n  };\n}\n\nfunction convertUnderlyingSinkAbortCallback(\n  fn: UnderlyingSinkAbortCallback,\n  original: UnderlyingSink,\n  context: string\n): (reason: any) => Promise<void> {\n  assertFunction(fn, context);\n  return (reason: any) => promiseCall(fn, original, [reason]);\n}\n\nfunction convertUnderlyingSinkCloseCallback(\n  fn: UnderlyingSinkCloseCallback,\n  original: UnderlyingSink,\n  context: string\n): () => Promise<void> {\n  assertFunction(fn, context);\n  return () => promiseCall(fn, original, []);\n}\n\nfunction convertUnderlyingSinkStartCallback(\n  fn: UnderlyingSinkStartCallback,\n  original: UnderlyingSink,\n  context: string\n): UnderlyingSinkStartCallback {\n  assertFunction(fn, context);\n  return (controller: WritableStreamDefaultController) => reflectCall(fn, original, [controller]);\n}\n\nfunction convertUnderlyingSinkWriteCallback<W>(\n  fn: UnderlyingSinkWriteCallback<W>,\n  original: UnderlyingSink<W>,\n  context: string\n): (chunk: W, controller: WritableStreamDefaultController) => Promise<void> {\n  assertFunction(fn, context);\n  return (chunk: W, controller: WritableStreamDefaultController) => promiseCall(fn, original, [chunk, controller]);\n}\n", "import { IsWritableStream, WritableStream } from '../writable-stream';\n\nexport function assertWritableStream(x: unknown, context: string): asserts x is WritableStream {\n  if (!IsWritableStream(x)) {\n    throw new TypeError(`${context} is not a WritableStream.`);\n  }\n}\n", "/**\n * A signal object that allows you to communicate with a request and abort it if required\n * via its associated `AbortController` object.\n *\n * @remarks\n *   This interface is compatible with the `AbortSignal` interface defined in TypeScript's DOM types.\n *   It is redefined here, so it can be polyfilled without a DOM, for example with\n *   {@link https://www.npmjs.com/package/abortcontroller-polyfill | abortcontroller-polyfill} in a Node environment.\n *\n * @public\n */\nexport interface AbortSignal {\n  /**\n   * Whether the request is aborted.\n   */\n  readonly aborted: boolean;\n\n  /**\n   * If aborted, returns the reason for aborting.\n   */\n  readonly reason?: any;\n\n  /**\n   * Add an event listener to be triggered when this signal becomes aborted.\n   */\n  addEventListener(type: 'abort', listener: () => void): void;\n\n  /**\n   * Remove an event listener that was previously added with {@link AbortSignal.addEventListener}.\n   */\n  removeEventListener(type: 'abort', listener: () => void): void;\n}\n\nexport function isAbortSignal(value: unknown): value is AbortSignal {\n  if (typeof value !== 'object' || value === null) {\n    return false;\n  }\n  try {\n    return typeof (value as AbortSignal).aborted === 'boolean';\n  } catch {\n    // AbortSignal.prototype.aborted throws if its brand check fails\n    return false;\n  }\n}\n\n/**\n * A controller object that allows you to abort an `AbortSignal` when desired.\n *\n * @remarks\n *   This interface is compatible with the `AbortController` interface defined in TypeScript's DOM types.\n *   It is redefined here, so it can be polyfilled without a DOM, for example with\n *   {@link https://www.npmjs.com/package/abortcontroller-polyfill | abortcontroller-polyfill} in a Node environment.\n *\n * @internal\n */\nexport interface AbortController {\n  readonly signal: AbortSignal;\n\n  abort(reason?: any): void;\n}\n\ninterface AbortControllerConstructor {\n  new(): AbortController;\n}\n\nconst supportsAbortController = typeof (AbortController as any) === 'function';\n\n/**\n * Construct a new AbortController, if supported by the platform.\n *\n * @internal\n */\nexport function createAbortController(): AbortController | undefined {\n  if (supportsAbortController) {\n    return new (AbortController as AbortControllerConstructor)();\n  }\n  return undefined;\n}\n", "import assert from '../stub/assert';\nimport {\n  newPromise,\n  promiseRejectedWith,\n  promiseResolvedWith,\n  setPromiseIsHandledToTrue,\n  uponPromise\n} from './helpers/webidl';\nimport {\n  DequeueValue,\n  EnqueueValueWithSize,\n  PeekQueueValue,\n  type QueuePair,\n  ResetQueue\n} from './abstract-ops/queue-with-sizes';\nimport type { QueuingStrategy, QueuingStrategySizeCallback } from './queuing-strategy';\nimport { SimpleQueue } from './simple-queue';\nimport { setFunctionName, typeIsObject } from './helpers/miscellaneous';\nimport { AbortSteps, ErrorSteps } from './abstract-ops/internal-methods';\nimport { IsNonNegativeNumber } from './abstract-ops/miscellaneous';\nimport { ExtractHighWaterMark, ExtractSizeAlgorithm } from './abstract-ops/queuing-strategy';\nimport { convertQueuingStrategy } from './validators/queuing-strategy';\nimport type {\n  UnderlyingSink,\n  UnderlyingSinkAbortCallback,\n  UnderlyingSinkCloseCallback,\n  UnderlyingSinkStartCallback,\n  UnderlyingSinkWriteCallback,\n  ValidatedUnderlyingSink\n} from './writable-stream/underlying-sink';\nimport { assertObject, assertRequiredArgument } from './validators/basic';\nimport { convertUnderlyingSink } from './validators/underlying-sink';\nimport { assertWritableStream } from './validators/writable-stream';\nimport { type AbortController, type AbortSignal, createAbortController } from './abort-signal';\n\ntype WritableStreamState = 'writable' | 'closed' | 'erroring' | 'errored';\n\ninterface WriteOrCloseRequest {\n  _resolve: (value?: undefined) => void;\n  _reject: (reason: any) => void;\n}\n\ntype WriteRequest = WriteOrCloseRequest;\ntype CloseRequest = WriteOrCloseRequest;\n\ninterface PendingAbortRequest {\n  _promise: Promise<undefined>;\n  _resolve: (value?: undefined) => void;\n  _reject: (reason: any) => void;\n  _reason: any;\n  _wasAlreadyErroring: boolean;\n}\n\n/**\n * A writable stream represents a destination for data, into which you can write.\n *\n * @public\n */\nclass WritableStream<W = any> {\n  /** @internal */\n  _state!: WritableStreamState;\n  /** @internal */\n  _storedError: any;\n  /** @internal */\n  _writer: WritableStreamDefaultWriter<W> | undefined;\n  /** @internal */\n  _writableStreamController!: WritableStreamDefaultController<W>;\n  /** @internal */\n  _writeRequests!: SimpleQueue<WriteRequest>;\n  /** @internal */\n  _inFlightWriteRequest: WriteRequest | undefined;\n  /** @internal */\n  _closeRequest: CloseRequest | undefined;\n  /** @internal */\n  _inFlightCloseRequest: CloseRequest | undefined;\n  /** @internal */\n  _pendingAbortRequest: PendingAbortRequest | undefined;\n  /** @internal */\n  _backpressure!: boolean;\n\n  constructor(underlyingSink?: UnderlyingSink<W>, strategy?: QueuingStrategy<W>);\n  constructor(rawUnderlyingSink: UnderlyingSink<W> | null | undefined = {},\n              rawStrategy: QueuingStrategy<W> | null | undefined = {}) {\n    if (rawUnderlyingSink === undefined) {\n      rawUnderlyingSink = null;\n    } else {\n      assertObject(rawUnderlyingSink, 'First parameter');\n    }\n\n    const strategy = convertQueuingStrategy(rawStrategy, 'Second parameter');\n    const underlyingSink = convertUnderlyingSink(rawUnderlyingSink, 'First parameter');\n\n    InitializeWritableStream(this);\n\n    const type = underlyingSink.type;\n    if (type !== undefined) {\n      throw new RangeError('Invalid type is specified');\n    }\n\n    const sizeAlgorithm = ExtractSizeAlgorithm(strategy);\n    const highWaterMark = ExtractHighWaterMark(strategy, 1);\n\n    SetUpWritableStreamDefaultControllerFromUnderlyingSink(this, underlyingSink, highWaterMark, sizeAlgorithm);\n  }\n\n  /**\n   * Returns whether or not the writable stream is locked to a writer.\n   */\n  get locked(): boolean {\n    if (!IsWritableStream(this)) {\n      throw streamBrandCheckException('locked');\n    }\n\n    return IsWritableStreamLocked(this);\n  }\n\n  /**\n   * Aborts the stream, signaling that the producer can no longer successfully write to the stream and it is to be\n   * immediately moved to an errored state, with any queued-up writes discarded. This will also execute any abort\n   * mechanism of the underlying sink.\n   *\n   * The returned promise will fulfill if the stream shuts down successfully, or reject if the underlying sink signaled\n   * that there was an error doing so. Additionally, it will reject with a `TypeError` (without attempting to cancel\n   * the stream) if the stream is currently locked.\n   */\n  abort(reason: any = undefined): Promise<void> {\n    if (!IsWritableStream(this)) {\n      return promiseRejectedWith(streamBrandCheckException('abort'));\n    }\n\n    if (IsWritableStreamLocked(this)) {\n      return promiseRejectedWith(new TypeError('Cannot abort a stream that already has a writer'));\n    }\n\n    return WritableStreamAbort(this, reason);\n  }\n\n  /**\n   * Closes the stream. The underlying sink will finish processing any previously-written chunks, before invoking its\n   * close behavior. During this time any further attempts to write will fail (without erroring the stream).\n   *\n   * The method returns a promise that will fulfill if all remaining chunks are successfully written and the stream\n   * successfully closes, or rejects if an error is encountered during this process. Additionally, it will reject with\n   * a `TypeError` (without attempting to cancel the stream) if the stream is currently locked.\n   */\n  close() {\n    if (!IsWritableStream(this)) {\n      return promiseRejectedWith(streamBrandCheckException('close'));\n    }\n\n    if (IsWritableStreamLocked(this)) {\n      return promiseRejectedWith(new TypeError('Cannot close a stream that already has a writer'));\n    }\n\n    if (WritableStreamCloseQueuedOrInFlight(this)) {\n      return promiseRejectedWith(new TypeError('Cannot close an already-closing stream'));\n    }\n\n    return WritableStreamClose(this);\n  }\n\n  /**\n   * Creates a {@link WritableStreamDefaultWriter | writer} and locks the stream to the new writer. While the stream\n   * is locked, no other writer can be acquired until this one is released.\n   *\n   * This functionality is especially useful for creating abstractions that desire the ability to write to a stream\n   * without interruption or interleaving. By getting a writer for the stream, you can ensure nobody else can write at\n   * the same time, which would cause the resulting written data to be unpredictable and probably useless.\n   */\n  getWriter(): WritableStreamDefaultWriter<W> {\n    if (!IsWritableStream(this)) {\n      throw streamBrandCheckException('getWriter');\n    }\n\n    return AcquireWritableStreamDefaultWriter(this);\n  }\n}\n\nObject.defineProperties(WritableStream.prototype, {\n  abort: { enumerable: true },\n  close: { enumerable: true },\n  getWriter: { enumerable: true },\n  locked: { enumerable: true }\n});\nsetFunctionName(WritableStream.prototype.abort, 'abort');\nsetFunctionName(WritableStream.prototype.close, 'close');\nsetFunctionName(WritableStream.prototype.getWriter, 'getWriter');\nif (typeof Symbol.toStringTag === 'symbol') {\n  Object.defineProperty(WritableStream.prototype, Symbol.toStringTag, {\n    value: 'WritableStream',\n    configurable: true\n  });\n}\n\nexport {\n  AcquireWritableStreamDefaultWriter,\n  CreateWritableStream,\n  IsWritableStream,\n  IsWritableStreamLocked,\n  WritableStream,\n  WritableStreamAbort,\n  WritableStreamDefaultControllerErrorIfNeeded,\n  WritableStreamDefaultWriterCloseWithErrorPropagation,\n  WritableStreamDefaultWriterRelease,\n  WritableStreamDefaultWriterWrite,\n  WritableStreamCloseQueuedOrInFlight\n};\n\nexport type {\n  UnderlyingSink,\n  UnderlyingSinkStartCallback,\n  UnderlyingSinkWriteCallback,\n  UnderlyingSinkCloseCallback,\n  UnderlyingSinkAbortCallback\n};\n\n// Abstract operations for the WritableStream.\n\nfunction AcquireWritableStreamDefaultWriter<W>(stream: WritableStream<W>): WritableStreamDefaultWriter<W> {\n  return new WritableStreamDefaultWriter(stream);\n}\n\n// Throws if and only if startAlgorithm throws.\nfunction CreateWritableStream<W>(startAlgorithm: () => void | PromiseLike<void>,\n                                 writeAlgorithm: (chunk: W) => Promise<void>,\n                                 closeAlgorithm: () => Promise<void>,\n                                 abortAlgorithm: (reason: any) => Promise<void>,\n                                 highWaterMark = 1,\n                                 sizeAlgorithm: QueuingStrategySizeCallback<W> = () => 1) {\n  assert(IsNonNegativeNumber(highWaterMark));\n\n  const stream: WritableStream<W> = Object.create(WritableStream.prototype);\n  InitializeWritableStream(stream);\n\n  const controller: WritableStreamDefaultController<W> = Object.create(WritableStreamDefaultController.prototype);\n\n  SetUpWritableStreamDefaultController(stream, controller, startAlgorithm, writeAlgorithm, closeAlgorithm,\n                                       abortAlgorithm, highWaterMark, sizeAlgorithm);\n  return stream;\n}\n\nfunction InitializeWritableStream<W>(stream: WritableStream<W>) {\n  stream._state = 'writable';\n\n  // The error that will be reported by new method calls once the state becomes errored. Only set when [[state]] is\n  // 'erroring' or 'errored'. May be set to an undefined value.\n  stream._storedError = undefined;\n\n  stream._writer = undefined;\n\n  // Initialize to undefined first because the constructor of the controller checks this\n  // variable to validate the caller.\n  stream._writableStreamController = undefined!;\n\n  // This queue is placed here instead of the writer class in order to allow for passing a writer to the next data\n  // producer without waiting for the queued writes to finish.\n  stream._writeRequests = new SimpleQueue();\n\n  // Write requests are removed from _writeRequests when write() is called on the underlying sink. This prevents\n  // them from being erroneously rejected on error. If a write() call is in-flight, the request is stored here.\n  stream._inFlightWriteRequest = undefined;\n\n  // The promise that was returned from writer.close(). Stored here because it may be fulfilled after the writer\n  // has been detached.\n  stream._closeRequest = undefined;\n\n  // Close request is removed from _closeRequest when close() is called on the underlying sink. This prevents it\n  // from being erroneously rejected on error. If a close() call is in-flight, the request is stored here.\n  stream._inFlightCloseRequest = undefined;\n\n  // The promise that was returned from writer.abort(). This may also be fulfilled after the writer has detached.\n  stream._pendingAbortRequest = undefined;\n\n  // The backpressure signal set by the controller.\n  stream._backpressure = false;\n}\n\nfunction IsWritableStream(x: unknown): x is WritableStream {\n  if (!typeIsObject(x)) {\n    return false;\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(x, '_writableStreamController')) {\n    return false;\n  }\n\n  return x instanceof WritableStream;\n}\n\nfunction IsWritableStreamLocked(stream: WritableStream): boolean {\n  assert(IsWritableStream(stream));\n\n  if (stream._writer === undefined) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction WritableStreamAbort(stream: WritableStream, reason: any): Promise<undefined> {\n  if (stream._state === 'closed' || stream._state === 'errored') {\n    return promiseResolvedWith(undefined);\n  }\n  stream._writableStreamController._abortReason = reason;\n  stream._writableStreamController._abortController?.abort(reason);\n\n  // TypeScript narrows the type of `stream._state` down to 'writable' | 'erroring',\n  // but it doesn't know that signaling abort runs author code that might have changed the state.\n  // Widen the type again by casting to WritableStreamState.\n  const state = stream._state as WritableStreamState;\n\n  if (state === 'closed' || state === 'errored') {\n    return promiseResolvedWith(undefined);\n  }\n  if (stream._pendingAbortRequest !== undefined) {\n    return stream._pendingAbortRequest._promise;\n  }\n\n  assert(state === 'writable' || state === 'erroring');\n\n  let wasAlreadyErroring = false;\n  if (state === 'erroring') {\n    wasAlreadyErroring = true;\n    // reason will not be used, so don't keep a reference to it.\n    reason = undefined;\n  }\n\n  const promise = newPromise<undefined>((resolve, reject) => {\n    stream._pendingAbortRequest = {\n      _promise: undefined!,\n      _resolve: resolve,\n      _reject: reject,\n      _reason: reason,\n      _wasAlreadyErroring: wasAlreadyErroring\n    };\n  });\n  stream._pendingAbortRequest!._promise = promise;\n\n  if (!wasAlreadyErroring) {\n    WritableStreamStartErroring(stream, reason);\n  }\n\n  return promise;\n}\n\nfunction WritableStreamClose(stream: WritableStream<any>): Promise<undefined> {\n  const state = stream._state;\n  if (state === 'closed' || state === 'errored') {\n    return promiseRejectedWith(new TypeError(\n      `The stream (in ${state} state) is not in the writable state and cannot be closed`));\n  }\n\n  assert(state === 'writable' || state === 'erroring');\n  assert(!WritableStreamCloseQueuedOrInFlight(stream));\n\n  const promise = newPromise<undefined>((resolve, reject) => {\n    const closeRequest: CloseRequest = {\n      _resolve: resolve,\n      _reject: reject\n    };\n\n    stream._closeRequest = closeRequest;\n  });\n\n  const writer = stream._writer;\n  if (writer !== undefined && stream._backpressure && state === 'writable') {\n    defaultWriterReadyPromiseResolve(writer);\n  }\n\n  WritableStreamDefaultControllerClose(stream._writableStreamController);\n\n  return promise;\n}\n\n// WritableStream API exposed for controllers.\n\nfunction WritableStreamAddWriteRequest(stream: WritableStream): Promise<undefined> {\n  assert(IsWritableStreamLocked(stream));\n  assert(stream._state === 'writable');\n\n  const promise = newPromise<undefined>((resolve, reject) => {\n    const writeRequest: WriteRequest = {\n      _resolve: resolve,\n      _reject: reject\n    };\n\n    stream._writeRequests.push(writeRequest);\n  });\n\n  return promise;\n}\n\nfunction WritableStreamDealWithRejection(stream: WritableStream, error: any) {\n  const state = stream._state;\n\n  if (state === 'writable') {\n    WritableStreamStartErroring(stream, error);\n    return;\n  }\n\n  assert(state === 'erroring');\n  WritableStreamFinishErroring(stream);\n}\n\nfunction WritableStreamStartErroring(stream: WritableStream, reason: any) {\n  assert(stream._storedError === undefined);\n  assert(stream._state === 'writable');\n\n  const controller = stream._writableStreamController;\n  assert(controller !== undefined);\n\n  stream._state = 'erroring';\n  stream._storedError = reason;\n  const writer = stream._writer;\n  if (writer !== undefined) {\n    WritableStreamDefaultWriterEnsureReadyPromiseRejected(writer, reason);\n  }\n\n  if (!WritableStreamHasOperationMarkedInFlight(stream) && controller._started) {\n    WritableStreamFinishErroring(stream);\n  }\n}\n\nfunction WritableStreamFinishErroring(stream: WritableStream) {\n  assert(stream._state === 'erroring');\n  assert(!WritableStreamHasOperationMarkedInFlight(stream));\n  stream._state = 'errored';\n  stream._writableStreamController[ErrorSteps]();\n\n  const storedError = stream._storedError;\n  stream._writeRequests.forEach(writeRequest => {\n    writeRequest._reject(storedError);\n  });\n  stream._writeRequests = new SimpleQueue();\n\n  if (stream._pendingAbortRequest === undefined) {\n    WritableStreamRejectCloseAndClosedPromiseIfNeeded(stream);\n    return;\n  }\n\n  const abortRequest = stream._pendingAbortRequest;\n  stream._pendingAbortRequest = undefined;\n\n  if (abortRequest._wasAlreadyErroring) {\n    abortRequest._reject(storedError);\n    WritableStreamRejectCloseAndClosedPromiseIfNeeded(stream);\n    return;\n  }\n\n  const promise = stream._writableStreamController[AbortSteps](abortRequest._reason);\n  uponPromise(\n    promise,\n    () => {\n      abortRequest._resolve();\n      WritableStreamRejectCloseAndClosedPromiseIfNeeded(stream);\n      return null;\n    },\n    (reason: any) => {\n      abortRequest._reject(reason);\n      WritableStreamRejectCloseAndClosedPromiseIfNeeded(stream);\n      return null;\n    });\n}\n\nfunction WritableStreamFinishInFlightWrite(stream: WritableStream) {\n  assert(stream._inFlightWriteRequest !== undefined);\n  stream._inFlightWriteRequest!._resolve(undefined);\n  stream._inFlightWriteRequest = undefined;\n}\n\nfunction WritableStreamFinishInFlightWriteWithError(stream: WritableStream, error: any) {\n  assert(stream._inFlightWriteRequest !== undefined);\n  stream._inFlightWriteRequest!._reject(error);\n  stream._inFlightWriteRequest = undefined;\n\n  assert(stream._state === 'writable' || stream._state === 'erroring');\n\n  WritableStreamDealWithRejection(stream, error);\n}\n\nfunction WritableStreamFinishInFlightClose(stream: WritableStream) {\n  assert(stream._inFlightCloseRequest !== undefined);\n  stream._inFlightCloseRequest!._resolve(undefined);\n  stream._inFlightCloseRequest = undefined;\n\n  const state = stream._state;\n\n  assert(state === 'writable' || state === 'erroring');\n\n  if (state === 'erroring') {\n    // The error was too late to do anything, so it is ignored.\n    stream._storedError = undefined;\n    if (stream._pendingAbortRequest !== undefined) {\n      stream._pendingAbortRequest._resolve();\n      stream._pendingAbortRequest = undefined;\n    }\n  }\n\n  stream._state = 'closed';\n\n  const writer = stream._writer;\n  if (writer !== undefined) {\n    defaultWriterClosedPromiseResolve(writer);\n  }\n\n  assert(stream._pendingAbortRequest === undefined);\n  assert(stream._storedError === undefined);\n}\n\nfunction WritableStreamFinishInFlightCloseWithError(stream: WritableStream, error: any) {\n  assert(stream._inFlightCloseRequest !== undefined);\n  stream._inFlightCloseRequest!._reject(error);\n  stream._inFlightCloseRequest = undefined;\n\n  assert(stream._state === 'writable' || stream._state === 'erroring');\n\n  // Never execute sink abort() after sink close().\n  if (stream._pendingAbortRequest !== undefined) {\n    stream._pendingAbortRequest._reject(error);\n    stream._pendingAbortRequest = undefined;\n  }\n  WritableStreamDealWithRejection(stream, error);\n}\n\n// TODO(ricea): Fix alphabetical order.\nfunction WritableStreamCloseQueuedOrInFlight(stream: WritableStream): boolean {\n  if (stream._closeRequest === undefined && stream._inFlightCloseRequest === undefined) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction WritableStreamHasOperationMarkedInFlight(stream: WritableStream): boolean {\n  if (stream._inFlightWriteRequest === undefined && stream._inFlightCloseRequest === undefined) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction WritableStreamMarkCloseRequestInFlight(stream: WritableStream) {\n  assert(stream._inFlightCloseRequest === undefined);\n  assert(stream._closeRequest !== undefined);\n  stream._inFlightCloseRequest = stream._closeRequest;\n  stream._closeRequest = undefined;\n}\n\nfunction WritableStreamMarkFirstWriteRequestInFlight(stream: WritableStream) {\n  assert(stream._inFlightWriteRequest === undefined);\n  assert(stream._writeRequests.length !== 0);\n  stream._inFlightWriteRequest = stream._writeRequests.shift();\n}\n\nfunction WritableStreamRejectCloseAndClosedPromiseIfNeeded(stream: WritableStream) {\n  assert(stream._state === 'errored');\n  if (stream._closeRequest !== undefined) {\n    assert(stream._inFlightCloseRequest === undefined);\n\n    stream._closeRequest._reject(stream._storedError);\n    stream._closeRequest = undefined;\n  }\n  const writer = stream._writer;\n  if (writer !== undefined) {\n    defaultWriterClosedPromiseReject(writer, stream._storedError);\n  }\n}\n\nfunction WritableStreamUpdateBackpressure(stream: WritableStream, backpressure: boolean) {\n  assert(stream._state === 'writable');\n  assert(!WritableStreamCloseQueuedOrInFlight(stream));\n\n  const writer = stream._writer;\n  if (writer !== undefined && backpressure !== stream._backpressure) {\n    if (backpressure) {\n      defaultWriterReadyPromiseReset(writer);\n    } else {\n      assert(!backpressure);\n\n      defaultWriterReadyPromiseResolve(writer);\n    }\n  }\n\n  stream._backpressure = backpressure;\n}\n\n/**\n * A default writer vended by a {@link WritableStream}.\n *\n * @public\n */\nexport class WritableStreamDefaultWriter<W = any> {\n  /** @internal */\n  _ownerWritableStream: WritableStream<W>;\n  /** @internal */\n  _closedPromise!: Promise<undefined>;\n  /** @internal */\n  _closedPromise_resolve?: (value?: undefined) => void;\n  /** @internal */\n  _closedPromise_reject?: (reason: any) => void;\n  /** @internal */\n  _closedPromiseState!: 'pending' | 'resolved' | 'rejected';\n  /** @internal */\n  _readyPromise!: Promise<undefined>;\n  /** @internal */\n  _readyPromise_resolve?: (value?: undefined) => void;\n  /** @internal */\n  _readyPromise_reject?: (reason: any) => void;\n  /** @internal */\n  _readyPromiseState!: 'pending' | 'fulfilled' | 'rejected';\n\n  constructor(stream: WritableStream<W>) {\n    assertRequiredArgument(stream, 1, 'WritableStreamDefaultWriter');\n    assertWritableStream(stream, 'First parameter');\n\n    if (IsWritableStreamLocked(stream)) {\n      throw new TypeError('This stream has already been locked for exclusive writing by another writer');\n    }\n\n    this._ownerWritableStream = stream;\n    stream._writer = this;\n\n    const state = stream._state;\n\n    if (state === 'writable') {\n      if (!WritableStreamCloseQueuedOrInFlight(stream) && stream._backpressure) {\n        defaultWriterReadyPromiseInitialize(this);\n      } else {\n        defaultWriterReadyPromiseInitializeAsResolved(this);\n      }\n\n      defaultWriterClosedPromiseInitialize(this);\n    } else if (state === 'erroring') {\n      defaultWriterReadyPromiseInitializeAsRejected(this, stream._storedError);\n      defaultWriterClosedPromiseInitialize(this);\n    } else if (state === 'closed') {\n      defaultWriterReadyPromiseInitializeAsResolved(this);\n      defaultWriterClosedPromiseInitializeAsResolved(this);\n    } else {\n      assert(state === 'errored');\n\n      const storedError = stream._storedError;\n      defaultWriterReadyPromiseInitializeAsRejected(this, storedError);\n      defaultWriterClosedPromiseInitializeAsRejected(this, storedError);\n    }\n  }\n\n  /**\n   * Returns a promise that will be fulfilled when the stream becomes closed, or rejected if the stream ever errors or\n   * the writer’s lock is released before the stream finishes closing.\n   */\n  get closed(): Promise<undefined> {\n    if (!IsWritableStreamDefaultWriter(this)) {\n      return promiseRejectedWith(defaultWriterBrandCheckException('closed'));\n    }\n\n    return this._closedPromise;\n  }\n\n  /**\n   * Returns the desired size to fill the stream’s internal queue. It can be negative, if the queue is over-full.\n   * A producer can use this information to determine the right amount of data to write.\n   *\n   * It will be `null` if the stream cannot be successfully written to (due to either being errored, or having an abort\n   * queued up). It will return zero if the stream is closed. And the getter will throw an exception if invoked when\n   * the writer’s lock is released.\n   */\n  get desiredSize(): number | null {\n    if (!IsWritableStreamDefaultWriter(this)) {\n      throw defaultWriterBrandCheckException('desiredSize');\n    }\n\n    if (this._ownerWritableStream === undefined) {\n      throw defaultWriterLockException('desiredSize');\n    }\n\n    return WritableStreamDefaultWriterGetDesiredSize(this);\n  }\n\n  /**\n   * Returns a promise that will be fulfilled when the desired size to fill the stream’s internal queue transitions\n   * from non-positive to positive, signaling that it is no longer applying backpressure. Once the desired size dips\n   * back to zero or below, the getter will return a new promise that stays pending until the next transition.\n   *\n   * If the stream becomes errored or aborted, or the writer’s lock is released, the returned promise will become\n   * rejected.\n   */\n  get ready(): Promise<undefined> {\n    if (!IsWritableStreamDefaultWriter(this)) {\n      return promiseRejectedWith(defaultWriterBrandCheckException('ready'));\n    }\n\n    return this._readyPromise;\n  }\n\n  /**\n   * If the reader is active, behaves the same as {@link WritableStream.abort | stream.abort(reason)}.\n   */\n  abort(reason: any = undefined): Promise<void> {\n    if (!IsWritableStreamDefaultWriter(this)) {\n      return promiseRejectedWith(defaultWriterBrandCheckException('abort'));\n    }\n\n    if (this._ownerWritableStream === undefined) {\n      return promiseRejectedWith(defaultWriterLockException('abort'));\n    }\n\n    return WritableStreamDefaultWriterAbort(this, reason);\n  }\n\n  /**\n   * If the reader is active, behaves the same as {@link WritableStream.close | stream.close()}.\n   */\n  close(): Promise<void> {\n    if (!IsWritableStreamDefaultWriter(this)) {\n      return promiseRejectedWith(defaultWriterBrandCheckException('close'));\n    }\n\n    const stream = this._ownerWritableStream;\n\n    if (stream === undefined) {\n      return promiseRejectedWith(defaultWriterLockException('close'));\n    }\n\n    if (WritableStreamCloseQueuedOrInFlight(stream)) {\n      return promiseRejectedWith(new TypeError('Cannot close an already-closing stream'));\n    }\n\n    return WritableStreamDefaultWriterClose(this);\n  }\n\n  /**\n   * Releases the writer’s lock on the corresponding stream. After the lock is released, the writer is no longer active.\n   * If the associated stream is errored when the lock is released, the writer will appear errored in the same way from\n   * now on; otherwise, the writer will appear closed.\n   *\n   * Note that the lock can still be released even if some ongoing writes have not yet finished (i.e. even if the\n   * promises returned from previous calls to {@link WritableStreamDefaultWriter.write | write()} have not yet settled).\n   * It’s not necessary to hold the lock on the writer for the duration of the write; the lock instead simply prevents\n   * other producers from writing in an interleaved manner.\n   */\n  releaseLock(): void {\n    if (!IsWritableStreamDefaultWriter(this)) {\n      throw defaultWriterBrandCheckException('releaseLock');\n    }\n\n    const stream = this._ownerWritableStream;\n\n    if (stream === undefined) {\n      return;\n    }\n\n    assert(stream._writer !== undefined);\n\n    WritableStreamDefaultWriterRelease(this);\n  }\n\n  /**\n   * Writes the given chunk to the writable stream, by waiting until any previous writes have finished successfully,\n   * and then sending the chunk to the underlying sink's {@link UnderlyingSink.write | write()} method. It will return\n   * a promise that fulfills with undefined upon a successful write, or rejects if the write fails or stream becomes\n   * errored before the writing process is initiated.\n   *\n   * Note that what \"success\" means is up to the underlying sink; it might indicate simply that the chunk has been\n   * accepted, and not necessarily that it is safely saved to its ultimate destination.\n   */\n  write(chunk: W): Promise<void>;\n  write(chunk: W = undefined!): Promise<void> {\n    if (!IsWritableStreamDefaultWriter(this)) {\n      return promiseRejectedWith(defaultWriterBrandCheckException('write'));\n    }\n\n    if (this._ownerWritableStream === undefined) {\n      return promiseRejectedWith(defaultWriterLockException('write to'));\n    }\n\n    return WritableStreamDefaultWriterWrite(this, chunk);\n  }\n}\n\nObject.defineProperties(WritableStreamDefaultWriter.prototype, {\n  abort: { enumerable: true },\n  close: { enumerable: true },\n  releaseLock: { enumerable: true },\n  write: { enumerable: true },\n  closed: { enumerable: true },\n  desiredSize: { enumerable: true },\n  ready: { enumerable: true }\n});\nsetFunctionName(WritableStreamDefaultWriter.prototype.abort, 'abort');\nsetFunctionName(WritableStreamDefaultWriter.prototype.close, 'close');\nsetFunctionName(WritableStreamDefaultWriter.prototype.releaseLock, 'releaseLock');\nsetFunctionName(WritableStreamDefaultWriter.prototype.write, 'write');\nif (typeof Symbol.toStringTag === 'symbol') {\n  Object.defineProperty(WritableStreamDefaultWriter.prototype, Symbol.toStringTag, {\n    value: 'WritableStreamDefaultWriter',\n    configurable: true\n  });\n}\n\n// Abstract operations for the WritableStreamDefaultWriter.\n\nfunction IsWritableStreamDefaultWriter<W = any>(x: any): x is WritableStreamDefaultWriter<W> {\n  if (!typeIsObject(x)) {\n    return false;\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(x, '_ownerWritableStream')) {\n    return false;\n  }\n\n  return x instanceof WritableStreamDefaultWriter;\n}\n\n// A client of WritableStreamDefaultWriter may use these functions directly to bypass state check.\n\nfunction WritableStreamDefaultWriterAbort(writer: WritableStreamDefaultWriter, reason: any) {\n  const stream = writer._ownerWritableStream;\n\n  assert(stream !== undefined);\n\n  return WritableStreamAbort(stream, reason);\n}\n\nfunction WritableStreamDefaultWriterClose(writer: WritableStreamDefaultWriter): Promise<undefined> {\n  const stream = writer._ownerWritableStream;\n\n  assert(stream !== undefined);\n\n  return WritableStreamClose(stream);\n}\n\nfunction WritableStreamDefaultWriterCloseWithErrorPropagation(writer: WritableStreamDefaultWriter): Promise<undefined> {\n  const stream = writer._ownerWritableStream;\n\n  assert(stream !== undefined);\n\n  const state = stream._state;\n  if (WritableStreamCloseQueuedOrInFlight(stream) || state === 'closed') {\n    return promiseResolvedWith(undefined);\n  }\n\n  if (state === 'errored') {\n    return promiseRejectedWith(stream._storedError);\n  }\n\n  assert(state === 'writable' || state === 'erroring');\n\n  return WritableStreamDefaultWriterClose(writer);\n}\n\nfunction WritableStreamDefaultWriterEnsureClosedPromiseRejected(writer: WritableStreamDefaultWriter, error: any) {\n  if (writer._closedPromiseState === 'pending') {\n    defaultWriterClosedPromiseReject(writer, error);\n  } else {\n    defaultWriterClosedPromiseResetToRejected(writer, error);\n  }\n}\n\nfunction WritableStreamDefaultWriterEnsureReadyPromiseRejected(writer: WritableStreamDefaultWriter, error: any) {\n  if (writer._readyPromiseState === 'pending') {\n    defaultWriterReadyPromiseReject(writer, error);\n  } else {\n    defaultWriterReadyPromiseResetToRejected(writer, error);\n  }\n}\n\nfunction WritableStreamDefaultWriterGetDesiredSize(writer: WritableStreamDefaultWriter): number | null {\n  const stream = writer._ownerWritableStream;\n  const state = stream._state;\n\n  if (state === 'errored' || state === 'erroring') {\n    return null;\n  }\n\n  if (state === 'closed') {\n    return 0;\n  }\n\n  return WritableStreamDefaultControllerGetDesiredSize(stream._writableStreamController);\n}\n\nfunction WritableStreamDefaultWriterRelease(writer: WritableStreamDefaultWriter) {\n  const stream = writer._ownerWritableStream;\n  assert(stream !== undefined);\n  assert(stream._writer === writer);\n\n  const releasedError = new TypeError(\n    `Writer was released and can no longer be used to monitor the stream's closedness`);\n\n  WritableStreamDefaultWriterEnsureReadyPromiseRejected(writer, releasedError);\n\n  // The state transitions to \"errored\" before the sink abort() method runs, but the writer.closed promise is not\n  // rejected until afterwards. This means that simply testing state will not work.\n  WritableStreamDefaultWriterEnsureClosedPromiseRejected(writer, releasedError);\n\n  stream._writer = undefined;\n  writer._ownerWritableStream = undefined!;\n}\n\nfunction WritableStreamDefaultWriterWrite<W>(writer: WritableStreamDefaultWriter<W>, chunk: W): Promise<undefined> {\n  const stream = writer._ownerWritableStream;\n\n  assert(stream !== undefined);\n\n  const controller = stream._writableStreamController;\n\n  const chunkSize = WritableStreamDefaultControllerGetChunkSize(controller, chunk);\n\n  if (stream !== writer._ownerWritableStream) {\n    return promiseRejectedWith(defaultWriterLockException('write to'));\n  }\n\n  const state = stream._state;\n  if (state === 'errored') {\n    return promiseRejectedWith(stream._storedError);\n  }\n  if (WritableStreamCloseQueuedOrInFlight(stream) || state === 'closed') {\n    return promiseRejectedWith(new TypeError('The stream is closing or closed and cannot be written to'));\n  }\n  if (state === 'erroring') {\n    return promiseRejectedWith(stream._storedError);\n  }\n\n  assert(state === 'writable');\n\n  const promise = WritableStreamAddWriteRequest(stream);\n\n  WritableStreamDefaultControllerWrite(controller, chunk, chunkSize);\n\n  return promise;\n}\n\nconst closeSentinel: unique symbol = {} as any;\n\ntype QueueRecord<W> = W | typeof closeSentinel;\n\n/**\n * Allows control of a {@link WritableStream | writable stream}'s state and internal queue.\n *\n * @public\n */\nexport class WritableStreamDefaultController<W = any> {\n  /** @internal */\n  _controlledWritableStream!: WritableStream<W>;\n  /** @internal */\n  _queue!: SimpleQueue<QueuePair<QueueRecord<W>>>;\n  /** @internal */\n  _queueTotalSize!: number;\n  /** @internal */\n  _abortReason: any;\n  /** @internal */\n  _abortController: AbortController | undefined;\n  /** @internal */\n  _started!: boolean;\n  /** @internal */\n  _strategySizeAlgorithm!: QueuingStrategySizeCallback<W>;\n  /** @internal */\n  _strategyHWM!: number;\n  /** @internal */\n  _writeAlgorithm!: (chunk: W) => Promise<void>;\n  /** @internal */\n  _closeAlgorithm!: () => Promise<void>;\n  /** @internal */\n  _abortAlgorithm!: (reason: any) => Promise<void>;\n\n  private constructor() {\n    throw new TypeError('Illegal constructor');\n  }\n\n  /**\n   * The reason which was passed to `WritableStream.abort(reason)` when the stream was aborted.\n   *\n   * @deprecated\n   *  This property has been removed from the specification, see https://github.com/whatwg/streams/pull/1177.\n   *  Use {@link WritableStreamDefaultController.signal}'s `reason` instead.\n   */\n  get abortReason(): any {\n    if (!IsWritableStreamDefaultController(this)) {\n      throw defaultControllerBrandCheckException('abortReason');\n    }\n    return this._abortReason;\n  }\n\n  /**\n   * An `AbortSignal` that can be used to abort the pending write or close operation when the stream is aborted.\n   */\n  get signal(): AbortSignal {\n    if (!IsWritableStreamDefaultController(this)) {\n      throw defaultControllerBrandCheckException('signal');\n    }\n    if (this._abortController === undefined) {\n      // Older browsers or older Node versions may not support `AbortController` or `AbortSignal`.\n      // We don't want to bundle and ship an `AbortController` polyfill together with our polyfill,\n      // so instead we only implement support for `signal` if we find a global `AbortController` constructor.\n      throw new TypeError('WritableStreamDefaultController.prototype.signal is not supported');\n    }\n    return this._abortController.signal;\n  }\n\n  /**\n   * Closes the controlled writable stream, making all future interactions with it fail with the given error `e`.\n   *\n   * This method is rarely used, since usually it suffices to return a rejected promise from one of the underlying\n   * sink's methods. However, it can be useful for suddenly shutting down a stream in response to an event outside the\n   * normal lifecycle of interactions with the underlying sink.\n   */\n  error(e: any = undefined): void {\n    if (!IsWritableStreamDefaultController(this)) {\n      throw defaultControllerBrandCheckException('error');\n    }\n    const state = this._controlledWritableStream._state;\n    if (state !== 'writable') {\n      // The stream is closed, errored or will be soon. The sink can't do anything useful if it gets an error here, so\n      // just treat it as a no-op.\n      return;\n    }\n\n    WritableStreamDefaultControllerError(this, e);\n  }\n\n  /** @internal */\n  [AbortSteps](reason: any): Promise<void> {\n    const result = this._abortAlgorithm(reason);\n    WritableStreamDefaultControllerClearAlgorithms(this);\n    return result;\n  }\n\n  /** @internal */\n  [ErrorSteps]() {\n    ResetQueue(this);\n  }\n}\n\nObject.defineProperties(WritableStreamDefaultController.prototype, {\n  abortReason: { enumerable: true },\n  signal: { enumerable: true },\n  error: { enumerable: true }\n});\nif (typeof Symbol.toStringTag === 'symbol') {\n  Object.defineProperty(WritableStreamDefaultController.prototype, Symbol.toStringTag, {\n    value: 'WritableStreamDefaultController',\n    configurable: true\n  });\n}\n\n// Abstract operations implementing interface required by the WritableStream.\n\nfunction IsWritableStreamDefaultController(x: any): x is WritableStreamDefaultController<any> {\n  if (!typeIsObject(x)) {\n    return false;\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(x, '_controlledWritableStream')) {\n    return false;\n  }\n\n  return x instanceof WritableStreamDefaultController;\n}\n\nfunction SetUpWritableStreamDefaultController<W>(stream: WritableStream<W>,\n                                                 controller: WritableStreamDefaultController<W>,\n                                                 startAlgorithm: () => void | PromiseLike<void>,\n                                                 writeAlgorithm: (chunk: W) => Promise<void>,\n                                                 closeAlgorithm: () => Promise<void>,\n                                                 abortAlgorithm: (reason: any) => Promise<void>,\n                                                 highWaterMark: number,\n                                                 sizeAlgorithm: QueuingStrategySizeCallback<W>) {\n  assert(IsWritableStream(stream));\n  assert(stream._writableStreamController === undefined);\n\n  controller._controlledWritableStream = stream;\n  stream._writableStreamController = controller;\n\n  // Need to set the slots so that the assert doesn't fire. In the spec the slots already exist implicitly.\n  controller._queue = undefined!;\n  controller._queueTotalSize = undefined!;\n  ResetQueue(controller);\n\n  controller._abortReason = undefined;\n  controller._abortController = createAbortController();\n  controller._started = false;\n\n  controller._strategySizeAlgorithm = sizeAlgorithm;\n  controller._strategyHWM = highWaterMark;\n\n  controller._writeAlgorithm = writeAlgorithm;\n  controller._closeAlgorithm = closeAlgorithm;\n  controller._abortAlgorithm = abortAlgorithm;\n\n  const backpressure = WritableStreamDefaultControllerGetBackpressure(controller);\n  WritableStreamUpdateBackpressure(stream, backpressure);\n\n  const startResult = startAlgorithm();\n  const startPromise = promiseResolvedWith(startResult);\n  uponPromise(\n    startPromise,\n    () => {\n      assert(stream._state === 'writable' || stream._state === 'erroring');\n      controller._started = true;\n      WritableStreamDefaultControllerAdvanceQueueIfNeeded(controller);\n      return null;\n    },\n    r => {\n      assert(stream._state === 'writable' || stream._state === 'erroring');\n      controller._started = true;\n      WritableStreamDealWithRejection(stream, r);\n      return null;\n    }\n  );\n}\n\nfunction SetUpWritableStreamDefaultControllerFromUnderlyingSink<W>(stream: WritableStream<W>,\n                                                                   underlyingSink: ValidatedUnderlyingSink<W>,\n                                                                   highWaterMark: number,\n                                                                   sizeAlgorithm: QueuingStrategySizeCallback<W>) {\n  const controller = Object.create(WritableStreamDefaultController.prototype);\n\n  let startAlgorithm: () => void | PromiseLike<void>;\n  let writeAlgorithm: (chunk: W) => Promise<void>;\n  let closeAlgorithm: () => Promise<void>;\n  let abortAlgorithm: (reason: any) => Promise<void>;\n\n  if (underlyingSink.start !== undefined) {\n    startAlgorithm = () => underlyingSink.start!(controller);\n  } else {\n    startAlgorithm = () => undefined;\n  }\n  if (underlyingSink.write !== undefined) {\n    writeAlgorithm = chunk => underlyingSink.write!(chunk, controller);\n  } else {\n    writeAlgorithm = () => promiseResolvedWith(undefined);\n  }\n  if (underlyingSink.close !== undefined) {\n    closeAlgorithm = () => underlyingSink.close!();\n  } else {\n    closeAlgorithm = () => promiseResolvedWith(undefined);\n  }\n  if (underlyingSink.abort !== undefined) {\n    abortAlgorithm = reason => underlyingSink.abort!(reason);\n  } else {\n    abortAlgorithm = () => promiseResolvedWith(undefined);\n  }\n\n  SetUpWritableStreamDefaultController(\n    stream, controller, startAlgorithm, writeAlgorithm, closeAlgorithm, abortAlgorithm, highWaterMark, sizeAlgorithm\n  );\n}\n\n// ClearAlgorithms may be called twice. Erroring the same stream in multiple ways will often result in redundant calls.\nfunction WritableStreamDefaultControllerClearAlgorithms(controller: WritableStreamDefaultController<any>) {\n  controller._writeAlgorithm = undefined!;\n  controller._closeAlgorithm = undefined!;\n  controller._abortAlgorithm = undefined!;\n  controller._strategySizeAlgorithm = undefined!;\n}\n\nfunction WritableStreamDefaultControllerClose<W>(controller: WritableStreamDefaultController<W>) {\n  EnqueueValueWithSize(controller, closeSentinel, 0);\n  WritableStreamDefaultControllerAdvanceQueueIfNeeded(controller);\n}\n\nfunction WritableStreamDefaultControllerGetChunkSize<W>(controller: WritableStreamDefaultController<W>,\n                                                        chunk: W): number {\n  try {\n    return controller._strategySizeAlgorithm(chunk);\n  } catch (chunkSizeE) {\n    WritableStreamDefaultControllerErrorIfNeeded(controller, chunkSizeE);\n    return 1;\n  }\n}\n\nfunction WritableStreamDefaultControllerGetDesiredSize(controller: WritableStreamDefaultController<any>): number {\n  return controller._strategyHWM - controller._queueTotalSize;\n}\n\nfunction WritableStreamDefaultControllerWrite<W>(controller: WritableStreamDefaultController<W>,\n                                                 chunk: W,\n                                                 chunkSize: number) {\n  try {\n    EnqueueValueWithSize(controller, chunk, chunkSize);\n  } catch (enqueueE) {\n    WritableStreamDefaultControllerErrorIfNeeded(controller, enqueueE);\n    return;\n  }\n\n  const stream = controller._controlledWritableStream;\n  if (!WritableStreamCloseQueuedOrInFlight(stream) && stream._state === 'writable') {\n    const backpressure = WritableStreamDefaultControllerGetBackpressure(controller);\n    WritableStreamUpdateBackpressure(stream, backpressure);\n  }\n\n  WritableStreamDefaultControllerAdvanceQueueIfNeeded(controller);\n}\n\n// Abstract operations for the WritableStreamDefaultController.\n\nfunction WritableStreamDefaultControllerAdvanceQueueIfNeeded<W>(controller: WritableStreamDefaultController<W>) {\n  const stream = controller._controlledWritableStream;\n\n  if (!controller._started) {\n    return;\n  }\n\n  if (stream._inFlightWriteRequest !== undefined) {\n    return;\n  }\n\n  const state = stream._state;\n  assert(state !== 'closed' && state !== 'errored');\n  if (state === 'erroring') {\n    WritableStreamFinishErroring(stream);\n    return;\n  }\n\n  if (controller._queue.length === 0) {\n    return;\n  }\n\n  const value = PeekQueueValue(controller);\n  if (value === closeSentinel) {\n    WritableStreamDefaultControllerProcessClose(controller);\n  } else {\n    WritableStreamDefaultControllerProcessWrite(controller, value);\n  }\n}\n\nfunction WritableStreamDefaultControllerErrorIfNeeded(controller: WritableStreamDefaultController<any>, error: any) {\n  if (controller._controlledWritableStream._state === 'writable') {\n    WritableStreamDefaultControllerError(controller, error);\n  }\n}\n\nfunction WritableStreamDefaultControllerProcessClose(controller: WritableStreamDefaultController<any>) {\n  const stream = controller._controlledWritableStream;\n\n  WritableStreamMarkCloseRequestInFlight(stream);\n\n  DequeueValue(controller);\n  assert(controller._queue.length === 0);\n\n  const sinkClosePromise = controller._closeAlgorithm();\n  WritableStreamDefaultControllerClearAlgorithms(controller);\n  uponPromise(\n    sinkClosePromise,\n    () => {\n      WritableStreamFinishInFlightClose(stream);\n      return null;\n    },\n    reason => {\n      WritableStreamFinishInFlightCloseWithError(stream, reason);\n      return null;\n    }\n  );\n}\n\nfunction WritableStreamDefaultControllerProcessWrite<W>(controller: WritableStreamDefaultController<W>, chunk: W) {\n  const stream = controller._controlledWritableStream;\n\n  WritableStreamMarkFirstWriteRequestInFlight(stream);\n\n  const sinkWritePromise = controller._writeAlgorithm(chunk);\n  uponPromise(\n    sinkWritePromise,\n    () => {\n      WritableStreamFinishInFlightWrite(stream);\n\n      const state = stream._state;\n      assert(state === 'writable' || state === 'erroring');\n\n      DequeueValue(controller);\n\n      if (!WritableStreamCloseQueuedOrInFlight(stream) && state === 'writable') {\n        const backpressure = WritableStreamDefaultControllerGetBackpressure(controller);\n        WritableStreamUpdateBackpressure(stream, backpressure);\n      }\n\n      WritableStreamDefaultControllerAdvanceQueueIfNeeded(controller);\n      return null;\n    },\n    reason => {\n      if (stream._state === 'writable') {\n        WritableStreamDefaultControllerClearAlgorithms(controller);\n      }\n      WritableStreamFinishInFlightWriteWithError(stream, reason);\n      return null;\n    }\n  );\n}\n\nfunction WritableStreamDefaultControllerGetBackpressure(controller: WritableStreamDefaultController<any>): boolean {\n  const desiredSize = WritableStreamDefaultControllerGetDesiredSize(controller);\n  return desiredSize <= 0;\n}\n\n// A client of WritableStreamDefaultController may use these functions directly to bypass state check.\n\nfunction WritableStreamDefaultControllerError(controller: WritableStreamDefaultController<any>, error: any) {\n  const stream = controller._controlledWritableStream;\n\n  assert(stream._state === 'writable');\n\n  WritableStreamDefaultControllerClearAlgorithms(controller);\n  WritableStreamStartErroring(stream, error);\n}\n\n// Helper functions for the WritableStream.\n\nfunction streamBrandCheckException(name: string): TypeError {\n  return new TypeError(`WritableStream.prototype.${name} can only be used on a WritableStream`);\n}\n\n// Helper functions for the WritableStreamDefaultController.\n\nfunction defaultControllerBrandCheckException(name: string): TypeError {\n  return new TypeError(\n    `WritableStreamDefaultController.prototype.${name} can only be used on a WritableStreamDefaultController`);\n}\n\n\n// Helper functions for the WritableStreamDefaultWriter.\n\nfunction defaultWriterBrandCheckException(name: string): TypeError {\n  return new TypeError(\n    `WritableStreamDefaultWriter.prototype.${name} can only be used on a WritableStreamDefaultWriter`);\n}\n\nfunction defaultWriterLockException(name: string): TypeError {\n  return new TypeError('Cannot ' + name + ' a stream using a released writer');\n}\n\nfunction defaultWriterClosedPromiseInitialize(writer: WritableStreamDefaultWriter) {\n  writer._closedPromise = newPromise((resolve, reject) => {\n    writer._closedPromise_resolve = resolve;\n    writer._closedPromise_reject = reject;\n    writer._closedPromiseState = 'pending';\n  });\n}\n\nfunction defaultWriterClosedPromiseInitializeAsRejected(writer: WritableStreamDefaultWriter, reason: any) {\n  defaultWriterClosedPromiseInitialize(writer);\n  defaultWriterClosedPromiseReject(writer, reason);\n}\n\nfunction defaultWriterClosedPromiseInitializeAsResolved(writer: WritableStreamDefaultWriter) {\n  defaultWriterClosedPromiseInitialize(writer);\n  defaultWriterClosedPromiseResolve(writer);\n}\n\nfunction defaultWriterClosedPromiseReject(writer: WritableStreamDefaultWriter, reason: any) {\n  if (writer._closedPromise_reject === undefined) {\n    return;\n  }\n  assert(writer._closedPromiseState === 'pending');\n\n  setPromiseIsHandledToTrue(writer._closedPromise);\n  writer._closedPromise_reject(reason);\n  writer._closedPromise_resolve = undefined;\n  writer._closedPromise_reject = undefined;\n  writer._closedPromiseState = 'rejected';\n}\n\nfunction defaultWriterClosedPromiseResetToRejected(writer: WritableStreamDefaultWriter, reason: any) {\n  assert(writer._closedPromise_resolve === undefined);\n  assert(writer._closedPromise_reject === undefined);\n  assert(writer._closedPromiseState !== 'pending');\n\n  defaultWriterClosedPromiseInitializeAsRejected(writer, reason);\n}\n\nfunction defaultWriterClosedPromiseResolve(writer: WritableStreamDefaultWriter) {\n  if (writer._closedPromise_resolve === undefined) {\n    return;\n  }\n  assert(writer._closedPromiseState === 'pending');\n\n  writer._closedPromise_resolve(undefined);\n  writer._closedPromise_resolve = undefined;\n  writer._closedPromise_reject = undefined;\n  writer._closedPromiseState = 'resolved';\n}\n\nfunction defaultWriterReadyPromiseInitialize(writer: WritableStreamDefaultWriter) {\n  writer._readyPromise = newPromise((resolve, reject) => {\n    writer._readyPromise_resolve = resolve;\n    writer._readyPromise_reject = reject;\n  });\n  writer._readyPromiseState = 'pending';\n}\n\nfunction defaultWriterReadyPromiseInitializeAsRejected(writer: WritableStreamDefaultWriter, reason: any) {\n  defaultWriterReadyPromiseInitialize(writer);\n  defaultWriterReadyPromiseReject(writer, reason);\n}\n\nfunction defaultWriterReadyPromiseInitializeAsResolved(writer: WritableStreamDefaultWriter) {\n  defaultWriterReadyPromiseInitialize(writer);\n  defaultWriterReadyPromiseResolve(writer);\n}\n\nfunction defaultWriterReadyPromiseReject(writer: WritableStreamDefaultWriter, reason: any) {\n  if (writer._readyPromise_reject === undefined) {\n    return;\n  }\n\n  setPromiseIsHandledToTrue(writer._readyPromise);\n  writer._readyPromise_reject(reason);\n  writer._readyPromise_resolve = undefined;\n  writer._readyPromise_reject = undefined;\n  writer._readyPromiseState = 'rejected';\n}\n\nfunction defaultWriterReadyPromiseReset(writer: WritableStreamDefaultWriter) {\n  assert(writer._readyPromise_resolve === undefined);\n  assert(writer._readyPromise_reject === undefined);\n\n  defaultWriterReadyPromiseInitialize(writer);\n}\n\nfunction defaultWriterReadyPromiseResetToRejected(writer: WritableStreamDefaultWriter, reason: any) {\n  assert(writer._readyPromise_resolve === undefined);\n  assert(writer._readyPromise_reject === undefined);\n\n  defaultWriterReadyPromiseInitializeAsRejected(writer, reason);\n}\n\nfunction defaultWriterReadyPromiseResolve(writer: WritableStreamDefaultWriter) {\n  if (writer._readyPromise_resolve === undefined) {\n    return;\n  }\n\n  writer._readyPromise_resolve(undefined);\n  writer._readyPromise_resolve = undefined;\n  writer._readyPromise_reject = undefined;\n  writer._readyPromiseState = 'fulfilled';\n}\n", "/// <reference lib=\"dom\" />\n\nfunction getGlobals(): typeof globalThis | undefined {\n  if (typeof globalThis !== 'undefined') {\n    return globalThis;\n  } else if (typeof self !== 'undefined') {\n    return self;\n  } else if (typeof global !== 'undefined') {\n    return global;\n  }\n  return undefined;\n}\n\nexport const globals = getGlobals();\n", "/// <reference types=\"node\" />\nimport { globals } from '../globals';\nimport { setFunctionName } from '../lib/helpers/miscellaneous';\n\ninterface DOMException extends Error {\n  name: string;\n  message: string;\n}\n\ntype DOMExceptionConstructor = new (message?: string, name?: string) => DOMException;\n\nfunction isDOMExceptionConstructor(ctor: unknown): ctor is DOMExceptionConstructor {\n  if (!(typeof ctor === 'function' || typeof ctor === 'object')) {\n    return false;\n  }\n  if ((ctor as DOMExceptionConstructor).name !== 'DOMException') {\n    return false;\n  }\n  try {\n    new (ctor as DOMExceptionConstructor)();\n    return true;\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Support:\n * - Web browsers\n * - Node 18 and higher (https://github.com/nodejs/node/commit/e4b1fb5e6422c1ff151234bb9de792d45dd88d87)\n */\nfunction getFromGlobal(): DOMExceptionConstructor | undefined {\n  const ctor = globals?.DOMException;\n  return isDOMExceptionConstructor(ctor) ? ctor : undefined;\n}\n\n/**\n * Support:\n * - All platforms\n */\nfunction createPolyfill(): DOMExceptionConstructor {\n  // eslint-disable-next-line @typescript-eslint/no-shadow\n  const ctor = function DOMException(this: DOMException, message?: string, name?: string) {\n    this.message = message || '';\n    this.name = name || 'Error';\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, this.constructor);\n    }\n  } as any;\n  setFunctionName(ctor, 'DOMException');\n  ctor.prototype = Object.create(Error.prototype);\n  Object.defineProperty(ctor.prototype, 'constructor', { value: ctor, writable: true, configurable: true });\n  return ctor;\n}\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nconst DOMException: DOMExceptionConstructor = getFromGlobal() || createPolyfill();\n\nexport { DOMException };\n", "import { IsReadableStream, IsReadableStreamLocked, ReadableStream, ReadableStreamCancel } from '../readable-stream';\nimport { AcquireReadableStreamDefaultReader, ReadableStreamDefaultReaderRead } from './default-reader';\nimport { ReadableStreamReaderGenericRelease } from './generic-reader';\nimport {\n  AcquireWritableStreamDefaultWriter,\n  IsWritableStream,\n  IsWritableStreamLocked,\n  WritableStream,\n  WritableStreamAbort,\n  WritableStreamCloseQueuedOrInFlight,\n  WritableStreamDefaultWriterCloseWithErrorPropagation,\n  WritableStreamDefaultWriterRelease,\n  WritableStreamDefaultWriterWrite\n} from '../writable-stream';\nimport assert from '../../stub/assert';\nimport {\n  newPromise,\n  PerformPromiseThen,\n  promiseResolvedWith,\n  setPromiseIsHandledToTrue,\n  uponFulfillment,\n  uponPromise,\n  uponRejection\n} from '../helpers/webidl';\nimport { noop } from '../../utils';\nimport { type AbortSignal, isAbortSignal } from '../abort-signal';\nimport { DOMException } from '../../stub/dom-exception';\n\nexport function ReadableStreamPipeTo<T>(source: ReadableStream<T>,\n                                        dest: WritableStream<T>,\n                                        preventClose: boolean,\n                                        preventAbort: boolean,\n                                        preventCancel: boolean,\n                                        signal: AbortSignal | undefined): Promise<undefined> {\n  assert(IsReadableStream(source));\n  assert(IsWritableStream(dest));\n  assert(typeof preventClose === 'boolean');\n  assert(typeof preventAbort === 'boolean');\n  assert(typeof preventCancel === 'boolean');\n  assert(signal === undefined || isAbortSignal(signal));\n  assert(!IsReadableStreamLocked(source));\n  assert(!IsWritableStreamLocked(dest));\n\n  const reader = AcquireReadableStreamDefaultReader<T>(source);\n  const writer = AcquireWritableStreamDefaultWriter<T>(dest);\n\n  source._disturbed = true;\n\n  let shuttingDown = false;\n\n  // This is used to keep track of the spec's requirement that we wait for ongoing writes during shutdown.\n  let currentWrite = promiseResolvedWith<void>(undefined);\n\n  return newPromise((resolve, reject) => {\n    let abortAlgorithm: () => void;\n    if (signal !== undefined) {\n      abortAlgorithm = () => {\n        const error = signal.reason !== undefined ? signal.reason : new DOMException('Aborted', 'AbortError');\n        const actions: Array<() => Promise<void>> = [];\n        if (!preventAbort) {\n          actions.push(() => {\n            if (dest._state === 'writable') {\n              return WritableStreamAbort(dest, error);\n            }\n            return promiseResolvedWith(undefined);\n          });\n        }\n        if (!preventCancel) {\n          actions.push(() => {\n            if (source._state === 'readable') {\n              return ReadableStreamCancel(source, error);\n            }\n            return promiseResolvedWith(undefined);\n          });\n        }\n        shutdownWithAction(() => Promise.all(actions.map(action => action())), true, error);\n      };\n\n      if (signal.aborted) {\n        abortAlgorithm();\n        return;\n      }\n\n      signal.addEventListener('abort', abortAlgorithm);\n    }\n\n    // Using reader and writer, read all chunks from this and write them to dest\n    // - Backpressure must be enforced\n    // - Shutdown must stop all activity\n    function pipeLoop() {\n      return newPromise<void>((resolveLoop, rejectLoop) => {\n        function next(done: boolean) {\n          if (done) {\n            resolveLoop();\n          } else {\n            // Use `PerformPromiseThen` instead of `uponPromise` to avoid\n            // adding unnecessary `.catch(rethrowAssertionErrorRejection)` handlers\n            PerformPromiseThen(pipeStep(), next, rejectLoop);\n          }\n        }\n\n        next(false);\n      });\n    }\n\n    function pipeStep(): Promise<boolean> {\n      if (shuttingDown) {\n        return promiseResolvedWith(true);\n      }\n\n      return PerformPromiseThen(writer._readyPromise, () => {\n        return newPromise<boolean>((resolveRead, rejectRead) => {\n          ReadableStreamDefaultReaderRead(\n            reader,\n            {\n              _chunkSteps: chunk => {\n                currentWrite = PerformPromiseThen(WritableStreamDefaultWriterWrite(writer, chunk), undefined, noop);\n                resolveRead(false);\n              },\n              _closeSteps: () => resolveRead(true),\n              _errorSteps: rejectRead\n            }\n          );\n        });\n      });\n    }\n\n    // Errors must be propagated forward\n    isOrBecomesErrored(source, reader._closedPromise, storedError => {\n      if (!preventAbort) {\n        shutdownWithAction(() => WritableStreamAbort(dest, storedError), true, storedError);\n      } else {\n        shutdown(true, storedError);\n      }\n      return null;\n    });\n\n    // Errors must be propagated backward\n    isOrBecomesErrored(dest, writer._closedPromise, storedError => {\n      if (!preventCancel) {\n        shutdownWithAction(() => ReadableStreamCancel(source, storedError), true, storedError);\n      } else {\n        shutdown(true, storedError);\n      }\n      return null;\n    });\n\n    // Closing must be propagated forward\n    isOrBecomesClosed(source, reader._closedPromise, () => {\n      if (!preventClose) {\n        shutdownWithAction(() => WritableStreamDefaultWriterCloseWithErrorPropagation(writer));\n      } else {\n        shutdown();\n      }\n      return null;\n    });\n\n    // Closing must be propagated backward\n    if (WritableStreamCloseQueuedOrInFlight(dest) || dest._state === 'closed') {\n      const destClosed = new TypeError('the destination writable stream closed before all data could be piped to it');\n\n      if (!preventCancel) {\n        shutdownWithAction(() => ReadableStreamCancel(source, destClosed), true, destClosed);\n      } else {\n        shutdown(true, destClosed);\n      }\n    }\n\n    setPromiseIsHandledToTrue(pipeLoop());\n\n    function waitForWritesToFinish(): Promise<void> {\n      // Another write may have started while we were waiting on this currentWrite, so we have to be sure to wait\n      // for that too.\n      const oldCurrentWrite = currentWrite;\n      return PerformPromiseThen(\n        currentWrite,\n        () => oldCurrentWrite !== currentWrite ? waitForWritesToFinish() : undefined\n      );\n    }\n\n    function isOrBecomesErrored(stream: ReadableStream | WritableStream,\n                                promise: Promise<void>,\n                                action: (reason: any) => null) {\n      if (stream._state === 'errored') {\n        action(stream._storedError);\n      } else {\n        uponRejection(promise, action);\n      }\n    }\n\n    function isOrBecomesClosed(stream: ReadableStream | WritableStream, promise: Promise<void>, action: () => null) {\n      if (stream._state === 'closed') {\n        action();\n      } else {\n        uponFulfillment(promise, action);\n      }\n    }\n\n    function shutdownWithAction(action: () => Promise<unknown>, originalIsError?: boolean, originalError?: any) {\n      if (shuttingDown) {\n        return;\n      }\n      shuttingDown = true;\n\n      if (dest._state === 'writable' && !WritableStreamCloseQueuedOrInFlight(dest)) {\n        uponFulfillment(waitForWritesToFinish(), doTheRest);\n      } else {\n        doTheRest();\n      }\n\n      function doTheRest(): null {\n        uponPromise(\n          action(),\n          () => finalize(originalIsError, originalError),\n          newError => finalize(true, newError)\n        );\n        return null;\n      }\n    }\n\n    function shutdown(isError?: boolean, error?: any) {\n      if (shuttingDown) {\n        return;\n      }\n      shuttingDown = true;\n\n      if (dest._state === 'writable' && !WritableStreamCloseQueuedOrInFlight(dest)) {\n        uponFulfillment(waitForWritesToFinish(), () => finalize(isError, error));\n      } else {\n        finalize(isError, error);\n      }\n    }\n\n    function finalize(isError?: boolean, error?: any): null {\n      WritableStreamDefaultWriterRelease(writer);\n      ReadableStreamReaderGenericRelease(reader);\n\n      if (signal !== undefined) {\n        signal.removeEventListener('abort', abortAlgorithm);\n      }\n      if (isError) {\n        reject(error);\n      } else {\n        resolve(undefined);\n      }\n\n      return null;\n    }\n  });\n}\n", "import type { QueuingStrategySizeCallback } from '../queuing-strategy';\nimport assert from '../../stub/assert';\nimport { DequeueValue, EnqueueValueWithSize, type QueuePair, ResetQueue } from '../abstract-ops/queue-with-sizes';\nimport {\n  ReadableStreamAddReadRequest,\n  ReadableStreamFulfillReadRequest,\n  ReadableStreamGetNumReadRequests,\n  type ReadRequest\n} from './default-reader';\nimport { SimpleQueue } from '../simple-queue';\nimport { IsReadableStreamLocked, ReadableStream, ReadableStreamClose, ReadableStreamError } from '../readable-stream';\nimport type { ValidatedUnderlyingSource } from './underlying-source';\nimport { setFunctionName, typeIsObject } from '../helpers/miscellaneous';\nimport { CancelSteps, PullSteps, ReleaseSteps } from '../abstract-ops/internal-methods';\nimport { promiseResolvedWith, uponPromise } from '../helpers/webidl';\n\n/**\n * Allows control of a {@link ReadableStream | readable stream}'s state and internal queue.\n *\n * @public\n */\nexport class ReadableStreamDefaultController<R> {\n  /** @internal */\n  _controlledReadableStream!: ReadableStream<R>;\n  /** @internal */\n  _queue!: SimpleQueue<QueuePair<R>>;\n  /** @internal */\n  _queueTotalSize!: number;\n  /** @internal */\n  _started!: boolean;\n  /** @internal */\n  _closeRequested!: boolean;\n  /** @internal */\n  _pullAgain!: boolean;\n  /** @internal */\n  _pulling !: boolean;\n  /** @internal */\n  _strategySizeAlgorithm!: QueuingStrategySizeCallback<R>;\n  /** @internal */\n  _strategyHWM!: number;\n  /** @internal */\n  _pullAlgorithm!: () => Promise<void>;\n  /** @internal */\n  _cancelAlgorithm!: (reason: any) => Promise<void>;\n\n  private constructor() {\n    throw new TypeError('Illegal constructor');\n  }\n\n  /**\n   * Returns the desired size to fill the controlled stream's internal queue. It can be negative, if the queue is\n   * over-full. An underlying source ought to use this information to determine when and how to apply backpressure.\n   */\n  get desiredSize(): number | null {\n    if (!IsReadableStreamDefaultController(this)) {\n      throw defaultControllerBrandCheckException('desiredSize');\n    }\n\n    return ReadableStreamDefaultControllerGetDesiredSize(this);\n  }\n\n  /**\n   * Closes the controlled readable stream. Consumers will still be able to read any previously-enqueued chunks from\n   * the stream, but once those are read, the stream will become closed.\n   */\n  close(): void {\n    if (!IsReadableStreamDefaultController(this)) {\n      throw defaultControllerBrandCheckException('close');\n    }\n\n    if (!ReadableStreamDefaultControllerCanCloseOrEnqueue(this)) {\n      throw new TypeError('The stream is not in a state that permits close');\n    }\n\n    ReadableStreamDefaultControllerClose(this);\n  }\n\n  /**\n   * Enqueues the given chunk `chunk` in the controlled readable stream.\n   */\n  enqueue(chunk: R): void;\n  enqueue(chunk: R = undefined!): void {\n    if (!IsReadableStreamDefaultController(this)) {\n      throw defaultControllerBrandCheckException('enqueue');\n    }\n\n    if (!ReadableStreamDefaultControllerCanCloseOrEnqueue(this)) {\n      throw new TypeError('The stream is not in a state that permits enqueue');\n    }\n\n    return ReadableStreamDefaultControllerEnqueue(this, chunk);\n  }\n\n  /**\n   * Errors the controlled readable stream, making all future interactions with it fail with the given error `e`.\n   */\n  error(e: any = undefined): void {\n    if (!IsReadableStreamDefaultController(this)) {\n      throw defaultControllerBrandCheckException('error');\n    }\n\n    ReadableStreamDefaultControllerError(this, e);\n  }\n\n  /** @internal */\n  [CancelSteps](reason: any): Promise<void> {\n    ResetQueue(this);\n    const result = this._cancelAlgorithm(reason);\n    ReadableStreamDefaultControllerClearAlgorithms(this);\n    return result;\n  }\n\n  /** @internal */\n  [PullSteps](readRequest: ReadRequest<R>): void {\n    const stream = this._controlledReadableStream;\n\n    if (this._queue.length > 0) {\n      const chunk = DequeueValue(this);\n\n      if (this._closeRequested && this._queue.length === 0) {\n        ReadableStreamDefaultControllerClearAlgorithms(this);\n        ReadableStreamClose(stream);\n      } else {\n        ReadableStreamDefaultControllerCallPullIfNeeded(this);\n      }\n\n      readRequest._chunkSteps(chunk);\n    } else {\n      ReadableStreamAddReadRequest(stream, readRequest);\n      ReadableStreamDefaultControllerCallPullIfNeeded(this);\n    }\n  }\n\n  /** @internal */\n  [ReleaseSteps](): void {\n    // Do nothing.\n  }\n}\n\nObject.defineProperties(ReadableStreamDefaultController.prototype, {\n  close: { enumerable: true },\n  enqueue: { enumerable: true },\n  error: { enumerable: true },\n  desiredSize: { enumerable: true }\n});\nsetFunctionName(ReadableStreamDefaultController.prototype.close, 'close');\nsetFunctionName(ReadableStreamDefaultController.prototype.enqueue, 'enqueue');\nsetFunctionName(ReadableStreamDefaultController.prototype.error, 'error');\nif (typeof Symbol.toStringTag === 'symbol') {\n  Object.defineProperty(ReadableStreamDefaultController.prototype, Symbol.toStringTag, {\n    value: 'ReadableStreamDefaultController',\n    configurable: true\n  });\n}\n\n// Abstract operations for the ReadableStreamDefaultController.\n\nfunction IsReadableStreamDefaultController<R = any>(x: any): x is ReadableStreamDefaultController<R> {\n  if (!typeIsObject(x)) {\n    return false;\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(x, '_controlledReadableStream')) {\n    return false;\n  }\n\n  return x instanceof ReadableStreamDefaultController;\n}\n\nfunction ReadableStreamDefaultControllerCallPullIfNeeded(controller: ReadableStreamDefaultController<any>): void {\n  const shouldPull = ReadableStreamDefaultControllerShouldCallPull(controller);\n  if (!shouldPull) {\n    return;\n  }\n\n  if (controller._pulling) {\n    controller._pullAgain = true;\n    return;\n  }\n\n  assert(!controller._pullAgain);\n\n  controller._pulling = true;\n\n  const pullPromise = controller._pullAlgorithm();\n  uponPromise(\n    pullPromise,\n    () => {\n      controller._pulling = false;\n\n      if (controller._pullAgain) {\n        controller._pullAgain = false;\n        ReadableStreamDefaultControllerCallPullIfNeeded(controller);\n      }\n\n      return null;\n    },\n    e => {\n      ReadableStreamDefaultControllerError(controller, e);\n      return null;\n    }\n  );\n}\n\nfunction ReadableStreamDefaultControllerShouldCallPull(controller: ReadableStreamDefaultController<any>): boolean {\n  const stream = controller._controlledReadableStream;\n\n  if (!ReadableStreamDefaultControllerCanCloseOrEnqueue(controller)) {\n    return false;\n  }\n\n  if (!controller._started) {\n    return false;\n  }\n\n  if (IsReadableStreamLocked(stream) && ReadableStreamGetNumReadRequests(stream) > 0) {\n    return true;\n  }\n\n  const desiredSize = ReadableStreamDefaultControllerGetDesiredSize(controller);\n  assert(desiredSize !== null);\n  if (desiredSize! > 0) {\n    return true;\n  }\n\n  return false;\n}\n\nfunction ReadableStreamDefaultControllerClearAlgorithms(controller: ReadableStreamDefaultController<any>) {\n  controller._pullAlgorithm = undefined!;\n  controller._cancelAlgorithm = undefined!;\n  controller._strategySizeAlgorithm = undefined!;\n}\n\n// A client of ReadableStreamDefaultController may use these functions directly to bypass state check.\n\nexport function ReadableStreamDefaultControllerClose(controller: ReadableStreamDefaultController<any>) {\n  if (!ReadableStreamDefaultControllerCanCloseOrEnqueue(controller)) {\n    return;\n  }\n\n  const stream = controller._controlledReadableStream;\n\n  controller._closeRequested = true;\n\n  if (controller._queue.length === 0) {\n    ReadableStreamDefaultControllerClearAlgorithms(controller);\n    ReadableStreamClose(stream);\n  }\n}\n\nexport function ReadableStreamDefaultControllerEnqueue<R>(\n  controller: ReadableStreamDefaultController<R>,\n  chunk: R\n): void {\n  if (!ReadableStreamDefaultControllerCanCloseOrEnqueue(controller)) {\n    return;\n  }\n\n  const stream = controller._controlledReadableStream;\n\n  if (IsReadableStreamLocked(stream) && ReadableStreamGetNumReadRequests(stream) > 0) {\n    ReadableStreamFulfillReadRequest(stream, chunk, false);\n  } else {\n    let chunkSize;\n    try {\n      chunkSize = controller._strategySizeAlgorithm(chunk);\n    } catch (chunkSizeE) {\n      ReadableStreamDefaultControllerError(controller, chunkSizeE);\n      throw chunkSizeE;\n    }\n\n    try {\n      EnqueueValueWithSize(controller, chunk, chunkSize);\n    } catch (enqueueE) {\n      ReadableStreamDefaultControllerError(controller, enqueueE);\n      throw enqueueE;\n    }\n  }\n\n  ReadableStreamDefaultControllerCallPullIfNeeded(controller);\n}\n\nexport function ReadableStreamDefaultControllerError(controller: ReadableStreamDefaultController<any>, e: any) {\n  const stream = controller._controlledReadableStream;\n\n  if (stream._state !== 'readable') {\n    return;\n  }\n\n  ResetQueue(controller);\n\n  ReadableStreamDefaultControllerClearAlgorithms(controller);\n  ReadableStreamError(stream, e);\n}\n\nexport function ReadableStreamDefaultControllerGetDesiredSize(\n  controller: ReadableStreamDefaultController<any>\n): number | null {\n  const state = controller._controlledReadableStream._state;\n\n  if (state === 'errored') {\n    return null;\n  }\n  if (state === 'closed') {\n    return 0;\n  }\n\n  return controller._strategyHWM - controller._queueTotalSize;\n}\n\n// This is used in the implementation of TransformStream.\nexport function ReadableStreamDefaultControllerHasBackpressure(\n  controller: ReadableStreamDefaultController<any>\n): boolean {\n  if (ReadableStreamDefaultControllerShouldCallPull(controller)) {\n    return false;\n  }\n\n  return true;\n}\n\nexport function ReadableStreamDefaultControllerCanCloseOrEnqueue(\n  controller: ReadableStreamDefaultController<any>\n): boolean {\n  const state = controller._controlledReadableStream._state;\n\n  if (!controller._closeRequested && state === 'readable') {\n    return true;\n  }\n\n  return false;\n}\n\nexport function SetUpReadableStreamDefaultController<R>(stream: ReadableStream<R>,\n                                                        controller: ReadableStreamDefaultController<R>,\n                                                        startAlgorithm: () => void | PromiseLike<void>,\n                                                        pullAlgorithm: () => Promise<void>,\n                                                        cancelAlgorithm: (reason: any) => Promise<void>,\n                                                        highWaterMark: number,\n                                                        sizeAlgorithm: QueuingStrategySizeCallback<R>) {\n  assert(stream._readableStreamController === undefined);\n\n  controller._controlledReadableStream = stream;\n\n  controller._queue = undefined!;\n  controller._queueTotalSize = undefined!;\n  ResetQueue(controller);\n\n  controller._started = false;\n  controller._closeRequested = false;\n  controller._pullAgain = false;\n  controller._pulling = false;\n\n  controller._strategySizeAlgorithm = sizeAlgorithm;\n  controller._strategyHWM = highWaterMark;\n\n  controller._pullAlgorithm = pullAlgorithm;\n  controller._cancelAlgorithm = cancelAlgorithm;\n\n  stream._readableStreamController = controller;\n\n  const startResult = startAlgorithm();\n  uponPromise(\n    promiseResolvedWith(startResult),\n    () => {\n      controller._started = true;\n\n      assert(!controller._pulling);\n      assert(!controller._pullAgain);\n\n      ReadableStreamDefaultControllerCallPullIfNeeded(controller);\n      return null;\n    },\n    r => {\n      ReadableStreamDefaultControllerError(controller, r);\n      return null;\n    }\n  );\n}\n\nexport function SetUpReadableStreamDefaultControllerFromUnderlyingSource<R>(\n  stream: ReadableStream<R>,\n  underlyingSource: ValidatedUnderlyingSource<R>,\n  highWaterMark: number,\n  sizeAlgorithm: QueuingStrategySizeCallback<R>\n) {\n  const controller: ReadableStreamDefaultController<R> = Object.create(ReadableStreamDefaultController.prototype);\n\n  let startAlgorithm: () => void | PromiseLike<void>;\n  let pullAlgorithm: () => Promise<void>;\n  let cancelAlgorithm: (reason: any) => Promise<void>;\n\n  if (underlyingSource.start !== undefined) {\n    startAlgorithm = () => underlyingSource.start!(controller);\n  } else {\n    startAlgorithm = () => undefined;\n  }\n  if (underlyingSource.pull !== undefined) {\n    pullAlgorithm = () => underlyingSource.pull!(controller);\n  } else {\n    pullAlgorithm = () => promiseResolvedWith(undefined);\n  }\n  if (underlyingSource.cancel !== undefined) {\n    cancelAlgorithm = reason => underlyingSource.cancel!(reason);\n  } else {\n    cancelAlgorithm = () => promiseResolvedWith(undefined);\n  }\n\n  SetUpReadableStreamDefaultController(\n    stream, controller, startAlgorithm, pullAlgorithm, cancelAlgorithm, highWaterMark, sizeAlgorithm\n  );\n}\n\n// Helper functions for the ReadableStreamDefaultController.\n\nfunction defaultControllerBrandCheckException(name: string): TypeError {\n  return new TypeError(\n    `ReadableStreamDefaultController.prototype.${name} can only be used on a ReadableStreamDefaultController`);\n}\n", "import {\n  CreateReadableByteStream,\n  CreateReadableStream,\n  type DefaultReadableStream,\n  IsReadableStream,\n  type ReadableByteStream,\n  ReadableStream,\n  ReadableStreamCancel,\n  type ReadableStreamReader\n} from '../readable-stream';\nimport { ReadableStreamReaderGenericRelease } from './generic-reader';\nimport {\n  AcquireReadableStreamDefaultReader,\n  IsReadableStreamDefaultReader,\n  ReadableStreamDefaultReaderRead,\n  type ReadRequest\n} from './default-reader';\nimport {\n  AcquireReadableStreamBYOBReader,\n  IsReadableStreamBYOBReader,\n  ReadableStreamBYOBReaderRead,\n  type ReadIntoRequest\n} from './byob-reader';\nimport assert from '../../stub/assert';\nimport { newPromise, promiseResolvedWith, queueMicrotask, uponRejection } from '../helpers/webidl';\nimport {\n  ReadableStreamDefaultControllerClose,\n  ReadableStreamDefaultControllerEnqueue,\n  ReadableStreamDefaultControllerError\n} from './default-controller';\nimport {\n  IsReadableByteStreamController,\n  ReadableByteStreamControllerClose,\n  ReadableByteStreamControllerEnqueue,\n  ReadableByteStreamControllerError,\n  ReadableByteStreamControllerGetBYOBRequest,\n  ReadableByteStreamControllerRespond,\n  ReadableByteStreamControllerRespondWithNewView\n} from './byte-stream-controller';\nimport { CreateArrayFromList } from '../abstract-ops/ecmascript';\nimport { CloneAsUint8Array } from '../abstract-ops/miscellaneous';\nimport type { NonShared } from '../helpers/array-buffer-view';\n\nexport function ReadableStreamTee<R>(stream: ReadableStream<R>,\n                                     cloneForBranch2: boolean): [ReadableStream<R>, ReadableStream<R>] {\n  assert(IsReadableStream(stream));\n  assert(typeof cloneForBranch2 === 'boolean');\n  if (IsReadableByteStreamController(stream._readableStreamController)) {\n    return ReadableByteStreamTee(stream as unknown as ReadableByteStream) as\n      unknown as [ReadableStream<R>, ReadableStream<R>];\n  }\n  return ReadableStreamDefaultTee(stream, cloneForBranch2);\n}\n\nexport function ReadableStreamDefaultTee<R>(\n  stream: ReadableStream<R>,\n  cloneForBranch2: boolean\n): [DefaultReadableStream<R>, DefaultReadableStream<R>] {\n  assert(IsReadableStream(stream));\n  assert(typeof cloneForBranch2 === 'boolean');\n\n  const reader = AcquireReadableStreamDefaultReader<R>(stream);\n\n  let reading = false;\n  let readAgain = false;\n  let canceled1 = false;\n  let canceled2 = false;\n  let reason1: any;\n  let reason2: any;\n  let branch1: DefaultReadableStream<R>;\n  let branch2: DefaultReadableStream<R>;\n\n  let resolveCancelPromise: (value: undefined | Promise<undefined>) => void;\n  const cancelPromise = newPromise<undefined>(resolve => {\n    resolveCancelPromise = resolve;\n  });\n\n  function pullAlgorithm(): Promise<void> {\n    if (reading) {\n      readAgain = true;\n      return promiseResolvedWith(undefined);\n    }\n\n    reading = true;\n\n    const readRequest: ReadRequest<R> = {\n      _chunkSteps: chunk => {\n        // This needs to be delayed a microtask because it takes at least a microtask to detect errors (using\n        // reader._closedPromise below), and we want errors in stream to error both branches immediately. We cannot let\n        // successful synchronously-available reads get ahead of asynchronously-available errors.\n        queueMicrotask(() => {\n          readAgain = false;\n          const chunk1 = chunk;\n          const chunk2 = chunk;\n\n          // There is no way to access the cloning code right now in the reference implementation.\n          // If we add one then we'll need an implementation for serializable objects.\n          // if (!canceled2 && cloneForBranch2) {\n          //   chunk2 = StructuredDeserialize(StructuredSerialize(chunk2));\n          // }\n\n          if (!canceled1) {\n            ReadableStreamDefaultControllerEnqueue(branch1._readableStreamController, chunk1);\n          }\n          if (!canceled2) {\n            ReadableStreamDefaultControllerEnqueue(branch2._readableStreamController, chunk2);\n          }\n\n          reading = false;\n          if (readAgain) {\n            pullAlgorithm();\n          }\n        });\n      },\n      _closeSteps: () => {\n        reading = false;\n        if (!canceled1) {\n          ReadableStreamDefaultControllerClose(branch1._readableStreamController);\n        }\n        if (!canceled2) {\n          ReadableStreamDefaultControllerClose(branch2._readableStreamController);\n        }\n\n        if (!canceled1 || !canceled2) {\n          resolveCancelPromise(undefined);\n        }\n      },\n      _errorSteps: () => {\n        reading = false;\n      }\n    };\n    ReadableStreamDefaultReaderRead(reader, readRequest);\n\n    return promiseResolvedWith(undefined);\n  }\n\n  function cancel1Algorithm(reason: any): Promise<void> {\n    canceled1 = true;\n    reason1 = reason;\n    if (canceled2) {\n      const compositeReason = CreateArrayFromList([reason1, reason2]);\n      const cancelResult = ReadableStreamCancel(stream, compositeReason);\n      resolveCancelPromise(cancelResult);\n    }\n    return cancelPromise;\n  }\n\n  function cancel2Algorithm(reason: any): Promise<void> {\n    canceled2 = true;\n    reason2 = reason;\n    if (canceled1) {\n      const compositeReason = CreateArrayFromList([reason1, reason2]);\n      const cancelResult = ReadableStreamCancel(stream, compositeReason);\n      resolveCancelPromise(cancelResult);\n    }\n    return cancelPromise;\n  }\n\n  function startAlgorithm() {\n    // do nothing\n  }\n\n  branch1 = CreateReadableStream(startAlgorithm, pullAlgorithm, cancel1Algorithm);\n  branch2 = CreateReadableStream(startAlgorithm, pullAlgorithm, cancel2Algorithm);\n\n  uponRejection(reader._closedPromise, (r: any) => {\n    ReadableStreamDefaultControllerError(branch1._readableStreamController, r);\n    ReadableStreamDefaultControllerError(branch2._readableStreamController, r);\n    if (!canceled1 || !canceled2) {\n      resolveCancelPromise(undefined);\n    }\n    return null;\n  });\n\n  return [branch1, branch2];\n}\n\nexport function ReadableByteStreamTee(stream: ReadableByteStream): [ReadableByteStream, ReadableByteStream] {\n  assert(IsReadableStream(stream));\n  assert(IsReadableByteStreamController(stream._readableStreamController));\n\n  let reader: ReadableStreamReader<NonShared<Uint8Array>> = AcquireReadableStreamDefaultReader(stream);\n  let reading = false;\n  let readAgainForBranch1 = false;\n  let readAgainForBranch2 = false;\n  let canceled1 = false;\n  let canceled2 = false;\n  let reason1: any;\n  let reason2: any;\n  let branch1: ReadableByteStream;\n  let branch2: ReadableByteStream;\n\n  let resolveCancelPromise: (value: undefined | Promise<undefined>) => void;\n  const cancelPromise = newPromise<void>(resolve => {\n    resolveCancelPromise = resolve;\n  });\n\n  function forwardReaderError(thisReader: ReadableStreamReader<NonShared<Uint8Array>>) {\n    uponRejection(thisReader._closedPromise, r => {\n      if (thisReader !== reader) {\n        return null;\n      }\n      ReadableByteStreamControllerError(branch1._readableStreamController, r);\n      ReadableByteStreamControllerError(branch2._readableStreamController, r);\n      if (!canceled1 || !canceled2) {\n        resolveCancelPromise(undefined);\n      }\n      return null;\n    });\n  }\n\n  function pullWithDefaultReader() {\n    if (IsReadableStreamBYOBReader(reader)) {\n      assert(reader._readIntoRequests.length === 0);\n      ReadableStreamReaderGenericRelease(reader);\n\n      reader = AcquireReadableStreamDefaultReader(stream);\n      forwardReaderError(reader);\n    }\n\n    const readRequest: ReadRequest<NonShared<Uint8Array>> = {\n      _chunkSteps: chunk => {\n        // This needs to be delayed a microtask because it takes at least a microtask to detect errors (using\n        // reader._closedPromise below), and we want errors in stream to error both branches immediately. We cannot let\n        // successful synchronously-available reads get ahead of asynchronously-available errors.\n        queueMicrotask(() => {\n          readAgainForBranch1 = false;\n          readAgainForBranch2 = false;\n\n          const chunk1 = chunk;\n          let chunk2 = chunk;\n          if (!canceled1 && !canceled2) {\n            try {\n              chunk2 = CloneAsUint8Array(chunk);\n            } catch (cloneE) {\n              ReadableByteStreamControllerError(branch1._readableStreamController, cloneE);\n              ReadableByteStreamControllerError(branch2._readableStreamController, cloneE);\n              resolveCancelPromise(ReadableStreamCancel(stream, cloneE));\n              return;\n            }\n          }\n\n          if (!canceled1) {\n            ReadableByteStreamControllerEnqueue(branch1._readableStreamController, chunk1);\n          }\n          if (!canceled2) {\n            ReadableByteStreamControllerEnqueue(branch2._readableStreamController, chunk2);\n          }\n\n          reading = false;\n          if (readAgainForBranch1) {\n            pull1Algorithm();\n          } else if (readAgainForBranch2) {\n            pull2Algorithm();\n          }\n        });\n      },\n      _closeSteps: () => {\n        reading = false;\n        if (!canceled1) {\n          ReadableByteStreamControllerClose(branch1._readableStreamController);\n        }\n        if (!canceled2) {\n          ReadableByteStreamControllerClose(branch2._readableStreamController);\n        }\n        if (branch1._readableStreamController._pendingPullIntos.length > 0) {\n          ReadableByteStreamControllerRespond(branch1._readableStreamController, 0);\n        }\n        if (branch2._readableStreamController._pendingPullIntos.length > 0) {\n          ReadableByteStreamControllerRespond(branch2._readableStreamController, 0);\n        }\n        if (!canceled1 || !canceled2) {\n          resolveCancelPromise(undefined);\n        }\n      },\n      _errorSteps: () => {\n        reading = false;\n      }\n    };\n    ReadableStreamDefaultReaderRead(reader, readRequest);\n  }\n\n  function pullWithBYOBReader(view: NonShared<ArrayBufferView>, forBranch2: boolean) {\n    if (IsReadableStreamDefaultReader<NonShared<Uint8Array>>(reader)) {\n      assert(reader._readRequests.length === 0);\n      ReadableStreamReaderGenericRelease(reader);\n\n      reader = AcquireReadableStreamBYOBReader(stream);\n      forwardReaderError(reader);\n    }\n\n    const byobBranch = forBranch2 ? branch2 : branch1;\n    const otherBranch = forBranch2 ? branch1 : branch2;\n\n    const readIntoRequest: ReadIntoRequest<NonShared<ArrayBufferView>> = {\n      _chunkSteps: chunk => {\n        // This needs to be delayed a microtask because it takes at least a microtask to detect errors (using\n        // reader._closedPromise below), and we want errors in stream to error both branches immediately. We cannot let\n        // successful synchronously-available reads get ahead of asynchronously-available errors.\n        queueMicrotask(() => {\n          readAgainForBranch1 = false;\n          readAgainForBranch2 = false;\n\n          const byobCanceled = forBranch2 ? canceled2 : canceled1;\n          const otherCanceled = forBranch2 ? canceled1 : canceled2;\n\n          if (!otherCanceled) {\n            let clonedChunk;\n            try {\n              clonedChunk = CloneAsUint8Array(chunk);\n            } catch (cloneE) {\n              ReadableByteStreamControllerError(byobBranch._readableStreamController, cloneE);\n              ReadableByteStreamControllerError(otherBranch._readableStreamController, cloneE);\n              resolveCancelPromise(ReadableStreamCancel(stream, cloneE));\n              return;\n            }\n            if (!byobCanceled) {\n              ReadableByteStreamControllerRespondWithNewView(byobBranch._readableStreamController, chunk);\n            }\n            ReadableByteStreamControllerEnqueue(otherBranch._readableStreamController, clonedChunk);\n          } else if (!byobCanceled) {\n            ReadableByteStreamControllerRespondWithNewView(byobBranch._readableStreamController, chunk);\n          }\n\n          reading = false;\n          if (readAgainForBranch1) {\n            pull1Algorithm();\n          } else if (readAgainForBranch2) {\n            pull2Algorithm();\n          }\n        });\n      },\n      _closeSteps: chunk => {\n        reading = false;\n\n        const byobCanceled = forBranch2 ? canceled2 : canceled1;\n        const otherCanceled = forBranch2 ? canceled1 : canceled2;\n\n        if (!byobCanceled) {\n          ReadableByteStreamControllerClose(byobBranch._readableStreamController);\n        }\n        if (!otherCanceled) {\n          ReadableByteStreamControllerClose(otherBranch._readableStreamController);\n        }\n\n        if (chunk !== undefined) {\n          assert(chunk.byteLength === 0);\n\n          if (!byobCanceled) {\n            ReadableByteStreamControllerRespondWithNewView(byobBranch._readableStreamController, chunk);\n          }\n          if (!otherCanceled && otherBranch._readableStreamController._pendingPullIntos.length > 0) {\n            ReadableByteStreamControllerRespond(otherBranch._readableStreamController, 0);\n          }\n        }\n\n        if (!byobCanceled || !otherCanceled) {\n          resolveCancelPromise(undefined);\n        }\n      },\n      _errorSteps: () => {\n        reading = false;\n      }\n    };\n    ReadableStreamBYOBReaderRead(reader, view, 1, readIntoRequest);\n  }\n\n  function pull1Algorithm(): Promise<void> {\n    if (reading) {\n      readAgainForBranch1 = true;\n      return promiseResolvedWith(undefined);\n    }\n\n    reading = true;\n\n    const byobRequest = ReadableByteStreamControllerGetBYOBRequest(branch1._readableStreamController);\n    if (byobRequest === null) {\n      pullWithDefaultReader();\n    } else {\n      pullWithBYOBReader(byobRequest._view!, false);\n    }\n\n    return promiseResolvedWith(undefined);\n  }\n\n  function pull2Algorithm(): Promise<void> {\n    if (reading) {\n      readAgainForBranch2 = true;\n      return promiseResolvedWith(undefined);\n    }\n\n    reading = true;\n\n    const byobRequest = ReadableByteStreamControllerGetBYOBRequest(branch2._readableStreamController);\n    if (byobRequest === null) {\n      pullWithDefaultReader();\n    } else {\n      pullWithBYOBReader(byobRequest._view!, true);\n    }\n\n    return promiseResolvedWith(undefined);\n  }\n\n  function cancel1Algorithm(reason: any): Promise<void> {\n    canceled1 = true;\n    reason1 = reason;\n    if (canceled2) {\n      const compositeReason = CreateArrayFromList([reason1, reason2]);\n      const cancelResult = ReadableStreamCancel(stream, compositeReason);\n      resolveCancelPromise(cancelResult);\n    }\n    return cancelPromise;\n  }\n\n  function cancel2Algorithm(reason: any): Promise<void> {\n    canceled2 = true;\n    reason2 = reason;\n    if (canceled1) {\n      const compositeReason = CreateArrayFromList([reason1, reason2]);\n      const cancelResult = ReadableStreamCancel(stream, compositeReason);\n      resolveCancelPromise(cancelResult);\n    }\n    return cancelPromise;\n  }\n\n  function startAlgorithm(): void {\n    return;\n  }\n\n  branch1 = CreateReadableByteStream(startAlgorithm, pull1Algorithm, cancel1Algorithm);\n  branch2 = CreateReadableByteStream(startAlgorithm, pull2Algorithm, cancel2Algorithm);\n\n  forwardReaderError(reader);\n\n  return [branch1, branch2];\n}\n", "import { typeIsObject } from '../helpers/miscellaneous';\nimport type { ReadableStreamDefaultReadResult } from './default-reader';\n\n/**\n * A common interface for a `ReadadableStream` implementation.\n *\n * @public\n */\nexport interface ReadableStreamLike<R = any> {\n  readonly locked: boolean;\n\n  getReader(): ReadableStreamDefaultReaderLike<R>;\n}\n\n/**\n * A common interface for a `ReadableStreamDefaultReader` implementation.\n *\n * @public\n */\nexport interface ReadableStreamDefaultReaderLike<R = any> {\n  readonly closed: Promise<undefined>;\n\n  cancel(reason?: any): Promise<void>;\n\n  read(): Promise<ReadableStreamDefaultReadResult<R>>;\n\n  releaseLock(): void;\n}\n\nexport function isReadableStreamLike<R>(stream: unknown): stream is ReadableStreamLike<R> {\n  return typeIsObject(stream) && typeof (stream as ReadableStreamLike<R>).getReader !== 'undefined';\n}\n", "import { CreateReadableStream, type DefaultReadableStream } from '../readable-stream';\nimport {\n  isReadableStreamLike,\n  type ReadableStreamDefaultReaderLike,\n  type ReadableStreamLike\n} from './readable-stream-like';\nimport { ReadableStreamDefaultControllerClose, ReadableStreamDefaultControllerEnqueue } from './default-controller';\nimport { GetIterator, GetMethod, IteratorComplete, IteratorNext, IteratorValue } from '../abstract-ops/ecmascript';\nimport { promiseRejectedWith, promiseResolvedWith, reflectCall, transformPromiseWith } from '../helpers/webidl';\nimport { typeIsObject } from '../helpers/miscellaneous';\nimport { noop } from '../../utils';\n\nexport function ReadableStreamFrom<R>(\n  source: Iterable<R> | AsyncIterable<R> | ReadableStreamLike<R>\n): DefaultReadableStream<R> {\n  if (isReadableStreamLike(source)) {\n    return ReadableStreamFromDefaultReader(source.getReader());\n  }\n  return ReadableStreamFromIterable(source);\n}\n\nexport function ReadableStreamFromIterable<R>(asyncIterable: Iterable<R> | AsyncIterable<R>): DefaultReadableStream<R> {\n  let stream: DefaultReadableStream<R>;\n  const iteratorRecord = GetIterator(asyncIterable, 'async');\n\n  const startAlgorithm = noop;\n\n  function pullAlgorithm(): Promise<void> {\n    let nextResult;\n    try {\n      nextResult = IteratorNext(iteratorRecord);\n    } catch (e) {\n      return promiseRejectedWith(e);\n    }\n    const nextPromise = promiseResolvedWith(nextResult);\n    return transformPromiseWith(nextPromise, iterResult => {\n      if (!typeIsObject(iterResult)) {\n        throw new TypeError('The promise returned by the iterator.next() method must fulfill with an object');\n      }\n      const done = IteratorComplete(iterResult);\n      if (done) {\n        ReadableStreamDefaultControllerClose(stream._readableStreamController);\n      } else {\n        const value = IteratorValue(iterResult);\n        ReadableStreamDefaultControllerEnqueue(stream._readableStreamController, value);\n      }\n    });\n  }\n\n  function cancelAlgorithm(reason: any): Promise<void> {\n    const iterator = iteratorRecord.iterator;\n    let returnMethod: (typeof iterator)['return'] | undefined;\n    try {\n      returnMethod = GetMethod(iterator, 'return');\n    } catch (e) {\n      return promiseRejectedWith(e);\n    }\n    if (returnMethod === undefined) {\n      return promiseResolvedWith(undefined);\n    }\n    let returnResult: IteratorResult<R> | Promise<IteratorResult<R>>;\n    try {\n      returnResult = reflectCall(returnMethod, iterator, [reason]);\n    } catch (e) {\n      return promiseRejectedWith(e);\n    }\n    const returnPromise = promiseResolvedWith(returnResult);\n    return transformPromiseWith(returnPromise, iterResult => {\n      if (!typeIsObject(iterResult)) {\n        throw new TypeError('The promise returned by the iterator.return() method must fulfill with an object');\n      }\n      return undefined;\n    });\n  }\n\n  stream = CreateReadableStream(startAlgorithm, pullAlgorithm, cancelAlgorithm, 0);\n  return stream;\n}\n\nexport function ReadableStreamFromDefaultReader<R>(\n  reader: ReadableStreamDefaultReaderLike<R>\n): DefaultReadableStream<R> {\n  let stream: DefaultReadableStream<R>;\n\n  const startAlgorithm = noop;\n\n  function pullAlgorithm(): Promise<void> {\n    let readPromise;\n    try {\n      readPromise = reader.read();\n    } catch (e) {\n      return promiseRejectedWith(e);\n    }\n    return transformPromiseWith(readPromise, readResult => {\n      if (!typeIsObject(readResult)) {\n        throw new TypeError('The promise returned by the reader.read() method must fulfill with an object');\n      }\n      if (readResult.done) {\n        ReadableStreamDefaultControllerClose(stream._readableStreamController);\n      } else {\n        const value = readResult.value;\n        ReadableStreamDefaultControllerEnqueue(stream._readableStreamController, value);\n      }\n    });\n  }\n\n  function cancelAlgorithm(reason: any): Promise<void> {\n    try {\n      return promiseResolvedWith(reader.cancel(reason));\n    } catch (e) {\n      return promiseRejectedWith(e);\n    }\n  }\n\n  stream = CreateReadableStream(startAlgorithm, pullAlgorithm, cancelAlgorithm, 0);\n  return stream;\n}\n", "import { assertDictionary, assertFunction, convertUnsignedLongLongWithEnforceRange } from './basic';\nimport type {\n  ReadableStreamController,\n  UnderlyingByteSource,\n  UnderlyingDefaultOrByteSource,\n  UnderlyingDefaultOrByteSourcePullCallback,\n  UnderlyingDefaultOrByteSourceStartCallback,\n  UnderlyingSource,\n  UnderlyingSourceCancelCallback,\n  ValidatedUnderlyingDefaultOrByteSource\n} from '../readable-stream/underlying-source';\nimport { promiseCall, reflectCall } from '../helpers/webidl';\n\nexport function convertUnderlyingDefaultOrByteSource<R>(\n  source: UnderlyingSource<R> | UnderlyingByteSource | null,\n  context: string\n): ValidatedUnderlyingDefaultOrByteSource<R> {\n  assertDictionary(source, context);\n  const original = source as (UnderlyingDefaultOrByteSource<R> | null);\n  const autoAllocateChunkSize = original?.autoAllocateChunkSize;\n  const cancel = original?.cancel;\n  const pull = original?.pull;\n  const start = original?.start;\n  const type = original?.type;\n  return {\n    autoAllocateChunkSize: autoAllocateChunkSize === undefined ?\n      undefined :\n      convertUnsignedLongLongWithEnforceRange(\n        autoAllocateChunkSize,\n        `${context} has member 'autoAllocateChunkSize' that`\n      ),\n    cancel: cancel === undefined ?\n      undefined :\n      convertUnderlyingSourceCancelCallback(cancel, original!, `${context} has member 'cancel' that`),\n    pull: pull === undefined ?\n      undefined :\n      convertUnderlyingSourcePullCallback(pull, original!, `${context} has member 'pull' that`),\n    start: start === undefined ?\n      undefined :\n      convertUnderlyingSourceStartCallback(start, original!, `${context} has member 'start' that`),\n    type: type === undefined ? undefined : convertReadableStreamType(type, `${context} has member 'type' that`)\n  };\n}\n\nfunction convertUnderlyingSourceCancelCallback(\n  fn: UnderlyingSourceCancelCallback,\n  original: UnderlyingDefaultOrByteSource,\n  context: string\n): (reason: any) => Promise<void> {\n  assertFunction(fn, context);\n  return (reason: any) => promiseCall(fn, original, [reason]);\n}\n\nfunction convertUnderlyingSourcePullCallback<R>(\n  fn: UnderlyingDefaultOrByteSourcePullCallback<R>,\n  original: UnderlyingDefaultOrByteSource<R>,\n  context: string\n): (controller: ReadableStreamController<R>) => Promise<void> {\n  assertFunction(fn, context);\n  return (controller: ReadableStreamController<R>) => promiseCall(fn, original, [controller]);\n}\n\nfunction convertUnderlyingSourceStartCallback<R>(\n  fn: UnderlyingDefaultOrByteSourceStartCallback<R>,\n  original: UnderlyingDefaultOrByteSource<R>,\n  context: string\n): UnderlyingDefaultOrByteSourceStartCallback<R> {\n  assertFunction(fn, context);\n  return (controller: ReadableStreamController<R>) => reflectCall(fn, original, [controller]);\n}\n\nfunction convertReadableStreamType(type: string, context: string): 'bytes' {\n  type = `${type}`;\n  if (type !== 'bytes') {\n    throw new TypeError(`${context} '${type}' is not a valid enumeration value for ReadableStreamType`);\n  }\n  return type;\n}\n", "import { assertDictionary } from './basic';\nimport type {\n  ReadableStreamIteratorOptions,\n  ValidatedReadableStreamIteratorOptions\n} from '../readable-stream/iterator-options';\n\nexport function convertIteratorOptions(options: ReadableStreamIteratorOptions | null | undefined,\n                                       context: string): ValidatedReadableStreamIteratorOptions {\n  assertDictionary(options, context);\n  const preventCancel = options?.preventCancel;\n  return { preventCancel: Boolean(preventCancel) };\n}\n", "import { assertDictionary } from './basic';\nimport type { StreamPipeOptions, ValidatedStreamPipeOptions } from '../readable-stream/pipe-options';\nimport { type AbortSignal, isAbortSignal } from '../abort-signal';\n\nexport function convertPipeOptions(options: StreamPipeOptions | null | undefined,\n                                   context: string): ValidatedStreamPipeOptions {\n  assertDictionary(options, context);\n  const preventAbort = options?.preventAbort;\n  const preventCancel = options?.preventCancel;\n  const preventClose = options?.preventClose;\n  const signal = options?.signal;\n  if (signal !== undefined) {\n    assertAbortSignal(signal, `${context} has member 'signal' that`);\n  }\n  return {\n    preventAbort: Boolean(preventAbort),\n    preventCancel: Boolean(preventCancel),\n    preventClose: Boolean(preventClose),\n    signal\n  };\n}\n\nfunction assertAbortSignal(signal: unknown, context: string): asserts signal is AbortSignal {\n  if (!isAbortSignal(signal)) {\n    throw new TypeError(`${context} is not an AbortSignal.`);\n  }\n}\n", "import { assertDictionary, assertRequiredField } from './basic';\nimport { ReadableStream } from '../readable-stream';\nimport { WritableStream } from '../writable-stream';\nimport { assertReadableStream } from './readable-stream';\nimport { assertWritableStream } from './writable-stream';\n\nexport function convertReadableWritablePair<RS extends ReadableStream, WS extends WritableStream>(\n  pair: { readable: RS; writable: WS } | null | undefined,\n  context: string\n): { readable: RS; writable: WS } {\n  assertDictionary(pair, context);\n\n  const readable = pair?.readable;\n  assertRequiredField(readable, 'readable', 'ReadableWritablePair');\n  assertReadableStream(readable, `${context} has member 'readable' that`);\n\n  const writable = pair?.writable;\n  assertRequiredField(writable, 'writable', 'ReadableWritablePair');\n  assertWritableStream(writable, `${context} has member 'writable' that`);\n\n  return { readable, writable };\n}\n", "import assert from '../stub/assert';\nimport {\n  promiseRejectedWith,\n  promiseResolvedWith,\n  setPromiseIsHandledToTrue,\n  transformPromiseWith\n} from './helpers/webidl';\nimport type { QueuingStrategy, QueuingStrategySizeCallback } from './queuing-strategy';\nimport { AcquireReadableStreamAsyncIterator, type ReadableStreamAsyncIterator } from './readable-stream/async-iterator';\nimport { defaultReaderClosedPromiseReject, defaultReaderClosedPromiseResolve } from './readable-stream/generic-reader';\nimport {\n  AcquireReadableStreamDefaultReader,\n  IsReadableStreamDefaultReader,\n  ReadableStreamDefaultReader,\n  ReadableStreamDefaultReaderErrorReadRequests,\n  type ReadableStreamDefaultReadResult\n} from './readable-stream/default-reader';\nimport {\n  AcquireReadableStreamBYOBReader,\n  IsReadableStreamBYOBReader,\n  ReadableStreamBYOBReader,\n  ReadableStreamBYOBReaderErrorReadIntoRequests,\n  type ReadableStreamBYOBReadResult\n} from './readable-stream/byob-reader';\nimport { ReadableStreamPipeTo } from './readable-stream/pipe';\nimport { ReadableStreamTee } from './readable-stream/tee';\nimport { ReadableStreamFrom } from './readable-stream/from';\nimport { IsWritableStream, IsWritableStreamLocked, WritableStream } from './writable-stream';\nimport { SimpleQueue } from './simple-queue';\nimport {\n  ReadableByteStreamController,\n  ReadableStreamBYOBRequest,\n  SetUpReadableByteStreamController,\n  SetUpReadableByteStreamControllerFromUnderlyingSource\n} from './readable-stream/byte-stream-controller';\nimport {\n  ReadableStreamDefaultController,\n  SetUpReadableStreamDefaultController,\n  SetUpReadableStreamDefaultControllerFromUnderlyingSource\n} from './readable-stream/default-controller';\nimport type {\n  UnderlyingByteSource,\n  UnderlyingByteSourcePullCallback,\n  UnderlyingByteSourceStartCallback,\n  UnderlyingSource,\n  UnderlyingSourceCancelCallback,\n  UnderlyingSourcePullCallback,\n  UnderlyingSourceStartCallback\n} from './readable-stream/underlying-source';\nimport { noop } from '../utils';\nimport { setFunctionName, typeIsObject } from './helpers/miscellaneous';\nimport { CreateArrayFromList, SymbolAsyncIterator } from './abstract-ops/ecmascript';\nimport { CancelSteps } from './abstract-ops/internal-methods';\nimport { IsNonNegativeNumber } from './abstract-ops/miscellaneous';\nimport { assertObject, assertRequiredArgument } from './validators/basic';\nimport { convertQueuingStrategy } from './validators/queuing-strategy';\nimport { ExtractHighWaterMark, ExtractSizeAlgorithm } from './abstract-ops/queuing-strategy';\nimport { convertUnderlyingDefaultOrByteSource } from './validators/underlying-source';\nimport type {\n  ReadableStreamBYOBReaderReadOptions,\n  ReadableStreamGetReaderOptions\n} from './readable-stream/reader-options';\nimport { convertReaderOptions } from './validators/reader-options';\nimport type { StreamPipeOptions, ValidatedStreamPipeOptions } from './readable-stream/pipe-options';\nimport type { ReadableStreamIteratorOptions } from './readable-stream/iterator-options';\nimport { convertIteratorOptions } from './validators/iterator-options';\nimport { convertPipeOptions } from './validators/pipe-options';\nimport type { ReadableWritablePair } from './readable-stream/readable-writable-pair';\nimport { convertReadableWritablePair } from './validators/readable-writable-pair';\nimport type { ReadableStreamDefaultReaderLike, ReadableStreamLike } from './readable-stream/readable-stream-like';\nimport type { NonShared } from './helpers/array-buffer-view';\n\nexport type DefaultReadableStream<R = any> = ReadableStream<R> & {\n  _readableStreamController: ReadableStreamDefaultController<R>\n};\n\nexport type ReadableByteStream = ReadableStream<NonShared<Uint8Array>> & {\n  _readableStreamController: ReadableByteStreamController\n};\n\ntype ReadableStreamState = 'readable' | 'closed' | 'errored';\n\n/**\n * A readable stream represents a source of data, from which you can read.\n *\n * @public\n */\nexport class ReadableStream<R = any> implements AsyncIterable<R> {\n  /** @internal */\n  _state!: ReadableStreamState;\n  /** @internal */\n  _reader: ReadableStreamReader<R> | undefined;\n  /** @internal */\n  _storedError: any;\n  /** @internal */\n  _disturbed!: boolean;\n  /** @internal */\n  _readableStreamController!: ReadableStreamDefaultController<R> | ReadableByteStreamController;\n\n  constructor(underlyingSource: UnderlyingByteSource, strategy?: { highWaterMark?: number; size?: undefined });\n  constructor(underlyingSource?: UnderlyingSource<R>, strategy?: QueuingStrategy<R>);\n  constructor(rawUnderlyingSource: UnderlyingSource<R> | UnderlyingByteSource | null | undefined = {},\n              rawStrategy: QueuingStrategy<R> | null | undefined = {}) {\n    if (rawUnderlyingSource === undefined) {\n      rawUnderlyingSource = null;\n    } else {\n      assertObject(rawUnderlyingSource, 'First parameter');\n    }\n\n    const strategy = convertQueuingStrategy(rawStrategy, 'Second parameter');\n    const underlyingSource = convertUnderlyingDefaultOrByteSource(rawUnderlyingSource, 'First parameter');\n\n    InitializeReadableStream(this);\n\n    if (underlyingSource.type === 'bytes') {\n      if (strategy.size !== undefined) {\n        throw new RangeError('The strategy for a byte stream cannot have a size function');\n      }\n      const highWaterMark = ExtractHighWaterMark(strategy, 0);\n      SetUpReadableByteStreamControllerFromUnderlyingSource(\n        this as unknown as ReadableByteStream,\n        underlyingSource,\n        highWaterMark\n      );\n    } else {\n      assert(underlyingSource.type === undefined);\n      const sizeAlgorithm = ExtractSizeAlgorithm(strategy);\n      const highWaterMark = ExtractHighWaterMark(strategy, 1);\n      SetUpReadableStreamDefaultControllerFromUnderlyingSource(\n        this,\n        underlyingSource,\n        highWaterMark,\n        sizeAlgorithm\n      );\n    }\n  }\n\n  /**\n   * Whether or not the readable stream is locked to a {@link ReadableStreamDefaultReader | reader}.\n   */\n  get locked(): boolean {\n    if (!IsReadableStream(this)) {\n      throw streamBrandCheckException('locked');\n    }\n\n    return IsReadableStreamLocked(this);\n  }\n\n  /**\n   * Cancels the stream, signaling a loss of interest in the stream by a consumer.\n   *\n   * The supplied `reason` argument will be given to the underlying source's {@link UnderlyingSource.cancel | cancel()}\n   * method, which might or might not use it.\n   */\n  cancel(reason: any = undefined): Promise<void> {\n    if (!IsReadableStream(this)) {\n      return promiseRejectedWith(streamBrandCheckException('cancel'));\n    }\n\n    if (IsReadableStreamLocked(this)) {\n      return promiseRejectedWith(new TypeError('Cannot cancel a stream that already has a reader'));\n    }\n\n    return ReadableStreamCancel(this, reason);\n  }\n\n  /**\n   * Creates a {@link ReadableStreamBYOBReader} and locks the stream to the new reader.\n   *\n   * This call behaves the same way as the no-argument variant, except that it only works on readable byte streams,\n   * i.e. streams which were constructed specifically with the ability to handle \"bring your own buffer\" reading.\n   * The returned BYOB reader provides the ability to directly read individual chunks from the stream via its\n   * {@link ReadableStreamBYOBReader.read | read()} method, into developer-supplied buffers, allowing more precise\n   * control over allocation.\n   */\n  getReader({ mode }: { mode: 'byob' }): ReadableStreamBYOBReader;\n  /**\n   * Creates a {@link ReadableStreamDefaultReader} and locks the stream to the new reader.\n   * While the stream is locked, no other reader can be acquired until this one is released.\n   *\n   * This functionality is especially useful for creating abstractions that desire the ability to consume a stream\n   * in its entirety. By getting a reader for the stream, you can ensure nobody else can interleave reads with yours\n   * or cancel the stream, which would interfere with your abstraction.\n   */\n  getReader(): ReadableStreamDefaultReader<R>;\n  getReader(\n    rawOptions: ReadableStreamGetReaderOptions | null | undefined = undefined\n  ): ReadableStreamDefaultReader<R> | ReadableStreamBYOBReader {\n    if (!IsReadableStream(this)) {\n      throw streamBrandCheckException('getReader');\n    }\n\n    const options = convertReaderOptions(rawOptions, 'First parameter');\n\n    if (options.mode === undefined) {\n      return AcquireReadableStreamDefaultReader(this);\n    }\n\n    assert(options.mode === 'byob');\n    return AcquireReadableStreamBYOBReader(this as unknown as ReadableByteStream);\n  }\n\n  /**\n   * Provides a convenient, chainable way of piping this readable stream through a transform stream\n   * (or any other `{ writable, readable }` pair). It simply {@link ReadableStream.pipeTo | pipes} the stream\n   * into the writable side of the supplied pair, and returns the readable side for further use.\n   *\n   * Piping a stream will lock it for the duration of the pipe, preventing any other consumer from acquiring a reader.\n   */\n  pipeThrough<RS extends ReadableStream>(\n    transform: { readable: RS; writable: WritableStream<R> },\n    options?: StreamPipeOptions\n  ): RS;\n  pipeThrough<RS extends ReadableStream>(\n    rawTransform: { readable: RS; writable: WritableStream<R> } | null | undefined,\n    rawOptions: StreamPipeOptions | null | undefined = {}\n  ): RS {\n    if (!IsReadableStream(this)) {\n      throw streamBrandCheckException('pipeThrough');\n    }\n    assertRequiredArgument(rawTransform, 1, 'pipeThrough');\n\n    const transform = convertReadableWritablePair(rawTransform, 'First parameter');\n    const options = convertPipeOptions(rawOptions, 'Second parameter');\n\n    if (IsReadableStreamLocked(this)) {\n      throw new TypeError('ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream');\n    }\n    if (IsWritableStreamLocked(transform.writable)) {\n      throw new TypeError('ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream');\n    }\n\n    const promise = ReadableStreamPipeTo(\n      this, transform.writable, options.preventClose, options.preventAbort, options.preventCancel, options.signal\n    );\n\n    setPromiseIsHandledToTrue(promise);\n\n    return transform.readable;\n  }\n\n  /**\n   * Pipes this readable stream to a given writable stream. The way in which the piping process behaves under\n   * various error conditions can be customized with a number of passed options. It returns a promise that fulfills\n   * when the piping process completes successfully, or rejects if any errors were encountered.\n   *\n   * Piping a stream will lock it for the duration of the pipe, preventing any other consumer from acquiring a reader.\n   */\n  pipeTo(destination: WritableStream<R>, options?: StreamPipeOptions): Promise<void>;\n  pipeTo(destination: WritableStream<R> | null | undefined,\n         rawOptions: StreamPipeOptions | null | undefined = {}): Promise<void> {\n    if (!IsReadableStream(this)) {\n      return promiseRejectedWith(streamBrandCheckException('pipeTo'));\n    }\n\n    if (destination === undefined) {\n      return promiseRejectedWith(`Parameter 1 is required in 'pipeTo'.`);\n    }\n    if (!IsWritableStream(destination)) {\n      return promiseRejectedWith(\n        new TypeError(`ReadableStream.prototype.pipeTo's first argument must be a WritableStream`)\n      );\n    }\n\n    let options: ValidatedStreamPipeOptions;\n    try {\n      options = convertPipeOptions(rawOptions, 'Second parameter');\n    } catch (e) {\n      return promiseRejectedWith(e);\n    }\n\n    if (IsReadableStreamLocked(this)) {\n      return promiseRejectedWith(\n        new TypeError('ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream')\n      );\n    }\n    if (IsWritableStreamLocked(destination)) {\n      return promiseRejectedWith(\n        new TypeError('ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream')\n      );\n    }\n\n    return ReadableStreamPipeTo<R>(\n      this, destination, options.preventClose, options.preventAbort, options.preventCancel, options.signal\n    );\n  }\n\n  /**\n   * Tees this readable stream, returning a two-element array containing the two resulting branches as\n   * new {@link ReadableStream} instances.\n   *\n   * Teeing a stream will lock it, preventing any other consumer from acquiring a reader.\n   * To cancel the stream, cancel both of the resulting branches; a composite cancellation reason will then be\n   * propagated to the stream's underlying source.\n   *\n   * Note that the chunks seen in each branch will be the same object. If the chunks are not immutable,\n   * this could allow interference between the two branches.\n   */\n  tee(): [ReadableStream<R>, ReadableStream<R>] {\n    if (!IsReadableStream(this)) {\n      throw streamBrandCheckException('tee');\n    }\n\n    const branches = ReadableStreamTee(this, false);\n    return CreateArrayFromList(branches);\n  }\n\n  /**\n   * Asynchronously iterates over the chunks in the stream's internal queue.\n   *\n   * Asynchronously iterating over the stream will lock it, preventing any other consumer from acquiring a reader.\n   * The lock will be released if the async iterator's {@link ReadableStreamAsyncIterator.return | return()} method\n   * is called, e.g. by breaking out of the loop.\n   *\n   * By default, calling the async iterator's {@link ReadableStreamAsyncIterator.return | return()} method will also\n   * cancel the stream. To prevent this, use the stream's {@link ReadableStream.values | values()} method, passing\n   * `true` for the `preventCancel` option.\n   */\n  values(options?: ReadableStreamIteratorOptions): ReadableStreamAsyncIterator<R>;\n  values(rawOptions: ReadableStreamIteratorOptions | null | undefined = undefined): ReadableStreamAsyncIterator<R> {\n    if (!IsReadableStream(this)) {\n      throw streamBrandCheckException('values');\n    }\n\n    const options = convertIteratorOptions(rawOptions, 'First parameter');\n    return AcquireReadableStreamAsyncIterator<R>(this, options.preventCancel);\n  }\n\n  /**\n   * {@inheritDoc ReadableStream.values}\n   */\n  [Symbol.asyncIterator](options?: ReadableStreamIteratorOptions): ReadableStreamAsyncIterator<R>;\n\n  [SymbolAsyncIterator](options?: ReadableStreamIteratorOptions): ReadableStreamAsyncIterator<R> {\n    // Stub implementation, overridden below\n    return this.values(options);\n  }\n\n  /**\n   * Creates a new ReadableStream wrapping the provided iterable or async iterable.\n   *\n   * This can be used to adapt various kinds of objects into a readable stream,\n   * such as an array, an async generator, or a Node.js readable stream.\n   */\n  static from<R>(asyncIterable: Iterable<R> | AsyncIterable<R> | ReadableStreamLike<R>): ReadableStream<R> {\n    return ReadableStreamFrom(asyncIterable);\n  }\n}\n\nObject.defineProperties(ReadableStream, {\n  from: { enumerable: true }\n});\nObject.defineProperties(ReadableStream.prototype, {\n  cancel: { enumerable: true },\n  getReader: { enumerable: true },\n  pipeThrough: { enumerable: true },\n  pipeTo: { enumerable: true },\n  tee: { enumerable: true },\n  values: { enumerable: true },\n  locked: { enumerable: true }\n});\nsetFunctionName(ReadableStream.from, 'from');\nsetFunctionName(ReadableStream.prototype.cancel, 'cancel');\nsetFunctionName(ReadableStream.prototype.getReader, 'getReader');\nsetFunctionName(ReadableStream.prototype.pipeThrough, 'pipeThrough');\nsetFunctionName(ReadableStream.prototype.pipeTo, 'pipeTo');\nsetFunctionName(ReadableStream.prototype.tee, 'tee');\nsetFunctionName(ReadableStream.prototype.values, 'values');\nif (typeof Symbol.toStringTag === 'symbol') {\n  Object.defineProperty(ReadableStream.prototype, Symbol.toStringTag, {\n    value: 'ReadableStream',\n    configurable: true\n  });\n}\nObject.defineProperty(ReadableStream.prototype, SymbolAsyncIterator, {\n  value: ReadableStream.prototype.values,\n  writable: true,\n  configurable: true\n});\n\nexport type {\n  ReadableStreamAsyncIterator,\n  ReadableStreamDefaultReadResult,\n  ReadableStreamBYOBReadResult,\n  ReadableStreamBYOBReaderReadOptions,\n  UnderlyingByteSource,\n  UnderlyingSource,\n  UnderlyingSourceStartCallback,\n  UnderlyingSourcePullCallback,\n  UnderlyingSourceCancelCallback,\n  UnderlyingByteSourceStartCallback,\n  UnderlyingByteSourcePullCallback,\n  StreamPipeOptions,\n  ReadableWritablePair,\n  ReadableStreamIteratorOptions,\n  ReadableStreamLike,\n  ReadableStreamDefaultReaderLike\n};\n\n// Abstract operations for the ReadableStream.\n\n// Throws if and only if startAlgorithm throws.\nexport function CreateReadableStream<R>(\n  startAlgorithm: () => void | PromiseLike<void>,\n  pullAlgorithm: () => Promise<void>,\n  cancelAlgorithm: (reason: any) => Promise<void>,\n  highWaterMark = 1,\n  sizeAlgorithm: QueuingStrategySizeCallback<R> = () => 1\n): DefaultReadableStream<R> {\n  assert(IsNonNegativeNumber(highWaterMark));\n\n  const stream: DefaultReadableStream<R> = Object.create(ReadableStream.prototype);\n  InitializeReadableStream(stream);\n\n  const controller: ReadableStreamDefaultController<R> = Object.create(ReadableStreamDefaultController.prototype);\n  SetUpReadableStreamDefaultController(\n    stream, controller, startAlgorithm, pullAlgorithm, cancelAlgorithm, highWaterMark, sizeAlgorithm\n  );\n\n  return stream;\n}\n\n// Throws if and only if startAlgorithm throws.\nexport function CreateReadableByteStream(\n  startAlgorithm: () => void | PromiseLike<void>,\n  pullAlgorithm: () => Promise<void>,\n  cancelAlgorithm: (reason: any) => Promise<void>\n): ReadableByteStream {\n  const stream: ReadableByteStream = Object.create(ReadableStream.prototype);\n  InitializeReadableStream(stream);\n\n  const controller: ReadableByteStreamController = Object.create(ReadableByteStreamController.prototype);\n  SetUpReadableByteStreamController(stream, controller, startAlgorithm, pullAlgorithm, cancelAlgorithm, 0, undefined);\n\n  return stream;\n}\n\nfunction InitializeReadableStream(stream: ReadableStream) {\n  stream._state = 'readable';\n  stream._reader = undefined;\n  stream._storedError = undefined;\n  stream._disturbed = false;\n}\n\nexport function IsReadableStream(x: unknown): x is ReadableStream {\n  if (!typeIsObject(x)) {\n    return false;\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(x, '_readableStreamController')) {\n    return false;\n  }\n\n  return x instanceof ReadableStream;\n}\n\nexport function IsReadableStreamDisturbed(stream: ReadableStream): boolean {\n  assert(IsReadableStream(stream));\n\n  return stream._disturbed;\n}\n\nexport function IsReadableStreamLocked(stream: ReadableStream): boolean {\n  assert(IsReadableStream(stream));\n\n  if (stream._reader === undefined) {\n    return false;\n  }\n\n  return true;\n}\n\n// ReadableStream API exposed for controllers.\n\nexport function ReadableStreamCancel<R>(stream: ReadableStream<R>, reason: any): Promise<undefined> {\n  stream._disturbed = true;\n\n  if (stream._state === 'closed') {\n    return promiseResolvedWith(undefined);\n  }\n  if (stream._state === 'errored') {\n    return promiseRejectedWith(stream._storedError);\n  }\n\n  ReadableStreamClose(stream);\n\n  const reader = stream._reader;\n  if (reader !== undefined && IsReadableStreamBYOBReader(reader)) {\n    const readIntoRequests = reader._readIntoRequests;\n    reader._readIntoRequests = new SimpleQueue();\n    readIntoRequests.forEach(readIntoRequest => {\n      readIntoRequest._closeSteps(undefined);\n    });\n  }\n\n  const sourceCancelPromise = stream._readableStreamController[CancelSteps](reason);\n  return transformPromiseWith(sourceCancelPromise, noop);\n}\n\nexport function ReadableStreamClose<R>(stream: ReadableStream<R>): void {\n  assert(stream._state === 'readable');\n\n  stream._state = 'closed';\n\n  const reader = stream._reader;\n\n  if (reader === undefined) {\n    return;\n  }\n\n  defaultReaderClosedPromiseResolve(reader);\n\n  if (IsReadableStreamDefaultReader<R>(reader)) {\n    const readRequests = reader._readRequests;\n    reader._readRequests = new SimpleQueue();\n    readRequests.forEach(readRequest => {\n      readRequest._closeSteps();\n    });\n  }\n}\n\nexport function ReadableStreamError<R>(stream: ReadableStream<R>, e: any): void {\n  assert(IsReadableStream(stream));\n  assert(stream._state === 'readable');\n\n  stream._state = 'errored';\n  stream._storedError = e;\n\n  const reader = stream._reader;\n\n  if (reader === undefined) {\n    return;\n  }\n\n  defaultReaderClosedPromiseReject(reader, e);\n\n  if (IsReadableStreamDefaultReader<R>(reader)) {\n    ReadableStreamDefaultReaderErrorReadRequests(reader, e);\n  } else {\n    assert(IsReadableStreamBYOBReader(reader));\n    ReadableStreamBYOBReaderErrorReadIntoRequests(reader, e);\n  }\n}\n\n// Readers\n\nexport type ReadableStreamReader<R> = ReadableStreamDefaultReader<R> | ReadableStreamBYOBReader;\n\nexport {\n  ReadableStreamDefaultReader,\n  ReadableStreamBYOBReader\n};\n\n// Controllers\n\nexport {\n  ReadableStreamDefaultController,\n  ReadableStreamBYOBRequest,\n  ReadableByteStreamController\n};\n\n// Helper functions for the ReadableStream.\n\nfunction streamBrandCheckException(name: string): TypeError {\n  return new TypeError(`ReadableStream.prototype.${name} can only be used on a ReadableStream`);\n}\n", "import type { QueuingStrategyInit } from '../queuing-strategy';\nimport { assertDictionary, assertRequiredField, convertUnrestrictedDouble } from './basic';\n\nexport function convertQueuingStrategyInit(init: QueuingStrategyInit | null | undefined,\n                                           context: string): QueuingStrategyInit {\n  assertDictionary(init, context);\n  const highWaterMark = init?.highWaterMark;\n  assertRequiredField(highWaterMark, 'highWaterMark', 'QueuingStrategyInit');\n  return {\n    highWaterMark: convertUnrestrictedDouble(highWaterMark)\n  };\n}\n", "import type { QueuingStrategy, QueuingStrategyInit } from './queuing-strategy';\nimport { setFunctionName, typeIsObject } from './helpers/miscellaneous';\nimport { assertRequiredArgument } from './validators/basic';\nimport { convertQueuingStrategyInit } from './validators/queuing-strategy-init';\n\n// The size function must not have a prototype property nor be a constructor\nconst byteLengthSizeFunction = (chunk: ArrayBufferView): number => {\n  return chunk.byteLength;\n};\nsetFunctionName(byteLengthSizeFunction, 'size');\n\n/**\n * A queuing strategy that counts the number of bytes in each chunk.\n *\n * @public\n */\nexport default class ByteLengthQueuingStrategy implements QueuingStrategy<ArrayBufferView> {\n  /** @internal */\n  readonly _byteLengthQueuingStrategyHighWaterMark: number;\n\n  constructor(options: QueuingStrategyInit) {\n    assertRequiredArgument(options, 1, 'ByteLengthQueuingStrategy');\n    options = convertQueuingStrategyInit(options, 'First parameter');\n    this._byteLengthQueuingStrategyHighWaterMark = options.highWaterMark;\n  }\n\n  /**\n   * Returns the high water mark provided to the constructor.\n   */\n  get highWaterMark(): number {\n    if (!IsByteLengthQueuingStrategy(this)) {\n      throw byteLengthBrandCheckException('highWaterMark');\n    }\n    return this._byteLengthQueuingStrategyHighWaterMark;\n  }\n\n  /**\n   * Measures the size of `chunk` by returning the value of its `byteLength` property.\n   */\n  get size(): (chunk: ArrayBufferView) => number {\n    if (!IsByteLengthQueuingStrategy(this)) {\n      throw byteLengthBrandCheckException('size');\n    }\n    return byteLengthSizeFunction;\n  }\n}\n\nObject.defineProperties(ByteLengthQueuingStrategy.prototype, {\n  highWaterMark: { enumerable: true },\n  size: { enumerable: true }\n});\nif (typeof Symbol.toStringTag === 'symbol') {\n  Object.defineProperty(ByteLengthQueuingStrategy.prototype, Symbol.toStringTag, {\n    value: 'ByteLengthQueuingStrategy',\n    configurable: true\n  });\n}\n\n// Helper functions for the ByteLengthQueuingStrategy.\n\nfunction byteLengthBrandCheckException(name: string): TypeError {\n  return new TypeError(`ByteLengthQueuingStrategy.prototype.${name} can only be used on a ByteLengthQueuingStrategy`);\n}\n\nexport function IsByteLengthQueuingStrategy(x: any): x is ByteLengthQueuingStrategy {\n  if (!typeIsObject(x)) {\n    return false;\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(x, '_byteLengthQueuingStrategyHighWaterMark')) {\n    return false;\n  }\n\n  return x instanceof ByteLengthQueuingStrategy;\n}\n", "import type { QueuingStrategy, QueuingStrategyInit } from './queuing-strategy';\nimport { setFunctionName, typeIsObject } from './helpers/miscellaneous';\nimport { assertRequiredArgument } from './validators/basic';\nimport { convertQueuingStrategyInit } from './validators/queuing-strategy-init';\n\n// The size function must not have a prototype property nor be a constructor\nconst countSizeFunction = (): 1 => {\n  return 1;\n};\nsetFunctionName(countSizeFunction, 'size');\n\n/**\n * A queuing strategy that counts the number of chunks.\n *\n * @public\n */\nexport default class CountQueuingStrategy implements QueuingStrategy<any> {\n  /** @internal */\n  readonly _countQueuingStrategyHighWaterMark!: number;\n\n  constructor(options: QueuingStrategyInit) {\n    assertRequiredArgument(options, 1, 'CountQueuingStrategy');\n    options = convertQueuingStrategyInit(options, 'First parameter');\n    this._countQueuingStrategyHighWaterMark = options.highWaterMark;\n  }\n\n  /**\n   * Returns the high water mark provided to the constructor.\n   */\n  get highWaterMark(): number {\n    if (!IsCountQueuingStrategy(this)) {\n      throw countBrandCheckException('highWaterMark');\n    }\n    return this._countQueuingStrategyHighWaterMark;\n  }\n\n  /**\n   * Measures the size of `chunk` by always returning 1.\n   * This ensures that the total queue size is a count of the number of chunks in the queue.\n   */\n  get size(): (chunk: any) => 1 {\n    if (!IsCountQueuingStrategy(this)) {\n      throw countBrandCheckException('size');\n    }\n    return countSizeFunction;\n  }\n}\n\nObject.defineProperties(CountQueuingStrategy.prototype, {\n  highWaterMark: { enumerable: true },\n  size: { enumerable: true }\n});\nif (typeof Symbol.toStringTag === 'symbol') {\n  Object.defineProperty(CountQueuingStrategy.prototype, Symbol.toStringTag, {\n    value: 'CountQueuingStrategy',\n    configurable: true\n  });\n}\n\n// Helper functions for the CountQueuingStrategy.\n\nfunction countBrandCheckException(name: string): TypeError {\n  return new TypeError(`CountQueuingStrategy.prototype.${name} can only be used on a CountQueuingStrategy`);\n}\n\nexport function IsCountQueuingStrategy(x: any): x is CountQueuingStrategy {\n  if (!typeIsObject(x)) {\n    return false;\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(x, '_countQueuingStrategyHighWaterMark')) {\n    return false;\n  }\n\n  return x instanceof CountQueuingStrategy;\n}\n", "import { assertDictionary, assertFunction } from './basic';\nimport { promiseCall, reflectCall } from '../helpers/webidl';\nimport type {\n  Transformer,\n  TransformerCancelCallback,\n  TransformerFlushCallback,\n  TransformerStartCallback,\n  TransformerTransformCallback,\n  ValidatedTransformer\n} from '../transform-stream/transformer';\nimport { TransformStreamDefaultController } from '../transform-stream';\n\nexport function convertTransformer<I, O>(original: Transformer<I, O> | null,\n                                         context: string): ValidatedTransformer<I, O> {\n  assertDictionary(original, context);\n  const cancel = original?.cancel;\n  const flush = original?.flush;\n  const readableType = original?.readableType;\n  const start = original?.start;\n  const transform = original?.transform;\n  const writableType = original?.writableType;\n  return {\n    cancel: cancel === undefined ?\n      undefined :\n      convertTransformerCancelCallback(cancel, original!, `${context} has member 'cancel' that`),\n    flush: flush === undefined ?\n      undefined :\n      convertTransformerFlushCallback(flush, original!, `${context} has member 'flush' that`),\n    readableType,\n    start: start === undefined ?\n      undefined :\n      convertTransformerStartCallback(start, original!, `${context} has member 'start' that`),\n    transform: transform === undefined ?\n      undefined :\n      convertTransformerTransformCallback(transform, original!, `${context} has member 'transform' that`),\n    writableType\n  };\n}\n\nfunction convertTransformerFlushCallback<I, O>(\n  fn: TransformerFlushCallback<O>,\n  original: Transformer<I, O>,\n  context: string\n): (controller: TransformStreamDefaultController<O>) => Promise<void> {\n  assertFunction(fn, context);\n  return (controller: TransformStreamDefaultController<O>) => promiseCall(fn, original, [controller]);\n}\n\nfunction convertTransformerStartCallback<I, O>(\n  fn: TransformerStartCallback<O>,\n  original: Transformer<I, O>,\n  context: string\n): TransformerStartCallback<O> {\n  assertFunction(fn, context);\n  return (controller: TransformStreamDefaultController<O>) => reflectCall(fn, original, [controller]);\n}\n\nfunction convertTransformerTransformCallback<I, O>(\n  fn: TransformerTransformCallback<I, O>,\n  original: Transformer<I, O>,\n  context: string\n): (chunk: I, controller: TransformStreamDefaultController<O>) => Promise<void> {\n  assertFunction(fn, context);\n  return (chunk: I, controller: TransformStreamDefaultController<O>) => promiseCall(fn, original, [chunk, controller]);\n}\n\nfunction convertTransformerCancelCallback<I, O>(\n  fn: TransformerCancelCallback,\n  original: Transformer<I, O>,\n  context: string\n): (reason: any) => Promise<void> {\n  assertFunction(fn, context);\n  return (reason: any) => promiseCall(fn, original, [reason]);\n}\n", "import assert from '../stub/assert';\nimport {\n  newPromise,\n  promiseRejectedWith,\n  promiseResolvedWith,\n  setPromiseIsHandledToTrue,\n  transformPromiseWith,\n  uponPromise\n} from './helpers/webidl';\nimport { CreateReadableStream, type DefaultReadableStream, ReadableStream } from './readable-stream';\nimport {\n  ReadableStreamDefaultControllerCanCloseOrEnqueue,\n  ReadableStreamDefaultControllerClose,\n  ReadableStreamDefaultControllerEnqueue,\n  ReadableStreamDefaultControllerError,\n  ReadableStreamDefaultControllerGetDesiredSize,\n  ReadableStreamDefaultControllerHasBackpressure\n} from './readable-stream/default-controller';\nimport type { QueuingStrategy, QueuingStrategySizeCallback } from './queuing-strategy';\nimport { CreateWritableStream, WritableStream, WritableStreamDefaultControllerErrorIfNeeded } from './writable-stream';\nimport { setFunctionName, typeIsObject } from './helpers/miscellaneous';\nimport { IsNonNegativeNumber } from './abstract-ops/miscellaneous';\nimport { convertQueuingStrategy } from './validators/queuing-strategy';\nimport { ExtractHighWaterMark, ExtractSizeAlgorithm } from './abstract-ops/queuing-strategy';\nimport type {\n  Transformer,\n  TransformerCancelCallback,\n  TransformerFlushCallback,\n  TransformerStartCallback,\n  TransformerTransformCallback,\n  ValidatedTransformer\n} from './transform-stream/transformer';\nimport { convertTransformer } from './validators/transformer';\n\n// Class TransformStream\n\n/**\n * A transform stream consists of a pair of streams: a {@link WritableStream | writable stream},\n * known as its writable side, and a {@link ReadableStream | readable stream}, known as its readable side.\n * In a manner specific to the transform stream in question, writes to the writable side result in new data being\n * made available for reading from the readable side.\n *\n * @public\n */\nexport class TransformStream<I = any, O = any> {\n  /** @internal */\n  _writable!: WritableStream<I>;\n  /** @internal */\n  _readable!: DefaultReadableStream<O>;\n  /** @internal */\n  _backpressure!: boolean;\n  /** @internal */\n  _backpressureChangePromise!: Promise<void>;\n  /** @internal */\n  _backpressureChangePromise_resolve!: () => void;\n  /** @internal */\n  _transformStreamController!: TransformStreamDefaultController<O>;\n\n  constructor(\n    transformer?: Transformer<I, O>,\n    writableStrategy?: QueuingStrategy<I>,\n    readableStrategy?: QueuingStrategy<O>\n  );\n  constructor(rawTransformer: Transformer<I, O> | null | undefined = {},\n              rawWritableStrategy: QueuingStrategy<I> | null | undefined = {},\n              rawReadableStrategy: QueuingStrategy<O> | null | undefined = {}) {\n    if (rawTransformer === undefined) {\n      rawTransformer = null;\n    }\n\n    const writableStrategy = convertQueuingStrategy(rawWritableStrategy, 'Second parameter');\n    const readableStrategy = convertQueuingStrategy(rawReadableStrategy, 'Third parameter');\n\n    const transformer = convertTransformer(rawTransformer, 'First parameter');\n    if (transformer.readableType !== undefined) {\n      throw new RangeError('Invalid readableType specified');\n    }\n    if (transformer.writableType !== undefined) {\n      throw new RangeError('Invalid writableType specified');\n    }\n\n    const readableHighWaterMark = ExtractHighWaterMark(readableStrategy, 0);\n    const readableSizeAlgorithm = ExtractSizeAlgorithm(readableStrategy);\n    const writableHighWaterMark = ExtractHighWaterMark(writableStrategy, 1);\n    const writableSizeAlgorithm = ExtractSizeAlgorithm(writableStrategy);\n\n    let startPromise_resolve!: (value: void | PromiseLike<void>) => void;\n    const startPromise = newPromise<void>(resolve => {\n      startPromise_resolve = resolve;\n    });\n\n    InitializeTransformStream(\n      this, startPromise, writableHighWaterMark, writableSizeAlgorithm, readableHighWaterMark, readableSizeAlgorithm\n    );\n    SetUpTransformStreamDefaultControllerFromTransformer(this, transformer);\n\n    if (transformer.start !== undefined) {\n      startPromise_resolve(transformer.start(this._transformStreamController));\n    } else {\n      startPromise_resolve(undefined);\n    }\n  }\n\n  /**\n   * The readable side of the transform stream.\n   */\n  get readable(): ReadableStream<O> {\n    if (!IsTransformStream(this)) {\n      throw streamBrandCheckException('readable');\n    }\n\n    return this._readable;\n  }\n\n  /**\n   * The writable side of the transform stream.\n   */\n  get writable(): WritableStream<I> {\n    if (!IsTransformStream(this)) {\n      throw streamBrandCheckException('writable');\n    }\n\n    return this._writable;\n  }\n}\n\nObject.defineProperties(TransformStream.prototype, {\n  readable: { enumerable: true },\n  writable: { enumerable: true }\n});\nif (typeof Symbol.toStringTag === 'symbol') {\n  Object.defineProperty(TransformStream.prototype, Symbol.toStringTag, {\n    value: 'TransformStream',\n    configurable: true\n  });\n}\n\nexport type {\n  Transformer,\n  TransformerCancelCallback,\n  TransformerStartCallback,\n  TransformerFlushCallback,\n  TransformerTransformCallback\n};\n\n// Transform Stream Abstract Operations\n\nexport function CreateTransformStream<I, O>(startAlgorithm: () => void | PromiseLike<void>,\n                                            transformAlgorithm: (chunk: I) => Promise<void>,\n                                            flushAlgorithm: () => Promise<void>,\n                                            cancelAlgorithm: (reason: any) => Promise<void>,\n                                            writableHighWaterMark = 1,\n                                            writableSizeAlgorithm: QueuingStrategySizeCallback<I> = () => 1,\n                                            readableHighWaterMark = 0,\n                                            readableSizeAlgorithm: QueuingStrategySizeCallback<O> = () => 1) {\n  assert(IsNonNegativeNumber(writableHighWaterMark));\n  assert(IsNonNegativeNumber(readableHighWaterMark));\n\n  const stream: TransformStream<I, O> = Object.create(TransformStream.prototype);\n\n  let startPromise_resolve!: (value: void | PromiseLike<void>) => void;\n  const startPromise = newPromise<void>(resolve => {\n    startPromise_resolve = resolve;\n  });\n\n  InitializeTransformStream(stream, startPromise, writableHighWaterMark, writableSizeAlgorithm, readableHighWaterMark,\n                            readableSizeAlgorithm);\n\n  const controller: TransformStreamDefaultController<O> = Object.create(TransformStreamDefaultController.prototype);\n\n  SetUpTransformStreamDefaultController(stream, controller, transformAlgorithm, flushAlgorithm, cancelAlgorithm);\n\n  const startResult = startAlgorithm();\n  startPromise_resolve(startResult);\n  return stream;\n}\n\nfunction InitializeTransformStream<I, O>(stream: TransformStream<I, O>,\n                                         startPromise: Promise<void>,\n                                         writableHighWaterMark: number,\n                                         writableSizeAlgorithm: QueuingStrategySizeCallback<I>,\n                                         readableHighWaterMark: number,\n                                         readableSizeAlgorithm: QueuingStrategySizeCallback<O>) {\n  function startAlgorithm(): Promise<void> {\n    return startPromise;\n  }\n\n  function writeAlgorithm(chunk: I): Promise<void> {\n    return TransformStreamDefaultSinkWriteAlgorithm(stream, chunk);\n  }\n\n  function abortAlgorithm(reason: any): Promise<void> {\n    return TransformStreamDefaultSinkAbortAlgorithm(stream, reason);\n  }\n\n  function closeAlgorithm(): Promise<void> {\n    return TransformStreamDefaultSinkCloseAlgorithm(stream);\n  }\n\n  stream._writable = CreateWritableStream(startAlgorithm, writeAlgorithm, closeAlgorithm, abortAlgorithm,\n                                          writableHighWaterMark, writableSizeAlgorithm);\n\n  function pullAlgorithm(): Promise<void> {\n    return TransformStreamDefaultSourcePullAlgorithm(stream);\n  }\n\n  function cancelAlgorithm(reason: any): Promise<void> {\n    return TransformStreamDefaultSourceCancelAlgorithm(stream, reason);\n  }\n\n  stream._readable = CreateReadableStream(startAlgorithm, pullAlgorithm, cancelAlgorithm, readableHighWaterMark,\n                                          readableSizeAlgorithm);\n\n  // The [[backpressure]] slot is set to undefined so that it can be initialised by TransformStreamSetBackpressure.\n  stream._backpressure = undefined!;\n  stream._backpressureChangePromise = undefined!;\n  stream._backpressureChangePromise_resolve = undefined!;\n  TransformStreamSetBackpressure(stream, true);\n\n  stream._transformStreamController = undefined!;\n}\n\nfunction IsTransformStream(x: unknown): x is TransformStream {\n  if (!typeIsObject(x)) {\n    return false;\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(x, '_transformStreamController')) {\n    return false;\n  }\n\n  return x instanceof TransformStream;\n}\n\n// This is a no-op if both sides are already errored.\nfunction TransformStreamError(stream: TransformStream, e: any) {\n  ReadableStreamDefaultControllerError(stream._readable._readableStreamController, e);\n  TransformStreamErrorWritableAndUnblockWrite(stream, e);\n}\n\nfunction TransformStreamErrorWritableAndUnblockWrite(stream: TransformStream, e: any) {\n  TransformStreamDefaultControllerClearAlgorithms(stream._transformStreamController);\n  WritableStreamDefaultControllerErrorIfNeeded(stream._writable._writableStreamController, e);\n  TransformStreamUnblockWrite(stream);\n}\n\nfunction TransformStreamUnblockWrite(stream: TransformStream) {\n  if (stream._backpressure) {\n    // Pretend that pull() was called to permit any pending write() calls to complete. TransformStreamSetBackpressure()\n    // cannot be called from enqueue() or pull() once the ReadableStream is errored, so this will will be the final time\n    // _backpressure is set.\n    TransformStreamSetBackpressure(stream, false);\n  }\n}\n\nfunction TransformStreamSetBackpressure(stream: TransformStream, backpressure: boolean) {\n  // Passes also when called during construction.\n  assert(stream._backpressure !== backpressure);\n\n  if (stream._backpressureChangePromise !== undefined) {\n    stream._backpressureChangePromise_resolve();\n  }\n\n  stream._backpressureChangePromise = newPromise(resolve => {\n    stream._backpressureChangePromise_resolve = resolve;\n  });\n\n  stream._backpressure = backpressure;\n}\n\n// Class TransformStreamDefaultController\n\n/**\n * Allows control of the {@link ReadableStream} and {@link WritableStream} of the associated {@link TransformStream}.\n *\n * @public\n */\nexport class TransformStreamDefaultController<O> {\n  /** @internal */\n  _controlledTransformStream: TransformStream<any, O>;\n  /** @internal */\n  _finishPromise: Promise<undefined> | undefined;\n  /** @internal */\n  _finishPromise_resolve?: (value?: undefined) => void;\n  /** @internal */\n  _finishPromise_reject?: (reason: any) => void;\n  /** @internal */\n  _transformAlgorithm: (chunk: any) => Promise<void>;\n  /** @internal */\n  _flushAlgorithm: () => Promise<void>;\n  /** @internal */\n  _cancelAlgorithm: (reason: any) => Promise<void>;\n\n  private constructor() {\n    throw new TypeError('Illegal constructor');\n  }\n\n  /**\n   * Returns the desired size to fill the readable side’s internal queue. It can be negative, if the queue is over-full.\n   */\n  get desiredSize(): number | null {\n    if (!IsTransformStreamDefaultController(this)) {\n      throw defaultControllerBrandCheckException('desiredSize');\n    }\n\n    const readableController = this._controlledTransformStream._readable._readableStreamController;\n    return ReadableStreamDefaultControllerGetDesiredSize(readableController);\n  }\n\n  /**\n   * Enqueues the given chunk `chunk` in the readable side of the controlled transform stream.\n   */\n  enqueue(chunk: O): void;\n  enqueue(chunk: O = undefined!): void {\n    if (!IsTransformStreamDefaultController(this)) {\n      throw defaultControllerBrandCheckException('enqueue');\n    }\n\n    TransformStreamDefaultControllerEnqueue(this, chunk);\n  }\n\n  /**\n   * Errors both the readable side and the writable side of the controlled transform stream, making all future\n   * interactions with it fail with the given error `e`. Any chunks queued for transformation will be discarded.\n   */\n  error(reason: any = undefined): void {\n    if (!IsTransformStreamDefaultController(this)) {\n      throw defaultControllerBrandCheckException('error');\n    }\n\n    TransformStreamDefaultControllerError(this, reason);\n  }\n\n  /**\n   * Closes the readable side and errors the writable side of the controlled transform stream. This is useful when the\n   * transformer only needs to consume a portion of the chunks written to the writable side.\n   */\n  terminate(): void {\n    if (!IsTransformStreamDefaultController(this)) {\n      throw defaultControllerBrandCheckException('terminate');\n    }\n\n    TransformStreamDefaultControllerTerminate(this);\n  }\n}\n\nObject.defineProperties(TransformStreamDefaultController.prototype, {\n  enqueue: { enumerable: true },\n  error: { enumerable: true },\n  terminate: { enumerable: true },\n  desiredSize: { enumerable: true }\n});\nsetFunctionName(TransformStreamDefaultController.prototype.enqueue, 'enqueue');\nsetFunctionName(TransformStreamDefaultController.prototype.error, 'error');\nsetFunctionName(TransformStreamDefaultController.prototype.terminate, 'terminate');\nif (typeof Symbol.toStringTag === 'symbol') {\n  Object.defineProperty(TransformStreamDefaultController.prototype, Symbol.toStringTag, {\n    value: 'TransformStreamDefaultController',\n    configurable: true\n  });\n}\n\n// Transform Stream Default Controller Abstract Operations\n\nfunction IsTransformStreamDefaultController<O = any>(x: any): x is TransformStreamDefaultController<O> {\n  if (!typeIsObject(x)) {\n    return false;\n  }\n\n  if (!Object.prototype.hasOwnProperty.call(x, '_controlledTransformStream')) {\n    return false;\n  }\n\n  return x instanceof TransformStreamDefaultController;\n}\n\nfunction SetUpTransformStreamDefaultController<I, O>(stream: TransformStream<I, O>,\n                                                     controller: TransformStreamDefaultController<O>,\n                                                     transformAlgorithm: (chunk: I) => Promise<void>,\n                                                     flushAlgorithm: () => Promise<void>,\n                                                     cancelAlgorithm: (reason: any) => Promise<void>) {\n  assert(IsTransformStream(stream));\n  assert(stream._transformStreamController === undefined);\n\n  controller._controlledTransformStream = stream;\n  stream._transformStreamController = controller;\n\n  controller._transformAlgorithm = transformAlgorithm;\n  controller._flushAlgorithm = flushAlgorithm;\n  controller._cancelAlgorithm = cancelAlgorithm;\n\n  controller._finishPromise = undefined;\n  controller._finishPromise_resolve = undefined;\n  controller._finishPromise_reject = undefined;\n}\n\nfunction SetUpTransformStreamDefaultControllerFromTransformer<I, O>(stream: TransformStream<I, O>,\n                                                                    transformer: ValidatedTransformer<I, O>) {\n  const controller: TransformStreamDefaultController<O> = Object.create(TransformStreamDefaultController.prototype);\n\n  let transformAlgorithm: (chunk: I) => Promise<void>;\n  let flushAlgorithm: () => Promise<void>;\n  let cancelAlgorithm: (reason: any) => Promise<void>;\n\n  if (transformer.transform !== undefined) {\n    transformAlgorithm = chunk => transformer.transform!(chunk, controller);\n  } else {\n    transformAlgorithm = chunk => {\n      try {\n        TransformStreamDefaultControllerEnqueue(controller, chunk as unknown as O);\n        return promiseResolvedWith(undefined);\n      } catch (transformResultE) {\n        return promiseRejectedWith(transformResultE);\n      }\n    };\n  }\n\n  if (transformer.flush !== undefined) {\n    flushAlgorithm = () => transformer.flush!(controller);\n  } else {\n    flushAlgorithm = () => promiseResolvedWith(undefined);\n  }\n\n  if (transformer.cancel !== undefined) {\n    cancelAlgorithm = reason => transformer.cancel!(reason);\n  } else {\n    cancelAlgorithm = () => promiseResolvedWith(undefined);\n  }\n\n  SetUpTransformStreamDefaultController(stream, controller, transformAlgorithm, flushAlgorithm, cancelAlgorithm);\n}\n\nfunction TransformStreamDefaultControllerClearAlgorithms(controller: TransformStreamDefaultController<any>) {\n  controller._transformAlgorithm = undefined!;\n  controller._flushAlgorithm = undefined!;\n  controller._cancelAlgorithm = undefined!;\n}\n\nfunction TransformStreamDefaultControllerEnqueue<O>(controller: TransformStreamDefaultController<O>, chunk: O) {\n  const stream = controller._controlledTransformStream;\n  const readableController = stream._readable._readableStreamController;\n  if (!ReadableStreamDefaultControllerCanCloseOrEnqueue(readableController)) {\n    throw new TypeError('Readable side is not in a state that permits enqueue');\n  }\n\n  // We throttle transform invocations based on the backpressure of the ReadableStream, but we still\n  // accept TransformStreamDefaultControllerEnqueue() calls.\n\n  try {\n    ReadableStreamDefaultControllerEnqueue(readableController, chunk);\n  } catch (e) {\n    // This happens when readableStrategy.size() throws.\n    TransformStreamErrorWritableAndUnblockWrite(stream, e);\n\n    throw stream._readable._storedError;\n  }\n\n  const backpressure = ReadableStreamDefaultControllerHasBackpressure(readableController);\n  if (backpressure !== stream._backpressure) {\n    assert(backpressure);\n    TransformStreamSetBackpressure(stream, true);\n  }\n}\n\nfunction TransformStreamDefaultControllerError(controller: TransformStreamDefaultController<any>, e: any) {\n  TransformStreamError(controller._controlledTransformStream, e);\n}\n\nfunction TransformStreamDefaultControllerPerformTransform<I, O>(controller: TransformStreamDefaultController<O>,\n                                                                chunk: I) {\n  const transformPromise = controller._transformAlgorithm(chunk);\n  return transformPromiseWith(transformPromise, undefined, r => {\n    TransformStreamError(controller._controlledTransformStream, r);\n    throw r;\n  });\n}\n\nfunction TransformStreamDefaultControllerTerminate<O>(controller: TransformStreamDefaultController<O>) {\n  const stream = controller._controlledTransformStream;\n  const readableController = stream._readable._readableStreamController;\n\n  ReadableStreamDefaultControllerClose(readableController);\n\n  const error = new TypeError('TransformStream terminated');\n  TransformStreamErrorWritableAndUnblockWrite(stream, error);\n}\n\n// TransformStreamDefaultSink Algorithms\n\nfunction TransformStreamDefaultSinkWriteAlgorithm<I, O>(stream: TransformStream<I, O>, chunk: I): Promise<void> {\n  assert(stream._writable._state === 'writable');\n\n  const controller = stream._transformStreamController;\n\n  if (stream._backpressure) {\n    const backpressureChangePromise = stream._backpressureChangePromise;\n    assert(backpressureChangePromise !== undefined);\n    return transformPromiseWith(backpressureChangePromise, () => {\n      const writable = stream._writable;\n      const state = writable._state;\n      if (state === 'erroring') {\n        throw writable._storedError;\n      }\n      assert(state === 'writable');\n      return TransformStreamDefaultControllerPerformTransform<I, O>(controller, chunk);\n    });\n  }\n\n  return TransformStreamDefaultControllerPerformTransform<I, O>(controller, chunk);\n}\n\nfunction TransformStreamDefaultSinkAbortAlgorithm<I, O>(stream: TransformStream<I, O>, reason: any): Promise<void> {\n  const controller = stream._transformStreamController;\n  if (controller._finishPromise !== undefined) {\n    return controller._finishPromise;\n  }\n\n  // stream._readable cannot change after construction, so caching it across a call to user code is safe.\n  const readable = stream._readable;\n\n  // Assign the _finishPromise now so that if _cancelAlgorithm calls readable.cancel() internally,\n  // we don't run the _cancelAlgorithm again.\n  controller._finishPromise = newPromise((resolve, reject) => {\n    controller._finishPromise_resolve = resolve;\n    controller._finishPromise_reject = reject;\n  });\n\n  const cancelPromise = controller._cancelAlgorithm(reason);\n  TransformStreamDefaultControllerClearAlgorithms(controller);\n\n  uponPromise(cancelPromise, () => {\n    if (readable._state === 'errored') {\n      defaultControllerFinishPromiseReject(controller, readable._storedError);\n    } else {\n      ReadableStreamDefaultControllerError(readable._readableStreamController, reason);\n      defaultControllerFinishPromiseResolve(controller);\n    }\n    return null;\n  }, r => {\n    ReadableStreamDefaultControllerError(readable._readableStreamController, r);\n    defaultControllerFinishPromiseReject(controller, r);\n    return null;\n  });\n\n  return controller._finishPromise;\n}\n\nfunction TransformStreamDefaultSinkCloseAlgorithm<I, O>(stream: TransformStream<I, O>): Promise<void> {\n  const controller = stream._transformStreamController;\n  if (controller._finishPromise !== undefined) {\n    return controller._finishPromise;\n  }\n\n  // stream._readable cannot change after construction, so caching it across a call to user code is safe.\n  const readable = stream._readable;\n\n  // Assign the _finishPromise now so that if _flushAlgorithm calls readable.cancel() internally,\n  // we don't also run the _cancelAlgorithm.\n  controller._finishPromise = newPromise((resolve, reject) => {\n    controller._finishPromise_resolve = resolve;\n    controller._finishPromise_reject = reject;\n  });\n\n  const flushPromise = controller._flushAlgorithm();\n  TransformStreamDefaultControllerClearAlgorithms(controller);\n\n  uponPromise(flushPromise, () => {\n    if (readable._state === 'errored') {\n      defaultControllerFinishPromiseReject(controller, readable._storedError);\n    } else {\n      ReadableStreamDefaultControllerClose(readable._readableStreamController);\n      defaultControllerFinishPromiseResolve(controller);\n    }\n    return null;\n  }, r => {\n    ReadableStreamDefaultControllerError(readable._readableStreamController, r);\n    defaultControllerFinishPromiseReject(controller, r);\n    return null;\n  });\n\n  return controller._finishPromise;\n}\n\n// TransformStreamDefaultSource Algorithms\n\nfunction TransformStreamDefaultSourcePullAlgorithm(stream: TransformStream): Promise<void> {\n  // Invariant. Enforced by the promises returned by start() and pull().\n  assert(stream._backpressure);\n\n  assert(stream._backpressureChangePromise !== undefined);\n\n  TransformStreamSetBackpressure(stream, false);\n\n  // Prevent the next pull() call until there is backpressure.\n  return stream._backpressureChangePromise;\n}\n\nfunction TransformStreamDefaultSourceCancelAlgorithm<I, O>(stream: TransformStream<I, O>, reason: any): Promise<void> {\n  const controller = stream._transformStreamController;\n  if (controller._finishPromise !== undefined) {\n    return controller._finishPromise;\n  }\n\n  // stream._writable cannot change after construction, so caching it across a call to user code is safe.\n  const writable = stream._writable;\n\n  // Assign the _finishPromise now so that if _flushAlgorithm calls writable.abort() or\n  // writable.cancel() internally, we don't run the _cancelAlgorithm again, or also run the\n  // _flushAlgorithm.\n  controller._finishPromise = newPromise((resolve, reject) => {\n    controller._finishPromise_resolve = resolve;\n    controller._finishPromise_reject = reject;\n  });\n\n  const cancelPromise = controller._cancelAlgorithm(reason);\n  TransformStreamDefaultControllerClearAlgorithms(controller);\n\n  uponPromise(cancelPromise, () => {\n    if (writable._state === 'errored') {\n      defaultControllerFinishPromiseReject(controller, writable._storedError);\n    } else {\n      WritableStreamDefaultControllerErrorIfNeeded(writable._writableStreamController, reason);\n      TransformStreamUnblockWrite(stream);\n      defaultControllerFinishPromiseResolve(controller);\n    }\n    return null;\n  }, r => {\n    WritableStreamDefaultControllerErrorIfNeeded(writable._writableStreamController, r);\n    TransformStreamUnblockWrite(stream);\n    defaultControllerFinishPromiseReject(controller, r);\n    return null;\n  });\n\n  return controller._finishPromise;\n}\n\n// Helper functions for the TransformStreamDefaultController.\n\nfunction defaultControllerBrandCheckException(name: string): TypeError {\n  return new TypeError(\n    `TransformStreamDefaultController.prototype.${name} can only be used on a TransformStreamDefaultController`);\n}\n\nexport function defaultControllerFinishPromiseResolve(controller: TransformStreamDefaultController<any>) {\n  if (controller._finishPromise_resolve === undefined) {\n    return;\n  }\n\n  controller._finishPromise_resolve();\n  controller._finishPromise_resolve = undefined;\n  controller._finishPromise_reject = undefined;\n}\n\nexport function defaultControllerFinishPromiseReject(controller: TransformStreamDefaultController<any>, reason: any) {\n  if (controller._finishPromise_reject === undefined) {\n    return;\n  }\n\n  setPromiseIsHandledToTrue(controller._finishPromise!);\n  controller._finishPromise_reject(reason);\n  controller._finishPromise_resolve = undefined;\n  controller._finishPromise_reject = undefined;\n}\n\n// Helper functions for the TransformStream.\n\nfunction streamBrandCheckException(name: string): TypeError {\n  return new TypeError(\n    `TransformStream.prototype.${name} can only be used on a TransformStream`);\n}\n", "/* c8 ignore start */\r\n// 64 KiB (same size chrome slice theirs blob into Uint8array's)\r\nconst POOL_SIZE = 65536\r\n\r\nif (!globalThis.ReadableStream) {\r\n  // `node:stream/web` got introduced in v16.5.0 as experimental\r\n  // and it's preferred over the polyfilled version. So we also\r\n  // suppress the warning that gets emitted by NodeJS for using it.\r\n  try {\r\n    const process = require('node:process')\r\n    const { emitWarning } = process\r\n    try {\r\n      process.emitWarning = () => {}\r\n      Object.assign(globalThis, require('node:stream/web'))\r\n      process.emitWarning = emitWarning\r\n    } catch (error) {\r\n      process.emitWarning = emitWarning\r\n      throw error\r\n    }\r\n  } catch (error) {\r\n    // fallback to polyfill implementation\r\n    Object.assign(globalThis, require('web-streams-polyfill/dist/ponyfill.es2018.js'))\r\n  }\r\n}\r\n\r\ntry {\r\n  // Don't use node: prefix for this, require+node: is not supported until node v14.14\r\n  // Only `import()` can use prefix in 12.20 and later\r\n  const { Blob } = require('buffer')\r\n  if (Blob && !Blob.prototype.stream) {\r\n    Blob.prototype.stream = function name (params) {\r\n      let position = 0\r\n      const blob = this\r\n\r\n      return new ReadableStream({\r\n        type: 'bytes',\r\n        async pull (ctrl) {\r\n          const chunk = blob.slice(position, Math.min(blob.size, position + POOL_SIZE))\r\n          const buffer = await chunk.arrayBuffer()\r\n          position += buffer.byteLength\r\n          ctrl.enqueue(new Uint8Array(buffer))\r\n\r\n          if (position === blob.size) {\r\n            ctrl.close()\r\n          }\r\n        }\r\n      })\r\n    }\r\n  }\r\n} catch (error) {}\r\n/* c8 ignore end */\r\n", "/*! fetch-blob. MIT License. Jimmy W\u00E4rting <https://jimmy.warting.se/opensource> */\r\n\r\n// TODO (jimmywarting): in the feature use conditional loading with top level await (requires 14.x)\r\n// Node has recently added whatwg stream into core\r\n\r\nimport './streams.cjs'\r\n\r\n// 64 KiB (same size chrome slice theirs blob into Uint8array's)\r\nconst POOL_SIZE = 65536\r\n\r\n/** @param {(Blob | Uint8Array)[]} parts */\r\nasync function * toIterator (parts, clone = true) {\r\n  for (const part of parts) {\r\n    if ('stream' in part) {\r\n      yield * (/** @type {AsyncIterableIterator<Uint8Array>} */ (part.stream()))\r\n    } else if (ArrayBuffer.isView(part)) {\r\n      if (clone) {\r\n        let position = part.byteOffset\r\n        const end = part.byteOffset + part.byteLength\r\n        while (position !== end) {\r\n          const size = Math.min(end - position, POOL_SIZE)\r\n          const chunk = part.buffer.slice(position, position + size)\r\n          position += chunk.byteLength\r\n          yield new Uint8Array(chunk)\r\n        }\r\n      } else {\r\n        yield part\r\n      }\r\n    /* c8 ignore next 10 */\r\n    } else {\r\n      // For blobs that have arrayBuffer but no stream method (nodes buffer.Blob)\r\n      let position = 0, b = (/** @type {Blob} */ (part))\r\n      while (position !== b.size) {\r\n        const chunk = b.slice(position, Math.min(b.size, position + POOL_SIZE))\r\n        const buffer = await chunk.arrayBuffer()\r\n        position += buffer.byteLength\r\n        yield new Uint8Array(buffer)\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nconst _Blob = class Blob {\r\n  /** @type {Array.<(Blob|Uint8Array)>} */\r\n  #parts = []\r\n  #type = ''\r\n  #size = 0\r\n  #endings = 'transparent'\r\n\r\n  /**\r\n   * The Blob() constructor returns a new Blob object. The content\r\n   * of the blob consists of the concatenation of the values given\r\n   * in the parameter array.\r\n   *\r\n   * @param {*} blobParts\r\n   * @param {{ type?: string, endings?: string }} [options]\r\n   */\r\n  constructor (blobParts = [], options = {}) {\r\n    if (typeof blobParts !== 'object' || blobParts === null) {\r\n      throw new TypeError('Failed to construct \\'Blob\\': The provided value cannot be converted to a sequence.')\r\n    }\r\n\r\n    if (typeof blobParts[Symbol.iterator] !== 'function') {\r\n      throw new TypeError('Failed to construct \\'Blob\\': The object must have a callable @@iterator property.')\r\n    }\r\n\r\n    if (typeof options !== 'object' && typeof options !== 'function') {\r\n      throw new TypeError('Failed to construct \\'Blob\\': parameter 2 cannot convert to dictionary.')\r\n    }\r\n\r\n    if (options === null) options = {}\r\n\r\n    const encoder = new TextEncoder()\r\n    for (const element of blobParts) {\r\n      let part\r\n      if (ArrayBuffer.isView(element)) {\r\n        part = new Uint8Array(element.buffer.slice(element.byteOffset, element.byteOffset + element.byteLength))\r\n      } else if (element instanceof ArrayBuffer) {\r\n        part = new Uint8Array(element.slice(0))\r\n      } else if (element instanceof Blob) {\r\n        part = element\r\n      } else {\r\n        part = encoder.encode(`${element}`)\r\n      }\r\n\r\n      this.#size += ArrayBuffer.isView(part) ? part.byteLength : part.size\r\n      this.#parts.push(part)\r\n    }\r\n\r\n    this.#endings = `${options.endings === undefined ? 'transparent' : options.endings}`\r\n    const type = options.type === undefined ? '' : String(options.type)\r\n    this.#type = /^[\\x20-\\x7E]*$/.test(type) ? type : ''\r\n  }\r\n\r\n  /**\r\n   * The Blob interface's size property returns the\r\n   * size of the Blob in bytes.\r\n   */\r\n  get size () {\r\n    return this.#size\r\n  }\r\n\r\n  /**\r\n   * The type property of a Blob object returns the MIME type of the file.\r\n   */\r\n  get type () {\r\n    return this.#type\r\n  }\r\n\r\n  /**\r\n   * The text() method in the Blob interface returns a Promise\r\n   * that resolves with a string containing the contents of\r\n   * the blob, interpreted as UTF-8.\r\n   *\r\n   * @return {Promise<string>}\r\n   */\r\n  async text () {\r\n    // More optimized than using this.arrayBuffer()\r\n    // that requires twice as much ram\r\n    const decoder = new TextDecoder()\r\n    let str = ''\r\n    for await (const part of toIterator(this.#parts, false)) {\r\n      str += decoder.decode(part, { stream: true })\r\n    }\r\n    // Remaining\r\n    str += decoder.decode()\r\n    return str\r\n  }\r\n\r\n  /**\r\n   * The arrayBuffer() method in the Blob interface returns a\r\n   * Promise that resolves with the contents of the blob as\r\n   * binary data contained in an ArrayBuffer.\r\n   *\r\n   * @return {Promise<ArrayBuffer>}\r\n   */\r\n  async arrayBuffer () {\r\n    // Easier way... Just a unnecessary overhead\r\n    // const view = new Uint8Array(this.size);\r\n    // await this.stream().getReader({mode: 'byob'}).read(view);\r\n    // return view.buffer;\r\n\r\n    const data = new Uint8Array(this.size)\r\n    let offset = 0\r\n    for await (const chunk of toIterator(this.#parts, false)) {\r\n      data.set(chunk, offset)\r\n      offset += chunk.length\r\n    }\r\n\r\n    return data.buffer\r\n  }\r\n\r\n  stream () {\r\n    const it = toIterator(this.#parts, true)\r\n\r\n    return new globalThis.ReadableStream({\r\n      // @ts-ignore\r\n      type: 'bytes',\r\n      async pull (ctrl) {\r\n        const chunk = await it.next()\r\n        chunk.done ? ctrl.close() : ctrl.enqueue(chunk.value)\r\n      },\r\n\r\n      async cancel () {\r\n        await it.return()\r\n      }\r\n    })\r\n  }\r\n\r\n  /**\r\n   * The Blob interface's slice() method creates and returns a\r\n   * new Blob object which contains data from a subset of the\r\n   * blob on which it's called.\r\n   *\r\n   * @param {number} [start]\r\n   * @param {number} [end]\r\n   * @param {string} [type]\r\n   */\r\n  slice (start = 0, end = this.size, type = '') {\r\n    const { size } = this\r\n\r\n    let relativeStart = start < 0 ? Math.max(size + start, 0) : Math.min(start, size)\r\n    let relativeEnd = end < 0 ? Math.max(size + end, 0) : Math.min(end, size)\r\n\r\n    const span = Math.max(relativeEnd - relativeStart, 0)\r\n    const parts = this.#parts\r\n    const blobParts = []\r\n    let added = 0\r\n\r\n    for (const part of parts) {\r\n      // don't add the overflow to new blobParts\r\n      if (added >= span) {\r\n        break\r\n      }\r\n\r\n      const size = ArrayBuffer.isView(part) ? part.byteLength : part.size\r\n      if (relativeStart && size <= relativeStart) {\r\n        // Skip the beginning and change the relative\r\n        // start & end position as we skip the unwanted parts\r\n        relativeStart -= size\r\n        relativeEnd -= size\r\n      } else {\r\n        let chunk\r\n        if (ArrayBuffer.isView(part)) {\r\n          chunk = part.subarray(relativeStart, Math.min(size, relativeEnd))\r\n          added += chunk.byteLength\r\n        } else {\r\n          chunk = part.slice(relativeStart, Math.min(size, relativeEnd))\r\n          added += chunk.size\r\n        }\r\n        relativeEnd -= size\r\n        blobParts.push(chunk)\r\n        relativeStart = 0 // All next sequential parts should start at 0\r\n      }\r\n    }\r\n\r\n    const blob = new Blob([], { type: String(type).toLowerCase() })\r\n    blob.#size = span\r\n    blob.#parts = blobParts\r\n\r\n    return blob\r\n  }\r\n\r\n  get [Symbol.toStringTag] () {\r\n    return 'Blob'\r\n  }\r\n\r\n  static [Symbol.hasInstance] (object) {\r\n    return (\r\n      object &&\r\n      typeof object === 'object' &&\r\n      typeof object.constructor === 'function' &&\r\n      (\r\n        typeof object.stream === 'function' ||\r\n        typeof object.arrayBuffer === 'function'\r\n      ) &&\r\n      /^(Blob|File)$/.test(object[Symbol.toStringTag])\r\n    )\r\n  }\r\n}\r\n\r\nObject.defineProperties(_Blob.prototype, {\r\n  size: { enumerable: true },\r\n  type: { enumerable: true },\r\n  slice: { enumerable: true }\r\n})\r\n\r\n/** @type {typeof globalThis.Blob} */\r\nexport const Blob = _Blob\r\nexport default Blob\r\n", "import Blob from './index.js'\r\n\r\nconst _File = class File extends Blob {\r\n  #lastModified = 0\r\n  #name = ''\r\n\r\n  /**\r\n   * @param {*[]} fileBits\r\n   * @param {string} fileName\r\n   * @param {{lastModified?: number, type?: string}} options\r\n   */// @ts-ignore\r\n  constructor (fileBits, fileName, options = {}) {\r\n    if (arguments.length < 2) {\r\n      throw new TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`)\r\n    }\r\n    super(fileBits, options)\r\n\r\n    if (options === null) options = {}\r\n\r\n    // Simulate WebIDL type casting for NaN value in lastModified option.\r\n    const lastModified = options.lastModified === undefined ? Date.now() : Number(options.lastModified)\r\n    if (!Number.isNaN(lastModified)) {\r\n      this.#lastModified = lastModified\r\n    }\r\n\r\n    this.#name = String(fileName)\r\n  }\r\n\r\n  get name () {\r\n    return this.#name\r\n  }\r\n\r\n  get lastModified () {\r\n    return this.#lastModified\r\n  }\r\n\r\n  get [Symbol.toStringTag] () {\r\n    return 'File'\r\n  }\r\n\r\n  static [Symbol.hasInstance] (object) {\r\n    return !!object && object instanceof Blob &&\r\n      /^(File)$/.test(object[Symbol.toStringTag])\r\n  }\r\n}\r\n\r\n/** @type {typeof globalThis.File} */// @ts-ignore\r\nexport const File = _File\r\nexport default File\r\n", "/*! formdata-polyfill. MIT License. Jimmy W\u00E4rting <https://jimmy.warting.se/opensource> */\r\n\r\nimport C from 'fetch-blob'\r\nimport F from 'fetch-blob/file.js'\r\n\r\nvar {toStringTag:t,iterator:i,hasInstance:h}=Symbol,\r\nr=Math.random,\r\nm='append,set,get,getAll,delete,keys,values,entries,forEach,constructor'.split(','),\r\nf=(a,b,c)=>(a+='',/^(Blob|File)$/.test(b && b[t])?[(c=c!==void 0?c+'':b[t]=='File'?b.name:'blob',a),b.name!==c||b[t]=='blob'?new F([b],c,b):b]:[a,b+'']),\r\ne=(c,f)=>(f?c:c.replace(/\\r?\\n|\\r/g,'\\r\\n')).replace(/\\n/g,'%0A').replace(/\\r/g,'%0D').replace(/\"/g,'%22'),\r\nx=(n, a, e)=>{if(a.length<e){throw new TypeError(`Failed to execute '${n}' on 'FormData': ${e} arguments required, but only ${a.length} present.`)}}\r\n\r\nexport const File = F\r\n\r\n/** @type {typeof globalThis.FormData} */\r\nexport const FormData = class FormData {\r\n#d=[];\r\nconstructor(...a){if(a.length)throw new TypeError(`Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.`)}\r\nget [t]() {return 'FormData'}\r\n[i](){return this.entries()}\r\nstatic [h](o) {return o&&typeof o==='object'&&o[t]==='FormData'&&!m.some(m=>typeof o[m]!='function')}\r\nappend(...a){x('append',arguments,2);this.#d.push(f(...a))}\r\ndelete(a){x('delete',arguments,1);a+='';this.#d=this.#d.filter(([b])=>b!==a)}\r\nget(a){x('get',arguments,1);a+='';for(var b=this.#d,l=b.length,c=0;c<l;c++)if(b[c][0]===a)return b[c][1];return null}\r\ngetAll(a,b){x('getAll',arguments,1);b=[];a+='';this.#d.forEach(c=>c[0]===a&&b.push(c[1]));return b}\r\nhas(a){x('has',arguments,1);a+='';return this.#d.some(b=>b[0]===a)}\r\nforEach(a,b){x('forEach',arguments,1);for(var [c,d]of this)a.call(b,d,c,this)}\r\nset(...a){x('set',arguments,2);var b=[],c=!0;a=f(...a);this.#d.forEach(d=>{d[0]===a[0]?c&&(c=!b.push(a)):b.push(d)});c&&b.push(a);this.#d=b}\r\n*entries(){yield*this.#d}\r\n*keys(){for(var[a]of this)yield a}\r\n*values(){for(var[,a]of this)yield a}}\r\n\r\n/** @param {FormData} F */\r\nexport function formDataToBlob (F,B=C){\r\nvar b=`${r()}${r()}`.replace(/\\./g, '').slice(-28).padStart(32, '-'),c=[],p=`--${b}\\r\\nContent-Disposition: form-data; name=\"`\r\nF.forEach((v,n)=>typeof v=='string'\r\n?c.push(p+e(n)+`\"\\r\\n\\r\\n${v.replace(/\\r(?!\\n)|(?<!\\r)\\n/g, '\\r\\n')}\\r\\n`)\r\n:c.push(p+e(n)+`\"; filename=\"${e(v.name, 1)}\"\\r\\nContent-Type: ${v.type||\"application/octet-stream\"}\\r\\n\\r\\n`, v, '\\r\\n'))\r\nc.push(`--${b}--`)\r\nreturn new B(c,{type:\"multipart/form-data; boundary=\"+b})}\r\n", "/*! node-domexception. MIT License. Jimmy W\u00E4rting <https://jimmy.warting.se/opensource> */\r\n\r\nif (!globalThis.DOMException) {\r\n  try {\r\n    const { MessageChannel } = require('worker_threads'),\r\n    port = new MessageChannel().port1,\r\n    ab = new ArrayBuffer()\r\n    port.postMessage(ab, [ab, ab])\r\n  } catch (err) {\r\n    err.constructor.name === 'DOMException' && (\r\n      globalThis.DOMException = err.constructor\r\n    )\r\n  }\r\n}\r\n\r\nmodule.exports = globalThis.DOMException\r\n", "import { statSync, createReadStream, promises as fs } from 'node:fs'\r\nimport { basename } from 'node:path'\r\nimport DOMException from 'node-domexception'\r\n\r\nimport File from './file.js'\r\nimport Blob from './index.js'\r\n\r\nconst { stat } = fs\r\n\r\n/**\r\n * @param {string} path filepath on the disk\r\n * @param {string} [type] mimetype to use\r\n */\r\nconst blobFromSync = (path, type) => fromBlob(statSync(path), path, type)\r\n\r\n/**\r\n * @param {string} path filepath on the disk\r\n * @param {string} [type] mimetype to use\r\n * @returns {Promise<Blob>}\r\n */\r\nconst blobFrom = (path, type) => stat(path).then(stat => fromBlob(stat, path, type))\r\n\r\n/**\r\n * @param {string} path filepath on the disk\r\n * @param {string} [type] mimetype to use\r\n * @returns {Promise<File>}\r\n */\r\nconst fileFrom = (path, type) => stat(path).then(stat => fromFile(stat, path, type))\r\n\r\n/**\r\n * @param {string} path filepath on the disk\r\n * @param {string} [type] mimetype to use\r\n */\r\nconst fileFromSync = (path, type) => fromFile(statSync(path), path, type)\r\n\r\n// @ts-ignore\r\nconst fromBlob = (stat, path, type = '') => new Blob([new BlobDataItem({\r\n  path,\r\n  size: stat.size,\r\n  lastModified: stat.mtimeMs,\r\n  start: 0\r\n})], { type })\r\n\r\n// @ts-ignore\r\nconst fromFile = (stat, path, type = '') => new File([new BlobDataItem({\r\n  path,\r\n  size: stat.size,\r\n  lastModified: stat.mtimeMs,\r\n  start: 0\r\n})], basename(path), { type, lastModified: stat.mtimeMs })\r\n\r\n/**\r\n * This is a blob backed up by a file on the disk\r\n * with minium requirement. Its wrapped around a Blob as a blobPart\r\n * so you have no direct access to this.\r\n *\r\n * @private\r\n */\r\nclass BlobDataItem {\r\n  #path\r\n  #start\r\n\r\n  constructor (options) {\r\n    this.#path = options.path\r\n    this.#start = options.start\r\n    this.size = options.size\r\n    this.lastModified = options.lastModified\r\n  }\r\n\r\n  /**\r\n   * Slicing arguments is first validated and formatted\r\n   * to not be out of range by Blob.prototype.slice\r\n   */\r\n  slice (start, end) {\r\n    return new BlobDataItem({\r\n      path: this.#path,\r\n      lastModified: this.lastModified,\r\n      size: end - start,\r\n      start: this.#start + start\r\n    })\r\n  }\r\n\r\n  async * stream () {\r\n    const { mtimeMs } = await stat(this.#path)\r\n    if (mtimeMs > this.lastModified) {\r\n      throw new DOMException('The requested file could not be read, typically due to permission problems that have occurred after a reference to a file was acquired.', 'NotReadableError')\r\n    }\r\n    yield * createReadStream(this.#path, {\r\n      start: this.#start,\r\n      end: this.#start + this.size - 1\r\n    })\r\n  }\r\n\r\n  get [Symbol.toStringTag] () {\r\n    return 'Blob'\r\n  }\r\n}\r\n\r\nexport default blobFromSync\r\nexport { File, Blob, blobFrom, blobFromSync, fileFrom, fileFromSync }\r\n", "import {File} from 'fetch-blob/from.js';\r\nimport {FormData} from 'formdata-polyfill/esm.min.js';\r\n\r\nlet s = 0;\r\nconst S = {\r\n\tSTART_BOUNDARY: s++,\r\n\tHEADER_FIELD_START: s++,\r\n\tHEADER_FIELD: s++,\r\n\tHEADER_VALUE_START: s++,\r\n\tHEADER_VALUE: s++,\r\n\tHEADER_VALUE_ALMOST_DONE: s++,\r\n\tHEADERS_ALMOST_DONE: s++,\r\n\tPART_DATA_START: s++,\r\n\tPART_DATA: s++,\r\n\tEND: s++\r\n};\r\n\r\nlet f = 1;\r\nconst F = {\r\n\tPART_BOUNDARY: f,\r\n\tLAST_BOUNDARY: f *= 2\r\n};\r\n\r\nconst LF = 10;\r\nconst CR = 13;\r\nconst SPACE = 32;\r\nconst HYPHEN = 45;\r\nconst COLON = 58;\r\nconst A = 97;\r\nconst Z = 122;\r\n\r\nconst lower = c => c | 0x20;\r\n\r\nconst noop = () => {};\r\n\r\nclass MultipartParser {\r\n\t/**\r\n\t * @param {string} boundary\r\n\t */\r\n\tconstructor(boundary) {\r\n\t\tthis.index = 0;\r\n\t\tthis.flags = 0;\r\n\r\n\t\tthis.onHeaderEnd = noop;\r\n\t\tthis.onHeaderField = noop;\r\n\t\tthis.onHeadersEnd = noop;\r\n\t\tthis.onHeaderValue = noop;\r\n\t\tthis.onPartBegin = noop;\r\n\t\tthis.onPartData = noop;\r\n\t\tthis.onPartEnd = noop;\r\n\r\n\t\tthis.boundaryChars = {};\r\n\r\n\t\tboundary = '\\r\\n--' + boundary;\r\n\t\tconst ui8a = new Uint8Array(boundary.length);\r\n\t\tfor (let i = 0; i < boundary.length; i++) {\r\n\t\t\tui8a[i] = boundary.charCodeAt(i);\r\n\t\t\tthis.boundaryChars[ui8a[i]] = true;\r\n\t\t}\r\n\r\n\t\tthis.boundary = ui8a;\r\n\t\tthis.lookbehind = new Uint8Array(this.boundary.length + 8);\r\n\t\tthis.state = S.START_BOUNDARY;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {Uint8Array} data\r\n\t */\r\n\twrite(data) {\r\n\t\tlet i = 0;\r\n\t\tconst length_ = data.length;\r\n\t\tlet previousIndex = this.index;\r\n\t\tlet {lookbehind, boundary, boundaryChars, index, state, flags} = this;\r\n\t\tconst boundaryLength = this.boundary.length;\r\n\t\tconst boundaryEnd = boundaryLength - 1;\r\n\t\tconst bufferLength = data.length;\r\n\t\tlet c;\r\n\t\tlet cl;\r\n\r\n\t\tconst mark = name => {\r\n\t\t\tthis[name + 'Mark'] = i;\r\n\t\t};\r\n\r\n\t\tconst clear = name => {\r\n\t\t\tdelete this[name + 'Mark'];\r\n\t\t};\r\n\r\n\t\tconst callback = (callbackSymbol, start, end, ui8a) => {\r\n\t\t\tif (start === undefined || start !== end) {\r\n\t\t\t\tthis[callbackSymbol](ui8a && ui8a.subarray(start, end));\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tconst dataCallback = (name, clear) => {\r\n\t\t\tconst markSymbol = name + 'Mark';\r\n\t\t\tif (!(markSymbol in this)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (clear) {\r\n\t\t\t\tcallback(name, this[markSymbol], i, data);\r\n\t\t\t\tdelete this[markSymbol];\r\n\t\t\t} else {\r\n\t\t\t\tcallback(name, this[markSymbol], data.length, data);\r\n\t\t\t\tthis[markSymbol] = 0;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tfor (i = 0; i < length_; i++) {\r\n\t\t\tc = data[i];\r\n\r\n\t\t\tswitch (state) {\r\n\t\t\t\tcase S.START_BOUNDARY:\r\n\t\t\t\t\tif (index === boundary.length - 2) {\r\n\t\t\t\t\t\tif (c === HYPHEN) {\r\n\t\t\t\t\t\t\tflags |= F.LAST_BOUNDARY;\r\n\t\t\t\t\t\t} else if (c !== CR) {\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tindex++;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t} else if (index - 1 === boundary.length - 2) {\r\n\t\t\t\t\t\tif (flags & F.LAST_BOUNDARY && c === HYPHEN) {\r\n\t\t\t\t\t\t\tstate = S.END;\r\n\t\t\t\t\t\t\tflags = 0;\r\n\t\t\t\t\t\t} else if (!(flags & F.LAST_BOUNDARY) && c === LF) {\r\n\t\t\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t\t\tcallback('onPartBegin');\r\n\t\t\t\t\t\t\tstate = S.HEADER_FIELD_START;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (c !== boundary[index + 2]) {\r\n\t\t\t\t\t\tindex = -2;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (c === boundary[index + 2]) {\r\n\t\t\t\t\t\tindex++;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase S.HEADER_FIELD_START:\r\n\t\t\t\t\tstate = S.HEADER_FIELD;\r\n\t\t\t\t\tmark('onHeaderField');\r\n\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t// falls through\r\n\t\t\t\tcase S.HEADER_FIELD:\r\n\t\t\t\t\tif (c === CR) {\r\n\t\t\t\t\t\tclear('onHeaderField');\r\n\t\t\t\t\t\tstate = S.HEADERS_ALMOST_DONE;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tindex++;\r\n\t\t\t\t\tif (c === HYPHEN) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (c === COLON) {\r\n\t\t\t\t\t\tif (index === 1) {\r\n\t\t\t\t\t\t\t// empty header field\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tdataCallback('onHeaderField', true);\r\n\t\t\t\t\t\tstate = S.HEADER_VALUE_START;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcl = lower(c);\r\n\t\t\t\t\tif (cl < A || cl > Z) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase S.HEADER_VALUE_START:\r\n\t\t\t\t\tif (c === SPACE) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tmark('onHeaderValue');\r\n\t\t\t\t\tstate = S.HEADER_VALUE;\r\n\t\t\t\t\t// falls through\r\n\t\t\t\tcase S.HEADER_VALUE:\r\n\t\t\t\t\tif (c === CR) {\r\n\t\t\t\t\t\tdataCallback('onHeaderValue', true);\r\n\t\t\t\t\t\tcallback('onHeaderEnd');\r\n\t\t\t\t\t\tstate = S.HEADER_VALUE_ALMOST_DONE;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase S.HEADER_VALUE_ALMOST_DONE:\r\n\t\t\t\t\tif (c !== LF) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tstate = S.HEADER_FIELD_START;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase S.HEADERS_ALMOST_DONE:\r\n\t\t\t\t\tif (c !== LF) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcallback('onHeadersEnd');\r\n\t\t\t\t\tstate = S.PART_DATA_START;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase S.PART_DATA_START:\r\n\t\t\t\t\tstate = S.PART_DATA;\r\n\t\t\t\t\tmark('onPartData');\r\n\t\t\t\t\t// falls through\r\n\t\t\t\tcase S.PART_DATA:\r\n\t\t\t\t\tpreviousIndex = index;\r\n\r\n\t\t\t\t\tif (index === 0) {\r\n\t\t\t\t\t\t// boyer-moore derrived algorithm to safely skip non-boundary data\r\n\t\t\t\t\t\ti += boundaryEnd;\r\n\t\t\t\t\t\twhile (i < bufferLength && !(data[i] in boundaryChars)) {\r\n\t\t\t\t\t\t\ti += boundaryLength;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\ti -= boundaryEnd;\r\n\t\t\t\t\t\tc = data[i];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (index < boundary.length) {\r\n\t\t\t\t\t\tif (boundary[index] === c) {\r\n\t\t\t\t\t\t\tif (index === 0) {\r\n\t\t\t\t\t\t\t\tdataCallback('onPartData', true);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tindex++;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (index === boundary.length) {\r\n\t\t\t\t\t\tindex++;\r\n\t\t\t\t\t\tif (c === CR) {\r\n\t\t\t\t\t\t\t// CR = part boundary\r\n\t\t\t\t\t\t\tflags |= F.PART_BOUNDARY;\r\n\t\t\t\t\t\t} else if (c === HYPHEN) {\r\n\t\t\t\t\t\t\t// HYPHEN = end boundary\r\n\t\t\t\t\t\t\tflags |= F.LAST_BOUNDARY;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (index - 1 === boundary.length) {\r\n\t\t\t\t\t\tif (flags & F.PART_BOUNDARY) {\r\n\t\t\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t\t\tif (c === LF) {\r\n\t\t\t\t\t\t\t\t// unset the PART_BOUNDARY flag\r\n\t\t\t\t\t\t\t\tflags &= ~F.PART_BOUNDARY;\r\n\t\t\t\t\t\t\t\tcallback('onPartEnd');\r\n\t\t\t\t\t\t\t\tcallback('onPartBegin');\r\n\t\t\t\t\t\t\t\tstate = S.HEADER_FIELD_START;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (flags & F.LAST_BOUNDARY) {\r\n\t\t\t\t\t\t\tif (c === HYPHEN) {\r\n\t\t\t\t\t\t\t\tcallback('onPartEnd');\r\n\t\t\t\t\t\t\t\tstate = S.END;\r\n\t\t\t\t\t\t\t\tflags = 0;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (index > 0) {\r\n\t\t\t\t\t\t// when matching a possible boundary, keep a lookbehind reference\r\n\t\t\t\t\t\t// in case it turns out to be a false lead\r\n\t\t\t\t\t\tlookbehind[index - 1] = c;\r\n\t\t\t\t\t} else if (previousIndex > 0) {\r\n\t\t\t\t\t\t// if our boundary turned out to be rubbish, the captured lookbehind\r\n\t\t\t\t\t\t// belongs to partData\r\n\t\t\t\t\t\tconst _lookbehind = new Uint8Array(lookbehind.buffer, lookbehind.byteOffset, lookbehind.byteLength);\r\n\t\t\t\t\t\tcallback('onPartData', 0, previousIndex, _lookbehind);\r\n\t\t\t\t\t\tpreviousIndex = 0;\r\n\t\t\t\t\t\tmark('onPartData');\r\n\r\n\t\t\t\t\t\t// reconsider the current character even so it interrupted the sequence\r\n\t\t\t\t\t\t// it could be the beginning of a new sequence\r\n\t\t\t\t\t\ti--;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase S.END:\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthrow new Error(`Unexpected state entered: ${state}`);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tdataCallback('onHeaderField');\r\n\t\tdataCallback('onHeaderValue');\r\n\t\tdataCallback('onPartData');\r\n\r\n\t\t// Update properties for the next call\r\n\t\tthis.index = index;\r\n\t\tthis.state = state;\r\n\t\tthis.flags = flags;\r\n\t}\r\n\r\n\tend() {\r\n\t\tif ((this.state === S.HEADER_FIELD_START && this.index === 0) ||\r\n\t\t\t(this.state === S.PART_DATA && this.index === this.boundary.length)) {\r\n\t\t\tthis.onPartEnd();\r\n\t\t} else if (this.state !== S.END) {\r\n\t\t\tthrow new Error('MultipartParser.end(): stream ended unexpectedly');\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction _fileName(headerValue) {\r\n\t// matches either a quoted-string or a token (RFC 2616 section 19.5.1)\r\n\tconst m = headerValue.match(/\\bfilename=(\"(.*?)\"|([^()<>@,;:\\\\\"/[\\]?={}\\s\\t]+))($|;\\s)/i);\r\n\tif (!m) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tconst match = m[2] || m[3] || '';\r\n\tlet filename = match.slice(match.lastIndexOf('\\\\') + 1);\r\n\tfilename = filename.replace(/%22/g, '\"');\r\n\tfilename = filename.replace(/&#(\\d{4});/g, (m, code) => {\r\n\t\treturn String.fromCharCode(code);\r\n\t});\r\n\treturn filename;\r\n}\r\n\r\nexport async function toFormData(Body, ct) {\r\n\tif (!/multipart/i.test(ct)) {\r\n\t\tthrow new TypeError('Failed to fetch');\r\n\t}\r\n\r\n\tconst m = ct.match(/boundary=(?:\"([^\"]+)\"|([^;]+))/i);\r\n\r\n\tif (!m) {\r\n\t\tthrow new TypeError('no or bad content-type header, no multipart boundary');\r\n\t}\r\n\r\n\tconst parser = new MultipartParser(m[1] || m[2]);\r\n\r\n\tlet headerField;\r\n\tlet headerValue;\r\n\tlet entryValue;\r\n\tlet entryName;\r\n\tlet contentType;\r\n\tlet filename;\r\n\tconst entryChunks = [];\r\n\tconst formData = new FormData();\r\n\r\n\tconst onPartData = ui8a => {\r\n\t\tentryValue += decoder.decode(ui8a, {stream: true});\r\n\t};\r\n\r\n\tconst appendToFile = ui8a => {\r\n\t\tentryChunks.push(ui8a);\r\n\t};\r\n\r\n\tconst appendFileToFormData = () => {\r\n\t\tconst file = new File(entryChunks, filename, {type: contentType});\r\n\t\tformData.append(entryName, file);\r\n\t};\r\n\r\n\tconst appendEntryToFormData = () => {\r\n\t\tformData.append(entryName, entryValue);\r\n\t};\r\n\r\n\tconst decoder = new TextDecoder('utf-8');\r\n\tdecoder.decode();\r\n\r\n\tparser.onPartBegin = function () {\r\n\t\tparser.onPartData = onPartData;\r\n\t\tparser.onPartEnd = appendEntryToFormData;\r\n\r\n\t\theaderField = '';\r\n\t\theaderValue = '';\r\n\t\tentryValue = '';\r\n\t\tentryName = '';\r\n\t\tcontentType = '';\r\n\t\tfilename = null;\r\n\t\tentryChunks.length = 0;\r\n\t};\r\n\r\n\tparser.onHeaderField = function (ui8a) {\r\n\t\theaderField += decoder.decode(ui8a, {stream: true});\r\n\t};\r\n\r\n\tparser.onHeaderValue = function (ui8a) {\r\n\t\theaderValue += decoder.decode(ui8a, {stream: true});\r\n\t};\r\n\r\n\tparser.onHeaderEnd = function () {\r\n\t\theaderValue += decoder.decode();\r\n\t\theaderField = headerField.toLowerCase();\r\n\r\n\t\tif (headerField === 'content-disposition') {\r\n\t\t\t// matches either a quoted-string or a token (RFC 2616 section 19.5.1)\r\n\t\t\tconst m = headerValue.match(/\\bname=(\"([^\"]*)\"|([^()<>@,;:\\\\\"/[\\]?={}\\s\\t]+))/i);\r\n\r\n\t\t\tif (m) {\r\n\t\t\t\tentryName = m[2] || m[3] || '';\r\n\t\t\t}\r\n\r\n\t\t\tfilename = _fileName(headerValue);\r\n\r\n\t\t\tif (filename) {\r\n\t\t\t\tparser.onPartData = appendToFile;\r\n\t\t\t\tparser.onPartEnd = appendFileToFormData;\r\n\t\t\t}\r\n\t\t} else if (headerField === 'content-type') {\r\n\t\t\tcontentType = headerValue;\r\n\t\t}\r\n\r\n\t\theaderValue = '';\r\n\t\theaderField = '';\r\n\t};\r\n\r\n\tfor await (const chunk of Body) {\r\n\t\tparser.write(chunk);\r\n\t}\r\n\r\n\tparser.end();\r\n\r\n\treturn formData;\r\n}\r\n", "'use strict';\r\nmodule.exports = balanced;\r\nfunction balanced(a, b, str) {\r\n  if (a instanceof RegExp) a = maybeMatch(a, str);\r\n  if (b instanceof RegExp) b = maybeMatch(b, str);\r\n\r\n  var r = range(a, b, str);\r\n\r\n  return r && {\r\n    start: r[0],\r\n    end: r[1],\r\n    pre: str.slice(0, r[0]),\r\n    body: str.slice(r[0] + a.length, r[1]),\r\n    post: str.slice(r[1] + b.length)\r\n  };\r\n}\r\n\r\nfunction maybeMatch(reg, str) {\r\n  var m = str.match(reg);\r\n  return m ? m[0] : null;\r\n}\r\n\r\nbalanced.range = range;\r\nfunction range(a, b, str) {\r\n  var begs, beg, left, right, result;\r\n  var ai = str.indexOf(a);\r\n  var bi = str.indexOf(b, ai + 1);\r\n  var i = ai;\r\n\r\n  if (ai >= 0 && bi > 0) {\r\n    if(a===b) {\r\n      return [ai, bi];\r\n    }\r\n    begs = [];\r\n    left = str.length;\r\n\r\n    while (i >= 0 && !result) {\r\n      if (i == ai) {\r\n        begs.push(i);\r\n        ai = str.indexOf(a, i + 1);\r\n      } else if (begs.length == 1) {\r\n        result = [ begs.pop(), bi ];\r\n      } else {\r\n        beg = begs.pop();\r\n        if (beg < left) {\r\n          left = beg;\r\n          right = bi;\r\n        }\r\n\r\n        bi = str.indexOf(b, i + 1);\r\n      }\r\n\r\n      i = ai < bi && ai >= 0 ? ai : bi;\r\n    }\r\n\r\n    if (begs.length) {\r\n      result = [ left, right ];\r\n    }\r\n  }\r\n\r\n  return result;\r\n}\r\n", "var balanced = require('balanced-match');\r\n\r\nmodule.exports = expandTop;\r\n\r\nvar escSlash = '\\0SLASH'+Math.random()+'\\0';\r\nvar escOpen = '\\0OPEN'+Math.random()+'\\0';\r\nvar escClose = '\\0CLOSE'+Math.random()+'\\0';\r\nvar escComma = '\\0COMMA'+Math.random()+'\\0';\r\nvar escPeriod = '\\0PERIOD'+Math.random()+'\\0';\r\n\r\nfunction numeric(str) {\r\n  return parseInt(str, 10) == str\r\n    ? parseInt(str, 10)\r\n    : str.charCodeAt(0);\r\n}\r\n\r\nfunction escapeBraces(str) {\r\n  return str.split('\\\\\\\\').join(escSlash)\r\n            .split('\\\\{').join(escOpen)\r\n            .split('\\\\}').join(escClose)\r\n            .split('\\\\,').join(escComma)\r\n            .split('\\\\.').join(escPeriod);\r\n}\r\n\r\nfunction unescapeBraces(str) {\r\n  return str.split(escSlash).join('\\\\')\r\n            .split(escOpen).join('{')\r\n            .split(escClose).join('}')\r\n            .split(escComma).join(',')\r\n            .split(escPeriod).join('.');\r\n}\r\n\r\n\r\n// Basically just str.split(\",\"), but handling cases\r\n// where we have nested braced sections, which should be\r\n// treated as individual members, like {a,{b,c},d}\r\nfunction parseCommaParts(str) {\r\n  if (!str)\r\n    return [''];\r\n\r\n  var parts = [];\r\n  var m = balanced('{', '}', str);\r\n\r\n  if (!m)\r\n    return str.split(',');\r\n\r\n  var pre = m.pre;\r\n  var body = m.body;\r\n  var post = m.post;\r\n  var p = pre.split(',');\r\n\r\n  p[p.length-1] += '{' + body + '}';\r\n  var postParts = parseCommaParts(post);\r\n  if (post.length) {\r\n    p[p.length-1] += postParts.shift();\r\n    p.push.apply(p, postParts);\r\n  }\r\n\r\n  parts.push.apply(parts, p);\r\n\r\n  return parts;\r\n}\r\n\r\nfunction expandTop(str) {\r\n  if (!str)\r\n    return [];\r\n\r\n  // I don't know why Bash 4.3 does this, but it does.\r\n  // Anything starting with {} will have the first two bytes preserved\r\n  // but *only* at the top level, so {},a}b will not expand to anything,\r\n  // but a{},b}c will be expanded to [a}c,abc].\r\n  // One could argue that this is a bug in Bash, but since the goal of\r\n  // this module is to match Bash's rules, we escape a leading {}\r\n  if (str.substr(0, 2) === '{}') {\r\n    str = '\\\\{\\\\}' + str.substr(2);\r\n  }\r\n\r\n  return expand(escapeBraces(str), true).map(unescapeBraces);\r\n}\r\n\r\nfunction embrace(str) {\r\n  return '{' + str + '}';\r\n}\r\nfunction isPadded(el) {\r\n  return /^-?0\\d/.test(el);\r\n}\r\n\r\nfunction lte(i, y) {\r\n  return i <= y;\r\n}\r\nfunction gte(i, y) {\r\n  return i >= y;\r\n}\r\n\r\nfunction expand(str, isTop) {\r\n  var expansions = [];\r\n\r\n  var m = balanced('{', '}', str);\r\n  if (!m) return [str];\r\n\r\n  // no need to expand pre, since it is guaranteed to be free of brace-sets\r\n  var pre = m.pre;\r\n  var post = m.post.length\r\n    ? expand(m.post, false)\r\n    : [''];\r\n\r\n  if (/\\$$/.test(m.pre)) {    \r\n    for (var k = 0; k < post.length; k++) {\r\n      var expansion = pre+ '{' + m.body + '}' + post[k];\r\n      expansions.push(expansion);\r\n    }\r\n  } else {\r\n    var isNumericSequence = /^-?\\d+\\.\\.-?\\d+(?:\\.\\.-?\\d+)?$/.test(m.body);\r\n    var isAlphaSequence = /^[a-zA-Z]\\.\\.[a-zA-Z](?:\\.\\.-?\\d+)?$/.test(m.body);\r\n    var isSequence = isNumericSequence || isAlphaSequence;\r\n    var isOptions = m.body.indexOf(',') >= 0;\r\n    if (!isSequence && !isOptions) {\r\n      // {a},b}\r\n      if (m.post.match(/,(?!,).*\\}/)) {\r\n        str = m.pre + '{' + m.body + escClose + m.post;\r\n        return expand(str);\r\n      }\r\n      return [str];\r\n    }\r\n\r\n    var n;\r\n    if (isSequence) {\r\n      n = m.body.split(/\\.\\./);\r\n    } else {\r\n      n = parseCommaParts(m.body);\r\n      if (n.length === 1) {\r\n        // x{{a,b}}y ==> x{a}y x{b}y\r\n        n = expand(n[0], false).map(embrace);\r\n        if (n.length === 1) {\r\n          return post.map(function(p) {\r\n            return m.pre + n[0] + p;\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    // at this point, n is the parts, and we know it's not a comma set\r\n    // with a single entry.\r\n    var N;\r\n\r\n    if (isSequence) {\r\n      var x = numeric(n[0]);\r\n      var y = numeric(n[1]);\r\n      var width = Math.max(n[0].length, n[1].length)\r\n      var incr = n.length == 3\r\n        ? Math.abs(numeric(n[2]))\r\n        : 1;\r\n      var test = lte;\r\n      var reverse = y < x;\r\n      if (reverse) {\r\n        incr *= -1;\r\n        test = gte;\r\n      }\r\n      var pad = n.some(isPadded);\r\n\r\n      N = [];\r\n\r\n      for (var i = x; test(i, y); i += incr) {\r\n        var c;\r\n        if (isAlphaSequence) {\r\n          c = String.fromCharCode(i);\r\n          if (c === '\\\\')\r\n            c = '';\r\n        } else {\r\n          c = String(i);\r\n          if (pad) {\r\n            var need = width - c.length;\r\n            if (need > 0) {\r\n              var z = new Array(need + 1).join('0');\r\n              if (i < 0)\r\n                c = '-' + z + c.slice(1);\r\n              else\r\n                c = z + c;\r\n            }\r\n          }\r\n        }\r\n        N.push(c);\r\n      }\r\n    } else {\r\n      N = [];\r\n\r\n      for (var j = 0; j < n.length; j++) {\r\n        N.push.apply(N, expand(n[j], false));\r\n      }\r\n    }\r\n\r\n    for (var j = 0; j < N.length; j++) {\r\n      for (var k = 0; k < post.length; k++) {\r\n        var expansion = pre + N[j] + post[k];\r\n        if (!isTop || isSequence || expansion)\r\n          expansions.push(expansion);\r\n      }\r\n    }\r\n  }\r\n\r\n  return expansions;\r\n}\r\n\r\n", "'use strict';\r\n\r\nconst nameStartChar = ':A-Za-z_\\\\u00C0-\\\\u00D6\\\\u00D8-\\\\u00F6\\\\u00F8-\\\\u02FF\\\\u0370-\\\\u037D\\\\u037F-\\\\u1FFF\\\\u200C-\\\\u200D\\\\u2070-\\\\u218F\\\\u2C00-\\\\u2FEF\\\\u3001-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFFD';\r\nconst nameChar = nameStartChar + '\\\\-.\\\\d\\\\u00B7\\\\u0300-\\\\u036F\\\\u203F-\\\\u2040';\r\nconst nameRegexp = '[' + nameStartChar + '][' + nameChar + ']*'\r\nconst regexName = new RegExp('^' + nameRegexp + '$');\r\n\r\nconst getAllMatches = function(string, regex) {\r\n  const matches = [];\r\n  let match = regex.exec(string);\r\n  while (match) {\r\n    const allmatches = [];\r\n    allmatches.startIndex = regex.lastIndex - match[0].length;\r\n    const len = match.length;\r\n    for (let index = 0; index < len; index++) {\r\n      allmatches.push(match[index]);\r\n    }\r\n    matches.push(allmatches);\r\n    match = regex.exec(string);\r\n  }\r\n  return matches;\r\n};\r\n\r\nconst isName = function(string) {\r\n  const match = regexName.exec(string);\r\n  return !(match === null || typeof match === 'undefined');\r\n};\r\n\r\nexports.isExist = function(v) {\r\n  return typeof v !== 'undefined';\r\n};\r\n\r\nexports.isEmptyObject = function(obj) {\r\n  return Object.keys(obj).length === 0;\r\n};\r\n\r\n/**\r\n * Copy all the properties of a into b.\r\n * @param {*} target\r\n * @param {*} a\r\n */\r\nexports.merge = function(target, a, arrayMode) {\r\n  if (a) {\r\n    const keys = Object.keys(a); // will return an array of own properties\r\n    const len = keys.length; //don't make it inline\r\n    for (let i = 0; i < len; i++) {\r\n      if (arrayMode === 'strict') {\r\n        target[keys[i]] = [ a[keys[i]] ];\r\n      } else {\r\n        target[keys[i]] = a[keys[i]];\r\n      }\r\n    }\r\n  }\r\n};\r\n/* exports.merge =function (b,a){\r\n  return Object.assign(b,a);\r\n} */\r\n\r\nexports.getValue = function(v) {\r\n  if (exports.isExist(v)) {\r\n    return v;\r\n  } else {\r\n    return '';\r\n  }\r\n};\r\n\r\n// const fakeCall = function(a) {return a;};\r\n// const fakeCallNoReturn = function() {};\r\n\r\nexports.isName = isName;\r\nexports.getAllMatches = getAllMatches;\r\nexports.nameRegexp = nameRegexp;\r\n", "'use strict';\r\n\r\nconst util = require('./util');\r\n\r\nconst defaultOptions = {\r\n  allowBooleanAttributes: false, //A tag can have attributes without any value\r\n  unpairedTags: []\r\n};\r\n\r\n//const tagsPattern = new RegExp(\"<\\\\/?([\\\\w:\\\\-_\\.]+)\\\\s*\\/?>\",\"g\");\r\nexports.validate = function (xmlData, options) {\r\n  options = Object.assign({}, defaultOptions, options);\r\n\r\n  //xmlData = xmlData.replace(/(\\r\\n|\\n|\\r)/gm,\"\");//make it single line\r\n  //xmlData = xmlData.replace(/(^\\s*<\\?xml.*?\\?>)/g,\"\");//Remove XML starting tag\r\n  //xmlData = xmlData.replace(/(<!DOCTYPE[\\s\\w\\\"\\.\\/\\-\\:]+(\\[.*\\])*\\s*>)/g,\"\");//Remove DOCTYPE\r\n  const tags = [];\r\n  let tagFound = false;\r\n\r\n  //indicates that the root tag has been closed (aka. depth 0 has been reached)\r\n  let reachedRoot = false;\r\n\r\n  if (xmlData[0] === '\\ufeff') {\r\n    // check for byte order mark (BOM)\r\n    xmlData = xmlData.substr(1);\r\n  }\r\n  \r\n  for (let i = 0; i < xmlData.length; i++) {\r\n\r\n    if (xmlData[i] === '<' && xmlData[i+1] === '?') {\r\n      i+=2;\r\n      i = readPI(xmlData,i);\r\n      if (i.err) return i;\r\n    }else if (xmlData[i] === '<') {\r\n      //starting of tag\r\n      //read until you reach to '>' avoiding any '>' in attribute value\r\n      let tagStartPos = i;\r\n      i++;\r\n      \r\n      if (xmlData[i] === '!') {\r\n        i = readCommentAndCDATA(xmlData, i);\r\n        continue;\r\n      } else {\r\n        let closingTag = false;\r\n        if (xmlData[i] === '/') {\r\n          //closing tag\r\n          closingTag = true;\r\n          i++;\r\n        }\r\n        //read tagname\r\n        let tagName = '';\r\n        for (; i < xmlData.length &&\r\n          xmlData[i] !== '>' &&\r\n          xmlData[i] !== ' ' &&\r\n          xmlData[i] !== '\\t' &&\r\n          xmlData[i] !== '\\n' &&\r\n          xmlData[i] !== '\\r'; i++\r\n        ) {\r\n          tagName += xmlData[i];\r\n        }\r\n        tagName = tagName.trim();\r\n        //console.log(tagName);\r\n\r\n        if (tagName[tagName.length - 1] === '/') {\r\n          //self closing tag without attributes\r\n          tagName = tagName.substring(0, tagName.length - 1);\r\n          //continue;\r\n          i--;\r\n        }\r\n        if (!validateTagName(tagName)) {\r\n          let msg;\r\n          if (tagName.trim().length === 0) {\r\n            msg = \"Invalid space after '<'.\";\r\n          } else {\r\n            msg = \"Tag '\"+tagName+\"' is an invalid name.\";\r\n          }\r\n          return getErrorObject('InvalidTag', msg, getLineNumberForPosition(xmlData, i));\r\n        }\r\n\r\n        const result = readAttributeStr(xmlData, i);\r\n        if (result === false) {\r\n          return getErrorObject('InvalidAttr', \"Attributes for '\"+tagName+\"' have open quote.\", getLineNumberForPosition(xmlData, i));\r\n        }\r\n        let attrStr = result.value;\r\n        i = result.index;\r\n\r\n        if (attrStr[attrStr.length - 1] === '/') {\r\n          //self closing tag\r\n          const attrStrStart = i - attrStr.length;\r\n          attrStr = attrStr.substring(0, attrStr.length - 1);\r\n          const isValid = validateAttributeString(attrStr, options);\r\n          if (isValid === true) {\r\n            tagFound = true;\r\n            //continue; //text may presents after self closing tag\r\n          } else {\r\n            //the result from the nested function returns the position of the error within the attribute\r\n            //in order to get the 'true' error line, we need to calculate the position where the attribute begins (i - attrStr.length) and then add the position within the attribute\r\n            //this gives us the absolute index in the entire xml, which we can use to find the line at last\r\n            return getErrorObject(isValid.err.code, isValid.err.msg, getLineNumberForPosition(xmlData, attrStrStart + isValid.err.line));\r\n          }\r\n        } else if (closingTag) {\r\n          if (!result.tagClosed) {\r\n            return getErrorObject('InvalidTag', \"Closing tag '\"+tagName+\"' doesn't have proper closing.\", getLineNumberForPosition(xmlData, i));\r\n          } else if (attrStr.trim().length > 0) {\r\n            return getErrorObject('InvalidTag', \"Closing tag '\"+tagName+\"' can't have attributes or invalid starting.\", getLineNumberForPosition(xmlData, tagStartPos));\r\n          } else if (tags.length === 0) {\r\n            return getErrorObject('InvalidTag', \"Closing tag '\"+tagName+\"' has not been opened.\", getLineNumberForPosition(xmlData, tagStartPos));\r\n          } else {\r\n            const otg = tags.pop();\r\n            if (tagName !== otg.tagName) {\r\n              let openPos = getLineNumberForPosition(xmlData, otg.tagStartPos);\r\n              return getErrorObject('InvalidTag',\r\n                \"Expected closing tag '\"+otg.tagName+\"' (opened in line \"+openPos.line+\", col \"+openPos.col+\") instead of closing tag '\"+tagName+\"'.\",\r\n                getLineNumberForPosition(xmlData, tagStartPos));\r\n            }\r\n\r\n            //when there are no more tags, we reached the root level.\r\n            if (tags.length == 0) {\r\n              reachedRoot = true;\r\n            }\r\n          }\r\n        } else {\r\n          const isValid = validateAttributeString(attrStr, options);\r\n          if (isValid !== true) {\r\n            //the result from the nested function returns the position of the error within the attribute\r\n            //in order to get the 'true' error line, we need to calculate the position where the attribute begins (i - attrStr.length) and then add the position within the attribute\r\n            //this gives us the absolute index in the entire xml, which we can use to find the line at last\r\n            return getErrorObject(isValid.err.code, isValid.err.msg, getLineNumberForPosition(xmlData, i - attrStr.length + isValid.err.line));\r\n          }\r\n\r\n          //if the root level has been reached before ...\r\n          if (reachedRoot === true) {\r\n            return getErrorObject('InvalidXml', 'Multiple possible root nodes found.', getLineNumberForPosition(xmlData, i));\r\n          } else if(options.unpairedTags.indexOf(tagName) !== -1){\r\n            //don't push into stack\r\n          } else {\r\n            tags.push({tagName, tagStartPos});\r\n          }\r\n          tagFound = true;\r\n        }\r\n\r\n        //skip tag text value\r\n        //It may include comments and CDATA value\r\n        for (i++; i < xmlData.length; i++) {\r\n          if (xmlData[i] === '<') {\r\n            if (xmlData[i + 1] === '!') {\r\n              //comment or CADATA\r\n              i++;\r\n              i = readCommentAndCDATA(xmlData, i);\r\n              continue;\r\n            } else if (xmlData[i+1] === '?') {\r\n              i = readPI(xmlData, ++i);\r\n              if (i.err) return i;\r\n            } else{\r\n              break;\r\n            }\r\n          } else if (xmlData[i] === '&') {\r\n            const afterAmp = validateAmpersand(xmlData, i);\r\n            if (afterAmp == -1)\r\n              return getErrorObject('InvalidChar', \"char '&' is not expected.\", getLineNumberForPosition(xmlData, i));\r\n            i = afterAmp;\r\n          }else{\r\n            if (reachedRoot === true && !isWhiteSpace(xmlData[i])) {\r\n              return getErrorObject('InvalidXml', \"Extra text at the end\", getLineNumberForPosition(xmlData, i));\r\n            }\r\n          }\r\n        } //end of reading tag text value\r\n        if (xmlData[i] === '<') {\r\n          i--;\r\n        }\r\n      }\r\n    } else {\r\n      if ( isWhiteSpace(xmlData[i])) {\r\n        continue;\r\n      }\r\n      return getErrorObject('InvalidChar', \"char '\"+xmlData[i]+\"' is not expected.\", getLineNumberForPosition(xmlData, i));\r\n    }\r\n  }\r\n\r\n  if (!tagFound) {\r\n    return getErrorObject('InvalidXml', 'Start tag expected.', 1);\r\n  }else if (tags.length == 1) {\r\n      return getErrorObject('InvalidTag', \"Unclosed tag '\"+tags[0].tagName+\"'.\", getLineNumberForPosition(xmlData, tags[0].tagStartPos));\r\n  }else if (tags.length > 0) {\r\n      return getErrorObject('InvalidXml', \"Invalid '\"+\r\n          JSON.stringify(tags.map(t => t.tagName), null, 4).replace(/\\r?\\n/g, '')+\r\n          \"' found.\", {line: 1, col: 1});\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nfunction isWhiteSpace(char){\r\n  return char === ' ' || char === '\\t' || char === '\\n'  || char === '\\r';\r\n}\r\n/**\r\n * Read Processing insstructions and skip\r\n * @param {*} xmlData\r\n * @param {*} i\r\n */\r\nfunction readPI(xmlData, i) {\r\n  const start = i;\r\n  for (; i < xmlData.length; i++) {\r\n    if (xmlData[i] == '?' || xmlData[i] == ' ') {\r\n      //tagname\r\n      const tagname = xmlData.substr(start, i - start);\r\n      if (i > 5 && tagname === 'xml') {\r\n        return getErrorObject('InvalidXml', 'XML declaration allowed only at the start of the document.', getLineNumberForPosition(xmlData, i));\r\n      } else if (xmlData[i] == '?' && xmlData[i + 1] == '>') {\r\n        //check if valid attribut string\r\n        i++;\r\n        break;\r\n      } else {\r\n        continue;\r\n      }\r\n    }\r\n  }\r\n  return i;\r\n}\r\n\r\nfunction readCommentAndCDATA(xmlData, i) {\r\n  if (xmlData.length > i + 5 && xmlData[i + 1] === '-' && xmlData[i + 2] === '-') {\r\n    //comment\r\n    for (i += 3; i < xmlData.length; i++) {\r\n      if (xmlData[i] === '-' && xmlData[i + 1] === '-' && xmlData[i + 2] === '>') {\r\n        i += 2;\r\n        break;\r\n      }\r\n    }\r\n  } else if (\r\n    xmlData.length > i + 8 &&\r\n    xmlData[i + 1] === 'D' &&\r\n    xmlData[i + 2] === 'O' &&\r\n    xmlData[i + 3] === 'C' &&\r\n    xmlData[i + 4] === 'T' &&\r\n    xmlData[i + 5] === 'Y' &&\r\n    xmlData[i + 6] === 'P' &&\r\n    xmlData[i + 7] === 'E'\r\n  ) {\r\n    let angleBracketsCount = 1;\r\n    for (i += 8; i < xmlData.length; i++) {\r\n      if (xmlData[i] === '<') {\r\n        angleBracketsCount++;\r\n      } else if (xmlData[i] === '>') {\r\n        angleBracketsCount--;\r\n        if (angleBracketsCount === 0) {\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  } else if (\r\n    xmlData.length > i + 9 &&\r\n    xmlData[i + 1] === '[' &&\r\n    xmlData[i + 2] === 'C' &&\r\n    xmlData[i + 3] === 'D' &&\r\n    xmlData[i + 4] === 'A' &&\r\n    xmlData[i + 5] === 'T' &&\r\n    xmlData[i + 6] === 'A' &&\r\n    xmlData[i + 7] === '['\r\n  ) {\r\n    for (i += 8; i < xmlData.length; i++) {\r\n      if (xmlData[i] === ']' && xmlData[i + 1] === ']' && xmlData[i + 2] === '>') {\r\n        i += 2;\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  return i;\r\n}\r\n\r\nconst doubleQuote = '\"';\r\nconst singleQuote = \"'\";\r\n\r\n/**\r\n * Keep reading xmlData until '<' is found outside the attribute value.\r\n * @param {string} xmlData\r\n * @param {number} i\r\n */\r\nfunction readAttributeStr(xmlData, i) {\r\n  let attrStr = '';\r\n  let startChar = '';\r\n  let tagClosed = false;\r\n  for (; i < xmlData.length; i++) {\r\n    if (xmlData[i] === doubleQuote || xmlData[i] === singleQuote) {\r\n      if (startChar === '') {\r\n        startChar = xmlData[i];\r\n      } else if (startChar !== xmlData[i]) {\r\n        //if vaue is enclosed with double quote then single quotes are allowed inside the value and vice versa\r\n      } else {\r\n        startChar = '';\r\n      }\r\n    } else if (xmlData[i] === '>') {\r\n      if (startChar === '') {\r\n        tagClosed = true;\r\n        break;\r\n      }\r\n    }\r\n    attrStr += xmlData[i];\r\n  }\r\n  if (startChar !== '') {\r\n    return false;\r\n  }\r\n\r\n  return {\r\n    value: attrStr,\r\n    index: i,\r\n    tagClosed: tagClosed\r\n  };\r\n}\r\n\r\n/**\r\n * Select all the attributes whether valid or invalid.\r\n */\r\nconst validAttrStrRegxp = new RegExp('(\\\\s*)([^\\\\s=]+)(\\\\s*=)?(\\\\s*([\\'\"])(([\\\\s\\\\S])*?)\\\\5)?', 'g');\r\n\r\n//attr, =\"sd\", a=\"amit's\", a=\"sd\"b=\"saf\", ab  cd=\"\"\r\n\r\nfunction validateAttributeString(attrStr, options) {\r\n  //console.log(\"start:\"+attrStr+\":end\");\r\n\r\n  //if(attrStr.trim().length === 0) return true; //empty string\r\n\r\n  const matches = util.getAllMatches(attrStr, validAttrStrRegxp);\r\n  const attrNames = {};\r\n\r\n  for (let i = 0; i < matches.length; i++) {\r\n    if (matches[i][1].length === 0) {\r\n      //nospace before attribute name: a=\"sd\"b=\"saf\"\r\n      return getErrorObject('InvalidAttr', \"Attribute '\"+matches[i][2]+\"' has no space in starting.\", getPositionFromMatch(matches[i]))\r\n    } else if (matches[i][3] !== undefined && matches[i][4] === undefined) {\r\n      return getErrorObject('InvalidAttr', \"Attribute '\"+matches[i][2]+\"' is without value.\", getPositionFromMatch(matches[i]));\r\n    } else if (matches[i][3] === undefined && !options.allowBooleanAttributes) {\r\n      //independent attribute: ab\r\n      return getErrorObject('InvalidAttr', \"boolean attribute '\"+matches[i][2]+\"' is not allowed.\", getPositionFromMatch(matches[i]));\r\n    }\r\n    /* else if(matches[i][6] === undefined){//attribute without value: ab=\r\n                    return { err: { code:\"InvalidAttr\",msg:\"attribute \" + matches[i][2] + \" has no value assigned.\"}};\r\n                } */\r\n    const attrName = matches[i][2];\r\n    if (!validateAttrName(attrName)) {\r\n      return getErrorObject('InvalidAttr', \"Attribute '\"+attrName+\"' is an invalid name.\", getPositionFromMatch(matches[i]));\r\n    }\r\n    if (!attrNames.hasOwnProperty(attrName)) {\r\n      //check for duplicate attribute.\r\n      attrNames[attrName] = 1;\r\n    } else {\r\n      return getErrorObject('InvalidAttr', \"Attribute '\"+attrName+\"' is repeated.\", getPositionFromMatch(matches[i]));\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\nfunction validateNumberAmpersand(xmlData, i) {\r\n  let re = /\\d/;\r\n  if (xmlData[i] === 'x') {\r\n    i++;\r\n    re = /[\\da-fA-F]/;\r\n  }\r\n  for (; i < xmlData.length; i++) {\r\n    if (xmlData[i] === ';')\r\n      return i;\r\n    if (!xmlData[i].match(re))\r\n      break;\r\n  }\r\n  return -1;\r\n}\r\n\r\nfunction validateAmpersand(xmlData, i) {\r\n  // https://www.w3.org/TR/xml/#dt-charref\r\n  i++;\r\n  if (xmlData[i] === ';')\r\n    return -1;\r\n  if (xmlData[i] === '#') {\r\n    i++;\r\n    return validateNumberAmpersand(xmlData, i);\r\n  }\r\n  let count = 0;\r\n  for (; i < xmlData.length; i++, count++) {\r\n    if (xmlData[i].match(/\\w/) && count < 20)\r\n      continue;\r\n    if (xmlData[i] === ';')\r\n      break;\r\n    return -1;\r\n  }\r\n  return i;\r\n}\r\n\r\nfunction getErrorObject(code, message, lineNumber) {\r\n  return {\r\n    err: {\r\n      code: code,\r\n      msg: message,\r\n      line: lineNumber.line || lineNumber,\r\n      col: lineNumber.col,\r\n    },\r\n  };\r\n}\r\n\r\nfunction validateAttrName(attrName) {\r\n  return util.isName(attrName);\r\n}\r\n\r\n// const startsWithXML = /^xml/i;\r\n\r\nfunction validateTagName(tagname) {\r\n  return util.isName(tagname) /* && !tagname.match(startsWithXML) */;\r\n}\r\n\r\n//this function returns the line number for the character at the given index\r\nfunction getLineNumberForPosition(xmlData, index) {\r\n  const lines = xmlData.substring(0, index).split(/\\r?\\n/);\r\n  return {\r\n    line: lines.length,\r\n\r\n    // column number is last line's length + 1, because column numbering starts at 1:\r\n    col: lines[lines.length - 1].length + 1\r\n  };\r\n}\r\n\r\n//this function returns the position of the first character of match within attrStr\r\nfunction getPositionFromMatch(match) {\r\n  return match.startIndex + match[1].length;\r\n}\r\n", "\r\nconst defaultOptions = {\r\n    preserveOrder: false,\r\n    attributeNamePrefix: '@_',\r\n    attributesGroupName: false,\r\n    textNodeName: '#text',\r\n    ignoreAttributes: true,\r\n    removeNSPrefix: false, // remove NS from tag name or attribute name if true\r\n    allowBooleanAttributes: false, //a tag can have attributes without any value\r\n    //ignoreRootElement : false,\r\n    parseTagValue: true,\r\n    parseAttributeValue: false,\r\n    trimValues: true, //Trim string values of tag and attributes\r\n    cdataPropName: false,\r\n    numberParseOptions: {\r\n      hex: true,\r\n      leadingZeros: true,\r\n      eNotation: true\r\n    },\r\n    tagValueProcessor: function(tagName, val) {\r\n      return val;\r\n    },\r\n    attributeValueProcessor: function(attrName, val) {\r\n      return val;\r\n    },\r\n    stopNodes: [], //nested tags will not be parsed even for errors\r\n    alwaysCreateTextNode: false,\r\n    isArray: () => false,\r\n    commentPropName: false,\r\n    unpairedTags: [],\r\n    processEntities: true,\r\n    htmlEntities: false,\r\n    ignoreDeclaration: false,\r\n    ignorePiTags: false,\r\n    transformTagName: false,\r\n    transformAttributeName: false,\r\n    updateTag: function(tagName, jPath, attrs){\r\n      return tagName\r\n    },\r\n    // skipEmptyListItem: false\r\n};\r\n   \r\nconst buildOptions = function(options) {\r\n    return Object.assign({}, defaultOptions, options);\r\n};\r\n\r\nexports.buildOptions = buildOptions;\r\nexports.defaultOptions = defaultOptions;", "'use strict';\r\n\r\nclass XmlNode{\r\n  constructor(tagname) {\r\n    this.tagname = tagname;\r\n    this.child = []; //nested tags, text, cdata, comments in order\r\n    this[\":@\"] = {}; //attributes map\r\n  }\r\n  add(key,val){\r\n    // this.child.push( {name : key, val: val, isCdata: isCdata });\r\n    if(key === \"__proto__\") key = \"#__proto__\";\r\n    this.child.push( {[key]: val });\r\n  }\r\n  addChild(node) {\r\n    if(node.tagname === \"__proto__\") node.tagname = \"#__proto__\";\r\n    if(node[\":@\"] && Object.keys(node[\":@\"]).length > 0){\r\n      this.child.push( { [node.tagname]: node.child, [\":@\"]: node[\":@\"] });\r\n    }else{\r\n      this.child.push( { [node.tagname]: node.child });\r\n    }\r\n  };\r\n};\r\n\r\n\r\nmodule.exports = XmlNode;", "const util = require('../util');\r\n\r\n//TODO: handle comments\r\nfunction readDocType(xmlData, i){\r\n    \r\n    const entities = {};\r\n    if( xmlData[i + 3] === 'O' &&\r\n         xmlData[i + 4] === 'C' &&\r\n         xmlData[i + 5] === 'T' &&\r\n         xmlData[i + 6] === 'Y' &&\r\n         xmlData[i + 7] === 'P' &&\r\n         xmlData[i + 8] === 'E')\r\n    {    \r\n        i = i+9;\r\n        let angleBracketsCount = 1;\r\n        let hasBody = false, comment = false;\r\n        let exp = \"\";\r\n        for(;i<xmlData.length;i++){\r\n            if (xmlData[i] === '<' && !comment) { //Determine the tag type\r\n                if( hasBody && isEntity(xmlData, i)){\r\n                    i += 7; \r\n                    let entityName, val;\r\n                    [entityName, val,i] = readEntityExp(xmlData,i+1);\r\n                    if(val.indexOf(\"&\") === -1) //Parameter entities are not supported\r\n                        entities[ validateEntityName(entityName) ] = {\r\n                            regx : RegExp( `&${entityName};`,\"g\"),\r\n                            val: val\r\n                        };\r\n                }\r\n                else if( hasBody && isElement(xmlData, i))  i += 8;//Not supported\r\n                else if( hasBody && isAttlist(xmlData, i))  i += 8;//Not supported\r\n                else if( hasBody && isNotation(xmlData, i)) i += 9;//Not supported\r\n                else if( isComment)                         comment = true;\r\n                else                                        throw new Error(\"Invalid DOCTYPE\");\r\n\r\n                angleBracketsCount++;\r\n                exp = \"\";\r\n            } else if (xmlData[i] === '>') { //Read tag content\r\n                if(comment){\r\n                    if( xmlData[i - 1] === \"-\" && xmlData[i - 2] === \"-\"){\r\n                        comment = false;\r\n                        angleBracketsCount--;\r\n                    }\r\n                }else{\r\n                    angleBracketsCount--;\r\n                }\r\n                if (angleBracketsCount === 0) {\r\n                  break;\r\n                }\r\n            }else if( xmlData[i] === '['){\r\n                hasBody = true;\r\n            }else{\r\n                exp += xmlData[i];\r\n            }\r\n        }\r\n        if(angleBracketsCount !== 0){\r\n            throw new Error(`Unclosed DOCTYPE`);\r\n        }\r\n    }else{\r\n        throw new Error(`Invalid Tag instead of DOCTYPE`);\r\n    }\r\n    return {entities, i};\r\n}\r\n\r\nfunction readEntityExp(xmlData,i){\r\n    //External entities are not supported\r\n    //    <!ENTITY ext SYSTEM \"http://normal-website.com\" >\r\n\r\n    //Parameter entities are not supported\r\n    //    <!ENTITY entityname \"&anotherElement;\">\r\n\r\n    //Internal entities are supported\r\n    //    <!ENTITY entityname \"replacement text\">\r\n    \r\n    //read EntityName\r\n    let entityName = \"\";\r\n    for (; i < xmlData.length && (xmlData[i] !== \"'\" && xmlData[i] !== '\"' ); i++) {\r\n        // if(xmlData[i] === \" \") continue;\r\n        // else \r\n        entityName += xmlData[i];\r\n    }\r\n    entityName = entityName.trim();\r\n    if(entityName.indexOf(\" \") !== -1) throw new Error(\"External entites are not supported\");\r\n\r\n    //read Entity Value\r\n    const startChar = xmlData[i++];\r\n    let val = \"\"\r\n    for (; i < xmlData.length && xmlData[i] !== startChar ; i++) {\r\n        val += xmlData[i];\r\n    }\r\n    return [entityName, val, i];\r\n}\r\n\r\nfunction isComment(xmlData, i){\r\n    if(xmlData[i+1] === '!' &&\r\n    xmlData[i+2] === '-' &&\r\n    xmlData[i+3] === '-') return true\r\n    return false\r\n}\r\nfunction isEntity(xmlData, i){\r\n    if(xmlData[i+1] === '!' &&\r\n    xmlData[i+2] === 'E' &&\r\n    xmlData[i+3] === 'N' &&\r\n    xmlData[i+4] === 'T' &&\r\n    xmlData[i+5] === 'I' &&\r\n    xmlData[i+6] === 'T' &&\r\n    xmlData[i+7] === 'Y') return true\r\n    return false\r\n}\r\nfunction isElement(xmlData, i){\r\n    if(xmlData[i+1] === '!' &&\r\n    xmlData[i+2] === 'E' &&\r\n    xmlData[i+3] === 'L' &&\r\n    xmlData[i+4] === 'E' &&\r\n    xmlData[i+5] === 'M' &&\r\n    xmlData[i+6] === 'E' &&\r\n    xmlData[i+7] === 'N' &&\r\n    xmlData[i+8] === 'T') return true\r\n    return false\r\n}\r\n\r\nfunction isAttlist(xmlData, i){\r\n    if(xmlData[i+1] === '!' &&\r\n    xmlData[i+2] === 'A' &&\r\n    xmlData[i+3] === 'T' &&\r\n    xmlData[i+4] === 'T' &&\r\n    xmlData[i+5] === 'L' &&\r\n    xmlData[i+6] === 'I' &&\r\n    xmlData[i+7] === 'S' &&\r\n    xmlData[i+8] === 'T') return true\r\n    return false\r\n}\r\nfunction isNotation(xmlData, i){\r\n    if(xmlData[i+1] === '!' &&\r\n    xmlData[i+2] === 'N' &&\r\n    xmlData[i+3] === 'O' &&\r\n    xmlData[i+4] === 'T' &&\r\n    xmlData[i+5] === 'A' &&\r\n    xmlData[i+6] === 'T' &&\r\n    xmlData[i+7] === 'I' &&\r\n    xmlData[i+8] === 'O' &&\r\n    xmlData[i+9] === 'N') return true\r\n    return false\r\n}\r\n\r\nfunction validateEntityName(name){\r\n    if (util.isName(name))\r\n\treturn name;\r\n    else\r\n        throw new Error(`Invalid entity name ${name}`);\r\n}\r\n\r\nmodule.exports = readDocType;\r\n", "const hexRegex = /^[-+]?0x[a-fA-F0-9]+$/;\r\nconst numRegex = /^([\\-\\+])?(0*)([0-9]*(\\.[0-9]*)?)$/;\r\n// const octRegex = /^0x[a-z0-9]+/;\r\n// const binRegex = /0x[a-z0-9]+/;\r\n\r\n \r\nconst consider = {\r\n    hex :  true,\r\n    // oct: false,\r\n    leadingZeros: true,\r\n    decimalPoint: \"\\.\",\r\n    eNotation: true,\r\n    //skipLike: /regex/\r\n};\r\n\r\nfunction toNumber(str, options = {}){\r\n    options = Object.assign({}, consider, options );\r\n    if(!str || typeof str !== \"string\" ) return str;\r\n    \r\n    let trimmedStr  = str.trim();\r\n    \r\n    if(options.skipLike !== undefined && options.skipLike.test(trimmedStr)) return str;\r\n    else if(str===\"0\") return 0;\r\n    else if (options.hex && hexRegex.test(trimmedStr)) {\r\n        return parse_int(trimmedStr, 16);\r\n    // }else if (options.oct && octRegex.test(str)) {\r\n    //     return Number.parseInt(val, 8);\r\n    }else if (trimmedStr.search(/[eE]/)!== -1) { //eNotation\r\n        const notation = trimmedStr.match(/^([-\\+])?(0*)([0-9]*(\\.[0-9]*)?[eE][-\\+]?[0-9]+)$/); \r\n        // +00.123 => [ , '+', '00', '.123', ..\r\n        if(notation){\r\n            // console.log(notation)\r\n            if(options.leadingZeros){ //accept with leading zeros\r\n                trimmedStr = (notation[1] || \"\") + notation[3];\r\n            }else{\r\n                if(notation[2] === \"0\" && notation[3][0]=== \".\"){ //valid number\r\n                }else{\r\n                    return str;\r\n                }\r\n            }\r\n            return options.eNotation ? Number(trimmedStr) : str;\r\n        }else{\r\n            return str;\r\n        }\r\n    // }else if (options.parseBin && binRegex.test(str)) {\r\n    //     return Number.parseInt(val, 2);\r\n    }else{\r\n        //separate negative sign, leading zeros, and rest number\r\n        const match = numRegex.exec(trimmedStr);\r\n        // +00.123 => [ , '+', '00', '.123', ..\r\n        if(match){\r\n            const sign = match[1];\r\n            const leadingZeros = match[2];\r\n            let numTrimmedByZeros = trimZeros(match[3]); //complete num without leading zeros\r\n            //trim ending zeros for floating number\r\n            \r\n            if(!options.leadingZeros && leadingZeros.length > 0 && sign && trimmedStr[2] !== \".\") return str; //-0123\r\n            else if(!options.leadingZeros && leadingZeros.length > 0 && !sign && trimmedStr[1] !== \".\") return str; //0123\r\n            else if(options.leadingZeros && leadingZeros===str) return 0; //00\r\n            \r\n            else{//no leading zeros or leading zeros are allowed\r\n                const num = Number(trimmedStr);\r\n                const numStr = \"\" + num;\r\n\r\n                if(numStr.search(/[eE]/) !== -1){ //given number is long and parsed to eNotation\r\n                    if(options.eNotation) return num;\r\n                    else return str;\r\n                }else if(trimmedStr.indexOf(\".\") !== -1){ //floating number\r\n                    if(numStr === \"0\" && (numTrimmedByZeros === \"\") ) return num; //0.0\r\n                    else if(numStr === numTrimmedByZeros) return num; //0.456. 0.79000\r\n                    else if( sign && numStr === \"-\"+numTrimmedByZeros) return num;\r\n                    else return str;\r\n                }\r\n                \r\n                if(leadingZeros){\r\n                    return (numTrimmedByZeros === numStr) || (sign+numTrimmedByZeros === numStr) ? num : str\r\n                }else  {\r\n                    return (trimmedStr === numStr) || (trimmedStr === sign+numStr) ? num : str\r\n                }\r\n            }\r\n        }else{ //non-numeric string\r\n            return str;\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * \r\n * @param {string} numStr without leading zeros\r\n * @returns \r\n */\r\nfunction trimZeros(numStr){\r\n    if(numStr && numStr.indexOf(\".\") !== -1){//float\r\n        numStr = numStr.replace(/0+$/, \"\"); //remove ending zeros\r\n        if(numStr === \".\")  numStr = \"0\";\r\n        else if(numStr[0] === \".\")  numStr = \"0\"+numStr;\r\n        else if(numStr[numStr.length-1] === \".\")  numStr = numStr.substr(0,numStr.length-1);\r\n        return numStr;\r\n    }\r\n    return numStr;\r\n}\r\n\r\nfunction parse_int(numStr, base){\r\n    //polyfill\r\n    if(parseInt) return parseInt(numStr, base);\r\n    else if(Number.parseInt) return Number.parseInt(numStr, base);\r\n    else if(window && window.parseInt) return window.parseInt(numStr, base);\r\n    else throw new Error(\"parseInt, Number.parseInt, window.parseInt are not supported\")\r\n}\r\n\r\nmodule.exports = toNumber;", "function getIgnoreAttributesFn(ignoreAttributes) {\r\n    if (typeof ignoreAttributes === 'function') {\r\n        return ignoreAttributes\r\n    }\r\n    if (Array.isArray(ignoreAttributes)) {\r\n        return (attrName) => {\r\n            for (const pattern of ignoreAttributes) {\r\n                if (typeof pattern === 'string' && attrName === pattern) {\r\n                    return true\r\n                }\r\n                if (pattern instanceof RegExp && pattern.test(attrName)) {\r\n                    return true\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return () => false\r\n}\r\n\r\nmodule.exports = getIgnoreAttributesFn", "'use strict';\r\n///@ts-check\r\n\r\nconst util = require('../util');\r\nconst xmlNode = require('./xmlNode');\r\nconst readDocType = require(\"./DocTypeReader\");\r\nconst toNumber = require(\"strnum\");\r\nconst getIgnoreAttributesFn = require('../ignoreAttributes')\r\n\r\n// const regx =\r\n//   '<((!\\\\[CDATA\\\\[([\\\\s\\\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\\\/)(NAME)\\\\s*>))([^<]*)'\r\n//   .replace(/NAME/g, util.nameRegexp);\r\n\r\n//const tagsRegx = new RegExp(\"<(\\\\/?[\\\\w:\\\\-\\._]+)([^>]*)>(\\\\s*\"+cdataRegx+\")*([^<]+)?\",\"g\");\r\n//const tagsRegx = new RegExp(\"<(\\\\/?)((\\\\w*:)?([\\\\w:\\\\-\\._]+))([^>]*)>([^<]*)(\"+cdataRegx+\"([^<]*))*([^<]+)?\",\"g\");\r\n\r\nclass OrderedObjParser{\r\n  constructor(options){\r\n    this.options = options;\r\n    this.currentNode = null;\r\n    this.tagsNodeStack = [];\r\n    this.docTypeEntities = {};\r\n    this.lastEntities = {\r\n      \"apos\" : { regex: /&(apos|#39|#x27);/g, val : \"'\"},\r\n      \"gt\" : { regex: /&(gt|#62|#x3E);/g, val : \">\"},\r\n      \"lt\" : { regex: /&(lt|#60|#x3C);/g, val : \"<\"},\r\n      \"quot\" : { regex: /&(quot|#34|#x22);/g, val : \"\\\"\"},\r\n    };\r\n    this.ampEntity = { regex: /&(amp|#38|#x26);/g, val : \"&\"};\r\n    this.htmlEntities = {\r\n      \"space\": { regex: /&(nbsp|#160);/g, val: \" \" },\r\n      // \"lt\" : { regex: /&(lt|#60);/g, val: \"<\" },\r\n      // \"gt\" : { regex: /&(gt|#62);/g, val: \">\" },\r\n      // \"amp\" : { regex: /&(amp|#38);/g, val: \"&\" },\r\n      // \"quot\" : { regex: /&(quot|#34);/g, val: \"\\\"\" },\r\n      // \"apos\" : { regex: /&(apos|#39);/g, val: \"'\" },\r\n      \"cent\" : { regex: /&(cent|#162);/g, val: \"\u00A2\" },\r\n      \"pound\" : { regex: /&(pound|#163);/g, val: \"\u00A3\" },\r\n      \"yen\" : { regex: /&(yen|#165);/g, val: \"\u00A5\" },\r\n      \"euro\" : { regex: /&(euro|#8364);/g, val: \"\u20AC\" },\r\n      \"copyright\" : { regex: /&(copy|#169);/g, val: \"\u00A9\" },\r\n      \"reg\" : { regex: /&(reg|#174);/g, val: \"\u00AE\" },\r\n      \"inr\" : { regex: /&(inr|#8377);/g, val: \"\u20B9\" },\r\n      \"num_dec\": { regex: /&#([0-9]{1,7});/g, val : (_, str) => String.fromCharCode(Number.parseInt(str, 10)) },\r\n      \"num_hex\": { regex: /&#x([0-9a-fA-F]{1,6});/g, val : (_, str) => String.fromCharCode(Number.parseInt(str, 16)) },\r\n    };\r\n    this.addExternalEntities = addExternalEntities;\r\n    this.parseXml = parseXml;\r\n    this.parseTextData = parseTextData;\r\n    this.resolveNameSpace = resolveNameSpace;\r\n    this.buildAttributesMap = buildAttributesMap;\r\n    this.isItStopNode = isItStopNode;\r\n    this.replaceEntitiesValue = replaceEntitiesValue;\r\n    this.readStopNodeData = readStopNodeData;\r\n    this.saveTextToParentTag = saveTextToParentTag;\r\n    this.addChild = addChild;\r\n    this.ignoreAttributesFn = getIgnoreAttributesFn(this.options.ignoreAttributes)\r\n  }\r\n\r\n}\r\n\r\nfunction addExternalEntities(externalEntities){\r\n  const entKeys = Object.keys(externalEntities);\r\n  for (let i = 0; i < entKeys.length; i++) {\r\n    const ent = entKeys[i];\r\n    this.lastEntities[ent] = {\r\n       regex: new RegExp(\"&\"+ent+\";\",\"g\"),\r\n       val : externalEntities[ent]\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * @param {string} val\r\n * @param {string} tagName\r\n * @param {string} jPath\r\n * @param {boolean} dontTrim\r\n * @param {boolean} hasAttributes\r\n * @param {boolean} isLeafNode\r\n * @param {boolean} escapeEntities\r\n */\r\nfunction parseTextData(val, tagName, jPath, dontTrim, hasAttributes, isLeafNode, escapeEntities) {\r\n  if (val !== undefined) {\r\n    if (this.options.trimValues && !dontTrim) {\r\n      val = val.trim();\r\n    }\r\n    if(val.length > 0){\r\n      if(!escapeEntities) val = this.replaceEntitiesValue(val);\r\n      \r\n      const newval = this.options.tagValueProcessor(tagName, val, jPath, hasAttributes, isLeafNode);\r\n      if(newval === null || newval === undefined){\r\n        //don't parse\r\n        return val;\r\n      }else if(typeof newval !== typeof val || newval !== val){\r\n        //overwrite\r\n        return newval;\r\n      }else if(this.options.trimValues){\r\n        return parseValue(val, this.options.parseTagValue, this.options.numberParseOptions);\r\n      }else{\r\n        const trimmedVal = val.trim();\r\n        if(trimmedVal === val){\r\n          return parseValue(val, this.options.parseTagValue, this.options.numberParseOptions);\r\n        }else{\r\n          return val;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction resolveNameSpace(tagname) {\r\n  if (this.options.removeNSPrefix) {\r\n    const tags = tagname.split(':');\r\n    const prefix = tagname.charAt(0) === '/' ? '/' : '';\r\n    if (tags[0] === 'xmlns') {\r\n      return '';\r\n    }\r\n    if (tags.length === 2) {\r\n      tagname = prefix + tags[1];\r\n    }\r\n  }\r\n  return tagname;\r\n}\r\n\r\n//TODO: change regex to capture NS\r\n//const attrsRegx = new RegExp(\"([\\\\w\\\\-\\\\.\\\\:]+)\\\\s*=\\\\s*(['\\\"])((.|\\n)*?)\\\\2\",\"gm\");\r\nconst attrsRegx = new RegExp('([^\\\\s=]+)\\\\s*(=\\\\s*([\\'\"])([\\\\s\\\\S]*?)\\\\3)?', 'gm');\r\n\r\nfunction buildAttributesMap(attrStr, jPath, tagName) {\r\n  if (this.options.ignoreAttributes !== true && typeof attrStr === 'string') {\r\n    // attrStr = attrStr.replace(/\\r?\\n/g, ' ');\r\n    //attrStr = attrStr || attrStr.trim();\r\n\r\n    const matches = util.getAllMatches(attrStr, attrsRegx);\r\n    const len = matches.length; //don't make it inline\r\n    const attrs = {};\r\n    for (let i = 0; i < len; i++) {\r\n      const attrName = this.resolveNameSpace(matches[i][1]);\r\n      if (this.ignoreAttributesFn(attrName, jPath)) {\r\n        continue\r\n      }\r\n      let oldVal = matches[i][4];\r\n      let aName = this.options.attributeNamePrefix + attrName;\r\n      if (attrName.length) {\r\n        if (this.options.transformAttributeName) {\r\n          aName = this.options.transformAttributeName(aName);\r\n        }\r\n        if(aName === \"__proto__\") aName  = \"#__proto__\";\r\n        if (oldVal !== undefined) {\r\n          if (this.options.trimValues) {\r\n            oldVal = oldVal.trim();\r\n          }\r\n          oldVal = this.replaceEntitiesValue(oldVal);\r\n          const newVal = this.options.attributeValueProcessor(attrName, oldVal, jPath);\r\n          if(newVal === null || newVal === undefined){\r\n            //don't parse\r\n            attrs[aName] = oldVal;\r\n          }else if(typeof newVal !== typeof oldVal || newVal !== oldVal){\r\n            //overwrite\r\n            attrs[aName] = newVal;\r\n          }else{\r\n            //parse\r\n            attrs[aName] = parseValue(\r\n              oldVal,\r\n              this.options.parseAttributeValue,\r\n              this.options.numberParseOptions\r\n            );\r\n          }\r\n        } else if (this.options.allowBooleanAttributes) {\r\n          attrs[aName] = true;\r\n        }\r\n      }\r\n    }\r\n    if (!Object.keys(attrs).length) {\r\n      return;\r\n    }\r\n    if (this.options.attributesGroupName) {\r\n      const attrCollection = {};\r\n      attrCollection[this.options.attributesGroupName] = attrs;\r\n      return attrCollection;\r\n    }\r\n    return attrs\r\n  }\r\n}\r\n\r\nconst parseXml = function(xmlData) {\r\n  xmlData = xmlData.replace(/\\r\\n?/g, \"\\n\"); //TODO: remove this line\r\n  const xmlObj = new xmlNode('!xml');\r\n  let currentNode = xmlObj;\r\n  let textData = \"\";\r\n  let jPath = \"\";\r\n  for(let i=0; i< xmlData.length; i++){//for each char in XML data\r\n    const ch = xmlData[i];\r\n    if(ch === '<'){\r\n      // const nextIndex = i+1;\r\n      // const _2ndChar = xmlData[nextIndex];\r\n      if( xmlData[i+1] === '/') {//Closing Tag\r\n        const closeIndex = findClosingIndex(xmlData, \">\", i, \"Closing Tag is not closed.\")\r\n        let tagName = xmlData.substring(i+2,closeIndex).trim();\r\n\r\n        if(this.options.removeNSPrefix){\r\n          const colonIndex = tagName.indexOf(\":\");\r\n          if(colonIndex !== -1){\r\n            tagName = tagName.substr(colonIndex+1);\r\n          }\r\n        }\r\n\r\n        if(this.options.transformTagName) {\r\n          tagName = this.options.transformTagName(tagName);\r\n        }\r\n\r\n        if(currentNode){\r\n          textData = this.saveTextToParentTag(textData, currentNode, jPath);\r\n        }\r\n\r\n        //check if last tag of nested tag was unpaired tag\r\n        const lastTagName = jPath.substring(jPath.lastIndexOf(\".\")+1);\r\n        if(tagName && this.options.unpairedTags.indexOf(tagName) !== -1 ){\r\n          throw new Error(`Unpaired tag can not be used as closing tag: </${tagName}>`);\r\n        }\r\n        let propIndex = 0\r\n        if(lastTagName && this.options.unpairedTags.indexOf(lastTagName) !== -1 ){\r\n          propIndex = jPath.lastIndexOf('.', jPath.lastIndexOf('.')-1)\r\n          this.tagsNodeStack.pop();\r\n        }else{\r\n          propIndex = jPath.lastIndexOf(\".\");\r\n        }\r\n        jPath = jPath.substring(0, propIndex);\r\n\r\n        currentNode = this.tagsNodeStack.pop();//avoid recursion, set the parent tag scope\r\n        textData = \"\";\r\n        i = closeIndex;\r\n      } else if( xmlData[i+1] === '?') {\r\n\r\n        let tagData = readTagExp(xmlData,i, false, \"?>\");\r\n        if(!tagData) throw new Error(\"Pi Tag is not closed.\");\r\n\r\n        textData = this.saveTextToParentTag(textData, currentNode, jPath);\r\n        if( (this.options.ignoreDeclaration && tagData.tagName === \"?xml\") || this.options.ignorePiTags){\r\n\r\n        }else{\r\n  \r\n          const childNode = new xmlNode(tagData.tagName);\r\n          childNode.add(this.options.textNodeName, \"\");\r\n          \r\n          if(tagData.tagName !== tagData.tagExp && tagData.attrExpPresent){\r\n            childNode[\":@\"] = this.buildAttributesMap(tagData.tagExp, jPath, tagData.tagName);\r\n          }\r\n          this.addChild(currentNode, childNode, jPath)\r\n\r\n        }\r\n\r\n\r\n        i = tagData.closeIndex + 1;\r\n      } else if(xmlData.substr(i + 1, 3) === '!--') {\r\n        const endIndex = findClosingIndex(xmlData, \"-->\", i+4, \"Comment is not closed.\")\r\n        if(this.options.commentPropName){\r\n          const comment = xmlData.substring(i + 4, endIndex - 2);\r\n\r\n          textData = this.saveTextToParentTag(textData, currentNode, jPath);\r\n\r\n          currentNode.add(this.options.commentPropName, [ { [this.options.textNodeName] : comment } ]);\r\n        }\r\n        i = endIndex;\r\n      } else if( xmlData.substr(i + 1, 2) === '!D') {\r\n        const result = readDocType(xmlData, i);\r\n        this.docTypeEntities = result.entities;\r\n        i = result.i;\r\n      }else if(xmlData.substr(i + 1, 2) === '![') {\r\n        const closeIndex = findClosingIndex(xmlData, \"]]>\", i, \"CDATA is not closed.\") - 2;\r\n        const tagExp = xmlData.substring(i + 9,closeIndex);\r\n\r\n        textData = this.saveTextToParentTag(textData, currentNode, jPath);\r\n\r\n        let val = this.parseTextData(tagExp, currentNode.tagname, jPath, true, false, true, true);\r\n        if(val == undefined) val = \"\";\r\n\r\n        //cdata should be set even if it is 0 length string\r\n        if(this.options.cdataPropName){\r\n          currentNode.add(this.options.cdataPropName, [ { [this.options.textNodeName] : tagExp } ]);\r\n        }else{\r\n          currentNode.add(this.options.textNodeName, val);\r\n        }\r\n        \r\n        i = closeIndex + 2;\r\n      }else {//Opening tag\r\n        let result = readTagExp(xmlData,i, this.options.removeNSPrefix);\r\n        let tagName= result.tagName;\r\n        const rawTagName = result.rawTagName;\r\n        let tagExp = result.tagExp;\r\n        let attrExpPresent = result.attrExpPresent;\r\n        let closeIndex = result.closeIndex;\r\n\r\n        if (this.options.transformTagName) {\r\n          tagName = this.options.transformTagName(tagName);\r\n        }\r\n        \r\n        //save text as child node\r\n        if (currentNode && textData) {\r\n          if(currentNode.tagname !== '!xml'){\r\n            //when nested tag is found\r\n            textData = this.saveTextToParentTag(textData, currentNode, jPath, false);\r\n          }\r\n        }\r\n\r\n        //check if last tag was unpaired tag\r\n        const lastTag = currentNode;\r\n        if(lastTag && this.options.unpairedTags.indexOf(lastTag.tagname) !== -1 ){\r\n          currentNode = this.tagsNodeStack.pop();\r\n          jPath = jPath.substring(0, jPath.lastIndexOf(\".\"));\r\n        }\r\n        if(tagName !== xmlObj.tagname){\r\n          jPath += jPath ? \".\" + tagName : tagName;\r\n        }\r\n        if (this.isItStopNode(this.options.stopNodes, jPath, tagName)) {\r\n          let tagContent = \"\";\r\n          //self-closing tag\r\n          if(tagExp.length > 0 && tagExp.lastIndexOf(\"/\") === tagExp.length - 1){\r\n            if(tagName[tagName.length - 1] === \"/\"){ //remove trailing '/'\r\n              tagName = tagName.substr(0, tagName.length - 1);\r\n              jPath = jPath.substr(0, jPath.length - 1);\r\n              tagExp = tagName;\r\n            }else{\r\n              tagExp = tagExp.substr(0, tagExp.length - 1);\r\n            }\r\n            i = result.closeIndex;\r\n          }\r\n          //unpaired tag\r\n          else if(this.options.unpairedTags.indexOf(tagName) !== -1){\r\n            \r\n            i = result.closeIndex;\r\n          }\r\n          //normal tag\r\n          else{\r\n            //read until closing tag is found\r\n            const result = this.readStopNodeData(xmlData, rawTagName, closeIndex + 1);\r\n            if(!result) throw new Error(`Unexpected end of ${rawTagName}`);\r\n            i = result.i;\r\n            tagContent = result.tagContent;\r\n          }\r\n\r\n          const childNode = new xmlNode(tagName);\r\n          if(tagName !== tagExp && attrExpPresent){\r\n            childNode[\":@\"] = this.buildAttributesMap(tagExp, jPath, tagName);\r\n          }\r\n          if(tagContent) {\r\n            tagContent = this.parseTextData(tagContent, tagName, jPath, true, attrExpPresent, true, true);\r\n          }\r\n          \r\n          jPath = jPath.substr(0, jPath.lastIndexOf(\".\"));\r\n          childNode.add(this.options.textNodeName, tagContent);\r\n          \r\n          this.addChild(currentNode, childNode, jPath)\r\n        }else{\r\n  //selfClosing tag\r\n          if(tagExp.length > 0 && tagExp.lastIndexOf(\"/\") === tagExp.length - 1){\r\n            if(tagName[tagName.length - 1] === \"/\"){ //remove trailing '/'\r\n              tagName = tagName.substr(0, tagName.length - 1);\r\n              jPath = jPath.substr(0, jPath.length - 1);\r\n              tagExp = tagName;\r\n            }else{\r\n              tagExp = tagExp.substr(0, tagExp.length - 1);\r\n            }\r\n            \r\n            if(this.options.transformTagName) {\r\n              tagName = this.options.transformTagName(tagName);\r\n            }\r\n\r\n            const childNode = new xmlNode(tagName);\r\n            if(tagName !== tagExp && attrExpPresent){\r\n              childNode[\":@\"] = this.buildAttributesMap(tagExp, jPath, tagName);\r\n            }\r\n            this.addChild(currentNode, childNode, jPath)\r\n            jPath = jPath.substr(0, jPath.lastIndexOf(\".\"));\r\n          }\r\n    //opening tag\r\n          else{\r\n            const childNode = new xmlNode( tagName);\r\n            this.tagsNodeStack.push(currentNode);\r\n            \r\n            if(tagName !== tagExp && attrExpPresent){\r\n              childNode[\":@\"] = this.buildAttributesMap(tagExp, jPath, tagName);\r\n            }\r\n            this.addChild(currentNode, childNode, jPath)\r\n            currentNode = childNode;\r\n          }\r\n          textData = \"\";\r\n          i = closeIndex;\r\n        }\r\n      }\r\n    }else{\r\n      textData += xmlData[i];\r\n    }\r\n  }\r\n  return xmlObj.child;\r\n}\r\n\r\nfunction addChild(currentNode, childNode, jPath){\r\n  const result = this.options.updateTag(childNode.tagname, jPath, childNode[\":@\"])\r\n  if(result === false){\r\n  }else if(typeof result === \"string\"){\r\n    childNode.tagname = result\r\n    currentNode.addChild(childNode);\r\n  }else{\r\n    currentNode.addChild(childNode);\r\n  }\r\n}\r\n\r\nconst replaceEntitiesValue = function(val){\r\n\r\n  if(this.options.processEntities){\r\n    for(let entityName in this.docTypeEntities){\r\n      const entity = this.docTypeEntities[entityName];\r\n      val = val.replace( entity.regx, entity.val);\r\n    }\r\n    for(let entityName in this.lastEntities){\r\n      const entity = this.lastEntities[entityName];\r\n      val = val.replace( entity.regex, entity.val);\r\n    }\r\n    if(this.options.htmlEntities){\r\n      for(let entityName in this.htmlEntities){\r\n        const entity = this.htmlEntities[entityName];\r\n        val = val.replace( entity.regex, entity.val);\r\n      }\r\n    }\r\n    val = val.replace( this.ampEntity.regex, this.ampEntity.val);\r\n  }\r\n  return val;\r\n}\r\nfunction saveTextToParentTag(textData, currentNode, jPath, isLeafNode) {\r\n  if (textData) { //store previously collected data as textNode\r\n    if(isLeafNode === undefined) isLeafNode = currentNode.child.length === 0\r\n    \r\n    textData = this.parseTextData(textData,\r\n      currentNode.tagname,\r\n      jPath,\r\n      false,\r\n      currentNode[\":@\"] ? Object.keys(currentNode[\":@\"]).length !== 0 : false,\r\n      isLeafNode);\r\n\r\n    if (textData !== undefined && textData !== \"\")\r\n      currentNode.add(this.options.textNodeName, textData);\r\n    textData = \"\";\r\n  }\r\n  return textData;\r\n}\r\n\r\n//TODO: use jPath to simplify the logic\r\n/**\r\n * \r\n * @param {string[]} stopNodes \r\n * @param {string} jPath\r\n * @param {string} currentTagName \r\n */\r\nfunction isItStopNode(stopNodes, jPath, currentTagName){\r\n  const allNodesExp = \"*.\" + currentTagName;\r\n  for (const stopNodePath in stopNodes) {\r\n    const stopNodeExp = stopNodes[stopNodePath];\r\n    if( allNodesExp === stopNodeExp || jPath === stopNodeExp  ) return true;\r\n  }\r\n  return false;\r\n}\r\n\r\n/**\r\n * Returns the tag Expression and where it is ending handling single-double quotes situation\r\n * @param {string} xmlData \r\n * @param {number} i starting index\r\n * @returns \r\n */\r\nfunction tagExpWithClosingIndex(xmlData, i, closingChar = \">\"){\r\n  let attrBoundary;\r\n  let tagExp = \"\";\r\n  for (let index = i; index < xmlData.length; index++) {\r\n    let ch = xmlData[index];\r\n    if (attrBoundary) {\r\n        if (ch === attrBoundary) attrBoundary = \"\";//reset\r\n    } else if (ch === '\"' || ch === \"'\") {\r\n        attrBoundary = ch;\r\n    } else if (ch === closingChar[0]) {\r\n      if(closingChar[1]){\r\n        if(xmlData[index + 1] === closingChar[1]){\r\n          return {\r\n            data: tagExp,\r\n            index: index\r\n          }\r\n        }\r\n      }else{\r\n        return {\r\n          data: tagExp,\r\n          index: index\r\n        }\r\n      }\r\n    } else if (ch === '\\t') {\r\n      ch = \" \"\r\n    }\r\n    tagExp += ch;\r\n  }\r\n}\r\n\r\nfunction findClosingIndex(xmlData, str, i, errMsg){\r\n  const closingIndex = xmlData.indexOf(str, i);\r\n  if(closingIndex === -1){\r\n    throw new Error(errMsg)\r\n  }else{\r\n    return closingIndex + str.length - 1;\r\n  }\r\n}\r\n\r\nfunction readTagExp(xmlData,i, removeNSPrefix, closingChar = \">\"){\r\n  const result = tagExpWithClosingIndex(xmlData, i+1, closingChar);\r\n  if(!result) return;\r\n  let tagExp = result.data;\r\n  const closeIndex = result.index;\r\n  const separatorIndex = tagExp.search(/\\s/);\r\n  let tagName = tagExp;\r\n  let attrExpPresent = true;\r\n  if(separatorIndex !== -1){//separate tag name and attributes expression\r\n    tagName = tagExp.substring(0, separatorIndex);\r\n    tagExp = tagExp.substring(separatorIndex + 1).trimStart();\r\n  }\r\n\r\n  const rawTagName = tagName;\r\n  if(removeNSPrefix){\r\n    const colonIndex = tagName.indexOf(\":\");\r\n    if(colonIndex !== -1){\r\n      tagName = tagName.substr(colonIndex+1);\r\n      attrExpPresent = tagName !== result.data.substr(colonIndex + 1);\r\n    }\r\n  }\r\n\r\n  return {\r\n    tagName: tagName,\r\n    tagExp: tagExp,\r\n    closeIndex: closeIndex,\r\n    attrExpPresent: attrExpPresent,\r\n    rawTagName: rawTagName,\r\n  }\r\n}\r\n/**\r\n * find paired tag for a stop node\r\n * @param {string} xmlData \r\n * @param {string} tagName \r\n * @param {number} i \r\n */\r\nfunction readStopNodeData(xmlData, tagName, i){\r\n  const startIndex = i;\r\n  // Starting at 1 since we already have an open tag\r\n  let openTagCount = 1;\r\n\r\n  for (; i < xmlData.length; i++) {\r\n    if( xmlData[i] === \"<\"){ \r\n      if (xmlData[i+1] === \"/\") {//close tag\r\n          const closeIndex = findClosingIndex(xmlData, \">\", i, `${tagName} is not closed`);\r\n          let closeTagName = xmlData.substring(i+2,closeIndex).trim();\r\n          if(closeTagName === tagName){\r\n            openTagCount--;\r\n            if (openTagCount === 0) {\r\n              return {\r\n                tagContent: xmlData.substring(startIndex, i),\r\n                i : closeIndex\r\n              }\r\n            }\r\n          }\r\n          i=closeIndex;\r\n        } else if(xmlData[i+1] === '?') { \r\n          const closeIndex = findClosingIndex(xmlData, \"?>\", i+1, \"StopNode is not closed.\")\r\n          i=closeIndex;\r\n        } else if(xmlData.substr(i + 1, 3) === '!--') { \r\n          const closeIndex = findClosingIndex(xmlData, \"-->\", i+3, \"StopNode is not closed.\")\r\n          i=closeIndex;\r\n        } else if(xmlData.substr(i + 1, 2) === '![') { \r\n          const closeIndex = findClosingIndex(xmlData, \"]]>\", i, \"StopNode is not closed.\") - 2;\r\n          i=closeIndex;\r\n        } else {\r\n          const tagData = readTagExp(xmlData, i, '>')\r\n\r\n          if (tagData) {\r\n            const openTagName = tagData && tagData.tagName;\r\n            if (openTagName === tagName && tagData.tagExp[tagData.tagExp.length-1] !== \"/\") {\r\n              openTagCount++;\r\n            }\r\n            i=tagData.closeIndex;\r\n          }\r\n        }\r\n      }\r\n  }//end for loop\r\n}\r\n\r\nfunction parseValue(val, shouldParse, options) {\r\n  if (shouldParse && typeof val === 'string') {\r\n    //console.log(options)\r\n    const newval = val.trim();\r\n    if(newval === 'true' ) return true;\r\n    else if(newval === 'false' ) return false;\r\n    else return toNumber(val, options);\r\n  } else {\r\n    if (util.isExist(val)) {\r\n      return val;\r\n    } else {\r\n      return '';\r\n    }\r\n  }\r\n}\r\n\r\n\r\nmodule.exports = OrderedObjParser;\r\n", "'use strict';\r\n\r\n/**\r\n * \r\n * @param {array} node \r\n * @param {any} options \r\n * @returns \r\n */\r\nfunction prettify(node, options){\r\n  return compress( node, options);\r\n}\r\n\r\n/**\r\n * \r\n * @param {array} arr \r\n * @param {object} options \r\n * @param {string} jPath \r\n * @returns object\r\n */\r\nfunction compress(arr, options, jPath){\r\n  let text;\r\n  const compressedObj = {};\r\n  for (let i = 0; i < arr.length; i++) {\r\n    const tagObj = arr[i];\r\n    const property = propName(tagObj);\r\n    let newJpath = \"\";\r\n    if(jPath === undefined) newJpath = property;\r\n    else newJpath = jPath + \".\" + property;\r\n\r\n    if(property === options.textNodeName){\r\n      if(text === undefined) text = tagObj[property];\r\n      else text += \"\" + tagObj[property];\r\n    }else if(property === undefined){\r\n      continue;\r\n    }else if(tagObj[property]){\r\n      \r\n      let val = compress(tagObj[property], options, newJpath);\r\n      const isLeaf = isLeafTag(val, options);\r\n\r\n      if(tagObj[\":@\"]){\r\n        assignAttributes( val, tagObj[\":@\"], newJpath, options);\r\n      }else if(Object.keys(val).length === 1 && val[options.textNodeName] !== undefined && !options.alwaysCreateTextNode){\r\n        val = val[options.textNodeName];\r\n      }else if(Object.keys(val).length === 0){\r\n        if(options.alwaysCreateTextNode) val[options.textNodeName] = \"\";\r\n        else val = \"\";\r\n      }\r\n\r\n      if(compressedObj[property] !== undefined && compressedObj.hasOwnProperty(property)) {\r\n        if(!Array.isArray(compressedObj[property])) {\r\n            compressedObj[property] = [ compressedObj[property] ];\r\n        }\r\n        compressedObj[property].push(val);\r\n      }else{\r\n        //TODO: if a node is not an array, then check if it should be an array\r\n        //also determine if it is a leaf node\r\n        if (options.isArray(property, newJpath, isLeaf )) {\r\n          compressedObj[property] = [val];\r\n        }else{\r\n          compressedObj[property] = val;\r\n        }\r\n      }\r\n    }\r\n    \r\n  }\r\n  // if(text && text.length > 0) compressedObj[options.textNodeName] = text;\r\n  if(typeof text === \"string\"){\r\n    if(text.length > 0) compressedObj[options.textNodeName] = text;\r\n  }else if(text !== undefined) compressedObj[options.textNodeName] = text;\r\n  return compressedObj;\r\n}\r\n\r\nfunction propName(obj){\r\n  const keys = Object.keys(obj);\r\n  for (let i = 0; i < keys.length; i++) {\r\n    const key = keys[i];\r\n    if(key !== \":@\") return key;\r\n  }\r\n}\r\n\r\nfunction assignAttributes(obj, attrMap, jpath, options){\r\n  if (attrMap) {\r\n    const keys = Object.keys(attrMap);\r\n    const len = keys.length; //don't make it inline\r\n    for (let i = 0; i < len; i++) {\r\n      const atrrName = keys[i];\r\n      if (options.isArray(atrrName, jpath + \".\" + atrrName, true, true)) {\r\n        obj[atrrName] = [ attrMap[atrrName] ];\r\n      } else {\r\n        obj[atrrName] = attrMap[atrrName];\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction isLeafTag(obj, options){\r\n  const { textNodeName } = options;\r\n  const propCount = Object.keys(obj).length;\r\n  \r\n  if (propCount === 0) {\r\n    return true;\r\n  }\r\n\r\n  if (\r\n    propCount === 1 &&\r\n    (obj[textNodeName] || typeof obj[textNodeName] === \"boolean\" || obj[textNodeName] === 0)\r\n  ) {\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n}\r\nexports.prettify = prettify;\r\n", "const { buildOptions} = require(\"./OptionsBuilder\");\r\nconst OrderedObjParser = require(\"./OrderedObjParser\");\r\nconst { prettify} = require(\"./node2json\");\r\nconst validator = require('../validator');\r\n\r\nclass XMLParser{\r\n    \r\n    constructor(options){\r\n        this.externalEntities = {};\r\n        this.options = buildOptions(options);\r\n        \r\n    }\r\n    /**\r\n     * Parse XML dats to JS object \r\n     * @param {string|Buffer} xmlData \r\n     * @param {boolean|Object} validationOption \r\n     */\r\n    parse(xmlData,validationOption){\r\n        if(typeof xmlData === \"string\"){\r\n        }else if( xmlData.toString){\r\n            xmlData = xmlData.toString();\r\n        }else{\r\n            throw new Error(\"XML data is accepted in String or Bytes[] form.\")\r\n        }\r\n        if( validationOption){\r\n            if(validationOption === true) validationOption = {}; //validate with default options\r\n            \r\n            const result = validator.validate(xmlData, validationOption);\r\n            if (result !== true) {\r\n              throw Error( `${result.err.msg}:${result.err.line}:${result.err.col}` )\r\n            }\r\n          }\r\n        const orderedObjParser = new OrderedObjParser(this.options);\r\n        orderedObjParser.addExternalEntities(this.externalEntities);\r\n        const orderedResult = orderedObjParser.parseXml(xmlData);\r\n        if(this.options.preserveOrder || orderedResult === undefined) return orderedResult;\r\n        else return prettify(orderedResult, this.options);\r\n    }\r\n\r\n    /**\r\n     * Add Entity which is not by default supported by this library\r\n     * @param {string} key \r\n     * @param {string} value \r\n     */\r\n    addEntity(key, value){\r\n        if(value.indexOf(\"&\") !== -1){\r\n            throw new Error(\"Entity value can't have '&'\")\r\n        }else if(key.indexOf(\"&\") !== -1 || key.indexOf(\";\") !== -1){\r\n            throw new Error(\"An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'\")\r\n        }else if(value === \"&\"){\r\n            throw new Error(\"An entity with value '&' is not permitted\");\r\n        }else{\r\n            this.externalEntities[key] = value;\r\n        }\r\n    }\r\n}\r\n\r\nmodule.exports = XMLParser;", "const EOL = \"\\n\";\r\n\r\n/**\r\n * \r\n * @param {array} jArray \r\n * @param {any} options \r\n * @returns \r\n */\r\nfunction toXml(jArray, options) {\r\n    let indentation = \"\";\r\n    if (options.format && options.indentBy.length > 0) {\r\n        indentation = EOL;\r\n    }\r\n    return arrToStr(jArray, options, \"\", indentation);\r\n}\r\n\r\nfunction arrToStr(arr, options, jPath, indentation) {\r\n    let xmlStr = \"\";\r\n    let isPreviousElementTag = false;\r\n\r\n    for (let i = 0; i < arr.length; i++) {\r\n        const tagObj = arr[i];\r\n        const tagName = propName(tagObj);\r\n        if(tagName === undefined) continue;\r\n\r\n        let newJPath = \"\";\r\n        if (jPath.length === 0) newJPath = tagName\r\n        else newJPath = `${jPath}.${tagName}`;\r\n\r\n        if (tagName === options.textNodeName) {\r\n            let tagText = tagObj[tagName];\r\n            if (!isStopNode(newJPath, options)) {\r\n                tagText = options.tagValueProcessor(tagName, tagText);\r\n                tagText = replaceEntitiesValue(tagText, options);\r\n            }\r\n            if (isPreviousElementTag) {\r\n                xmlStr += indentation;\r\n            }\r\n            xmlStr += tagText;\r\n            isPreviousElementTag = false;\r\n            continue;\r\n        } else if (tagName === options.cdataPropName) {\r\n            if (isPreviousElementTag) {\r\n                xmlStr += indentation;\r\n            }\r\n            xmlStr += `<![CDATA[${tagObj[tagName][0][options.textNodeName]}]]>`;\r\n            isPreviousElementTag = false;\r\n            continue;\r\n        } else if (tagName === options.commentPropName) {\r\n            xmlStr += indentation + `<!--${tagObj[tagName][0][options.textNodeName]}-->`;\r\n            isPreviousElementTag = true;\r\n            continue;\r\n        } else if (tagName[0] === \"?\") {\r\n            const attStr = attr_to_str(tagObj[\":@\"], options);\r\n            const tempInd = tagName === \"?xml\" ? \"\" : indentation;\r\n            let piTextNodeName = tagObj[tagName][0][options.textNodeName];\r\n            piTextNodeName = piTextNodeName.length !== 0 ? \" \" + piTextNodeName : \"\"; //remove extra spacing\r\n            xmlStr += tempInd + `<${tagName}${piTextNodeName}${attStr}?>`;\r\n            isPreviousElementTag = true;\r\n            continue;\r\n        }\r\n        let newIdentation = indentation;\r\n        if (newIdentation !== \"\") {\r\n            newIdentation += options.indentBy;\r\n        }\r\n        const attStr = attr_to_str(tagObj[\":@\"], options);\r\n        const tagStart = indentation + `<${tagName}${attStr}`;\r\n        const tagValue = arrToStr(tagObj[tagName], options, newJPath, newIdentation);\r\n        if (options.unpairedTags.indexOf(tagName) !== -1) {\r\n            if (options.suppressUnpairedNode) xmlStr += tagStart + \">\";\r\n            else xmlStr += tagStart + \"/>\";\r\n        } else if ((!tagValue || tagValue.length === 0) && options.suppressEmptyNode) {\r\n            xmlStr += tagStart + \"/>\";\r\n        } else if (tagValue && tagValue.endsWith(\">\")) {\r\n            xmlStr += tagStart + `>${tagValue}${indentation}</${tagName}>`;\r\n        } else {\r\n            xmlStr += tagStart + \">\";\r\n            if (tagValue && indentation !== \"\" && (tagValue.includes(\"/>\") || tagValue.includes(\"</\"))) {\r\n                xmlStr += indentation + options.indentBy + tagValue + indentation;\r\n            } else {\r\n                xmlStr += tagValue;\r\n            }\r\n            xmlStr += `</${tagName}>`;\r\n        }\r\n        isPreviousElementTag = true;\r\n    }\r\n\r\n    return xmlStr;\r\n}\r\n\r\nfunction propName(obj) {\r\n    const keys = Object.keys(obj);\r\n    for (let i = 0; i < keys.length; i++) {\r\n        const key = keys[i];\r\n        if(!obj.hasOwnProperty(key)) continue;\r\n        if (key !== \":@\") return key;\r\n    }\r\n}\r\n\r\nfunction attr_to_str(attrMap, options) {\r\n    let attrStr = \"\";\r\n    if (attrMap && !options.ignoreAttributes) {\r\n        for (let attr in attrMap) {\r\n            if(!attrMap.hasOwnProperty(attr)) continue;\r\n            let attrVal = options.attributeValueProcessor(attr, attrMap[attr]);\r\n            attrVal = replaceEntitiesValue(attrVal, options);\r\n            if (attrVal === true && options.suppressBooleanAttributes) {\r\n                attrStr += ` ${attr.substr(options.attributeNamePrefix.length)}`;\r\n            } else {\r\n                attrStr += ` ${attr.substr(options.attributeNamePrefix.length)}=\"${attrVal}\"`;\r\n            }\r\n        }\r\n    }\r\n    return attrStr;\r\n}\r\n\r\nfunction isStopNode(jPath, options) {\r\n    jPath = jPath.substr(0, jPath.length - options.textNodeName.length - 1);\r\n    let tagName = jPath.substr(jPath.lastIndexOf(\".\") + 1);\r\n    for (let index in options.stopNodes) {\r\n        if (options.stopNodes[index] === jPath || options.stopNodes[index] === \"*.\" + tagName) return true;\r\n    }\r\n    return false;\r\n}\r\n\r\nfunction replaceEntitiesValue(textValue, options) {\r\n    if (textValue && textValue.length > 0 && options.processEntities) {\r\n        for (let i = 0; i < options.entities.length; i++) {\r\n            const entity = options.entities[i];\r\n            textValue = textValue.replace(entity.regex, entity.val);\r\n        }\r\n    }\r\n    return textValue;\r\n}\r\nmodule.exports = toXml;\r\n", "'use strict';\r\n//parse Empty Node as self closing node\r\nconst buildFromOrderedJs = require('./orderedJs2Xml');\r\nconst getIgnoreAttributesFn = require('../ignoreAttributes')\r\n\r\nconst defaultOptions = {\r\n  attributeNamePrefix: '@_',\r\n  attributesGroupName: false,\r\n  textNodeName: '#text',\r\n  ignoreAttributes: true,\r\n  cdataPropName: false,\r\n  format: false,\r\n  indentBy: '  ',\r\n  suppressEmptyNode: false,\r\n  suppressUnpairedNode: true,\r\n  suppressBooleanAttributes: true,\r\n  tagValueProcessor: function(key, a) {\r\n    return a;\r\n  },\r\n  attributeValueProcessor: function(attrName, a) {\r\n    return a;\r\n  },\r\n  preserveOrder: false,\r\n  commentPropName: false,\r\n  unpairedTags: [],\r\n  entities: [\r\n    { regex: new RegExp(\"&\", \"g\"), val: \"&amp;\" },//it must be on top\r\n    { regex: new RegExp(\">\", \"g\"), val: \"&gt;\" },\r\n    { regex: new RegExp(\"<\", \"g\"), val: \"&lt;\" },\r\n    { regex: new RegExp(\"\\'\", \"g\"), val: \"&apos;\" },\r\n    { regex: new RegExp(\"\\\"\", \"g\"), val: \"&quot;\" }\r\n  ],\r\n  processEntities: true,\r\n  stopNodes: [],\r\n  // transformTagName: false,\r\n  // transformAttributeName: false,\r\n  oneListGroup: false\r\n};\r\n\r\nfunction Builder(options) {\r\n  this.options = Object.assign({}, defaultOptions, options);\r\n  if (this.options.ignoreAttributes === true || this.options.attributesGroupName) {\r\n    this.isAttribute = function(/*a*/) {\r\n      return false;\r\n    };\r\n  } else {\r\n    this.ignoreAttributesFn = getIgnoreAttributesFn(this.options.ignoreAttributes)\r\n    this.attrPrefixLen = this.options.attributeNamePrefix.length;\r\n    this.isAttribute = isAttribute;\r\n  }\r\n\r\n  this.processTextOrObjNode = processTextOrObjNode\r\n\r\n  if (this.options.format) {\r\n    this.indentate = indentate;\r\n    this.tagEndChar = '>\\n';\r\n    this.newLine = '\\n';\r\n  } else {\r\n    this.indentate = function() {\r\n      return '';\r\n    };\r\n    this.tagEndChar = '>';\r\n    this.newLine = '';\r\n  }\r\n}\r\n\r\nBuilder.prototype.build = function(jObj) {\r\n  if(this.options.preserveOrder){\r\n    return buildFromOrderedJs(jObj, this.options);\r\n  }else {\r\n    if(Array.isArray(jObj) && this.options.arrayNodeName && this.options.arrayNodeName.length > 1){\r\n      jObj = {\r\n        [this.options.arrayNodeName] : jObj\r\n      }\r\n    }\r\n    return this.j2x(jObj, 0, []).val;\r\n  }\r\n};\r\n\r\nBuilder.prototype.j2x = function(jObj, level, ajPath) {\r\n  let attrStr = '';\r\n  let val = '';\r\n  const jPath = ajPath.join('.')\r\n  for (let key in jObj) {\r\n    if(!Object.prototype.hasOwnProperty.call(jObj, key)) continue;\r\n    if (typeof jObj[key] === 'undefined') {\r\n      // supress undefined node only if it is not an attribute\r\n      if (this.isAttribute(key)) {\r\n        val += '';\r\n      }\r\n    } else if (jObj[key] === null) {\r\n      // null attribute should be ignored by the attribute list, but should not cause the tag closing\r\n      if (this.isAttribute(key)) {\r\n        val += '';\r\n      } else if (key === this.options.cdataPropName) {\r\n        val += '';\r\n      } else if (key[0] === '?') {\r\n        val += this.indentate(level) + '<' + key + '?' + this.tagEndChar;\r\n      } else {\r\n        val += this.indentate(level) + '<' + key + '/' + this.tagEndChar;\r\n      }\r\n      // val += this.indentate(level) + '<' + key + '/' + this.tagEndChar;\r\n    } else if (jObj[key] instanceof Date) {\r\n      val += this.buildTextValNode(jObj[key], key, '', level);\r\n    } else if (typeof jObj[key] !== 'object') {\r\n      //premitive type\r\n      const attr = this.isAttribute(key);\r\n      if (attr && !this.ignoreAttributesFn(attr, jPath)) {\r\n        attrStr += this.buildAttrPairStr(attr, '' + jObj[key]);\r\n      } else if (!attr) {\r\n        //tag value\r\n        if (key === this.options.textNodeName) {\r\n          let newval = this.options.tagValueProcessor(key, '' + jObj[key]);\r\n          val += this.replaceEntitiesValue(newval);\r\n        } else {\r\n          val += this.buildTextValNode(jObj[key], key, '', level);\r\n        }\r\n      }\r\n    } else if (Array.isArray(jObj[key])) {\r\n      //repeated nodes\r\n      const arrLen = jObj[key].length;\r\n      let listTagVal = \"\";\r\n      let listTagAttr = \"\";\r\n      for (let j = 0; j < arrLen; j++) {\r\n        const item = jObj[key][j];\r\n        if (typeof item === 'undefined') {\r\n          // supress undefined node\r\n        } else if (item === null) {\r\n          if(key[0] === \"?\") val += this.indentate(level) + '<' + key + '?' + this.tagEndChar;\r\n          else val += this.indentate(level) + '<' + key + '/' + this.tagEndChar;\r\n          // val += this.indentate(level) + '<' + key + '/' + this.tagEndChar;\r\n        } else if (typeof item === 'object') {\r\n          if(this.options.oneListGroup){\r\n            const result = this.j2x(item, level + 1, ajPath.concat(key));\r\n            listTagVal += result.val;\r\n            if (this.options.attributesGroupName && item.hasOwnProperty(this.options.attributesGroupName)) {\r\n              listTagAttr += result.attrStr\r\n            }\r\n          }else{\r\n            listTagVal += this.processTextOrObjNode(item, key, level, ajPath)\r\n          }\r\n        } else {\r\n          if (this.options.oneListGroup) {\r\n            let textValue = this.options.tagValueProcessor(key, item);\r\n            textValue = this.replaceEntitiesValue(textValue);\r\n            listTagVal += textValue;\r\n          } else {\r\n            listTagVal += this.buildTextValNode(item, key, '', level);\r\n          }\r\n        }\r\n      }\r\n      if(this.options.oneListGroup){\r\n        listTagVal = this.buildObjectNode(listTagVal, key, listTagAttr, level);\r\n      }\r\n      val += listTagVal;\r\n    } else {\r\n      //nested node\r\n      if (this.options.attributesGroupName && key === this.options.attributesGroupName) {\r\n        const Ks = Object.keys(jObj[key]);\r\n        const L = Ks.length;\r\n        for (let j = 0; j < L; j++) {\r\n          attrStr += this.buildAttrPairStr(Ks[j], '' + jObj[key][Ks[j]]);\r\n        }\r\n      } else {\r\n        val += this.processTextOrObjNode(jObj[key], key, level, ajPath)\r\n      }\r\n    }\r\n  }\r\n  return {attrStr: attrStr, val: val};\r\n};\r\n\r\nBuilder.prototype.buildAttrPairStr = function(attrName, val){\r\n  val = this.options.attributeValueProcessor(attrName, '' + val);\r\n  val = this.replaceEntitiesValue(val);\r\n  if (this.options.suppressBooleanAttributes && val === \"true\") {\r\n    return ' ' + attrName;\r\n  } else return ' ' + attrName + '=\"' + val + '\"';\r\n}\r\n\r\nfunction processTextOrObjNode (object, key, level, ajPath) {\r\n  const result = this.j2x(object, level + 1, ajPath.concat(key));\r\n  if (object[this.options.textNodeName] !== undefined && Object.keys(object).length === 1) {\r\n    return this.buildTextValNode(object[this.options.textNodeName], key, result.attrStr, level);\r\n  } else {\r\n    return this.buildObjectNode(result.val, key, result.attrStr, level);\r\n  }\r\n}\r\n\r\nBuilder.prototype.buildObjectNode = function(val, key, attrStr, level) {\r\n  if(val === \"\"){\r\n    if(key[0] === \"?\") return  this.indentate(level) + '<' + key + attrStr+ '?' + this.tagEndChar;\r\n    else {\r\n      return this.indentate(level) + '<' + key + attrStr + this.closeTag(key) + this.tagEndChar;\r\n    }\r\n  }else{\r\n\r\n    let tagEndExp = '</' + key + this.tagEndChar;\r\n    let piClosingChar = \"\";\r\n    \r\n    if(key[0] === \"?\") {\r\n      piClosingChar = \"?\";\r\n      tagEndExp = \"\";\r\n    }\r\n  \r\n    // attrStr is an empty string in case the attribute came as undefined or null\r\n    if ((attrStr || attrStr === '') && val.indexOf('<') === -1) {\r\n      return ( this.indentate(level) + '<' +  key + attrStr + piClosingChar + '>' + val + tagEndExp );\r\n    } else if (this.options.commentPropName !== false && key === this.options.commentPropName && piClosingChar.length === 0) {\r\n      return this.indentate(level) + `<!--${val}-->` + this.newLine;\r\n    }else {\r\n      return (\r\n        this.indentate(level) + '<' + key + attrStr + piClosingChar + this.tagEndChar +\r\n        val +\r\n        this.indentate(level) + tagEndExp    );\r\n    }\r\n  }\r\n}\r\n\r\nBuilder.prototype.closeTag = function(key){\r\n  let closeTag = \"\";\r\n  if(this.options.unpairedTags.indexOf(key) !== -1){ //unpaired\r\n    if(!this.options.suppressUnpairedNode) closeTag = \"/\"\r\n  }else if(this.options.suppressEmptyNode){ //empty\r\n    closeTag = \"/\";\r\n  }else{\r\n    closeTag = `></${key}`\r\n  }\r\n  return closeTag;\r\n}\r\n\r\nfunction buildEmptyObjNode(val, key, attrStr, level) {\r\n  if (val !== '') {\r\n    return this.buildObjectNode(val, key, attrStr, level);\r\n  } else {\r\n    if(key[0] === \"?\") return  this.indentate(level) + '<' + key + attrStr+ '?' + this.tagEndChar;\r\n    else {\r\n      return  this.indentate(level) + '<' + key + attrStr + '/' + this.tagEndChar;\r\n      // return this.buildTagStr(level,key, attrStr);\r\n    }\r\n  }\r\n}\r\n\r\nBuilder.prototype.buildTextValNode = function(val, key, attrStr, level) {\r\n  if (this.options.cdataPropName !== false && key === this.options.cdataPropName) {\r\n    return this.indentate(level) + `<![CDATA[${val}]]>` +  this.newLine;\r\n  }else if (this.options.commentPropName !== false && key === this.options.commentPropName) {\r\n    return this.indentate(level) + `<!--${val}-->` +  this.newLine;\r\n  }else if(key[0] === \"?\") {//PI tag\r\n    return  this.indentate(level) + '<' + key + attrStr+ '?' + this.tagEndChar; \r\n  }else{\r\n    let textValue = this.options.tagValueProcessor(key, val);\r\n    textValue = this.replaceEntitiesValue(textValue);\r\n  \r\n    if( textValue === ''){\r\n      return this.indentate(level) + '<' + key + attrStr + this.closeTag(key) + this.tagEndChar;\r\n    }else{\r\n      return this.indentate(level) + '<' + key + attrStr + '>' +\r\n         textValue +\r\n        '</' + key + this.tagEndChar;\r\n    }\r\n  }\r\n}\r\n\r\nBuilder.prototype.replaceEntitiesValue = function(textValue){\r\n  if(textValue && textValue.length > 0 && this.options.processEntities){\r\n    for (let i=0; i<this.options.entities.length; i++) {\r\n      const entity = this.options.entities[i];\r\n      textValue = textValue.replace(entity.regex, entity.val);\r\n    }\r\n  }\r\n  return textValue;\r\n}\r\n\r\nfunction indentate(level) {\r\n  return this.options.indentBy.repeat(level);\r\n}\r\n\r\nfunction isAttribute(name /*, options*/) {\r\n  if (name.startsWith(this.options.attributeNamePrefix) && name !== this.options.textNodeName) {\r\n    return name.substr(this.attrPrefixLen);\r\n  } else {\r\n    return false;\r\n  }\r\n}\r\n\r\nmodule.exports = Builder;\r\n", "'use strict';\r\n\r\nconst validator = require('./validator');\r\nconst XMLParser = require('./xmlparser/XMLParser');\r\nconst XMLBuilder = require('./xmlbuilder/json2xml');\r\n\r\nmodule.exports = {\r\n  XMLParser: XMLParser,\r\n  XMLValidator: validator,\r\n  XMLBuilder: XMLBuilder\r\n}", "/**\r\n* @license nested-property https://github.com/cosmosio/nested-property\r\n*\r\n* The MIT License (MIT)\r\n*\r\n* Copyright (c) 2014-2020 Olivier Scherrer <pode.fr@gmail.com>\r\n*/\r\n\"use strict\";\r\n\r\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\r\n\r\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\r\n\r\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\r\n\r\nfunction _wrapNativeSuper(Class) { var _cache = typeof Map === \"function\" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== \"function\") { throw new TypeError(\"Super expression must either be null or a function\"); } if (typeof _cache !== \"undefined\") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }\r\n\r\nfunction _construct(Parent, args, Class) { if (_isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }\r\n\r\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\r\n\r\nfunction _isNativeFunction(fn) { return Function.toString.call(fn).indexOf(\"[native code]\") !== -1; }\r\n\r\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\r\n\r\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\r\n\r\nvar ARRAY_WILDCARD = \"+\";\r\nvar PATH_DELIMITER = \".\";\r\n\r\nvar ObjectPrototypeMutationError = /*#__PURE__*/function (_Error) {\r\n  _inherits(ObjectPrototypeMutationError, _Error);\r\n\r\n  function ObjectPrototypeMutationError(params) {\r\n    var _this;\r\n\r\n    _classCallCheck(this, ObjectPrototypeMutationError);\r\n\r\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ObjectPrototypeMutationError).call(this, params));\r\n    _this.name = \"ObjectPrototypeMutationError\";\r\n    return _this;\r\n  }\r\n\r\n  return ObjectPrototypeMutationError;\r\n}(_wrapNativeSuper(Error));\r\n\r\nmodule.exports = {\r\n  set: setNestedProperty,\r\n  get: getNestedProperty,\r\n  has: hasNestedProperty,\r\n  hasOwn: function hasOwn(object, property, options) {\r\n    return this.has(object, property, options || {\r\n      own: true\r\n    });\r\n  },\r\n  isIn: isInNestedProperty,\r\n  ObjectPrototypeMutationError: ObjectPrototypeMutationError\r\n};\r\n/**\r\n * Get the property of an object nested in one or more objects or array\r\n * Given an object such as a.b.c.d = 5, getNestedProperty(a, \"b.c.d\") will return 5.\r\n * It also works through arrays. Given a nested array such as a[0].b = 5, getNestedProperty(a, \"0.b\") will return 5.\r\n * For accessing nested properties through all items in an array, you may use the array wildcard \"+\".\r\n * For instance, getNestedProperty([{a:1}, {a:2}, {a:3}], \"+.a\") will return [1, 2, 3]\r\n * @param {Object} object the object to get the property from\r\n * @param {String} property the path to the property as a string\r\n * @returns the object or the the property value if found\r\n */\r\n\r\nfunction getNestedProperty(object, property) {\r\n  if (_typeof(object) != \"object\" || object === null) {\r\n    return object;\r\n  }\r\n\r\n  if (typeof property == \"undefined\") {\r\n    return object;\r\n  }\r\n\r\n  if (typeof property == \"number\") {\r\n    return object[property];\r\n  }\r\n\r\n  try {\r\n    return traverse(object, property, function _getNestedProperty(currentObject, currentProperty) {\r\n      return currentObject[currentProperty];\r\n    });\r\n  } catch (err) {\r\n    return object;\r\n  }\r\n}\r\n/**\r\n * Tell if a nested object has a given property (or array a given index)\r\n * given an object such as a.b.c.d = 5, hasNestedProperty(a, \"b.c.d\") will return true.\r\n * It also returns true if the property is in the prototype chain.\r\n * @param {Object} object the object to get the property from\r\n * @param {String} property the path to the property as a string\r\n * @param {Object} options:\r\n *  - own: set to reject properties from the prototype\r\n * @returns true if has (property in object), false otherwise\r\n */\r\n\r\n\r\nfunction hasNestedProperty(object, property) {\r\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\r\n\r\n  if (_typeof(object) != \"object\" || object === null) {\r\n    return false;\r\n  }\r\n\r\n  if (typeof property == \"undefined\") {\r\n    return false;\r\n  }\r\n\r\n  if (typeof property == \"number\") {\r\n    return property in object;\r\n  }\r\n\r\n  try {\r\n    var has = false;\r\n    traverse(object, property, function _hasNestedProperty(currentObject, currentProperty, segments, index) {\r\n      if (isLastSegment(segments, index)) {\r\n        if (options.own) {\r\n          has = currentObject.hasOwnProperty(currentProperty);\r\n        } else {\r\n          has = currentProperty in currentObject;\r\n        }\r\n      } else {\r\n        return currentObject && currentObject[currentProperty];\r\n      }\r\n    });\r\n    return has;\r\n  } catch (err) {\r\n    return false;\r\n  }\r\n}\r\n/**\r\n * Set the property of an object nested in one or more objects\r\n * If the property doesn't exist, it gets created.\r\n * @param {Object} object\r\n * @param {String} property\r\n * @param value the value to set\r\n * @returns object if no assignment was made or the value if the assignment was made\r\n */\r\n\r\n\r\nfunction setNestedProperty(object, property, value) {\r\n  if (_typeof(object) != \"object\" || object === null) {\r\n    return object;\r\n  }\r\n\r\n  if (typeof property == \"undefined\") {\r\n    return object;\r\n  }\r\n\r\n  if (typeof property == \"number\") {\r\n    object[property] = value;\r\n    return object[property];\r\n  }\r\n\r\n  try {\r\n    return traverse(object, property, function _setNestedProperty(currentObject, currentProperty, segments, index) {\r\n      if (currentObject === Reflect.getPrototypeOf({})) {\r\n        throw new ObjectPrototypeMutationError(\"Attempting to mutate Object.prototype\");\r\n      }\r\n\r\n      if (!currentObject[currentProperty]) {\r\n        var nextPropIsNumber = Number.isInteger(Number(segments[index + 1]));\r\n        var nextPropIsArrayWildcard = segments[index + 1] === ARRAY_WILDCARD;\r\n\r\n        if (nextPropIsNumber || nextPropIsArrayWildcard) {\r\n          currentObject[currentProperty] = [];\r\n        } else {\r\n          currentObject[currentProperty] = {};\r\n        }\r\n      }\r\n\r\n      if (isLastSegment(segments, index)) {\r\n        currentObject[currentProperty] = value;\r\n      }\r\n\r\n      return currentObject[currentProperty];\r\n    });\r\n  } catch (err) {\r\n    if (err instanceof ObjectPrototypeMutationError) {\r\n      // rethrow\r\n      throw err;\r\n    } else {\r\n      return object;\r\n    }\r\n  }\r\n}\r\n/**\r\n * Tell if an object is on the path to a nested property\r\n * If the object is on the path, and the path exists, it returns true, and false otherwise.\r\n * @param {Object} object to get the nested property from\r\n * @param {String} property name of the nested property\r\n * @param {Object} objectInPath the object to check\r\n * @param {Object} options:\r\n *  - validPath: return false if the path is invalid, even if the object is in the path\r\n * @returns {boolean} true if the object is on the path\r\n */\r\n\r\n\r\nfunction isInNestedProperty(object, property, objectInPath) {\r\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\r\n\r\n  if (_typeof(object) != \"object\" || object === null) {\r\n    return false;\r\n  }\r\n\r\n  if (typeof property == \"undefined\") {\r\n    return false;\r\n  }\r\n\r\n  try {\r\n    var isIn = false,\r\n        pathExists = false;\r\n    traverse(object, property, function _isInNestedProperty(currentObject, currentProperty, segments, index) {\r\n      isIn = isIn || currentObject === objectInPath || !!currentObject && currentObject[currentProperty] === objectInPath;\r\n      pathExists = isLastSegment(segments, index) && _typeof(currentObject) === \"object\" && currentProperty in currentObject;\r\n      return currentObject && currentObject[currentProperty];\r\n    });\r\n\r\n    if (options.validPath) {\r\n      return isIn && pathExists;\r\n    } else {\r\n      return isIn;\r\n    }\r\n  } catch (err) {\r\n    return false;\r\n  }\r\n}\r\n\r\nfunction traverse(object, path) {\r\n  var callback = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function () {};\r\n  var segments = path.split(PATH_DELIMITER);\r\n  var length = segments.length;\r\n\r\n  var _loop = function _loop(idx) {\r\n    var currentSegment = segments[idx];\r\n\r\n    if (!object) {\r\n      return {\r\n        v: void 0\r\n      };\r\n    }\r\n\r\n    if (currentSegment === ARRAY_WILDCARD) {\r\n      if (Array.isArray(object)) {\r\n        return {\r\n          v: object.map(function (value, index) {\r\n            var remainingSegments = segments.slice(idx + 1);\r\n\r\n            if (remainingSegments.length > 0) {\r\n              return traverse(value, remainingSegments.join(PATH_DELIMITER), callback);\r\n            } else {\r\n              return callback(object, index, segments, idx);\r\n            }\r\n          })\r\n        };\r\n      } else {\r\n        var pathToHere = segments.slice(0, idx).join(PATH_DELIMITER);\r\n        throw new Error(\"Object at wildcard (\".concat(pathToHere, \") is not an array\"));\r\n      }\r\n    } else {\r\n      object = callback(object, currentSegment, segments, idx);\r\n    }\r\n  };\r\n\r\n  for (var idx = 0; idx < length; idx++) {\r\n    var _ret = _loop(idx);\r\n\r\n    if (_typeof(_ret) === \"object\") return _ret.v;\r\n  }\r\n\r\n  return object;\r\n}\r\n\r\nfunction isLastSegment(segments, index) {\r\n  return segments.length === index + 1;\r\n}\r\n", null, "import {Notice, Plugin} from 'obsidian';\r\nimport { WebDAVSettingTab } from './WebDAVSettingTab';\r\nimport { WebDAVExplorerView } from './WebDAVExplorerView';\r\nimport {setI18n, i18n, LangPack, Locale} from './i18n';\r\nimport { WebDAVSettings, DEFAULT_SETTINGS, WebDAVServer, VIEW_TYPE_WEBDAV_EXPLORER } from './types';\r\n\r\nexport default class WebDAVPlugin extends Plugin {\r\n\tsettings: WebDAVSettings = DEFAULT_SETTINGS;\r\n\r\n\t// \u83B7\u53D6\u56FD\u9645\u5316\u6587\u672C\r\n\ti18n(): LangPack {\r\n\t\treturn i18n();\r\n\t}\r\n\r\n\tasync onload() {\r\n\t\tawait this.loadSettings();\r\n\r\n\t\t// \u521D\u59CB\u5316\u8BED\u8A00\u8BBE\u7F6E\r\n\t\tconst locale = this.getLocale();\r\n\t\tsetI18n(locale);\r\n\r\n\t\tthis.addStyle(); // \u6DFB\u52A0CSS\u6837\u5F0F\r\n\r\n\t\t// \u6CE8\u518C\u89C6\u56FE\r\n\t\tthis.registerView(\r\n\t\t\tVIEW_TYPE_WEBDAV_EXPLORER,\r\n\t\t\t(leaf) => new WebDAVExplorerView(leaf, this),\r\n\t\t);\r\n\r\n\t\t// \u6DFB\u52A0\u8BBE\u7F6E\u9762\u677F\r\n\t\tthis.addSettingTab(new WebDAVSettingTab(this.app, this));\r\n\r\n\t\t// \u6DFB\u52A0ribbon\u56FE\u6807\r\n\t\tthis.addRibbonIcon('cloud', 'WebDAV Explorer', () => {\r\n\t\t\tthis.activateView();\r\n\t\t});\r\n\r\n\t\tthis.registerDragAndDrop();\r\n\r\n\t\t// \u5982\u679C\u6709\u9ED8\u8BA4\u670D\u52A1\u5668\uFF0C\u81EA\u52A8\u6253\u5F00\u89C6\u56FE\r\n\t\tif (this.getDefaultServer()) {\r\n\t\t\tsetTimeout(() => this.activateView(), 300);\r\n\t\t}\r\n\t}\r\n\r\n\t// \u83B7\u53D6\u5F53\u524D\u670D\u52A1\u5668\r\n\tgetCurrentServer(): WebDAVServer | null {\r\n\t\tconst {servers, currentServerId} = this.settings;\r\n\r\n\t\t// \u4F18\u5148\u4F7F\u7528\u5F53\u524D\u9009\u4E2D\u7684\u670D\u52A1\u5668\r\n\t\tif (currentServerId) {\r\n\t\t\tconst server = servers.find(s => s.id === currentServerId);\r\n\t\t\tif (server) return server;\r\n\t\t}\r\n\r\n\t\treturn this.getDefaultServer();\r\n\t}\r\n\r\n\t// \u83B7\u53D6\u9ED8\u8BA4\u670D\u52A1\u5668\r\n\tgetDefaultServer(): WebDAVServer | null {\r\n\t\tconst {servers} = this.settings;\r\n\r\n\t\t// \u9996\u5148\u67E5\u627E\u6807\u8BB0\u4E3A\u9ED8\u8BA4\u7684\u670D\u52A1\u5668\r\n\t\tconst defaultServer = servers.find(s => s.isDefault);\r\n\t\tif (defaultServer) return defaultServer;\r\n\r\n\t\t// \u5982\u679C\u6CA1\u6709\u9ED8\u8BA4\u670D\u52A1\u5668\uFF0C\u8FD4\u56DE\u7B2C\u4E00\u4E2A\r\n\t\treturn servers.length > 0 ? servers[0] : null;\r\n\t}\r\n\r\n\t// \u83B7\u53D6\u6240\u6709\u670D\u52A1\u5668\r\n\tgetServers(): WebDAVServer[] {\r\n\t\treturn this.settings.servers;\r\n\t}\r\n\r\n\t// \u6839\u636EID\u83B7\u53D6\u670D\u52A1\u5668\r\n\tgetServerById(id: string): WebDAVServer | null {\r\n\t\treturn this.settings.servers.find(s => s.id === id) || null;\r\n\t}\r\n\r\n\t// \u6FC0\u6D3B\u89C6\u56FE\r\n\tasync activateView() {\r\n\t\tconst {workspace} = this.app;\r\n\t\tconst t = this.i18n();\r\n\r\n\t\t// \u603B\u662F\u4F7F\u7528\u9ED8\u8BA4\u670D\u52A1\u5668\uFF0C\u5FFD\u7565\u5F53\u524D\u9009\u4E2D\u7684\u670D\u52A1\u5668\r\n\t\tconst defaultServer = this.getDefaultServer();\r\n\t\tif (!defaultServer) {\r\n\t\t\tnew Notice(t.settings.serverListEmpty);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// \u8BBE\u7F6E\u5F53\u524D\u670D\u52A1\u5668\u4E3A\u9ED8\u8BA4\u670D\u52A1\u5668\r\n\t\tthis.settings.currentServerId = defaultServer.id;\r\n\t\tawait this.saveSettings();\r\n\r\n\t\t// \u67E5\u627E\u5DF2\u5B58\u5728\u7684\u89C6\u56FE\r\n\t\tlet leaf = workspace.getLeavesOfType(VIEW_TYPE_WEBDAV_EXPLORER)[0];\r\n\r\n\t\tif (leaf) {\r\n\t\t\tworkspace.revealLeaf(leaf);\r\n\t\t\t// \u5F3A\u5236\u5237\u65B0\u89C6\u56FE\uFF0C\u4F7F\u7528\u9ED8\u8BA4\u670D\u52A1\u5668\r\n\t\t\tif (leaf.view instanceof WebDAVExplorerView) {\r\n\t\t\t\t// \u5B8C\u5168\u91CD\u65B0\u521D\u59CB\u5316\u89C6\u56FE\r\n\t\t\t\tawait leaf.view.onunload();\r\n\t\t\t\tawait leaf.view.onOpen();\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// \u521B\u5EFA\u65B0\u89C6\u56FE\r\n\t\tconst rightLeaf = workspace.getRightLeaf(false);\r\n\t\tif (rightLeaf) {\r\n\t\t\tawait rightLeaf.setViewState({\r\n\t\t\t\ttype: VIEW_TYPE_WEBDAV_EXPLORER,\r\n\t\t\t\tactive: true,\r\n\t\t\t});\r\n\t\t\tworkspace.revealLeaf(rightLeaf);\r\n\t\t} else {\r\n\t\t\tconst newLeaf = workspace.createLeafBySplit(workspace.getLeaf(), 'vertical');\r\n\t\t\tawait newLeaf.setViewState({\r\n\t\t\t\ttype: VIEW_TYPE_WEBDAV_EXPLORER,\r\n\t\t\t\tactive: true,\r\n\t\t\t});\r\n\t\t\tworkspace.revealLeaf(newLeaf);\r\n\t\t}\r\n\t}\r\n\r\n\t// \u53EF\u9009\uFF1A\u6DFB\u52A0\u4E00\u4E2A\u65B9\u6CD5\u6765\u6FC0\u6D3B\u7279\u5B9A\u670D\u52A1\u5668\u7684\u89C6\u56FE\uFF08\u7528\u4E8E\u5176\u4ED6\u573A\u666F\uFF09\r\n\tasync activateViewWithServer(serverId?: string) {\r\n\t\tconst {workspace} = this.app;\r\n\t\tconst t = this.i18n();\r\n\r\n\t\t// \u8BBE\u7F6E\u5F53\u524D\u670D\u52A1\u5668\r\n\t\tif (serverId) {\r\n\t\t\tthis.settings.currentServerId = serverId;\r\n\t\t\tawait this.saveSettings();\r\n\t\t}\r\n\r\n\t\t// \u68C0\u67E5\u662F\u5426\u6709\u53EF\u7528\u7684\u670D\u52A1\u5668\r\n\t\tconst currentServer = this.getCurrentServer();\r\n\t\tif (!currentServer) {\r\n\t\t\tnew Notice(t.settings.serverListEmpty);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// \u67E5\u627E\u5DF2\u5B58\u5728\u7684\u89C6\u56FE\r\n\t\tlet leaf = workspace.getLeavesOfType(VIEW_TYPE_WEBDAV_EXPLORER)[0];\r\n\r\n\t\tif (leaf) {\r\n\t\t\tworkspace.revealLeaf(leaf);\r\n\t\t\t// \u5F3A\u5236\u5237\u65B0\u89C6\u56FE\uFF0C\u5305\u62EC\u91CD\u65B0\u521D\u59CB\u5316\r\n\t\t\tif (leaf.view instanceof WebDAVExplorerView) {\r\n\t\t\t\t// \u5B8C\u5168\u91CD\u65B0\u521D\u59CB\u5316\u89C6\u56FE\r\n\t\t\t\tawait leaf.view.onunload();\r\n\t\t\t\tawait leaf.view.onOpen();\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// \u521B\u5EFA\u65B0\u89C6\u56FE\r\n\t\tconst rightLeaf = workspace.getRightLeaf(false);\r\n\t\tif (rightLeaf) {\r\n\t\t\tawait rightLeaf.setViewState({\r\n\t\t\t\ttype: VIEW_TYPE_WEBDAV_EXPLORER,\r\n\t\t\t\tactive: true,\r\n\t\t\t});\r\n\t\t\tworkspace.revealLeaf(rightLeaf);\r\n\t\t} else {\r\n\t\t\tconst newLeaf = workspace.createLeafBySplit(workspace.getLeaf(), 'vertical');\r\n\t\t\tawait newLeaf.setViewState({\r\n\t\t\t\ttype: VIEW_TYPE_WEBDAV_EXPLORER,\r\n\t\t\t\tactive: true,\r\n\t\t\t});\r\n\t\t\tworkspace.revealLeaf(newLeaf);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\taddStyle() {\r\n\t\tif (document.getElementById('webdav-explorer-style')) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst style = document.createElement('style');\r\n\t\tstyle.id = 'webdav-explorer-style';\r\n\t\tstyle.textContent = `\r\n\t\t\t/* \u8FDE\u63A5\u5931\u8D25\u63D0\u793A\u6837\u5F0F */\r\n\t\t\t.webdav-connection-failed {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\theight: 100%;\r\n\t\t\t\tgap: 16px;\r\n\t\t\t\tpadding: 20px;\r\n\t\t\t\ttext-align: center;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.webdav-connection-failed p {\r\n\t\t\t\tmargin: 0;\r\n\t\t\t\tcolor: var(--text-muted);\r\n\t\t\t\tfont-size: 1.1em;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.webdav-error-details {\r\n\t\t\t\tfont-size: 0.9em !important;\r\n\t\t\t\tcolor: var(--text-error) !important;\r\n\t\t\t\tword-break: break-word;\r\n\t\t\t\tmax-width: 100%;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t/* \u89C6\u56FE\u5BB9\u5668\u6837\u5F0F */\r\n\t\t\t.webdav-explorer-view {\r\n\t\t\t\theight: 100%;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t/* \u5934\u90E8\u6837\u5F0F */\r\n\t\t\t.webdav-header {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\tgap: 8px;\r\n\t\t\t\tpadding: 10px 0;\r\n\t\t\t\tborder-bottom: 1px solid var(--background-modifier-border);\r\n\t\t\t\tmargin-bottom: 10px;\r\n\t\t\t\tflex-shrink: 0;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t/* \u6807\u9898\u884C\u6837\u5F0F - \u6240\u6709\u6309\u94AE\u9760\u5DE6 */\r\n\t\t\t.webdav-title-row {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: 8px;\r\n\t\t\t\tpadding: 0 8px;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t/* \u7EDF\u4E00\u6309\u94AE\u6837\u5F0F */\r\n\t\t\t.webdav-button {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tpadding: 6px 8px;\r\n\t\t\t\tborder-radius: 4px;\r\n\t\t\t\tcursor: pointer;\r\n\t\t\t\ttransition: all 0.15s ease;\r\n\t\t\t\tcolor: var(--text-muted);\r\n\t\t\t\tborder: 1px solid var(--background-modifier-border);\r\n\t\t\t\tbackground-color: var(--background-primary);\r\n\t\t\t\tuser-select: none;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.webdav-button:hover {\r\n\t\t\t\tbackground-color: var(--background-modifier-hover);\r\n\t\t\t\tcolor: var(--text-normal);\r\n\t\t\t\tborder-color: var(--background-modifier-border-hover);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t/* \u6309\u94AE\u5185\u5BB9\u5BB9\u5668\u6837\u5F0F */\r\n\t\t\t.webdav-button-content {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: 4px;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t/* \u6309\u94AE\u56FE\u6807\u6837\u5F0F */\r\n\t\t\t.webdav-server-icon,\r\n\t\t\t.webdav-refresh-icon,\r\n\t\t\t.webdav-sort-icon {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\twidth: 16px;\r\n\t\t\t\theight: 16px;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t/* \u6309\u94AE\u6587\u5B57\u6837\u5F0F */\r\n\t\t\t.webdav-button-text {\r\n\t\t\t\tfont-size: 0.8em;\r\n\t\t\t\tcolor: var(--text-muted);\r\n\t\t\t\twhite-space: nowrap;\r\n\t\t\t\tfont-weight: 500;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.webdav-button:hover .webdav-button-text {\r\n\t\t\t\tcolor: var(--text-normal);\r\n\t\t\t}\r\n\t\t\t/* \u6309\u94AE\u5185\u5BB9\u5BB9\u5668\u6837\u5F0F */\r\n\t\t\t.webdav-button-content {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: 4px;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t/* \u6309\u94AE\u56FE\u6807\u6837\u5F0F */\r\n\t\t\t.webdav-server-icon,\r\n\t\t\t.webdav-refresh-icon,\r\n\t\t\t.webdav-sort-icon {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\twidth: 16px;\r\n\t\t\t\theight: 16px;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t/* \u6309\u94AE\u6587\u5B57\u6837\u5F0F */\r\n\t\t\t.webdav-button-text {\r\n\t\t\t\tfont-size: 0.8em;\r\n\t\t\t\tcolor: var(--text-muted);\r\n\t\t\t\twhite-space: nowrap;\r\n\t\t\t\tfont-weight: 500;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.webdav-server-button:hover .webdav-button-text,\r\n\t\t\t.webdav-refresh-button:hover .webdav-button-text,\r\n\t\t\t.webdav-sort-button:hover .webdav-button-text {\r\n\t\t\t\tcolor: var(--text-normal);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t/* \u64CD\u4F5C\u6309\u94AE\u5BB9\u5668\u6837\u5F0F */\r\n\t\t\t.webdav-actions-container {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: 8px;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t/* \u663E\u793A\u540D\u79F0\u6837\u5F0F */\r\n\t\t\t.webdav-display-name {\r\n\t\t\t\tfont-size: 0.9em;\r\n\t\t\t\tfont-weight: 600;\r\n\t\t\t\tcolor: var(--text-normal);\r\n\t\t\t\twhite-space: nowrap;\r\n\t\t\t\tmargin-left: 8px;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t/* \u9762\u5305\u5C51\u5BFC\u822A\u6837\u5F0F */\r\n\t\t\t.webdav-breadcrumb-container {\r\n\t\t\t\tpadding: 0 8px;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.webdav-breadcrumb {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tflex-wrap: wrap;\r\n\t\t\t\tgap: 4px;\r\n\t\t\t\tfont-size: 0.9em;\r\n\t\t\t\tcolor: var(--text-muted);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.breadcrumb-item {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t.breadcrumb-item a {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\ttext-decoration: none;\r\n\t\t\t\tcolor: var(--text-muted);\r\n\t\t\t\tpadding: 2px 6px;\r\n\t\t\t\tborder-radius: 3px;\r\n\t\t\t\ttransition: all 0.15s ease;\r\n\t\t\t\tcursor: pointer;\r\n\t\t\t\tmax-width: 120px;\r\n\t\t\t\toverflow: hidden;\r\n\t\t\t\ttext-overflow: ellipsis;\r\n\t\t\t\twhite-space: nowrap;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.breadcrumb-item a:hover {\r\n\t\t\t\tbackground-color: var(--background-modifier-hover);\r\n\t\t\t\tcolor: var(--text-normal);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.breadcrumb-current {\r\n\t\t\t\tcolor: var(--text-normal) !important;\r\n\t\t\t\tfont-weight: 500;\r\n\t\t\t\tcursor: default !important;\r\n\t\t\t\tbackground: none !important;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.breadcrumb-separator {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tcolor: var(--text-faint);\r\n\t\t\t\tuser-select: none;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.breadcrumb-separator svg {\r\n\t\t\t\twidth: 14px;\r\n\t\t\t\theight: 14px;\r\n\t\t\t\topacity: 0.5;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t/* \u6587\u4EF6\u5217\u8868\u5BB9\u5668\u6837\u5F0F */\r\n\t\t\t.file-list-container {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\toverflow: hidden;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.file-list {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\toverflow-y: auto;\r\n\t\t\t\toverflow-x: hidden;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t/* \u6587\u4EF6\u9879\u6837\u5F0F */\r\n\t\t\t.file-item {\r\n\t\t\t\tpadding: 8px 12px;\r\n\t\t\t\tmargin: 2px 0;\r\n\t\t\t\tcursor: pointer;\r\n\t\t\t\ttransition: all 0.15s ease;\r\n\t\t\t\tuser-select: none;\r\n\t\t\t\tborder-radius: 6px;\r\n\t\t\t\tborder: 1px solid transparent;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: 8px;\r\n\t\t\t\tmin-height: 28px;\r\n\t\t\t\tbox-sizing: border-box;\r\n\t\t\t}\r\n\t\t\r\n\t\t\t.file-item.folder .file-name {\r\n\t\t\t\tcolor: var(--text-normal);\r\n\t\t\t\tfont-weight: 500;\r\n\t\t\t}\r\n\t\t\r\n\t\t\t.file-item.file .file-name {\r\n\t\t\t\tcolor: var(--text-muted);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.file-item.selected .file-name {\r\n\t\t\t\tcolor: var(--text-on-accent) !important;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.file-icon {\r\n\t\t\t\twidth: 16px;\r\n\t\t\t\theight: 16px;\r\n\t\t\t\tflex-shrink: 0;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.file-name {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tmin-width: 0;\r\n\t\t\t\toverflow: hidden;\r\n\t\t\t\ttext-overflow: ellipsis;\r\n\t\t\t\twhite-space: nowrap;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.file-item.selected {\r\n\t\t\t\tbackground-color: var(--interactive-accent);\r\n\t\t\t\tcolor: var(--text-on-accent);\r\n\t\t\t\tborder-radius: 4px;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.file-item:hover:not(.selected) {\r\n\t\t\t\tbackground-color: var(--background-modifier-hover);\r\n\t\t\t\tborder-radius: 4px;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.file-item.empty {\r\n\t\t\t\tcolor: var(--text-muted);\r\n\t\t\t\tfont-style: italic;\r\n\t\t\t\tcursor: default;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.file-item.error {\r\n\t\t\t\tcolor: var(--text-error);\r\n\t\t\t\tcursor: default;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.file-item.loading {\r\n\t\t\t\tcolor: var(--text-muted);\r\n\t\t\t\tfont-style: italic;\r\n\t\t\t\tcursor: default;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t/* \u6EDA\u52A8\u6761\u6837\u5F0F */\r\n\t\t\t.file-list::-webkit-scrollbar {\r\n\t\t\t\twidth: 8px;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.file-list::-webkit-scrollbar-track {\r\n\t\t\t\tbackground: var(--background-primary);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.file-list::-webkit-scrollbar-thumb {\r\n\t\t\t\tbackground: var(--background-modifier-border);\r\n\t\t\t\tborder-radius: 4px;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.file-list::-webkit-scrollbar-thumb:hover {\r\n\t\t\t\tbackground: var(--background-modifier-border-hover);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t/* \u65E0\u670D\u52A1\u5668\u914D\u7F6E\u63D0\u793A\u6837\u5F0F */\r\n\t\t\t.webdav-no-servers {\r\n\t\t\t\ttext-align: center;\r\n\t\t\t\tcolor: var(--text-muted);\r\n\t\t\t\tfont-style: italic;\r\n\t\t\t\tpadding: 20px;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.webdav-no-server {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\theight: 100%;\r\n\t\t\t\tgap: 16px;\r\n\t\t\t\tpadding: 20px;\r\n\t\t\t\ttext-align: center;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.webdav-no-server p {\r\n\t\t\t\tmargin: 0;\r\n\t\t\t\tcolor: var(--text-muted);\r\n\t\t\t\tfont-size: 1.1em;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t/* \u8BBE\u7F6E\u9762\u677F\u6837\u5F0F */\r\n\t\t\t.webdav-no-servers {\r\n\t\t\t\ttext-align: center;\r\n\t\t\t\tcolor: var(--text-muted);\r\n\t\t\t\tfont-style: italic;\r\n\t\t\t\tpadding: 20px;\r\n\t\t\t\tborder: 1px dashed var(--background-modifier-border);\r\n\t\t\t\tborder-radius: 8px;\r\n\t\t\t\tmargin: 10px 0;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t/* \u70B9\u51FB\u56FE\u6807\u901A\u7528\u6837\u5F0F */\r\n\t\t\t.clickable-icon {\r\n\t\t\t\tcursor: pointer;\r\n\t\t\t\ttransition: all 0.15s ease;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.clickable-icon:hover {\r\n\t\t\t\ttransform: scale(1.02);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.clickable-icon:active {\r\n\t\t\t\ttransform: scale(0.98);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t/* \u54CD\u5E94\u5F0F\u8BBE\u8BA1 */\r\n\t\t\t@media (max-width: 400px) {\r\n\t\t\t\t.webdav-title-row {\r\n\t\t\t\t\tflex-wrap: wrap;\r\n\t\t\t\t\tgap: 6px;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t.webdav-button-text {\r\n\t\t\t\t\tdisplay: none;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t.webdav-actions-container {\r\n\t\t\t\t\tgap: 4px;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t.webdav-server-button,\r\n\t\t\t\t.webdav-refresh-button,\r\n\t\t\t\t.webdav-sort-button {\r\n\t\t\t\t\tpadding: 4px 6px;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t/* \u5C0F\u5C4F\u5E55\u9002\u914D */\r\n\t\t\t@media (max-width: 300px) {\r\n\t\t\t\t.webdav-title-row {\r\n\t\t\t\t\tjustify-content: space-between;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t.webdav-server-button {\r\n\t\t\t\t\tflex: 1;\r\n\t\t\t\t\tmin-width: 0;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t.webdav-actions-container {\r\n\t\t\t\t\tmargin-left: 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n    `;\r\n\t\tdocument.head.appendChild(style);\r\n\t}\r\n\r\n\t// \u6CE8\u518C\u62D6\u62FD\u529F\u80FD\uFF08\u7A7A\u5B9E\u73B0\uFF09\r\n\tregisterDragAndDrop() {\r\n\t\t// \u7A7A\u5B9E\u73B0\r\n\t}\r\n\r\n\t// \u63D2\u4EF6\u5378\u8F7D\u6E05\u7406\r\n\tasync onunload() {\r\n\t\tconst leaves = this.app.workspace.getLeavesOfType(VIEW_TYPE_WEBDAV_EXPLORER);\r\n\r\n\t\t// \u5378\u8F7D\u6240\u6709\u89C6\u56FE\r\n\t\tfor (const leaf of leaves) {\r\n\t\t\tif (leaf.view && typeof leaf.view.onunload === 'function') {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tawait leaf.view.onunload();\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tconsole.error('Error unloading view:', e);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tleaf.detach();\r\n\t\t}\r\n\r\n\t\t// \u79FB\u9664\u6837\u5F0F\r\n\t\tconst style = document.getElementById('webdav-explorer-style');\r\n\t\tif (style) {\r\n\t\t\tstyle.remove();\r\n\t\t}\r\n\r\n\t\t// \u91CD\u7F6E\u8BBE\u7F6E\r\n\t\tthis.settings = DEFAULT_SETTINGS;\r\n\t}\r\n\r\n\t// \u52A0\u8F7D\u8BBE\u7F6E\r\n\tasync loadSettings() {\r\n\t\tconst data = await this.loadData();\r\n\t\tthis.settings = {...DEFAULT_SETTINGS, ...data}; // \u5408\u5E76\u9ED8\u8BA4\u8BBE\u7F6E\r\n\t}\r\n\r\n\t// \u4FDD\u5B58\u8BBE\u7F6E\r\n\tasync saveSettings() {\r\n\t\tawait this.saveData(this.settings);\r\n\t}\r\n\r\n\t// \u83B7\u53D6\u8BED\u8A00\u8BBE\u7F6E\r\n\tprivate getLocale(): Locale {\r\n\t\ttry {\r\n\t\t\tconst language = localStorage.getItem('language');\r\n\t\t\treturn language?.startsWith('zh') ? 'zh' : 'en'; // \u4E2D\u6587\u6216\u82F1\u6587\r\n\t\t} catch (e) {\r\n\t\t\treturn 'en';\r\n\t\t}\r\n\t}\r\n}\r\n\r\n", "import { App, PluginSettingTab, Setting, Notice } from 'obsidian';\r\nimport  WebDAVPlugin from './main';\r\nimport { WebDAVServer } from './types';\r\n\r\nexport class WebDAVSettingTab extends PluginSettingTab {\r\n  plugin: WebDAVPlugin;\r\n  private defaultServerDropdown: any = null;\r\n\r\n  constructor(app: App, plugin: WebDAVPlugin) {\r\n    super(app, plugin);\r\n    this.plugin = plugin;\r\n  }\r\n\r\n  display(): void {\r\n    const { containerEl } = this;\r\n    const { i18n } = this.plugin;\r\n    const t = i18n();\r\n\r\n    containerEl.empty();\r\n    containerEl.createEl('h2', { text: t.settings.title });\r\n\r\n    // \u9ED8\u8BA4\u670D\u52A1\u5668\u8BBE\u7F6E\r\n    const defaultServerSetting = new Setting(containerEl)\r\n      .setName(t.settings.defaultServer)\r\n      .setDesc(t.settings.defaultServerDesc);\r\n\r\n    defaultServerSetting.addDropdown(dropdown => {\r\n      this.defaultServerDropdown = dropdown;\r\n      dropdown.selectEl.style.minWidth = '150px';\r\n      this.updateDefaultServerDropdown();\r\n\r\n      dropdown.onChange(async (value: string) => {\r\n        if (value && this.plugin.settings.servers.length > 0) {\r\n          this.plugin.settings.servers.forEach(s => {\r\n            s.isDefault = s.id === value;\r\n          });\r\n          this.plugin.settings.currentServerId = value;\r\n          await this.plugin.saveSettings();\r\n          this.display();\r\n        }\r\n      });\r\n    });\r\n\r\n    containerEl.createEl('hr');\r\n\r\n    // \u670D\u52A1\u5668\u5217\u8868\u6807\u9898\u548C\u6DFB\u52A0\u6309\u94AE\r\n    const serversHeader = containerEl.createEl('div', { cls: 'webdav-servers-header' });\r\n    serversHeader.createEl('h3', { text: t.settings.serverList });\r\n\r\n    // \u6DFB\u52A0\u670D\u52A1\u5668\u6309\u94AE\r\n    const addServerSetting = new Setting(serversHeader)\r\n      .setName(t.settings.addServer)\r\n      .addButton(button => {\r\n        button\r\n          .setButtonText('+')\r\n          .setCta()\r\n          .onClick(async () => {\r\n            const newServer: WebDAVServer = {\r\n              id: this.generateId(),\r\n              name: `WebDAV Server ${this.plugin.settings.servers.length + 1}`,\r\n              url: '',\r\n              username: '',\r\n              password: '',\r\n              remoteDir: '',\r\n              isDefault: this.plugin.settings.servers.length === 0\r\n            };\r\n            this.plugin.settings.servers.push(newServer);\r\n\r\n            if (this.plugin.settings.servers.length === 1) {\r\n              newServer.isDefault = true;\r\n              this.plugin.settings.currentServerId = newServer.id;\r\n            }\r\n\r\n            await this.plugin.saveSettings();\r\n            this.display();\r\n          });\r\n      });\r\n\r\n    // \u670D\u52A1\u5668\u5217\u8868\u5BB9\u5668\r\n    const serversContainer = containerEl.createEl('div', { cls: 'webdav-servers-container' });\r\n\r\n    // \u5982\u679C\u6CA1\u6709\u670D\u52A1\u5668\uFF0C\u663E\u793A\u63D0\u793A\r\n    if (this.plugin.settings.servers.length === 0) {\r\n      serversContainer.createEl('p', {\r\n        text: t.settings.noServers,\r\n        cls: 'webdav-no-servers'\r\n      });\r\n      return;\r\n    }\r\n\r\n    // \u663E\u793A\u6240\u6709\u670D\u52A1\u5668\u914D\u7F6E\r\n    this.plugin.settings.servers.forEach((server, index) => {\r\n      // \u521B\u5EFA\u670D\u52A1\u5668\u6807\u9898\u548C\u5220\u9664\u6309\u94AE\r\n      const serverSetting = new Setting(serversContainer)\r\n        .setName(server.name)\r\n        .setDesc(this.getServerDescription(server))\r\n        .addButton(button => {\r\n          button\r\n            .setIcon('trash-2')\r\n            .setTooltip(t.settings.deleteServer)\r\n            .onClick(async () => {\r\n              if (this.plugin.settings.servers.length === 1) {\r\n                new Notice(t.settings.deleteNotice);\r\n                return;\r\n              }\r\n\r\n              const isDeletingDefault = server.isDefault;\r\n              this.plugin.settings.servers.splice(index, 1);\r\n\r\n              if (isDeletingDefault) {\r\n                const newDefault = this.plugin.settings.servers[0];\r\n                newDefault.isDefault = true;\r\n                this.plugin.settings.currentServerId = newDefault.id;\r\n              }\r\n\r\n              await this.plugin.saveSettings();\r\n              this.display();\r\n            });\r\n        });\r\n\r\n      // \u670D\u52A1\u5668\u540D\u79F0\u8F93\u5165\u6846\r\n      serverSetting.addText(text => {\r\n        text\r\n          .setPlaceholder(t.settings.serverName)\r\n          .setValue(server.name)\r\n          .onChange(async (value: string) => {\r\n            server.name = value.trim();\r\n            await this.plugin.saveSettings();\r\n            serverSetting.setName(server.name);\r\n            serverSetting.setDesc(this.getServerDescription(server));\r\n            this.updateDefaultServerDropdown();\r\n          });\r\n      });\r\n\r\n      // URL\u914D\u7F6E\r\n      new Setting(serversContainer)\r\n        .setName(t.settings.url.name)\r\n        .setDesc(t.settings.url.desc)\r\n        .addText(text => {\r\n          text\r\n            .setPlaceholder('http://192.168.0.1:8888/dav')\r\n            .setValue(server.url)\r\n            .onChange(async (value: string) => {\r\n              server.url = value.trim();\r\n              await this.plugin.saveSettings();\r\n              serverSetting.setDesc(this.getServerDescription(server));\r\n            });\r\n        });\r\n\r\n      // \u7528\u6237\u540D\u914D\u7F6E\r\n      new Setting(serversContainer)\r\n        .setName(t.settings.username)\r\n        .addText(text => {\r\n          text\r\n            .setPlaceholder(t.settings.username)\r\n            .setValue(server.username)\r\n            .onChange(async (value: string) => {\r\n              server.username = value.trim();\r\n              await this.plugin.saveSettings();\r\n            });\r\n        });\r\n\r\n      // \u5BC6\u7801\u914D\u7F6E\r\n      new Setting(serversContainer)\r\n        .setName(t.settings.password)\r\n        .addText(text => {\r\n          text\r\n            .setPlaceholder(t.settings.password)\r\n            .setValue(server.password)\r\n          text.inputEl.type = 'password';\r\n          text.onChange(async (value: string) => {\r\n            server.password = value;\r\n            await this.plugin.saveSettings();\r\n          });\r\n        });\r\n\r\n      // \u8FDC\u7A0B\u76EE\u5F55\u914D\u7F6E\r\n      new Setting(serversContainer)\r\n        .setName(t.settings.remoteDir.name)\r\n        .setDesc(t.settings.remoteDir.desc)\r\n        .addText(text => {\r\n          text\r\n            .setPlaceholder('/')\r\n            .setValue(server.remoteDir)\r\n            .onChange(async (value: string) => {\r\n              server.remoteDir = value.trim();\r\n              await this.plugin.saveSettings();\r\n              serverSetting.setDesc(this.getServerDescription(server));\r\n            });\r\n        });\r\n\r\n      // \u5206\u9694\u7EBF\r\n      if (index < this.plugin.settings.servers.length - 1) {\r\n        serversContainer.createEl('hr');\r\n      }\r\n    });\r\n  }\r\n\r\n  private updateDefaultServerDropdown() {\r\n    if (!this.defaultServerDropdown) return;\r\n    const currentValue = this.defaultServerDropdown.getValue();\r\n    this.defaultServerDropdown.selectEl.empty();\r\n\r\n    this.plugin.settings.servers.forEach(server => {\r\n      this.defaultServerDropdown.addOption(server.id, server.name);\r\n    });\r\n\r\n    if (currentValue && this.plugin.settings.servers.some(s => s.id === currentValue)) {\r\n      this.defaultServerDropdown.setValue(currentValue);\r\n    } else if (this.plugin.settings.servers.length > 0) {\r\n      const defaultServer = this.plugin.settings.servers.find(s => s.isDefault) || this.plugin.settings.servers[0];\r\n      this.defaultServerDropdown.setValue(defaultServer.id);\r\n    }\r\n  }\r\n\r\n  private getServerDescription(server: WebDAVServer): string {\r\n    const parts = [];\r\n    parts.push(`ID: ${server.id}`);\r\n    if (server.remoteDir && server.remoteDir !== '/') {\r\n      parts.push(`Dir: ${server.remoteDir}`);\r\n    }\r\n    if (server.isDefault) {\r\n      parts.push('(Default)');\r\n    }\r\n    return parts.length > 0 ? parts.join(' | ') : 'No remote directory configured';\r\n  }\r\n\r\n  private generateId(): string {\r\n    return 'server_' + Date.now() + '_' + Math.random().toString(36).slice(2, 11);\r\n  }\r\n}\r\n", "import { WorkspaceLeaf, View, Notice, Menu, MarkdownView, setIcon } from 'obsidian';\r\nimport WebDAVPlugin from './main';\r\nimport { WebDAVServer, WebDAVFile, VIEW_TYPE_WEBDAV_EXPLORER } from './types'; // \u6DFB\u52A0 VIEW_TYPE_WEBDAV_EXPLORER\r\nimport { WebDAVClient } from './WebDAVClient';\r\nimport { FileUtils } from './fileUtils';\r\nimport { DomUtils } from './domUtils';\r\nimport { createClient } from \"webdav\";\r\n\r\n\r\nexport class WebDAVExplorerView extends View {\r\n\tplugin: WebDAVPlugin;\r\n\tclient: any = null;\r\n\tcurrentPath: string = '/';\r\n\tselectedItem: HTMLElement | null = null;\r\n\trootPath: string = '/';\r\n\tcurrentServer: WebDAVServer | null = null;\r\n\r\n\t// DOM\u5143\u7D20\u5F15\u7528\r\n\tprivate serverSelector: HTMLElement | null = null;\r\n\tprivate serverNameEl: HTMLElement | null = null;\r\n\tprivate serverIconEl: HTMLElement | null = null;\r\n\r\n\t// \u6392\u5E8F\u76F8\u5173\u5C5E\u6027\r\n\tprivate sortField: 'name' | 'type' | 'size' | 'date' = 'name';\r\n\tprivate sortOrder: 'asc' | 'desc' = 'asc';\r\n\tprivate sortButton: HTMLElement | null = null;\r\n\tprivate sortIconEl: HTMLElement | null = null;\r\n\tprivate isConnectionFailed: boolean = false;\r\n\tprivate refreshDebounceTimer: number | null = null;\r\n\r\n\tconstructor(leaf: WorkspaceLeaf, plugin: WebDAVPlugin) {\r\n\t\tsuper(leaf);\r\n\t\tthis.plugin = plugin;\r\n\t\tthis.currentServer = plugin.getCurrentServer();\r\n\t}\r\n\r\n\tgetViewType(): string {\r\n\t\treturn VIEW_TYPE_WEBDAV_EXPLORER;\r\n\t}\r\n\r\n\tgetDisplayText(): string {\r\n\t\treturn this.plugin.i18n().displayName;\r\n\t}\r\n\r\n\tgetIcon(): string {\r\n\t\treturn 'cloud'; // \u4F7F\u7528\u4E91\u56FE\u6807\r\n\t}\r\n\r\n\tasync onOpen() {\r\n\t\tthis.containerEl.empty();\r\n\t\tthis.containerEl.addClass('webdav-explorer-view');\r\n\r\n\t\t// \u91CD\u7F6E\u8FDE\u63A5\u72B6\u6001\r\n\t\tthis.isConnectionFailed = false;\r\n\r\n\t\t// \u66F4\u65B0\u5F53\u524D\u670D\u52A1\u5668\r\n\t\tthis.currentServer = this.plugin.getCurrentServer();\r\n\r\n\t\tif (!this.currentServer) {\r\n\t\t\tthis.showNoServerConfigured();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// \u8FDE\u63A5\u670D\u52A1\u5668\u5E76\u5217\u51FA\u6587\u4EF6\r\n\t\tawait this.connectAndList();\r\n\t}\r\n\r\n\r\n// \u8FDE\u63A5\u670D\u52A1\u5668\u5E76\u5217\u51FA\u76EE\u5F55\r\n\r\n// \u8FDE\u63A5\u670D\u52A1\u5668\u5E76\u5217\u51FA\u76EE\u5F55\r\n\tasync connectAndList() {\r\n\t\tif (!this.currentServer) {\r\n\t\t\tthis.showNoServerConfigured();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst {url, username, password} = this.currentServer;\r\n\t\tconst t = this.plugin.i18n();\r\n\r\n\t\t// \u68C0\u67E5\u5FC5\u8981\u914D\u7F6E\r\n\t\tif (!url || !username || !password) {\r\n\t\t\tthis.showNoServerConfigured();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\t// \u91CD\u7F6E\u8FDE\u63A5\u72B6\u6001\r\n\t\t\tthis.isConnectionFailed = false;\r\n\r\n\t\t\tconst success = await this.initializeClient();\r\n\t\t\tif (success) {\r\n\t\t\t\t// \u8FDE\u63A5\u6210\u529F\uFF0C\u6784\u5EFA\u6B63\u5E38\u89C6\u56FE\r\n\t\t\t\tthis.buildNormalView();\r\n\t\t\t\tawait this.listDirectory(this.currentPath);\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error('Failed to initialize WebDAV client');\r\n\t\t\t}\r\n\t\t} catch (err: any) {\r\n\t\t\tconst msg = err.message || String(err);\r\n\t\t\tnew Notice(`\u274C ${t.view.connectionFailed}: ${msg.substring(0, 100)}...`);\r\n\r\n\t\t\t// \u8BBE\u7F6E\u8FDE\u63A5\u5931\u8D25\u72B6\u6001\r\n\t\t\tthis.isConnectionFailed = true;\r\n\r\n\t\t\t// \u663E\u793A\u8FDE\u63A5\u5931\u8D25\u754C\u9762\uFF0C\u4F46\u4FDD\u7559\u89C6\u56FE\u7ED3\u6784\r\n\t\t\tthis.showConnectionFailed(msg);\r\n\t\t}\r\n\t}\r\n\r\n\t// \u83B7\u53D6\u6839\u8DEF\u5F84\uFF08\u57FA\u4E8E\u670D\u52A1\u5668\u914D\u7F6E\uFF09\r\n\tgetRootPath(): string {\r\n\t\tif (!this.currentServer) return '/';\r\n\r\n\t\tconst raw = this.currentServer.remoteDir.trim();\r\n\t\t// \u5904\u7406\u8DEF\u5F84\u683C\u5F0F\uFF1A\u53BB\u9664\u591A\u4F59\u659C\u6760\uFF0C\u786E\u4FDD\u6B63\u786E\u683C\u5F0F\r\n\t\treturn raw === '' || raw === '/' ? '/' : '/' + raw.replace(/^\\/+/, '').replace(/\\/+$/, '');\r\n\t}\r\n\r\n\t// \u521B\u5EFA\u9762\u5305\u5C51\u5BFC\u822A\r\n\tcreateBreadcrumb(path: string) {\r\n\t\tconst breadcrumbContainer = this.containerEl.querySelector('.webdav-breadcrumb-container');\r\n\t\tif (!breadcrumbContainer) return;\r\n\r\n\t\tbreadcrumbContainer.empty();\r\n\t\tconst breadcrumbEl = breadcrumbContainer.createEl('div', {cls: 'webdav-breadcrumb'});\r\n\r\n\t\tconst rootPath = this.rootPath;\r\n\r\n\t\t// \u786E\u4FDD\u5F53\u524D\u8DEF\u5F84\u4EE5\u6839\u8DEF\u5F84\u5F00\u5934\r\n\t\tlet currentFullPath = path;\r\n\t\tif (!currentFullPath.startsWith(rootPath)) {\r\n\t\t\tcurrentFullPath = rootPath + (rootPath.endsWith('/') ? '' : '/') + path.replace(/^\\//, '');\r\n\t\t}\r\n\r\n\t\t// \u6E05\u7406\u8DEF\u5F84\u4E2D\u7684\u591A\u4F59\u659C\u6760\r\n\t\tcurrentFullPath = currentFullPath.replace(/\\/+/g, '/');\r\n\r\n\t\tconst relativePath = currentFullPath === rootPath ? '' : currentFullPath.substring(rootPath.length);\r\n\r\n\t\t// \u6839\u76EE\u5F55\u94FE\u63A5 - \u4F7F\u7528home\u56FE\u6807\r\n\t\tconst rootItem = breadcrumbEl.createEl('span', {cls: 'breadcrumb-item breadcrumb-root'});\r\n\t\tconst rootLink = rootItem.createEl('a', {cls: 'breadcrumb-root-link'});\r\n\r\n\t\tsetIcon(rootLink, 'home'); // \u4F7F\u7528Lucide\u7684home\u56FE\u6807\r\n\t\trootLink.title = this.plugin.i18n().view.rootDirectory;\r\n\t\trootLink.onclick = async () => {\r\n\t\t\tawait this.listDirectory(rootPath);\r\n\t\t};\r\n\r\n\t\t// \u5982\u679C\u4E0D\u662F\u6839\u76EE\u5F55\uFF0C\u6DFB\u52A0\u8DEF\u5F84\u90E8\u5206\r\n\t\tif (relativePath) {\r\n\t\t\t// \u6DFB\u52A0\u5206\u9694\u7B26\r\n\t\t\tconst separator = breadcrumbEl.createEl('span', {cls: 'breadcrumb-separator'});\r\n\t\t\tsetIcon(separator, 'chevron-right'); // \u4F7F\u7528\u53F3\u7BAD\u5934\u56FE\u6807\r\n\r\n\t\t\tconst parts = relativePath.split('/').filter(p => p);\r\n\t\t\tlet currentPath = rootPath;\r\n\r\n\t\t\tfor (let i = 0; i < parts.length; i++) {\r\n\t\t\t\t// \u5206\u9694\u7B26\uFF08\u9664\u4E86\u7B2C\u4E00\u4E2A\uFF09\r\n\t\t\t\tif (i > 0) {\r\n\t\t\t\t\tconst sep = breadcrumbEl.createEl('span', {cls: 'breadcrumb-separator'});\r\n\t\t\t\t\tsetIcon(sep, 'chevron-right');\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst part = parts[i];\r\n\t\t\t\t// \u6B63\u786E\u6784\u5EFA\u8DEF\u5F84\r\n\t\t\t\tcurrentPath = currentPath === '/' ? `/${part}` : `${currentPath}/${part}`;\r\n\r\n\t\t\t\tconst item = breadcrumbEl.createEl('span', {cls: 'breadcrumb-item'});\r\n\t\t\t\tconst link = item.createEl('a', {text: part});\r\n\r\n\t\t\t\t// \u5982\u679C\u662F\u6700\u540E\u4E00\u90E8\u5206\uFF0C\u4E0D\u52A0\u94FE\u63A5\r\n\t\t\t\tif (i === parts.length - 1) {\r\n\t\t\t\t\tlink.addClass('breadcrumb-current');\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// \u4E3A\u8DEF\u5F84\u90E8\u5206\u6DFB\u52A0\u70B9\u51FB\u4E8B\u4EF6\r\n\t\t\t\t\tconst targetPath = currentPath;\r\n\t\t\t\t\tlink.onclick = async () => {\r\n\t\t\t\t\t\tawait this.listDirectory(targetPath);\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n// \u5217\u51FA\u76EE\u5F55\u5185\u5BB9\uFF08\u7B80\u5316\u7248\u672C\uFF0C\u5220\u9664\u91CD\u8BD5\u673A\u5236\uFF09\r\n\tasync listDirectory(path: string) {\r\n\t\tif (!this.currentServer) return;\r\n\r\n\t\tconst t = this.plugin.i18n();\r\n\r\n\t\t// \u68C0\u67E5\u5BA2\u6237\u7AEF\u662F\u5426\u5B58\u5728\r\n\t\tif (!this.client) {\r\n\t\t\tconst success = await this.initializeClient();\r\n\t\t\tif (!success) {\r\n\t\t\t\tthis.showError(t.view.connectionFailed);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst rootPath = this.getRootPath();\r\n\r\n\t\t// \u8DEF\u5F84\u89C4\u8303\u5316\u5904\u7406\uFF08\u4FDD\u6301\u4E0D\u53D8\uFF09\r\n\t\tlet normalizedPath = path;\r\n\r\n\t\t// \u5904\u7406\u6839\u8DEF\u5F84\r\n\t\tif (path === '' || path === '/' || path === rootPath) {\r\n\t\t\tnormalizedPath = rootPath;\r\n\t\t} else {\r\n\t\t\t// \u786E\u4FDD\u8DEF\u5F84\u4EE5\u6839\u8DEF\u5F84\u5F00\u5934\r\n\t\t\tif (!path.startsWith(rootPath)) {\r\n\t\t\t\tnormalizedPath = rootPath === '/' ? `/${path.replace(/^\\//, '')}` : `${rootPath}/${path.replace(/^\\//, '')}`;\r\n\t\t\t}\r\n\t\t\t// \u6E05\u7406\u8DEF\u5F84\u4E2D\u7684\u591A\u4F59\u659C\u6760\r\n\t\t\tnormalizedPath = normalizedPath.replace(/\\/+/g, '/');\r\n\t\t}\r\n\r\n\t\t// \u786E\u4FDD\u8DEF\u5F84\u4E0D\u4EE5\u659C\u6760\u7ED3\u5C3E\uFF08\u9664\u4E86\u6839\u8DEF\u5F84\uFF09\r\n\t\tif (normalizedPath !== '/' && normalizedPath.endsWith('/')) {\r\n\t\t\tnormalizedPath = normalizedPath.slice(0, -1);\r\n\t\t}\r\n\r\n\t\t// \u5B89\u5168\u68C0\u67E5\uFF1A\u786E\u4FDD\u4E0D\u8BBF\u95EE\u6839\u8DEF\u5F84\u4E4B\u5916\u7684\u76EE\u5F55\r\n\t\tif (!normalizedPath.startsWith(rootPath)) {\r\n\t\t\tconsole.warn(`Attempted to access ${normalizedPath}, which is outside of root: ${rootPath}`);\r\n\t\t\tnormalizedPath = rootPath;\r\n\t\t}\r\n\r\n\t\tthis.rootPath = rootPath;\r\n\t\tthis.currentPath = normalizedPath;\r\n\t\tconst container = this.containerEl;\r\n\r\n\t\t// \u66F4\u65B0\u9762\u5305\u5C51\u5BFC\u822A\r\n\t\tthis.createBreadcrumb(normalizedPath);\r\n\r\n\t\t// \u79FB\u9664\u65E7\u7684\u6587\u4EF6\u5217\u8868\r\n\t\tconst oldList = container.querySelector('.file-list-container');\r\n\t\tif (oldList) oldList.remove();\r\n\r\n\t\tthis.selectedItem = null;\r\n\r\n\t\tconst listContainer = container.createEl('div', {cls: 'file-list-container'});\r\n\t\tconst fileList = listContainer.createEl('div', {cls: 'file-list'});\r\n\r\n\t\t// \u663E\u793A\u52A0\u8F7D\u72B6\u6001\r\n\t\tconst loadingEl = fileList.createEl('div', {\r\n\t\t\tcls: 'file-item loading',\r\n\t\t\ttext: '\u23F3 ' + (t.view.loading || 'Loading...')\r\n\t\t});\r\n\r\n\t\ttry {\r\n\t\t\t// \u83B7\u53D6\u76EE\u5F55\u5185\u5BB9\uFF08\u5E26\u8D85\u65F6\u63A7\u5236\uFF09\r\n\t\t\tconst files = await this.withTimeout(\r\n\t\t\t\tthis.client.getDirectoryContents(this.currentPath),\r\n\t\t\t\t15000 // 15\u79D2\u8D85\u65F6\r\n\t\t\t) as any[];\r\n\r\n\t\t\tloadingEl.remove();\r\n\r\n\t\t\t// \u6DFB\u52A0\u4E0A\u4E00\u7EA7\u76EE\u5F55\u5BFC\u822A (\"..\")\r\n\t\t\tif (this.currentPath !== this.rootPath) {\r\n\t\t\t\tconst upItem = fileList.createEl('div', {\r\n\t\t\t\t\tcls: 'file-item folder',\r\n\t\t\t\t\ttext: '\uD83D\uDCC1 ..'\r\n\t\t\t\t});\r\n\t\t\t\tupItem.onclick = async () => {\r\n\t\t\t\t\t// \u8BA1\u7B97\u7236\u76EE\u5F55\u8DEF\u5F84\r\n\t\t\t\t\tlet parentPath = this.currentPath;\r\n\r\n\t\t\t\t\t// \u79FB\u9664\u672B\u5C3E\u7684\u659C\u6760\r\n\t\t\t\t\tif (parentPath.endsWith('/') && parentPath !== '/') {\r\n\t\t\t\t\t\tparentPath = parentPath.slice(0, -1);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// \u627E\u5230\u6700\u540E\u4E00\u4E2A\u659C\u6760\u7684\u4F4D\u7F6E\r\n\t\t\t\t\tconst lastSlashIndex = parentPath.lastIndexOf('/');\r\n\t\t\t\t\tif (lastSlashIndex > 0) {\r\n\t\t\t\t\t\tparentPath = parentPath.substring(0, lastSlashIndex);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tparentPath = '/';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// \u5982\u679C\u7236\u8DEF\u5F84\u4E3A\u7A7A\uFF0C\u8BBE\u4E3A\u6839\u8DEF\u5F84\r\n\t\t\t\t\tif (parentPath === '') {\r\n\t\t\t\t\t\tparentPath = '/';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// \u786E\u4FDD\u7236\u8DEF\u5F84\u4E0D\u4F4E\u4E8E\u6839\u8DEF\u5F84\r\n\t\t\t\t\tif (!parentPath.startsWith(this.rootPath)) {\r\n\t\t\t\t\t\tparentPath = this.rootPath;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tawait this.listDirectory(parentPath);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\t// \u7A7A\u76EE\u5F55\u5904\u7406\r\n\t\t\tif (files.length === 0) {\r\n\t\t\t\tfileList.createEl('div', {\r\n\t\t\t\t\tcls: 'file-item empty',\r\n\t\t\t\t\ttext: '\uD83D\uDCC2 ' + t.view.emptyDir\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// \u6E32\u67D3\u6587\u4EF6\u5217\u8868\r\n\t\t\tthis.renderFileList(fileList, files);\r\n\r\n\t\t} catch (err: any) {\r\n\t\t\tloadingEl.remove();\r\n\r\n\t\t\t// \u7B80\u5316\u9519\u8BEF\u5904\u7406\uFF1A\u53EA\u663E\u793A\u9519\u8BEF\u4FE1\u606F\uFF0C\u4E0D\u8FDB\u884C\u91CD\u8BD5\r\n\t\t\tconst msg = err.message || String(err);\r\n\t\t\tconsole.error('WebDAV list directory error:', err);\r\n\t\t\tnew Notice(`${t.view.listFailed}: ${msg.substring(0, 100)}...`);\r\n\r\n\t\t\tfileList.createEl('div', {\r\n\t\t\t\tcls: 'file-item error',\r\n\t\t\t\ttext: `\u26D4 ${t.view.error}: ${msg}`\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t// \u5217\u51FA\u76EE\u5F55\u5185\u5BB9\uFF08\u5E26\u91CD\u8BD5\u673A\u5236\uFF09\r\n\r\n\t// \u9009\u4E2D\u6587\u4EF6\u9879\r\n\tselectItem(item: HTMLElement) {\r\n\t\tif (this.selectedItem) {\r\n\t\t\tthis.selectedItem.removeClass('selected');\r\n\t\t}\r\n\r\n\t\tthis.selectedItem = item;\r\n\t\titem.addClass('selected');\r\n\t}\r\n\r\n\t// \u6839\u636E\u6587\u4EF6\u6269\u5C55\u540D\u83B7\u53D6\u56FE\u6807\r\n\tgetFileIcon(filename: string): string {\r\n\t\tconst ext = filename.split('.').pop()?.toLowerCase();\r\n\t\tconst iconMap: { [key: string]: string } = {\r\n\t\t\t'md': '\uD83D\uDCDD',   // Markdown\r\n\t\t\t'txt': '\uD83D\uDCC4',  // \u6587\u672C\u6587\u4EF6\r\n\t\t\t'pdf': '\uD83D\uDCD5',  // PDF\r\n\t\t\t'doc': '\uD83D\uDCD8',  // Word\u6587\u6863\r\n\t\t\t'docx': '\uD83D\uDCD8',\r\n\t\t\t'xls': '\uD83D\uDCD7',  // Excel\r\n\t\t\t'xlsx': '\uD83D\uDCD7',\r\n\t\t\t'ppt': '\uD83D\uDCD9',  // PowerPoint\r\n\t\t\t'pptx': '\uD83D\uDCD9',\r\n\t\t\t'jpg': '\uD83D\uDDBC\uFE0F',  // \u56FE\u7247\r\n\t\t\t'jpeg': '\uD83D\uDDBC\uFE0F',\r\n\t\t\t'png': '\uD83D\uDDBC\uFE0F',\r\n\t\t\t'gif': '\uD83D\uDDBC\uFE0F',\r\n\t\t\t'mp4': '\uD83C\uDFAC',  // \u89C6\u9891\r\n\t\t\t'mkv': '\uD83C\uDFAC',\r\n\t\t\t'avi': '\uD83C\uDFAC',\r\n\t\t\t'mov': '\uD83C\uDFAC',\r\n\t\t\t'mp3': '\uD83C\uDFB5',  // \u97F3\u9891\r\n\t\t\t'wav': '\uD83C\uDFB5',\r\n\t\t\t'zip': '\uD83D\uDCE6',  // \u538B\u7F29\u6587\u4EF6\r\n\t\t\t'rar': '\uD83D\uDCE6',\r\n\t\t\t'7z': '\uD83D\uDCE6',\r\n\t\t\t'strm': '\uD83D\uDD17'  // strm\u6587\u4EF6\r\n\t\t};\r\n\r\n\t\tif (!ext || !iconMap[ext]) {\r\n\t\t\treturn '\uD83D\uDCC4'; // \u9ED8\u8BA4\u6587\u4EF6\u56FE\u6807\r\n\t\t}\r\n\r\n\t\treturn iconMap[ext];\r\n\t}\r\n\r\n\t//\u91CD\u8981!\u4E0D\u80FD\u6539\u52A8!\r\n\t// getFileFullUrl(remotePath: string): string {\r\n\t// \tif (!this.currentServer) return '';\r\n\t// \tconst baseUrl = this.currentServer.url.replace(/\\/$/, '');\r\n\t// \tconst separator = remotePath.startsWith('/') ? '' : '/';\r\n\t// \treturn `${baseUrl}${separator}${remotePath}`.replace(/#/g, '%23').replace(/\\(/g, '%28').replace(/\\)/g, '%29');\r\n\t// }\r\n\r\n\tgetFileFullUrl(remotePath: string): string {\r\n\t\tif (!this.currentServer) return '';\r\n\r\n\t\tconst baseUrl = this.currentServer.url.replace(/\\/$/, '');\r\n\t\tconst separator = remotePath.startsWith('/') ? '' : '/';\r\n\r\n\t\t// \u5206\u5272\u8DEF\u5F84\u90E8\u5206\u8FDB\u884C\u7F16\u7801\uFF08\u4FDD\u7559\u5DF2\u5B58\u5728\u7684\u659C\u6760\uFF09\r\n\t\tconst encodedPath = remotePath.split('/')\r\n\t\t\t.map(segment => encodeURIComponent(segment))\r\n\t\t\t.join('/');\r\n\r\n\t\treturn `${baseUrl}${separator}${encodedPath}`;\r\n\t}\r\n\r\n\t// \u83B7\u53D6\u6587\u4EF6\u7684\u5B8C\u6574URL\r\n\r\n\t// \u4F7F\u7528\u7CFB\u7EDF\u5E94\u7528\u6253\u5F00\u6587\u4EF6\r\n// \u4F7F\u7528\u7CFB\u7EDF\u5E94\u7528\u6253\u5F00\u6587\u4EF6\r\n\tasync openFileWithWeb(remotePath: string) {\r\n\t\tif (!this.currentServer) return;\r\n\r\n\t\tconst t = this.plugin.i18n();\r\n\t\ttry {\r\n\t\t\tconst filename = remotePath.split('/').pop() || '';\r\n\r\n\t\t\t// \u83B7\u53D6\u6700\u7EC8URL\uFF08\u5DF2\u7ECF\u7F16\u7801\u8FC7\u7684\uFF09\r\n\t\t\tconst finalUrl = this.getFileFullUrl(remotePath);\r\n\r\n\t\t\t// \u521B\u5EFA\u5E26Basic\u8BA4\u8BC1\u7684URL\r\n\t\t\tconst {username, password} = this.currentServer;\r\n\r\n\t\t\tconst authUrl = finalUrl.replace(/^https?:\\/\\//, `http://${username}:${password}@`);\r\n\r\n\t\t\t// \u5728\u65B0\u6807\u7B7E\u9875\u4E2D\u6253\u5F00\r\n\t\t\twindow.open(authUrl, '_blank');\r\n\r\n\t\t\tnew Notice(`\u2705 ${t.view.opening}`,1000);\r\n\r\n\t\t} catch (err: any) {\r\n\t\t\tconsole.error('File open error:', err);\r\n\t\t\tconst errorMsg = err.message || String(err);\r\n\t\t\tnew Notice(`\u274C ${t.view.openFailed}: ${errorMsg}`);\r\n\t\t}\r\n\t}\r\n\r\n\t// \u89C6\u56FE\u5378\u8F7D\u6E05\u7406\r\n\tasync onunload() {\r\n\t\tthis.client = null;\r\n\t\tthis.selectedItem = null;\r\n\t\tthis.currentServer = null;\r\n\r\n\t\tif (this.containerEl) {\r\n\t\t\tthis.containerEl.empty();\r\n\t\t}\r\n\t}\r\n\r\n\tasync refresh() {\r\n// \u9632\u6296\u5904\u7406\uFF0C\u907F\u514D\u9891\u7E41\u5237\u65B0\r\n\t\tif (this.refreshDebounceTimer) {\r\n\t\t\tclearTimeout(this.refreshDebounceTimer);\r\n\t\t}\r\n\r\n\t\tthis.refreshDebounceTimer = window.setTimeout(async () => {\r\n\t\t\tif (!this.currentServer) {\r\n\t\t\t\tthis.showNoServerConfigured();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst t = this.plugin.i18n();\r\n\t\t\tnew Notice(t.view.refreshing, 1000);\r\n\r\n\t\t\ttry {\r\n\t\t\t\t// \u91CD\u7F6E\u8FDE\u63A5\u72B6\u6001\r\n\t\t\t\tthis.isConnectionFailed = false;\r\n\r\n\t\t\t\t// \u91CD\u65B0\u521D\u59CB\u5316\u5BA2\u6237\u7AEF\r\n\t\t\t\tconst success = await this.initializeClient();\r\n\t\t\t\tif (!success) {\r\n\t\t\t\t\tthrow new Error('Failed to initialize WebDAV client');\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// \u5982\u679C\u5F53\u524D\u663E\u793A\u7684\u662F\u8FDE\u63A5\u5931\u8D25\u754C\u9762\uFF0C\u91CD\u5EFA\u6B63\u5E38\u89C6\u56FE\r\n\t\t\t\tif (this.containerEl.querySelector('.webdav-connection-failed')) {\r\n\t\t\t\t\tthis.buildNormalView();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tawait this.listDirectory(this.currentPath);\r\n\t\t\t} catch (err: any) {\r\n\t\t\t\tconst msg = err.message || String(err);\r\n\t\t\t\tnew Notice(`\u274C ${t.view.connectionFailed}: ${msg.substring(0, 100)}...`);\r\n\r\n\t\t\t\tthis.isConnectionFailed = true;\r\n\t\t\t\tthis.showConnectionFailed(msg);\r\n\t\t\t}\r\n\t\t}, 300);\r\n\t}\r\n\r\n// \u6784\u5EFA\u6B63\u5E38\u89C6\u56FE\uFF08\u5934\u90E8\u548C\u6587\u4EF6\u5217\u8868\u533A\u57DF\uFF09\r\n\tprivate buildNormalView() {\r\n\t\tthis.containerEl.empty();\r\n\t\tthis.containerEl.addClass('webdav-explorer-view');\r\n\t\tthis.isConnectionFailed = false;\r\n\r\n\t\t// \u521B\u5EFA\u5934\u90E8\u533A\u57DF\r\n\t\tconst headerEl = this.containerEl.createEl('div', {cls: 'webdav-header'});\r\n\r\n\t\t// \u6807\u9898\u884C - \u6240\u6709\u6309\u94AE\u90FD\u9760\u5DE6\r\n\t\tconst titleRow = headerEl.createEl('div', {cls: 'webdav-title-row'});\r\n\r\n\t\t// \u670D\u52A1\u5668\u9009\u62E9\u5668\r\n\t\tthis.serverSelector = titleRow.createEl('div', {cls: 'webdav-button'});\r\n\t\tconst serverContent = this.serverSelector.createEl('div', {cls: 'webdav-button-content'});\r\n\t\tthis.serverIconEl = serverContent.createSpan({cls: 'webdav-server-icon'});\r\n\t\tconst serverText = serverContent.createSpan({\r\n\t\t\tcls: 'webdav-button-text',\r\n\t\t\ttext: this.currentServer?.name || ''\r\n\t\t});\r\n\r\n\t\t// \u66F4\u65B0\u670D\u52A1\u5668\u56FE\u6807\r\n\t\tthis.updateServerIcon();\r\n\r\n\t\t// \u670D\u52A1\u5668\u9009\u62E9\u5668\u70B9\u51FB\u4E8B\u4EF6\r\n\t\tthis.serverSelector.onclick = (evt) => {\r\n\t\t\tthis.showServerMenu(evt);\r\n\t\t};\r\n\r\n\t\t// \u5237\u65B0\u6309\u94AE\u548C\u6392\u5E8F\u6309\u94AE\u7EC4\u5408\u5BB9\u5668\r\n\t\tconst actionsContainer = titleRow.createEl('div', {cls: 'webdav-actions-container'});\r\n\r\n\t\t// \u5237\u65B0\u6309\u94AE - \u5E26\u6587\u5B57\r\n\t\tconst refreshButton = actionsContainer.createEl('div', {cls: 'webdav-button'});\r\n\t\tconst refreshContent = refreshButton.createEl('div', {cls: 'webdav-button-content'});\r\n\t\tconst refreshIcon = refreshContent.createSpan({cls: 'webdav-refresh-icon'});\r\n\t\tsetIcon(refreshIcon, 'refresh-cw');\r\n\t\tconst refreshText = refreshContent.createSpan({\r\n\t\t\tcls: 'webdav-button-text',\r\n\t\t\ttext: this.plugin.i18n().view.refresh\r\n\t\t});\r\n\t\trefreshButton.setAttribute('aria-label', 'Refresh');\r\n\t\trefreshButton.onclick = async () => {\r\n\t\t\tawait this.refresh();\r\n\t\t};\r\n\r\n\t\t// \u6392\u5E8F\u6309\u94AE - \u5E26\u6587\u5B57\r\n\t\tthis.sortButton = actionsContainer.createEl('div', {cls: 'webdav-button'});\r\n\t\tconst sortContent = this.sortButton.createEl('div', {cls: 'webdav-button-content'});\r\n\t\tthis.sortIconEl = sortContent.createSpan({cls: 'webdav-sort-icon'});\r\n\t\tconst sortText = sortContent.createSpan({\r\n\t\t\tcls: 'webdav-button-text',\r\n\t\t\ttext: this.plugin.i18n().view.sort,\r\n\t\t});\r\n\t\tthis.updateSortIcon();\r\n\t\tthis.sortButton.setAttribute('aria-label', 'Sort files');\r\n\t\tthis.sortButton.onclick = (evt) => {\r\n\t\t\tthis.showSortMenu(evt);\r\n\t\t};\r\n\r\n\t\t// \u9762\u5305\u5C51\u5BFC\u822A\u5BB9\u5668\r\n\t\tconst breadcrumbContainer = headerEl.createEl('div', {cls: 'webdav-breadcrumb-container'});\r\n\r\n\t\t// \u6587\u4EF6\u5217\u8868\u5BB9\u5668\r\n\t\tconst listContainer = this.containerEl.createEl('div', {cls: 'file-list-container'});\r\n\t\tlistContainer.createEl('div', {cls: 'file-list'});\r\n\t}\r\n\r\n// \u663E\u793A\u8FDE\u63A5\u5931\u8D25\u63D0\u793A\r\n\tprivate showConnectionFailed(errorMessage: string) {\r\n\t\t// \u6E05\u7A7A\u5BB9\u5668\u4F46\u4FDD\u7559\u57FA\u672C\u7ED3\u6784\r\n\t\tconst contentEl = this.containerEl.querySelector('.file-list-container') ||\r\n\t\t\tthis.containerEl.querySelector('.webdav-connection-failed');\r\n\r\n\t\tif (contentEl) {\r\n\t\t\tcontentEl.remove();\r\n\t\t}\r\n\r\n\t\tconst messageEl = this.containerEl.createEl('div', {cls: 'webdav-connection-failed'});\r\n\t\tconst t = this.plugin.i18n();\r\n\r\n\t\t// \u9519\u8BEF\u56FE\u6807\u548C\u6807\u9898\r\n\t\tconst errorTitle = messageEl.createEl('p', {\r\n\t\t\ttext: `\u274C ${t.view.connectionFailed}`,\r\n\t\t\tcls: 'webdav-error-title'\r\n\t\t});\r\n\r\n\t\t// \u9519\u8BEF\u8BE6\u60C5\r\n\t\tconst errorDetails = messageEl.createEl('p', {\r\n\t\t\ttext: errorMessage,\r\n\t\t\tcls: 'webdav-error-details'\r\n\t\t});\r\n\r\n\t\t// \u5237\u65B0\u6309\u94AE\r\n\t\tconst refreshButton = messageEl.createEl('button', {\r\n\t\t\ttext: t.view.refresh || 'Refresh',\r\n\t\t\tcls: 'mod-cta'\r\n\t\t});\r\n\r\n\t\trefreshButton.onclick = async () => {\r\n\t\t\tawait this.connectAndList();\r\n\t\t};\r\n\t}\r\n\r\n// \u663E\u793A\u6392\u5E8F\u83DC\u5355\r\n\tprivate showSortMenu(evt: MouseEvent) {\r\n\t\tconst menu = new Menu();\r\n\t\tconst t = this.plugin.i18n();\r\n\t\t// \u540D\u79F0\u5347\u5E8F\r\n\t\tmenu.addItem(item => {\r\n\t\t\titem\r\n\t\t\t\t.setTitle(t.view.sortByNameAsc)\r\n\t\t\t\t.setIcon(this.sortField === 'name' && this.sortOrder === 'asc' ? 'check' : '')\r\n\t\t\t\t.onClick(() => {\r\n\t\t\t\t\tthis.sortField = 'name';\r\n\t\t\t\t\tthis.sortOrder = 'asc';\r\n\t\t\t\t\tthis.updateSortIcon();\r\n\t\t\t\t\tthis.refreshFileList();\r\n\t\t\t\t});\r\n\t\t});\r\n\r\n\t\t// \u540D\u79F0\u964D\u5E8F\r\n\t\tmenu.addItem(item => {\r\n\t\t\titem\r\n\t\t\t\t.setTitle(t.view.sortByNameDesc)\r\n\t\t\t\t.setIcon(this.sortField === 'name' && this.sortOrder === 'desc' ? 'check' : '')\r\n\t\t\t\t.onClick(() => {\r\n\t\t\t\t\tthis.sortField = 'name';\r\n\t\t\t\t\tthis.sortOrder = 'desc';\r\n\t\t\t\t\tthis.updateSortIcon();\r\n\t\t\t\t\tthis.refreshFileList();\r\n\t\t\t\t});\r\n\t\t});\r\n\r\n\t\t// \u7C7B\u578B\u5347\u5E8F\r\n\t\tmenu.addItem(item => {\r\n\t\t\titem\r\n\t\t\t\t.setTitle(t.view.sortByTypeAsc)\r\n\t\t\t\t.setIcon(this.sortField === 'type' && this.sortOrder === 'asc' ? 'check' : '')\r\n\t\t\t\t.onClick(() => {\r\n\t\t\t\t\tthis.sortField = 'type';\r\n\t\t\t\t\tthis.sortOrder = 'asc';\r\n\t\t\t\t\tthis.updateSortIcon();\r\n\t\t\t\t\tthis.refreshFileList();\r\n\t\t\t\t});\r\n\t\t});\r\n\r\n\t\t// \u7C7B\u578B\u964D\u5E8F\r\n\t\tmenu.addItem(item => {\r\n\t\t\titem\r\n\t\t\t\t.setTitle(t.view.sortByTypeDesc)\r\n\t\t\t\t.setIcon(this.sortField === 'type' && this.sortOrder === 'desc' ? 'check' : '')\r\n\t\t\t\t.onClick(() => {\r\n\t\t\t\t\tthis.sortField = 'type';\r\n\t\t\t\t\tthis.sortOrder = 'desc';\r\n\t\t\t\t\tthis.updateSortIcon();\r\n\t\t\t\t\tthis.refreshFileList();\r\n\t\t\t\t});\r\n\t\t});\r\n\r\n\r\n\t\t// \u6587\u4EF6\u5927\u5C0F\u5347\u5E8F\r\n\t\tmenu.addItem(item => {\r\n\t\t\titem\r\n\t\t\t\t.setTitle(t.view.sortBySizeAsc)\r\n\t\t\t\t.setIcon(this.sortField === 'size' && this.sortOrder === 'asc' ? 'check' : '')\r\n\t\t\t\t.onClick(() => {\r\n\t\t\t\t\tthis.sortField = 'size';\r\n\t\t\t\t\tthis.sortOrder = 'asc';\r\n\t\t\t\t\tthis.updateSortIcon();\r\n\t\t\t\t\tthis.refreshFileList();\r\n\t\t\t\t});\r\n\t\t});\r\n\r\n\r\n\t\t// \u5927\u5C0F\u964D\u5E8F\r\n\t\tmenu.addItem(item => {\r\n\t\t\titem\r\n\t\t\t\t.setTitle(t.view.sortBySizeDesc)\r\n\t\t\t\t.setIcon(this.sortField === 'size' && this.sortOrder === 'desc' ? 'check' : '')\r\n\t\t\t\t.onClick(() => {\r\n\t\t\t\t\tthis.sortField = 'size';\r\n\t\t\t\t\tthis.sortOrder = 'desc';\r\n\t\t\t\t\tthis.updateSortIcon();\r\n\t\t\t\t\tthis.refreshFileList();\r\n\t\t\t\t});\r\n\t\t});\r\n\r\n\r\n\t\t// \u65E5\u671F\u5347\u5E8F\r\n\t\tmenu.addItem(item => {\r\n\t\t\titem\r\n\t\t\t\t.setTitle(t.view.sortByDateAsc)\r\n\t\t\t\t.setIcon(this.sortField === 'date' && this.sortOrder === 'asc' ? 'check' : '')\r\n\t\t\t\t.onClick(() => {\r\n\t\t\t\t\tthis.sortField = 'date';\r\n\t\t\t\t\tthis.sortOrder = 'asc';\r\n\t\t\t\t\tthis.updateSortIcon();\r\n\t\t\t\t\tthis.refreshFileList();\r\n\t\t\t\t});\r\n\t\t});\r\n\r\n\r\n\t\t// \u65E5\u671F\u964D\u5E8F\r\n\t\tmenu.addItem(item => {\r\n\t\t\titem\r\n\t\t\t\t.setTitle(t.view.sortByDateDesc)\r\n\t\t\t\t.setIcon(this.sortField === 'date' && this.sortOrder === 'desc' ? 'check' : '')\r\n\t\t\t\t.onClick(() => {\r\n\t\t\t\t\tthis.sortField = 'date';\r\n\t\t\t\t\tthis.sortOrder = 'desc';\r\n\t\t\t\t\tthis.updateSortIcon();\r\n\t\t\t\t\tthis.refreshFileList();\r\n\t\t\t\t});\r\n\t\t});\r\n\r\n\r\n\t\tmenu.showAtMouseEvent(evt);\r\n\t}\r\n\r\n// \u66F4\u65B0\u6392\u5E8F\u56FE\u6807\r\n\tprivate updateSortIcon() {\r\n\t\tif (!this.sortIconEl) return;\r\n\r\n\t\tthis.sortIconEl.empty();\r\n\r\n\t\tlet iconName = 'arrow-up-down';\r\n\t\tlet tooltip = `Sort by: ${this.sortField}, Order: ${this.sortOrder}`;\r\n\r\n\t\ticonName = this.sortOrder === 'asc' ? 'arrow-up-narrow-wide' : 'arrow-down-wide-narrow';\r\n\r\n\r\n\t\tsetIcon(this.sortIconEl, iconName);\r\n\t\tif (this.sortButton) {\r\n\t\t\tthis.sortButton.setAttribute('aria-label', tooltip);\r\n\t\t}\r\n\t}\r\n\r\n\t// \u5237\u65B0\u6587\u4EF6\u5217\u8868\uFF08\u4FDD\u6301\u5F53\u524D\u8DEF\u5F84\uFF09\r\n\tprivate async refreshFileList() {\r\n\t\tif (this.currentPath) {\r\n\t\t\tawait this.listDirectory(this.currentPath);\r\n\t\t}\r\n\t}\r\n\r\n\t// \u66F4\u65B0\u670D\u52A1\u5668\u56FE\u6807\u663E\u793A\r\n\tprivate updateServerIcon() {\r\n\t\tif (!this.serverIconEl || !this.currentServer) return;\r\n\r\n\t\tthis.serverIconEl.empty();\r\n\t\tsetIcon(this.serverIconEl, 'server');\r\n\r\n\t\t// \u66F4\u65B0\u670D\u52A1\u5668\u540D\u79F0\u663E\u793A\r\n\t\tif (this.serverNameEl) {\r\n\t\t\tthis.serverNameEl.textContent = this.currentServer.name;\r\n\t\t}\r\n\t}\r\n\r\n\t// \u663E\u793A\u670D\u52A1\u5668\u9009\u62E9\u83DC\u5355\r\n\tprivate showServerMenu(evt: MouseEvent) {\r\n\t\tconst servers = this.plugin.getServers();\r\n\t\tconst t = this.plugin.i18n();\r\n\t\tif (servers.length === 0) {\r\n\t\t\tnew Notice(t.settings.serverListEmpty);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst menu = new Menu();\r\n\r\n\t\t// \u6DFB\u52A0\u670D\u52A1\u5668\u9009\u9879\r\n\t\tservers.forEach(server => {\r\n\t\t\tmenu.addItem(item => {\r\n\t\t\t\titem\r\n\t\t\t\t\t.setTitle(server.name)\r\n\t\t\t\t\t.setIcon(server.id === this.currentServer?.id ? 'check' : 'server') // \u5F53\u524D\u670D\u52A1\u5668\u663E\u793A\u52FE\u9009\r\n\t\t\t\t\t.onClick(async () => {\r\n\t\t\t\t\t\tawait this.switchServer(server.id);\r\n\t\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tmenu.showAtMouseEvent(evt);\r\n\t}\r\n\r\n\t// \u5207\u6362\u670D\u52A1\u5668\r\n// \u5207\u6362\u670D\u52A1\u5668\r\n\tprivate async switchServer(serverId: string) {\r\n\t\tthis.currentServer = this.plugin.getServerById(serverId);\r\n\t\tif (this.currentServer) {\r\n\t\t\tthis.plugin.settings.currentServerId = serverId;\r\n\t\t\tawait this.plugin.saveSettings();\r\n\r\n\t\t\t// \u91CD\u7F6E\u72B6\u6001\r\n\t\t\tthis.client = null;\r\n\t\t\tthis.currentPath = '/';\r\n\t\t\tthis.rootPath = '/';\r\n\t\t\tthis.selectedItem = null;\r\n\t\t\tthis.isConnectionFailed = false;\r\n\r\n\t\t\t// \u91CD\u65B0\u8FDE\u63A5 - \u8FD9\u4F1A\u91CD\u5EFA\u89C6\u56FE\r\n\t\t\tawait this.connectAndList();\r\n\t\t}\r\n\t}\r\n\r\n// \u66F4\u65B0\u670D\u52A1\u5668\u6309\u94AE\u6587\u672C\r\n\tprivate updateServerButtonText() {\r\n\t\tif (!this.serverSelector || !this.currentServer) return;\r\n\r\n\t\t// \u67E5\u627E\u6309\u94AE\u4E2D\u7684\u6587\u672C\u5143\u7D20\r\n\t\tconst buttonTextEl = this.serverSelector.querySelector('.webdav-button-text');\r\n\t\tif (buttonTextEl) {\r\n\t\t\tbuttonTextEl.textContent = this.currentServer.name;\r\n\t\t}\r\n\r\n\t\t// \u540C\u65F6\u66F4\u65B0\u5DE5\u5177\u63D0\u793A\r\n\t\tthis.serverSelector.setAttribute('aria-label', `Current server: ${this.currentServer.name}`);\r\n\t}\r\n\r\n\t// \u663E\u793A\u65E0\u670D\u52A1\u5668\u914D\u7F6E\u7684\u63D0\u793A\r\n\tprivate showNoServerConfigured() {\r\n\t\tthis.containerEl.empty();\r\n\t\tconst messageEl = this.containerEl.createEl('div', {cls: 'webdav-no-server'});\r\n\t\tconst t = this.plugin.i18n();\r\n\t\tmessageEl.createEl('p', {text: t.view.pleaseConfigure});\r\n\r\n\t\t// \u914D\u7F6E\u670D\u52A1\u5668\u6309\u94AE\r\n\t\tconst configureButton = messageEl.createEl('button', {\r\n\t\t\ttext: 'Configure Servers',\r\n\t\t\tcls: 'mod-cta'\r\n\t\t});\r\n\r\n\t\tconfigureButton.onclick = () => {\r\n\t\t\t(this.app as any).setting.open();\r\n\t\t\t(this.app as any).setting.openTabById('webdav-explorer');\r\n\t\t};\r\n\t}\r\n\r\n\t// \u521D\u59CB\u5316WebDAV\u5BA2\u6237\u7AEF\r\n\tprivate async initializeClient(): Promise<boolean> {\r\n\t\tif (!this.currentServer) return false;\r\n\r\n\t\tconst {url, username, password} = this.currentServer;\r\n\r\n\t\tif (!url || !username || !password) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tconst authHeader = 'Basic ' + btoa(`${username}:${password}`);\r\n\r\n\t\t\t// \u521B\u5EFAWebDAV\u5BA2\u6237\u7AEF\r\n\t\t\tthis.client = createClient(url, {\r\n\t\t\t\tusername,\r\n\t\t\t\tpassword,\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t'Authorization': authHeader\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// \u6D4B\u8BD5\u8FDE\u63A5\r\n\t\t\tconst testPath = this.getRootPath();\r\n\t\t\tawait this.client.getDirectoryContents(testPath);\r\n\t\t\treturn true;\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error('Failed to initialize WebDAV client:', err);\r\n\t\t\tthis.client = null;\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t// \u8D85\u65F6\u63A7\u5236\u5305\u88C5\u5668\r\n\tprivate withTimeout<T>(promise: Promise<T>, timeoutMs: number): Promise<T> {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tconst timeoutId = setTimeout(() => {\r\n\t\t\t\treject(new Error('Request timeout'));\r\n\t\t\t}, timeoutMs);\r\n\r\n\t\t\tpromise.then(\r\n\t\t\t\t(result) => {\r\n\t\t\t\t\tclearTimeout(timeoutId);\r\n\t\t\t\t\tresolve(result);\r\n\t\t\t\t},\r\n\t\t\t\t(error) => {\r\n\t\t\t\t\tclearTimeout(timeoutId);\r\n\t\t\t\t\treject(error);\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\t// \u6E32\u67D3\u6587\u4EF6\u5217\u8868\r\n// \u6E32\u67D3\u6587\u4EF6\u5217\u8868 - \u4F7F\u7528\u6392\u5E8F\u540E\u7684\u6587\u4EF6\r\n\tprivate renderFileList(fileList: HTMLElement, files: any[]) {\r\n\t\t// \u6392\u5E8F\u6587\u4EF6\u5217\u8868\r\n\t\tconst sortedFiles = this.sortFiles(files);\r\n\r\n\t\tfor (const file of sortedFiles) {\r\n\t\t\tconst item = fileList.createEl('div', {\r\n\t\t\t\tcls: 'file-item'\r\n\t\t\t});\r\n\r\n\t\t\t// \u521B\u5EFA\u56FE\u6807\u548C\u540D\u79F0\u7684\u5BB9\u5668\r\n\t\t\tconst iconSpan = item.createSpan({cls: 'file-icon'});\r\n\t\t\tconst nameSpan = item.createSpan({cls: 'file-name', text: this.getFileName(file)});\r\n\r\n\t\t\t// \u8BBE\u7F6E\u56FE\u6807\r\n\t\t\tif (file.type === 'directory') {\r\n\t\t\t\ticonSpan.textContent = '\uD83D\uDCC1';\r\n\t\t\t\titem.addClass('folder');\r\n\t\t\t} else {\r\n\t\t\t\tconst icon = this.getFileIcon(file.basename);\r\n\t\t\t\ticonSpan.textContent = icon;\r\n\t\t\t\titem.addClass('file');\r\n\t\t\t\titem.addClass('folder');\r\n\t\t\t}\r\n\r\n\t\t\titem.addClass('is-clickable');\r\n\t\t\titem.setAttr('draggable', 'true');\r\n\r\n\t\t\t// \u6587\u4EF6\u5939\u70B9\u51FB\u4E8B\u4EF6\r\n\t\t\tif (file.type === 'directory') {\r\n\t\t\t\titem.onclick = async () => {\r\n\t\t\t\t\tthis.selectItem(item);\r\n\t\t\t\t\tawait this.listDirectory(file.filename);\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\t// \u6587\u4EF6\u70B9\u51FB\u4E8B\u4EF6\r\n\t\t\t\titem.onclick = () => {\r\n\t\t\t\t\tthis.selectItem(item);\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// \u6587\u4EF6\u53CC\u51FB\u4E8B\u4EF6 - \u6253\u5F00\u6587\u4EF6\r\n\t\t\t\titem.ondblclick = async () => {\r\n\t\t\t\t\tthis.selectItem(item);\r\n\t\t\t\t\tawait this.openFileWithWeb(file.filename);\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// \u6587\u4EF6\u62D6\u62FD\u4E8B\u4EF6\r\n\t\t\t\titem.ondragstart = async (event) => {\r\n\t\t\t\t\tthis.selectItem(item);\r\n\t\t\t\t\tconst finalUrl = await this.getFileFullUrl(file.filename);\r\n\r\n\t\t\t\t\tevent.dataTransfer?.setData('text/plain', file.filename);\r\n\t\t\t\t\tevent.dataTransfer?.setData('text/uri-list', finalUrl);\r\n\r\n\t\t\t\t\tdocument.addEventListener('dragend', () => {\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tconst markdownView = this.app.workspace.getActiveViewOfType(MarkdownView);\r\n\t\t\t\t\t\t\tif (markdownView?.editor) {\r\n\t\t\t\t\t\t\t\tconst editor = markdownView.editor;\r\n\t\t\t\t\t\t\t\tconst cursor = editor.getCursor();\r\n\t\t\t\t\t\t\t\teditor.replaceRange('\\n', cursor);\r\n\t\t\t\t\t\t\t\teditor.setCursor({line: cursor.line + 1, ch: 0});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, 10);\r\n\t\t\t\t\t}, {once: true});\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// \u6587\u4EF6\u6392\u5E8F\u65B9\u6CD5\r\n\tprivate sortFiles(files: any[]): any[] {\r\n\t\treturn files.sort((a, b) => {\r\n\t\t\t// \u9996\u5148\u6309\u7C7B\u578B\u6392\u5E8F\uFF1A\u6587\u4EF6\u5939\u5728\u524D\uFF0C\u6587\u4EF6\u5728\u540E\r\n\t\t\tif (a.type === 'directory' && b.type !== 'directory') {\r\n\t\t\t\treturn this.sortOrder === 'asc' ? -1 : 1;\r\n\t\t\t} else if (a.type !== 'directory' && b.type === 'directory') {\r\n\t\t\t\treturn this.sortOrder === 'asc' ? 1 : -1;\r\n\t\t\t}\r\n\r\n\t\t\t// \u540C\u7C7B\u578B\u65F6\u6309\u9009\u62E9\u7684\u5B57\u6BB5\u6392\u5E8F\r\n\t\t\tlet compareResult = 0;\r\n\r\n\t\t\tif (this.sortField === 'name') {\r\n\t\t\t\t// \u6309\u540D\u79F0\u6392\u5E8F\r\n\t\t\t\tconst nameA = this.getFileName(a).toLowerCase();\r\n\t\t\t\tconst nameB = this.getFileName(b).toLowerCase();\r\n\t\t\t\tcompareResult = nameA.localeCompare(nameB);\r\n\t\t\t} else if (this.sortField === 'type') {\r\n\t\t\t\t// \u6309\u6587\u4EF6\u6269\u5C55\u540D\u6392\u5E8F\r\n\t\t\t\tconst extA = this.getFileExtension(a.basename).toLowerCase();\r\n\t\t\t\tconst extB = this.getFileExtension(b.basename).toLowerCase();\r\n\t\t\t\tcompareResult = extA.localeCompare(extB);\r\n\r\n\t\t\t\t// \u5982\u679C\u6269\u5C55\u540D\u76F8\u540C\uFF0C\u6309\u540D\u79F0\u6392\u5E8F\r\n\t\t\t\tif (compareResult === 0) {\r\n\t\t\t\t\tconst nameA = this.getFileName(a).toLowerCase();\r\n\t\t\t\t\tconst nameB = this.getFileName(b).toLowerCase();\r\n\t\t\t\t\tcompareResult = nameA.localeCompare(nameB);\r\n\t\t\t\t}\r\n\t\t\t} else if (this.sortField === 'size') {\r\n\t\t\t\t// \u6309\u5927\u5C0F\u6392\u5E8F\r\n\t\t\t\tconst sizeA = Number(a.size) || 0;\r\n\t\t\t\tconst sizeB = Number(b.size) || 0;\r\n\t\t\t\tcompareResult = sizeA - sizeB;\r\n\t\t\t} else if (this.sortField === 'date') {\r\n\t\t\t\t// \u6309\u65E5\u671F\u6392\u5E8F - \u4FEE\u6B63\u65E5\u671F\u89E3\u6790\r\n\t\t\t\tconst dateA = this.parseLastModDate(a.lastmod);\r\n\t\t\t\tconst dateB = this.parseLastModDate(b.lastmod);\r\n\r\n\t\t\t\tcompareResult = dateB - dateA; // \u65B0\u7684\u5728\u524D\r\n\t\t\t}\r\n\r\n\t\t\t// \u5E94\u7528\u6392\u5E8F\u987A\u5E8F\r\n\t\t\treturn this.sortOrder === 'desc' ? -compareResult : compareResult;\r\n\t\t});\r\n\t}\r\n\r\n\tprivate parseLastModDate(lastmod: string): number {\r\n\t\tif (!lastmod) return 0;\r\n\r\n\t\ttry {\r\n\t\t\t// \u76F4\u63A5\u4F7F\u7528 Date \u89E3\u6790 RFC 2822 / GMT \u683C\u5F0F\u7684\u65E5\u671F\u5B57\u7B26\u4E32\r\n\t\t\tconst date = new Date(lastmod);\r\n\t\t\tconst timestamp = date.getTime();\r\n\r\n\t\t\t// \u68C0\u67E5\u89E3\u6790\u662F\u5426\u6210\u529F\r\n\t\t\tif (isNaN(timestamp)) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\r\n\t\t\treturn timestamp;\r\n\t\t} catch (error) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t}\r\n\r\n// \u83B7\u53D6\u6587\u4EF6\u6269\u5C55\u540D\r\n\tprivate getFileExtension(filename: string): string {\r\n\t\tconst parts = filename.split('.');\r\n\t\treturn parts.length > 1 ? parts.pop() || '' : '';\r\n\t}\r\n\r\n// \u83B7\u53D6\u6587\u4EF6\u6269\u5C55\u540D\r\n\r\n\r\n\t// \u83B7\u53D6\u6587\u4EF6\u540D\uFF08\u5904\u7406\u4E0D\u540C\u5C5E\u6027\u540D\uFF09\r\n\tprivate getFileName(file: any): string {\r\n\t\tif (file.originalName) {\r\n\t\t\treturn file.originalName;\r\n\t\t} else if (file.displayName) {\r\n\t\t\treturn file.displayName;\r\n\t\t} else if (file.filename) {\r\n\t\t\tconst parts = file.filename.split('/');\r\n\t\t\treturn parts[parts.length - 1];\r\n\t\t}\r\n\t\treturn file.basename;\r\n\t}\r\n\r\n\t// \u663E\u793A\u9519\u8BEF\u4FE1\u606F\r\n// \u663E\u793A\u9519\u8BEF\u4FE1\u606F\r\n\tprivate showError(message: string) {\r\n\t\tconst container = this.containerEl;\r\n\t\tconst listContainer = container.createEl('div', {cls: 'file-list-container'});\r\n\t\tconst fileList = listContainer.createEl('div', {cls: 'file-list'});\r\n\r\n\t\tfileList.createEl('div', {\r\n\t\t\tcls: 'file-item error',\r\n\t\t\ttext: `\u26D4 ${message}`\r\n\t\t});\r\n\t}\r\n}\r\n", "// === \u5E38\u91CF\u5B9A\u4E49 ===\r\nexport const VIEW_TYPE_WEBDAV_EXPLORER = 'webdav-explorer';\r\n\r\n// === \u8BBE\u7F6E\u63A5\u53E3 ===\r\nexport interface WebDAVServer {\r\n  id: string;\r\n  name: string;\r\n  url: string;\r\n  username: string;\r\n  password: string;\r\n  remoteDir: string;\r\n  isDefault?: boolean;\r\n}\r\n\r\nexport interface WebDAVSettings {\r\n  servers: WebDAVServer[];\r\n  currentServerId?: string;\r\n}\r\n\r\n// \u9ED8\u8BA4\u8BBE\u7F6E\r\nexport const DEFAULT_SETTINGS: WebDAVSettings = {\r\n  servers: [],\r\n};\r\n\r\n// \u6587\u4EF6\u9879\u63A5\u53E3\r\nexport interface WebDAVFile {\r\n  filename: string;\r\n  basename: string;\r\n  lastmod: string;\r\n  size: number;\r\n  type: 'file' | 'directory';\r\n}\r\n\r\n// \u6392\u5E8F\u76F8\u5173\u7C7B\u578B\r\nexport type SortField = 'name' | 'type' | 'size' | 'date';\r\nexport type SortOrder = 'asc' | 'desc';\r\n", "import URL from \"url-parse\";\r\nimport { Layerr } from \"layerr\";\r\nimport _joinURL from \"url-join\";\r\nimport { normalisePath } from \"./path.js\";\r\nexport function extractURLPath(fullURL) {\r\n    const url = new URL(fullURL);\r\n    let urlPath = url.pathname;\r\n    if (urlPath.length <= 0) {\r\n        urlPath = \"/\";\r\n    }\r\n    return normalisePath(urlPath);\r\n}\r\nexport function joinURL(...parts) {\r\n    return _joinURL(parts.reduce((output, nextPart, partIndex) => {\r\n        if (partIndex === 0 ||\r\n            nextPart !== \"/\" ||\r\n            (nextPart === \"/\" && output[output.length - 1] !== \"/\")) {\r\n            output.push(nextPart);\r\n        }\r\n        return output;\r\n    }, []));\r\n}\r\nexport function normaliseHREF(href) {\r\n    try {\r\n        const normalisedHref = href.replace(/^https?:\\/\\/[^\\/]+/, \"\");\r\n        return normalisedHref;\r\n    }\r\n    catch (err) {\r\n        throw new Layerr(err, \"Failed normalising HREF\");\r\n    }\r\n}\r\n", "export function assertError(err) {\r\n    if (!isError(err)) {\r\n        throw new Error(\"Parameter was not an error\");\r\n    }\r\n}\r\nexport function isError(err) {\r\n    return ((!!err &&\r\n        typeof err === \"object\" &&\r\n        objectToString(err) === \"[object Error]\") ||\r\n        err instanceof Error);\r\n}\r\nfunction objectToString(obj) {\r\n    return Object.prototype.toString.call(obj);\r\n}\r\n", "const NAME = \"Layerr\";\r\nlet __name = NAME;\r\nexport function getGlobalName() {\r\n    return __name;\r\n}\r\nexport function setGlobalName(name = null) {\r\n    __name = name ?? NAME;\r\n}\r\n", "import { isError } from \"./error.js\";\r\nexport function parseArguments(args) {\r\n    let options, shortMessage = \"\";\r\n    if (args.length === 0) {\r\n        options = {};\r\n    }\r\n    else if (isError(args[0])) {\r\n        options = {\r\n            cause: args[0],\r\n        };\r\n        shortMessage = args.slice(1).join(\" \") || \"\";\r\n    }\r\n    else if (args[0] && typeof args[0] === \"object\") {\r\n        options = Object.assign({}, args[0]);\r\n        shortMessage = args.slice(1).join(\" \") || \"\";\r\n    }\r\n    else if (typeof args[0] === \"string\") {\r\n        options = {};\r\n        shortMessage = shortMessage = args.join(\" \") || \"\";\r\n    }\r\n    else {\r\n        throw new Error(\"Invalid arguments passed to Layerr\");\r\n    }\r\n    return {\r\n        options,\r\n        shortMessage,\r\n    };\r\n}\r\n", "import { assertError, isError } from \"./error.js\";\r\nimport { getGlobalName } from \"./global.js\";\r\nimport { parseArguments } from \"./tools.js\";\r\nexport class Layerr extends Error {\r\n    constructor(errorOptionsOrMessage, messageText) {\r\n        const args = [...arguments];\r\n        const { options, shortMessage } = parseArguments(args);\r\n        let message = shortMessage;\r\n        if (options.cause) {\r\n            message = `${message}: ${options.cause.message}`;\r\n        }\r\n        super(message);\r\n        this.message = message;\r\n        if (options.name && typeof options.name === \"string\") {\r\n            this.name = options.name;\r\n        }\r\n        else {\r\n            this.name = getGlobalName();\r\n        }\r\n        if (options.cause) {\r\n            Object.defineProperty(this, \"_cause\", { value: options.cause });\r\n        }\r\n        Object.defineProperty(this, \"_info\", { value: {} });\r\n        if (options.info && typeof options.info === \"object\") {\r\n            Object.assign(this._info, options.info);\r\n        }\r\n        if (Error.captureStackTrace) {\r\n            const ctor = options.constructorOpt || this.constructor;\r\n            Error.captureStackTrace(this, ctor);\r\n        }\r\n    }\r\n    static cause(err) {\r\n        assertError(err);\r\n        if (!err._cause)\r\n            return null;\r\n        return isError(err._cause)\r\n            ? err._cause\r\n            : null;\r\n    }\r\n    static fullStack(err) {\r\n        assertError(err);\r\n        const cause = Layerr.cause(err);\r\n        if (cause) {\r\n            return `${err.stack}\\ncaused by: ${Layerr.fullStack(cause)}`;\r\n        }\r\n        return err.stack ?? \"\";\r\n    }\r\n    static info(err) {\r\n        assertError(err);\r\n        const output = {};\r\n        const cause = Layerr.cause(err);\r\n        if (cause) {\r\n            Object.assign(output, Layerr.info(cause));\r\n        }\r\n        if (err._info) {\r\n            Object.assign(output, err._info);\r\n        }\r\n        return output;\r\n    }\r\n    toString() {\r\n        let output = this.name ||\r\n            this.constructor.name ||\r\n            this.constructor.prototype.name;\r\n        if (this.message) {\r\n            output = `${output}: ${this.message}`;\r\n        }\r\n        return output;\r\n    }\r\n}\r\n", "function normalize (strArray) {\r\n  var resultArray = [];\r\n  if (strArray.length === 0) { return ''; }\r\n\r\n  if (typeof strArray[0] !== 'string') {\r\n    throw new TypeError('Url must be a string. Received ' + strArray[0]);\r\n  }\r\n\r\n  // If the first part is a plain protocol, we combine it with the next part.\r\n  if (strArray[0].match(/^[^/:]+:\\/*$/) && strArray.length > 1) {\r\n    var first = strArray.shift();\r\n    strArray[0] = first + strArray[0];\r\n  }\r\n\r\n  // There must be two or three slashes in the file protocol, two slashes in anything else.\r\n  if (strArray[0].match(/^file:\\/\\/\\//)) {\r\n    strArray[0] = strArray[0].replace(/^([^/:]+):\\/*/, '$1:///');\r\n  } else {\r\n    strArray[0] = strArray[0].replace(/^([^/:]+):\\/*/, '$1://');\r\n  }\r\n\r\n  for (var i = 0; i < strArray.length; i++) {\r\n    var component = strArray[i];\r\n\r\n    if (typeof component !== 'string') {\r\n      throw new TypeError('Url must be a string. Received ' + component);\r\n    }\r\n\r\n    if (component === '') { continue; }\r\n\r\n    if (i > 0) {\r\n      // Removing the starting slashes for each component but the first.\r\n      component = component.replace(/^[\\/]+/, '');\r\n    }\r\n    if (i < strArray.length - 1) {\r\n      // Removing the ending slashes for each component but the last.\r\n      component = component.replace(/[\\/]+$/, '');\r\n    } else {\r\n      // For the last component we will combine multiple slashes to a single one.\r\n      component = component.replace(/[\\/]+$/, '/');\r\n    }\r\n\r\n    resultArray.push(component);\r\n\r\n  }\r\n\r\n  var str = resultArray.join('/');\r\n  // Each input component is now separated by a single slash except the possible first plain protocol part.\r\n\r\n  // remove trailing slash before parameters or hash\r\n  str = str.replace(/\\/(\\?|&|#[^!])/g, '$1');\r\n\r\n  // replace ? in parameters with &\r\n  var parts = str.split('?');\r\n  str = parts.shift() + (parts.length > 0 ? '?': '') + parts.join('&');\r\n\r\n  return str;\r\n}\r\n\r\nexport default function urlJoin() {\r\n  var input;\r\n\r\n  if (typeof arguments[0] === 'object') {\r\n    input = arguments[0];\r\n  } else {\r\n    input = [].slice.call(arguments);\r\n  }\r\n\r\n  return normalize(input);\r\n}\r\n", "import { Layerr } from \"layerr\";\r\nimport path from \"path-posix\";\r\nconst SEP_PATH_POSIX = \"__PATH_SEPARATOR_POSIX__\";\r\nconst SEP_PATH_WINDOWS = \"__PATH_SEPARATOR_WINDOWS__\";\r\nexport function encodePath(filePath) {\r\n    try {\r\n        const replaced = filePath.replace(/\\//g, SEP_PATH_POSIX).replace(/\\\\\\\\/g, SEP_PATH_WINDOWS);\r\n        const formatted = encodeURIComponent(replaced);\r\n        return formatted.split(SEP_PATH_WINDOWS).join(\"\\\\\\\\\").split(SEP_PATH_POSIX).join(\"/\");\r\n    }\r\n    catch (err) {\r\n        throw new Layerr(err, \"Failed encoding path\");\r\n    }\r\n}\r\nexport function getAllDirectories(directory) {\r\n    if (!directory || directory === \"/\")\r\n        return [];\r\n    let currentPath = directory;\r\n    const output = [];\r\n    do {\r\n        output.push(currentPath);\r\n        currentPath = path.dirname(currentPath);\r\n    } while (currentPath && currentPath !== \"/\");\r\n    return output;\r\n}\r\nexport function makePathAbsolute(pathStr) {\r\n    return pathStr.startsWith(\"/\") ? pathStr : \"/\" + pathStr;\r\n}\r\nexport function normalisePath(pathStr) {\r\n    let normalisedPath = pathStr;\r\n    if (normalisedPath[0] !== \"/\") {\r\n        normalisedPath = \"/\" + normalisedPath;\r\n    }\r\n    if (/^.+\\/$/.test(normalisedPath)) {\r\n        normalisedPath = normalisedPath.substr(0, normalisedPath.length - 1);\r\n    }\r\n    return normalisedPath;\r\n}\r\n", "import md5 from \"md5\";\r\nimport { ha1Compute } from \"../tools/crypto.js\";\r\nconst NONCE_CHARS = \"abcdef0123456789\";\r\nconst NONCE_SIZE = 32;\r\nexport function createDigestContext(username, password, ha1) {\r\n    return { username, password, ha1, nc: 0, algorithm: \"md5\", hasDigestAuth: false };\r\n}\r\nexport function generateDigestAuthHeader(options, digest) {\r\n    const url = options.url.replace(\"//\", \"\");\r\n    const uri = url.indexOf(\"/\") == -1 ? \"/\" : url.slice(url.indexOf(\"/\"));\r\n    const method = options.method ? options.method.toUpperCase() : \"GET\";\r\n    const qop = /(^|,)\\s*auth\\s*($|,)/.test(digest.qop) ? \"auth\" : false;\r\n    const ncString = `00000000${digest.nc}`.slice(-8);\r\n    const ha1 = ha1Compute(digest.algorithm, digest.username, digest.realm, digest.password, digest.nonce, digest.cnonce, digest.ha1);\r\n    const ha2 = md5(`${method}:${uri}`);\r\n    const digestResponse = qop\r\n        ? md5(`${ha1}:${digest.nonce}:${ncString}:${digest.cnonce}:${qop}:${ha2}`)\r\n        : md5(`${ha1}:${digest.nonce}:${ha2}`);\r\n    const authValues = {\r\n        username: digest.username,\r\n        realm: digest.realm,\r\n        nonce: digest.nonce,\r\n        uri,\r\n        qop,\r\n        response: digestResponse,\r\n        nc: ncString,\r\n        cnonce: digest.cnonce,\r\n        algorithm: digest.algorithm,\r\n        opaque: digest.opaque\r\n    };\r\n    const authHeader = [];\r\n    for (const k in authValues) {\r\n        if (authValues[k]) {\r\n            if (k === \"qop\" || k === \"nc\" || k === \"algorithm\") {\r\n                authHeader.push(`${k}=${authValues[k]}`);\r\n            }\r\n            else {\r\n                authHeader.push(`${k}=\"${authValues[k]}\"`);\r\n            }\r\n        }\r\n    }\r\n    return `Digest ${authHeader.join(\", \")}`;\r\n}\r\nfunction makeNonce() {\r\n    let uid = \"\";\r\n    for (let i = 0; i < NONCE_SIZE; ++i) {\r\n        uid = `${uid}${NONCE_CHARS[Math.floor(Math.random() * NONCE_CHARS.length)]}`;\r\n    }\r\n    return uid;\r\n}\r\nexport function parseDigestAuth(response, _digest) {\r\n    const isDigest = responseIndicatesDigestAuth(response);\r\n    if (!isDigest) {\r\n        return false;\r\n    }\r\n    const re = /([a-z0-9_-]+)=(?:\"([^\"]+)\"|([a-z0-9_-]+))/gi;\r\n    for (;;) {\r\n        const authHeader = (response.headers && response.headers.get(\"www-authenticate\")) || \"\";\r\n        const match = re.exec(authHeader);\r\n        if (!match) {\r\n            break;\r\n        }\r\n        _digest[match[1]] = match[2] || match[3];\r\n    }\r\n    _digest.nc += 1;\r\n    _digest.cnonce = makeNonce();\r\n    return true;\r\n}\r\nexport function responseIndicatesDigestAuth(response) {\r\n    const authHeader = (response.headers && response.headers.get(\"www-authenticate\")) || \"\";\r\n    return authHeader.split(/\\s/)[0].toLowerCase() === \"digest\";\r\n}\r\n", "import md5 from \"md5\";\r\nexport function ha1Compute(algorithm, user, realm, pass, nonce, cnonce, ha1) {\r\n    const ha1Hash = ha1 || md5(`${user}:${realm}:${pass}`);\r\n    if (algorithm && algorithm.toLowerCase() === \"md5-sess\") {\r\n        return md5(`${ha1Hash}:${nonce}:${cnonce}`);\r\n    }\r\n    return ha1Hash;\r\n}\r\n", "import base64 from \"base-64\";\r\nimport { decodeHTML } from \"entities\";\r\nimport { isWeb } from \"../compat/env.js\";\r\nexport function decodeHTMLEntities(text) {\r\n    if (isWeb()) {\r\n        const txt = document.createElement(\"textarea\");\r\n        txt.innerHTML = text;\r\n        return txt.value;\r\n    }\r\n    return decodeHTML(text);\r\n}\r\nexport function fromBase64(text) {\r\n    return base64.decode(text);\r\n}\r\nexport function toBase64(text) {\r\n    return base64.encode(text);\r\n}\r\n", "// Adapted from https://github.com/mathiasbynens/he/blob/36afe179392226cf1b6ccdb16ebbb7a5a844d93a/src/he.js#L106-L134\r\n\r\nconst decodeMap = new Map([\r\n    [0, 65_533],\r\n    // C1 Unicode control character reference replacements\r\n    [128, 8364],\r\n    [130, 8218],\r\n    [131, 402],\r\n    [132, 8222],\r\n    [133, 8230],\r\n    [134, 8224],\r\n    [135, 8225],\r\n    [136, 710],\r\n    [137, 8240],\r\n    [138, 352],\r\n    [139, 8249],\r\n    [140, 338],\r\n    [142, 381],\r\n    [145, 8216],\r\n    [146, 8217],\r\n    [147, 8220],\r\n    [148, 8221],\r\n    [149, 8226],\r\n    [150, 8211],\r\n    [151, 8212],\r\n    [152, 732],\r\n    [153, 8482],\r\n    [154, 353],\r\n    [155, 8250],\r\n    [156, 339],\r\n    [158, 382],\r\n    [159, 376],\r\n]);\r\n\r\n/**\r\n * Polyfill for `String.fromCodePoint`. It is used to create a string from a Unicode code point.\r\n */\r\nexport const fromCodePoint: (...codePoints: number[]) => string =\r\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition, n/no-unsupported-features/es-builtins\r\n    String.fromCodePoint ??\r\n    function (codePoint: number): string {\r\n        let output = \"\";\r\n\r\n        if (codePoint > 0xff_ff) {\r\n            codePoint -= 0x1_00_00;\r\n            output += String.fromCharCode(\r\n                ((codePoint >>> 10) & 0x3_ff) | 0xd8_00,\r\n            );\r\n            codePoint = 0xdc_00 | (codePoint & 0x3_ff);\r\n        }\r\n\r\n        output += String.fromCharCode(codePoint);\r\n        return output;\r\n    };\r\n\r\n/**\r\n * Replace the given code point with a replacement character if it is a\r\n * surrogate or is outside the valid range. Otherwise return the code\r\n * point unchanged.\r\n */\r\nexport function replaceCodePoint(codePoint: number): number {\r\n    if (\r\n        (codePoint >= 0xd8_00 && codePoint <= 0xdf_ff) ||\r\n        codePoint > 0x10_ff_ff\r\n    ) {\r\n        return 0xff_fd;\r\n    }\r\n\r\n    return decodeMap.get(codePoint) ?? codePoint;\r\n}\r\n\r\n/**\r\n * Replace the code point if relevant, then convert it to a string.\r\n *\r\n * @deprecated Use `fromCodePoint(replaceCodePoint(codePoint))` instead.\r\n * @param codePoint The code point to decode.\r\n * @returns The decoded code point.\r\n */\r\nexport function decodeCodePoint(codePoint: number): string {\r\n    return fromCodePoint(replaceCodePoint(codePoint));\r\n}\r\n", "import { htmlDecodeTree } from \"./generated/decode-data-html.js\";\r\nimport { xmlDecodeTree } from \"./generated/decode-data-xml.js\";\r\nimport { replaceCodePoint, fromCodePoint } from \"./decode-codepoint.js\";\r\n\r\nconst enum CharCodes {\r\n    NUM = 35, // \"#\"\r\n    SEMI = 59, // \";\"\r\n    EQUALS = 61, // \"=\"\r\n    ZERO = 48, // \"0\"\r\n    NINE = 57, // \"9\"\r\n    LOWER_A = 97, // \"a\"\r\n    LOWER_F = 102, // \"f\"\r\n    LOWER_X = 120, // \"x\"\r\n    LOWER_Z = 122, // \"z\"\r\n    UPPER_A = 65, // \"A\"\r\n    UPPER_F = 70, // \"F\"\r\n    UPPER_Z = 90, // \"Z\"\r\n}\r\n\r\n/** Bit that needs to be set to convert an upper case ASCII character to lower case */\r\nconst TO_LOWER_BIT = 0b10_0000;\r\n\r\nexport enum BinTrieFlags {\r\n    VALUE_LENGTH = 0b1100_0000_0000_0000,\r\n    BRANCH_LENGTH = 0b0011_1111_1000_0000,\r\n    JUMP_TABLE = 0b0000_0000_0111_1111,\r\n}\r\n\r\nfunction isNumber(code: number): boolean {\r\n    return code >= CharCodes.ZERO && code <= CharCodes.NINE;\r\n}\r\n\r\nfunction isHexadecimalCharacter(code: number): boolean {\r\n    return (\r\n        (code >= CharCodes.UPPER_A && code <= CharCodes.UPPER_F) ||\r\n        (code >= CharCodes.LOWER_A && code <= CharCodes.LOWER_F)\r\n    );\r\n}\r\n\r\nfunction isAsciiAlphaNumeric(code: number): boolean {\r\n    return (\r\n        (code >= CharCodes.UPPER_A && code <= CharCodes.UPPER_Z) ||\r\n        (code >= CharCodes.LOWER_A && code <= CharCodes.LOWER_Z) ||\r\n        isNumber(code)\r\n    );\r\n}\r\n\r\n/**\r\n * Checks if the given character is a valid end character for an entity in an attribute.\r\n *\r\n * Attribute values that aren't terminated properly aren't parsed, and shouldn't lead to a parser error.\r\n * See the example in https://html.spec.whatwg.org/multipage/parsing.html#named-character-reference-state\r\n */\r\nfunction isEntityInAttributeInvalidEnd(code: number): boolean {\r\n    return code === CharCodes.EQUALS || isAsciiAlphaNumeric(code);\r\n}\r\n\r\nconst enum EntityDecoderState {\r\n    EntityStart,\r\n    NumericStart,\r\n    NumericDecimal,\r\n    NumericHex,\r\n    NamedEntity,\r\n}\r\n\r\nexport enum DecodingMode {\r\n    /** Entities in text nodes that can end with any character. */\r\n    Legacy = 0,\r\n    /** Only allow entities terminated with a semicolon. */\r\n    Strict = 1,\r\n    /** Entities in attributes have limitations on ending characters. */\r\n    Attribute = 2,\r\n}\r\n\r\n/**\r\n * Producers for character reference errors as defined in the HTML spec.\r\n */\r\nexport interface EntityErrorProducer {\r\n    missingSemicolonAfterCharacterReference(): void;\r\n    absenceOfDigitsInNumericCharacterReference(\r\n        consumedCharacters: number,\r\n    ): void;\r\n    validateNumericCharacterReference(code: number): void;\r\n}\r\n\r\n/**\r\n * Token decoder with support of writing partial entities.\r\n */\r\nexport class EntityDecoder {\r\n    constructor(\r\n        /** The tree used to decode entities. */\r\n        private readonly decodeTree: Uint16Array,\r\n        /**\r\n         * The function that is called when a codepoint is decoded.\r\n         *\r\n         * For multi-byte named entities, this will be called multiple times,\r\n         * with the second codepoint, and the same `consumed` value.\r\n         *\r\n         * @param codepoint The decoded codepoint.\r\n         * @param consumed The number of bytes consumed by the decoder.\r\n         */\r\n        private readonly emitCodePoint: (cp: number, consumed: number) => void,\r\n        /** An object that is used to produce errors. */\r\n        private readonly errors?: EntityErrorProducer | undefined,\r\n    ) {}\r\n\r\n    /** The current state of the decoder. */\r\n    private state = EntityDecoderState.EntityStart;\r\n    /** Characters that were consumed while parsing an entity. */\r\n    private consumed = 1;\r\n    /**\r\n     * The result of the entity.\r\n     *\r\n     * Either the result index of a numeric entity, or the codepoint of a\r\n     * numeric entity.\r\n     */\r\n    private result = 0;\r\n\r\n    /** The current index in the decode tree. */\r\n    private treeIndex = 0;\r\n    /** The number of characters that were consumed in excess. */\r\n    private excess = 1;\r\n    /** The mode in which the decoder is operating. */\r\n    private decodeMode = DecodingMode.Strict;\r\n\r\n    /** Resets the instance to make it reusable. */\r\n    startEntity(decodeMode: DecodingMode): void {\r\n        this.decodeMode = decodeMode;\r\n        this.state = EntityDecoderState.EntityStart;\r\n        this.result = 0;\r\n        this.treeIndex = 0;\r\n        this.excess = 1;\r\n        this.consumed = 1;\r\n    }\r\n\r\n    /**\r\n     * Write an entity to the decoder. This can be called multiple times with partial entities.\r\n     * If the entity is incomplete, the decoder will return -1.\r\n     *\r\n     * Mirrors the implementation of `getDecoder`, but with the ability to stop decoding if the\r\n     * entity is incomplete, and resume when the next string is written.\r\n     *\r\n     * @param input The string containing the entity (or a continuation of the entity).\r\n     * @param offset The offset at which the entity begins. Should be 0 if this is not the first call.\r\n     * @returns The number of characters that were consumed, or -1 if the entity is incomplete.\r\n     */\r\n    write(input: string, offset: number): number {\r\n        switch (this.state) {\r\n            case EntityDecoderState.EntityStart: {\r\n                if (input.charCodeAt(offset) === CharCodes.NUM) {\r\n                    this.state = EntityDecoderState.NumericStart;\r\n                    this.consumed += 1;\r\n                    return this.stateNumericStart(input, offset + 1);\r\n                }\r\n                this.state = EntityDecoderState.NamedEntity;\r\n                return this.stateNamedEntity(input, offset);\r\n            }\r\n\r\n            case EntityDecoderState.NumericStart: {\r\n                return this.stateNumericStart(input, offset);\r\n            }\r\n\r\n            case EntityDecoderState.NumericDecimal: {\r\n                return this.stateNumericDecimal(input, offset);\r\n            }\r\n\r\n            case EntityDecoderState.NumericHex: {\r\n                return this.stateNumericHex(input, offset);\r\n            }\r\n\r\n            case EntityDecoderState.NamedEntity: {\r\n                return this.stateNamedEntity(input, offset);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Switches between the numeric decimal and hexadecimal states.\r\n     *\r\n     * Equivalent to the `Numeric character reference state` in the HTML spec.\r\n     *\r\n     * @param input The string containing the entity (or a continuation of the entity).\r\n     * @param offset The current offset.\r\n     * @returns The number of characters that were consumed, or -1 if the entity is incomplete.\r\n     */\r\n    private stateNumericStart(input: string, offset: number): number {\r\n        if (offset >= input.length) {\r\n            return -1;\r\n        }\r\n\r\n        if ((input.charCodeAt(offset) | TO_LOWER_BIT) === CharCodes.LOWER_X) {\r\n            this.state = EntityDecoderState.NumericHex;\r\n            this.consumed += 1;\r\n            return this.stateNumericHex(input, offset + 1);\r\n        }\r\n\r\n        this.state = EntityDecoderState.NumericDecimal;\r\n        return this.stateNumericDecimal(input, offset);\r\n    }\r\n\r\n    private addToNumericResult(\r\n        input: string,\r\n        start: number,\r\n        end: number,\r\n        base: number,\r\n    ): void {\r\n        if (start !== end) {\r\n            const digitCount = end - start;\r\n            this.result =\r\n                this.result * Math.pow(base, digitCount) +\r\n                Number.parseInt(input.substr(start, digitCount), base);\r\n            this.consumed += digitCount;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Parses a hexadecimal numeric entity.\r\n     *\r\n     * Equivalent to the `Hexademical character reference state` in the HTML spec.\r\n     *\r\n     * @param input The string containing the entity (or a continuation of the entity).\r\n     * @param offset The current offset.\r\n     * @returns The number of characters that were consumed, or -1 if the entity is incomplete.\r\n     */\r\n    private stateNumericHex(input: string, offset: number): number {\r\n        const startIndex = offset;\r\n\r\n        while (offset < input.length) {\r\n            const char = input.charCodeAt(offset);\r\n            if (isNumber(char) || isHexadecimalCharacter(char)) {\r\n                offset += 1;\r\n            } else {\r\n                this.addToNumericResult(input, startIndex, offset, 16);\r\n                return this.emitNumericEntity(char, 3);\r\n            }\r\n        }\r\n\r\n        this.addToNumericResult(input, startIndex, offset, 16);\r\n\r\n        return -1;\r\n    }\r\n\r\n    /**\r\n     * Parses a decimal numeric entity.\r\n     *\r\n     * Equivalent to the `Decimal character reference state` in the HTML spec.\r\n     *\r\n     * @param input The string containing the entity (or a continuation of the entity).\r\n     * @param offset The current offset.\r\n     * @returns The number of characters that were consumed, or -1 if the entity is incomplete.\r\n     */\r\n    private stateNumericDecimal(input: string, offset: number): number {\r\n        const startIndex = offset;\r\n\r\n        while (offset < input.length) {\r\n            const char = input.charCodeAt(offset);\r\n            if (isNumber(char)) {\r\n                offset += 1;\r\n            } else {\r\n                this.addToNumericResult(input, startIndex, offset, 10);\r\n                return this.emitNumericEntity(char, 2);\r\n            }\r\n        }\r\n\r\n        this.addToNumericResult(input, startIndex, offset, 10);\r\n\r\n        return -1;\r\n    }\r\n\r\n    /**\r\n     * Validate and emit a numeric entity.\r\n     *\r\n     * Implements the logic from the `Hexademical character reference start\r\n     * state` and `Numeric character reference end state` in the HTML spec.\r\n     *\r\n     * @param lastCp The last code point of the entity. Used to see if the\r\n     *               entity was terminated with a semicolon.\r\n     * @param expectedLength The minimum number of characters that should be\r\n     *                       consumed. Used to validate that at least one digit\r\n     *                       was consumed.\r\n     * @returns The number of characters that were consumed.\r\n     */\r\n    private emitNumericEntity(lastCp: number, expectedLength: number): number {\r\n        // Ensure we consumed at least one digit.\r\n        if (this.consumed <= expectedLength) {\r\n            this.errors?.absenceOfDigitsInNumericCharacterReference(\r\n                this.consumed,\r\n            );\r\n            return 0;\r\n        }\r\n\r\n        // Figure out if this is a legit end of the entity\r\n        if (lastCp === CharCodes.SEMI) {\r\n            this.consumed += 1;\r\n        } else if (this.decodeMode === DecodingMode.Strict) {\r\n            return 0;\r\n        }\r\n\r\n        this.emitCodePoint(replaceCodePoint(this.result), this.consumed);\r\n\r\n        if (this.errors) {\r\n            if (lastCp !== CharCodes.SEMI) {\r\n                this.errors.missingSemicolonAfterCharacterReference();\r\n            }\r\n\r\n            this.errors.validateNumericCharacterReference(this.result);\r\n        }\r\n\r\n        return this.consumed;\r\n    }\r\n\r\n    /**\r\n     * Parses a named entity.\r\n     *\r\n     * Equivalent to the `Named character reference state` in the HTML spec.\r\n     *\r\n     * @param input The string containing the entity (or a continuation of the entity).\r\n     * @param offset The current offset.\r\n     * @returns The number of characters that were consumed, or -1 if the entity is incomplete.\r\n     */\r\n    private stateNamedEntity(input: string, offset: number): number {\r\n        const { decodeTree } = this;\r\n        let current = decodeTree[this.treeIndex];\r\n        // The mask is the number of bytes of the value, including the current byte.\r\n        let valueLength = (current & BinTrieFlags.VALUE_LENGTH) >> 14;\r\n\r\n        for (; offset < input.length; offset++, this.excess++) {\r\n            const char = input.charCodeAt(offset);\r\n\r\n            this.treeIndex = determineBranch(\r\n                decodeTree,\r\n                current,\r\n                this.treeIndex + Math.max(1, valueLength),\r\n                char,\r\n            );\r\n\r\n            if (this.treeIndex < 0) {\r\n                return this.result === 0 ||\r\n                    // If we are parsing an attribute\r\n                    (this.decodeMode === DecodingMode.Attribute &&\r\n                        // We shouldn't have consumed any characters after the entity,\r\n                        (valueLength === 0 ||\r\n                            // And there should be no invalid characters.\r\n                            isEntityInAttributeInvalidEnd(char)))\r\n                    ? 0\r\n                    : this.emitNotTerminatedNamedEntity();\r\n            }\r\n\r\n            current = decodeTree[this.treeIndex];\r\n            valueLength = (current & BinTrieFlags.VALUE_LENGTH) >> 14;\r\n\r\n            // If the branch is a value, store it and continue\r\n            if (valueLength !== 0) {\r\n                // If the entity is terminated by a semicolon, we are done.\r\n                if (char === CharCodes.SEMI) {\r\n                    return this.emitNamedEntityData(\r\n                        this.treeIndex,\r\n                        valueLength,\r\n                        this.consumed + this.excess,\r\n                    );\r\n                }\r\n\r\n                // If we encounter a non-terminated (legacy) entity while parsing strictly, then ignore it.\r\n                if (this.decodeMode !== DecodingMode.Strict) {\r\n                    this.result = this.treeIndex;\r\n                    this.consumed += this.excess;\r\n                    this.excess = 0;\r\n                }\r\n            }\r\n        }\r\n\r\n        return -1;\r\n    }\r\n\r\n    /**\r\n     * Emit a named entity that was not terminated with a semicolon.\r\n     *\r\n     * @returns The number of characters consumed.\r\n     */\r\n    private emitNotTerminatedNamedEntity(): number {\r\n        const { result, decodeTree } = this;\r\n\r\n        const valueLength =\r\n            (decodeTree[result] & BinTrieFlags.VALUE_LENGTH) >> 14;\r\n\r\n        this.emitNamedEntityData(result, valueLength, this.consumed);\r\n        this.errors?.missingSemicolonAfterCharacterReference();\r\n\r\n        return this.consumed;\r\n    }\r\n\r\n    /**\r\n     * Emit a named entity.\r\n     *\r\n     * @param result The index of the entity in the decode tree.\r\n     * @param valueLength The number of bytes in the entity.\r\n     * @param consumed The number of characters consumed.\r\n     *\r\n     * @returns The number of characters consumed.\r\n     */\r\n    private emitNamedEntityData(\r\n        result: number,\r\n        valueLength: number,\r\n        consumed: number,\r\n    ): number {\r\n        const { decodeTree } = this;\r\n\r\n        this.emitCodePoint(\r\n            valueLength === 1\r\n                ? decodeTree[result] & ~BinTrieFlags.VALUE_LENGTH\r\n                : decodeTree[result + 1],\r\n            consumed,\r\n        );\r\n        if (valueLength === 3) {\r\n            // For multi-byte values, we need to emit the second byte.\r\n            this.emitCodePoint(decodeTree[result + 2], consumed);\r\n        }\r\n\r\n        return consumed;\r\n    }\r\n\r\n    /**\r\n     * Signal to the parser that the end of the input was reached.\r\n     *\r\n     * Remaining data will be emitted and relevant errors will be produced.\r\n     *\r\n     * @returns The number of characters consumed.\r\n     */\r\n    end(): number {\r\n        switch (this.state) {\r\n            case EntityDecoderState.NamedEntity: {\r\n                // Emit a named entity if we have one.\r\n                return this.result !== 0 &&\r\n                    (this.decodeMode !== DecodingMode.Attribute ||\r\n                        this.result === this.treeIndex)\r\n                    ? this.emitNotTerminatedNamedEntity()\r\n                    : 0;\r\n            }\r\n            // Otherwise, emit a numeric entity if we have one.\r\n            case EntityDecoderState.NumericDecimal: {\r\n                return this.emitNumericEntity(0, 2);\r\n            }\r\n            case EntityDecoderState.NumericHex: {\r\n                return this.emitNumericEntity(0, 3);\r\n            }\r\n            case EntityDecoderState.NumericStart: {\r\n                this.errors?.absenceOfDigitsInNumericCharacterReference(\r\n                    this.consumed,\r\n                );\r\n                return 0;\r\n            }\r\n            case EntityDecoderState.EntityStart: {\r\n                // Return 0 if we have no entity.\r\n                return 0;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Creates a function that decodes entities in a string.\r\n *\r\n * @param decodeTree The decode tree.\r\n * @returns A function that decodes entities in a string.\r\n */\r\nfunction getDecoder(decodeTree: Uint16Array) {\r\n    let returnValue = \"\";\r\n    const decoder = new EntityDecoder(\r\n        decodeTree,\r\n        (data) => (returnValue += fromCodePoint(data)),\r\n    );\r\n\r\n    return function decodeWithTrie(\r\n        input: string,\r\n        decodeMode: DecodingMode,\r\n    ): string {\r\n        let lastIndex = 0;\r\n        let offset = 0;\r\n\r\n        while ((offset = input.indexOf(\"&\", offset)) >= 0) {\r\n            returnValue += input.slice(lastIndex, offset);\r\n\r\n            decoder.startEntity(decodeMode);\r\n\r\n            const length = decoder.write(\r\n                input,\r\n                // Skip the \"&\"\r\n                offset + 1,\r\n            );\r\n\r\n            if (length < 0) {\r\n                lastIndex = offset + decoder.end();\r\n                break;\r\n            }\r\n\r\n            lastIndex = offset + length;\r\n            // If `length` is 0, skip the current `&` and continue.\r\n            offset = length === 0 ? lastIndex + 1 : lastIndex;\r\n        }\r\n\r\n        const result = returnValue + input.slice(lastIndex);\r\n\r\n        // Make sure we don't keep a reference to the final string.\r\n        returnValue = \"\";\r\n\r\n        return result;\r\n    };\r\n}\r\n\r\n/**\r\n * Determines the branch of the current node that is taken given the current\r\n * character. This function is used to traverse the trie.\r\n *\r\n * @param decodeTree The trie.\r\n * @param current The current node.\r\n * @param nodeIdx The index right after the current node and its value.\r\n * @param char The current character.\r\n * @returns The index of the next node, or -1 if no branch is taken.\r\n */\r\nexport function determineBranch(\r\n    decodeTree: Uint16Array,\r\n    current: number,\r\n    nodeIndex: number,\r\n    char: number,\r\n): number {\r\n    const branchCount = (current & BinTrieFlags.BRANCH_LENGTH) >> 7;\r\n    const jumpOffset = current & BinTrieFlags.JUMP_TABLE;\r\n\r\n    // Case 1: Single branch encoded in jump offset\r\n    if (branchCount === 0) {\r\n        return jumpOffset !== 0 && char === jumpOffset ? nodeIndex : -1;\r\n    }\r\n\r\n    // Case 2: Multiple branches encoded in jump table\r\n    if (jumpOffset) {\r\n        const value = char - jumpOffset;\r\n\r\n        return value < 0 || value >= branchCount\r\n            ? -1\r\n            : decodeTree[nodeIndex + value] - 1;\r\n    }\r\n\r\n    // Case 3: Multiple branches encoded in dictionary\r\n\r\n    // Binary search for the character.\r\n    let lo = nodeIndex;\r\n    let hi = lo + branchCount - 1;\r\n\r\n    while (lo <= hi) {\r\n        const mid = (lo + hi) >>> 1;\r\n        const midValue = decodeTree[mid];\r\n\r\n        if (midValue < char) {\r\n            lo = mid + 1;\r\n        } else if (midValue > char) {\r\n            hi = mid - 1;\r\n        } else {\r\n            return decodeTree[mid + branchCount];\r\n        }\r\n    }\r\n\r\n    return -1;\r\n}\r\n\r\nconst htmlDecoder = /* #__PURE__ */ getDecoder(htmlDecodeTree);\r\nconst xmlDecoder = /* #__PURE__ */ getDecoder(xmlDecodeTree);\r\n\r\n/**\r\n * Decodes an HTML string.\r\n *\r\n * @param htmlString The string to decode.\r\n * @param mode The decoding mode.\r\n * @returns The decoded string.\r\n */\r\nexport function decodeHTML(\r\n    htmlString: string,\r\n    mode: DecodingMode = DecodingMode.Legacy,\r\n): string {\r\n    return htmlDecoder(htmlString, mode);\r\n}\r\n\r\n/**\r\n * Decodes an HTML string in an attribute.\r\n *\r\n * @param htmlAttribute The string to decode.\r\n * @returns The decoded string.\r\n */\r\nexport function decodeHTMLAttribute(htmlAttribute: string): string {\r\n    return htmlDecoder(htmlAttribute, DecodingMode.Attribute);\r\n}\r\n\r\n/**\r\n * Decodes an HTML string, requiring all entities to be terminated by a semicolon.\r\n *\r\n * @param htmlString The string to decode.\r\n * @returns The decoded string.\r\n */\r\nexport function decodeHTMLStrict(htmlString: string): string {\r\n    return htmlDecoder(htmlString, DecodingMode.Strict);\r\n}\r\n\r\n/**\r\n * Decodes an XML string, requiring all entities to be terminated by a semicolon.\r\n *\r\n * @param xmlString The string to decode.\r\n * @returns The decoded string.\r\n */\r\nexport function decodeXML(xmlString: string): string {\r\n    return xmlDecoder(xmlString, DecodingMode.Strict);\r\n}\r\n\r\n// Re-export for use by eg. htmlparser2\r\nexport { htmlDecodeTree } from \"./generated/decode-data-html.js\";\r\nexport { xmlDecodeTree } from \"./generated/decode-data-xml.js\";\r\n\r\nexport {\r\n    decodeCodePoint,\r\n    replaceCodePoint,\r\n    fromCodePoint,\r\n} from \"./decode-codepoint.js\";\r\n", "export const xmlReplacer: RegExp = /[\"$&'<>\\u0080-\\uFFFF]/g;\r\n\r\nconst xmlCodeMap = new Map([\r\n    [34, \"&quot;\"],\r\n    [38, \"&amp;\"],\r\n    [39, \"&apos;\"],\r\n    [60, \"&lt;\"],\r\n    [62, \"&gt;\"],\r\n]);\r\n\r\n// For compatibility with node < 4, we wrap `codePointAt`\r\nexport const getCodePoint: (c: string, index: number) => number =\r\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\r\n    String.prototype.codePointAt == null\r\n        ? (c: string, index: number): number =>\r\n              (c.charCodeAt(index) & 0xfc_00) === 0xd8_00\r\n                  ? (c.charCodeAt(index) - 0xd8_00) * 0x4_00 +\r\n                    c.charCodeAt(index + 1) -\r\n                    0xdc_00 +\r\n                    0x1_00_00\r\n                  : c.charCodeAt(index)\r\n        : // http://mathiasbynens.be/notes/javascript-encoding#surrogate-formulae\r\n          (input: string, index: number): number => input.codePointAt(index)!;\r\n\r\n/**\r\n * Encodes all non-ASCII characters, as well as characters not valid in XML\r\n * documents using XML entities.\r\n *\r\n * If a character has no equivalent entity, a\r\n * numeric hexadecimal reference (eg. `&#xfc;`) will be used.\r\n */\r\nexport function encodeXML(input: string): string {\r\n    let returnValue = \"\";\r\n    let lastIndex = 0;\r\n    let match;\r\n\r\n    while ((match = xmlReplacer.exec(input)) !== null) {\r\n        const { index } = match;\r\n        const char = input.charCodeAt(index);\r\n        const next = xmlCodeMap.get(char);\r\n\r\n        if (next === undefined) {\r\n            returnValue += `${input.substring(lastIndex, index)}&#x${getCodePoint(\r\n                input,\r\n                index,\r\n            ).toString(16)};`;\r\n            // Increase by 1 if we have a surrogate pair\r\n            lastIndex = xmlReplacer.lastIndex += Number(\r\n                (char & 0xfc_00) === 0xd8_00,\r\n            );\r\n        } else {\r\n            returnValue += input.substring(lastIndex, index) + next;\r\n            lastIndex = index + 1;\r\n        }\r\n    }\r\n\r\n    return returnValue + input.substr(lastIndex);\r\n}\r\n\r\n/**\r\n * Encodes all non-ASCII characters, as well as characters not valid in XML\r\n * documents using numeric hexadecimal reference (eg. `&#xfc;`).\r\n *\r\n * Have a look at `escapeUTF8` if you want a more concise output at the expense\r\n * of reduced transportability.\r\n *\r\n * @param data String to escape.\r\n */\r\nexport const escape: typeof encodeXML = encodeXML;\r\n\r\n/**\r\n * Creates a function that escapes all characters matched by the given regular\r\n * expression using the given map of characters to escape to their entities.\r\n *\r\n * @param regex Regular expression to match characters to escape.\r\n * @param map Map of characters to escape to their entities.\r\n *\r\n * @returns Function that escapes all characters matched by the given regular\r\n * expression using the given map of characters to escape to their entities.\r\n */\r\nfunction getEscaper(\r\n    regex: RegExp,\r\n    map: Map<number, string>,\r\n): (data: string) => string {\r\n    return function escape(data: string): string {\r\n        let match;\r\n        let lastIndex = 0;\r\n        let result = \"\";\r\n\r\n        while ((match = regex.exec(data))) {\r\n            if (lastIndex !== match.index) {\r\n                result += data.substring(lastIndex, match.index);\r\n            }\r\n\r\n            // We know that this character will be in the map.\r\n            result += map.get(match[0].charCodeAt(0))!;\r\n\r\n            // Every match will be of length 1\r\n            lastIndex = match.index + 1;\r\n        }\r\n\r\n        return result + data.substring(lastIndex);\r\n    };\r\n}\r\n\r\n/**\r\n * Encodes all characters not valid in XML documents using XML entities.\r\n *\r\n * Note that the output will be character-set dependent.\r\n *\r\n * @param data String to escape.\r\n */\r\nexport const escapeUTF8: (data: string) => string = /* #__PURE__ */ getEscaper(\r\n    /[\"&'<>]/g,\r\n    xmlCodeMap,\r\n);\r\n\r\n/**\r\n * Encodes all characters that have to be escaped in HTML attributes,\r\n * following {@link https://html.spec.whatwg.org/multipage/parsing.html#escapingString}.\r\n *\r\n * @param data String to escape.\r\n */\r\nexport const escapeAttribute: (data: string) => string =\r\n    /* #__PURE__ */ getEscaper(\r\n        /[\"&\\u00A0]/g,\r\n        new Map([\r\n            [34, \"&quot;\"],\r\n            [38, \"&amp;\"],\r\n            [160, \"&nbsp;\"],\r\n        ]),\r\n    );\r\n\r\n/**\r\n * Encodes all characters that have to be escaped in HTML text,\r\n * following {@link https://html.spec.whatwg.org/multipage/parsing.html#escapingString}.\r\n *\r\n * @param data String to escape.\r\n */\r\nexport const escapeText: (data: string) => string = /* #__PURE__ */ getEscaper(\r\n    /[&<>\\u00A0]/g,\r\n    new Map([\r\n        [38, \"&amp;\"],\r\n        [60, \"&lt;\"],\r\n        [62, \"&gt;\"],\r\n        [160, \"&nbsp;\"],\r\n    ]),\r\n);\r\n", "import { decodeXML, decodeHTML, DecodingMode } from \"./decode.js\";\r\nimport { encodeHTML, encodeNonAsciiHTML } from \"./encode.js\";\r\nimport {\r\n    encodeXML,\r\n    escapeUTF8,\r\n    escapeAttribute,\r\n    escapeText,\r\n} from \"./escape.js\";\r\n\r\n/** The level of entities to support. */\r\nexport enum EntityLevel {\r\n    /** Support only XML entities. */\r\n    XML = 0,\r\n    /** Support HTML entities, which are a superset of XML entities. */\r\n    HTML = 1,\r\n}\r\n\r\nexport enum EncodingMode {\r\n    /**\r\n     * The output is UTF-8 encoded. Only characters that need escaping within\r\n     * XML will be escaped.\r\n     */\r\n    UTF8,\r\n    /**\r\n     * The output consists only of ASCII characters. Characters that need\r\n     * escaping within HTML, and characters that aren't ASCII characters will\r\n     * be escaped.\r\n     */\r\n    ASCII,\r\n    /**\r\n     * Encode all characters that have an equivalent entity, as well as all\r\n     * characters that are not ASCII characters.\r\n     */\r\n    Extensive,\r\n    /**\r\n     * Encode all characters that have to be escaped in HTML attributes,\r\n     * following {@link https://html.spec.whatwg.org/multipage/parsing.html#escapingString}.\r\n     */\r\n    Attribute,\r\n    /**\r\n     * Encode all characters that have to be escaped in HTML text,\r\n     * following {@link https://html.spec.whatwg.org/multipage/parsing.html#escapingString}.\r\n     */\r\n    Text,\r\n}\r\n\r\nexport interface DecodingOptions {\r\n    /**\r\n     * The level of entities to support.\r\n     * @default {@link EntityLevel.XML}\r\n     */\r\n    level?: EntityLevel;\r\n    /**\r\n     * Decoding mode. If `Legacy`, will support legacy entities not terminated\r\n     * with a semicolon (`;`).\r\n     *\r\n     * Always `Strict` for XML. For HTML, set this to `true` if you are parsing\r\n     * an attribute value.\r\n     *\r\n     * The deprecated `decodeStrict` function defaults this to `Strict`.\r\n     *\r\n     * @default {@link DecodingMode.Legacy}\r\n     */\r\n    mode?: DecodingMode | undefined;\r\n}\r\n\r\n/**\r\n * Decodes a string with entities.\r\n *\r\n * @param input String to decode.\r\n * @param options Decoding options.\r\n */\r\nexport function decode(\r\n    input: string,\r\n    options: DecodingOptions | EntityLevel = EntityLevel.XML,\r\n): string {\r\n    const level = typeof options === \"number\" ? options : options.level;\r\n\r\n    if (level === EntityLevel.HTML) {\r\n        const mode = typeof options === \"object\" ? options.mode : undefined;\r\n        return decodeHTML(input, mode);\r\n    }\r\n\r\n    return decodeXML(input);\r\n}\r\n\r\n/**\r\n * Decodes a string with entities. Does not allow missing trailing semicolons for entities.\r\n *\r\n * @param input String to decode.\r\n * @param options Decoding options.\r\n * @deprecated Use `decode` with the `mode` set to `Strict`.\r\n */\r\nexport function decodeStrict(\r\n    input: string,\r\n    options: DecodingOptions | EntityLevel = EntityLevel.XML,\r\n): string {\r\n    const normalizedOptions =\r\n        typeof options === \"number\" ? { level: options } : options;\r\n    normalizedOptions.mode ??= DecodingMode.Strict;\r\n\r\n    return decode(input, normalizedOptions);\r\n}\r\n\r\n/**\r\n * Options for `encode`.\r\n */\r\nexport interface EncodingOptions {\r\n    /**\r\n     * The level of entities to support.\r\n     * @default {@link EntityLevel.XML}\r\n     */\r\n    level?: EntityLevel;\r\n    /**\r\n     * Output format.\r\n     * @default {@link EncodingMode.Extensive}\r\n     */\r\n    mode?: EncodingMode;\r\n}\r\n\r\n/**\r\n * Encodes a string with entities.\r\n *\r\n * @param input String to encode.\r\n * @param options Encoding options.\r\n */\r\nexport function encode(\r\n    input: string,\r\n    options: EncodingOptions | EntityLevel = EntityLevel.XML,\r\n): string {\r\n    const { mode = EncodingMode.Extensive, level = EntityLevel.XML } =\r\n        typeof options === \"number\" ? { level: options } : options;\r\n\r\n    switch (mode) {\r\n        case EncodingMode.UTF8: {\r\n            return escapeUTF8(input);\r\n        }\r\n        case EncodingMode.Attribute: {\r\n            return escapeAttribute(input);\r\n        }\r\n        case EncodingMode.Text: {\r\n            return escapeText(input);\r\n        }\r\n        case EncodingMode.ASCII: {\r\n            return level === EntityLevel.HTML\r\n                ? encodeNonAsciiHTML(input)\r\n                : encodeXML(input);\r\n        }\r\n        // eslint-disable-next-line unicorn/no-useless-switch-case\r\n        case EncodingMode.Extensive:\r\n        default: {\r\n            return level === EntityLevel.HTML\r\n                ? encodeHTML(input)\r\n                : encodeXML(input);\r\n        }\r\n    }\r\n}\r\n\r\nexport {\r\n    encodeXML,\r\n    escape,\r\n    escapeUTF8,\r\n    escapeAttribute,\r\n    escapeText,\r\n} from \"./escape.js\";\r\n\r\nexport {\r\n    encodeHTML,\r\n    encodeNonAsciiHTML,\r\n    // Legacy aliases (deprecated)\r\n    encodeHTML as encodeHTML4,\r\n    encodeHTML as encodeHTML5,\r\n} from \"./encode.js\";\r\n\r\nexport {\r\n    EntityDecoder,\r\n    DecodingMode,\r\n    decodeXML,\r\n    decodeHTML,\r\n    decodeHTMLStrict,\r\n    decodeHTMLAttribute,\r\n    // Legacy aliases (deprecated)\r\n    decodeHTML as decodeHTML4,\r\n    decodeHTML as decodeHTML5,\r\n    decodeHTMLStrict as decodeHTML4Strict,\r\n    decodeHTMLStrict as decodeHTML5Strict,\r\n    decodeXML as decodeXMLStrict,\r\n} from \"./decode.js\";\r\n", "export function getDebugBuildName() {\r\n    if (typeof TARGET === \"string\") {\r\n        return TARGET;\r\n    }\r\n    return \"node\";\r\n}\r\nexport function isReactNative() {\r\n    return typeof TARGET === \"string\" && TARGET === \"react-native\";\r\n}\r\nexport function isWeb() {\r\n    return typeof TARGET === \"string\" && TARGET === \"web\";\r\n}\r\n", "import { toBase64 } from \"../tools/encode.js\";\r\nexport function generateBasicAuthHeader(username, password) {\r\n    const encoded = toBase64(`${username}:${password}`);\r\n    return `Basic ${encoded}`;\r\n}\r\n", "export function generateTokenAuthHeader(token) {\r\n    return `${token.token_type} ${token.access_token}`;\r\n}\r\n", "/**\r\n * Index.js\r\n *\r\n * a request API compatible with window.fetch\r\n *\r\n * All spec algorithm step numbers are based on https://fetch.spec.whatwg.org/commit-snapshots/ae716822cb3a61843226cd090eefc6589446c1d2/.\r\n */\r\n\r\nimport http from 'node:http';\r\nimport https from 'node:https';\r\nimport zlib from 'node:zlib';\r\nimport Stream, {PassThrough, pipeline as pump} from 'node:stream';\r\nimport {Buffer} from 'node:buffer';\r\n\r\nimport dataUriToBuffer from 'data-uri-to-buffer';\r\n\r\nimport {writeToStream, clone} from './body.js';\r\nimport Response from './response.js';\r\nimport Headers, {fromRawHeaders} from './headers.js';\r\nimport Request, {getNodeRequestOptions} from './request.js';\r\nimport {FetchError} from './errors/fetch-error.js';\r\nimport {AbortError} from './errors/abort-error.js';\r\nimport {isRedirect} from './utils/is-redirect.js';\r\nimport {FormData} from 'formdata-polyfill/esm.min.js';\r\nimport {isDomainOrSubdomain, isSameProtocol} from './utils/is.js';\r\nimport {parseReferrerPolicyFromHeader} from './utils/referrer.js';\r\nimport {\r\n\tBlob,\r\n\tFile,\r\n\tfileFromSync,\r\n\tfileFrom,\r\n\tblobFromSync,\r\n\tblobFrom\r\n} from 'fetch-blob/from.js';\r\n\r\nexport {FormData, Headers, Request, Response, FetchError, AbortError, isRedirect};\r\nexport {Blob, File, fileFromSync, fileFrom, blobFromSync, blobFrom};\r\n\r\nconst supportedSchemas = new Set(['data:', 'http:', 'https:']);\r\n\r\n/**\r\n * Fetch function\r\n *\r\n * @param   {string | URL | import('./request').default} url - Absolute url or Request instance\r\n * @param   {*} [options_] - Fetch options\r\n * @return  {Promise<import('./response').default>}\r\n */\r\nexport default async function fetch(url, options_) {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\t// Build request object\r\n\t\tconst request = new Request(url, options_);\r\n\t\tconst {parsedURL, options} = getNodeRequestOptions(request);\r\n\t\tif (!supportedSchemas.has(parsedURL.protocol)) {\r\n\t\t\tthrow new TypeError(`node-fetch cannot load ${url}. URL scheme \"${parsedURL.protocol.replace(/:$/, '')}\" is not supported.`);\r\n\t\t}\r\n\r\n\t\tif (parsedURL.protocol === 'data:') {\r\n\t\t\tconst data = dataUriToBuffer(request.url);\r\n\t\t\tconst response = new Response(data, {headers: {'Content-Type': data.typeFull}});\r\n\t\t\tresolve(response);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Wrap http.request into fetch\r\n\t\tconst send = (parsedURL.protocol === 'https:' ? https : http).request;\r\n\t\tconst {signal} = request;\r\n\t\tlet response = null;\r\n\r\n\t\tconst abort = () => {\r\n\t\t\tconst error = new AbortError('The operation was aborted.');\r\n\t\t\treject(error);\r\n\t\t\tif (request.body && request.body instanceof Stream.Readable) {\r\n\t\t\t\trequest.body.destroy(error);\r\n\t\t\t}\r\n\r\n\t\t\tif (!response || !response.body) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tresponse.body.emit('error', error);\r\n\t\t};\r\n\r\n\t\tif (signal && signal.aborted) {\r\n\t\t\tabort();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst abortAndFinalize = () => {\r\n\t\t\tabort();\r\n\t\t\tfinalize();\r\n\t\t};\r\n\r\n\t\t// Send request\r\n\t\tconst request_ = send(parsedURL.toString(), options);\r\n\r\n\t\tif (signal) {\r\n\t\t\tsignal.addEventListener('abort', abortAndFinalize);\r\n\t\t}\r\n\r\n\t\tconst finalize = () => {\r\n\t\t\trequest_.abort();\r\n\t\t\tif (signal) {\r\n\t\t\t\tsignal.removeEventListener('abort', abortAndFinalize);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\trequest_.on('error', error => {\r\n\t\t\treject(new FetchError(`request to ${request.url} failed, reason: ${error.message}`, 'system', error));\r\n\t\t\tfinalize();\r\n\t\t});\r\n\r\n\t\tfixResponseChunkedTransferBadEnding(request_, error => {\r\n\t\t\tif (response && response.body) {\r\n\t\t\t\tresponse.body.destroy(error);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/* c8 ignore next 18 */\r\n\t\tif (process.version < 'v14') {\r\n\t\t\t// Before Node.js 14, pipeline() does not fully support async iterators and does not always\r\n\t\t\t// properly handle when the socket close/end events are out of order.\r\n\t\t\trequest_.on('socket', s => {\r\n\t\t\t\tlet endedWithEventsCount;\r\n\t\t\t\ts.prependListener('end', () => {\r\n\t\t\t\t\tendedWithEventsCount = s._eventsCount;\r\n\t\t\t\t});\r\n\t\t\t\ts.prependListener('close', hadError => {\r\n\t\t\t\t\t// if end happened before close but the socket didn't emit an error, do it now\r\n\t\t\t\t\tif (response && endedWithEventsCount < s._eventsCount && !hadError) {\r\n\t\t\t\t\t\tconst error = new Error('Premature close');\r\n\t\t\t\t\t\terror.code = 'ERR_STREAM_PREMATURE_CLOSE';\r\n\t\t\t\t\t\tresponse.body.emit('error', error);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\trequest_.on('response', response_ => {\r\n\t\t\trequest_.setTimeout(0);\r\n\t\t\tconst headers = fromRawHeaders(response_.rawHeaders);\r\n\r\n\t\t\t// HTTP fetch step 5\r\n\t\t\tif (isRedirect(response_.statusCode)) {\r\n\t\t\t\t// HTTP fetch step 5.2\r\n\t\t\t\tconst location = headers.get('Location');\r\n\r\n\t\t\t\t// HTTP fetch step 5.3\r\n\t\t\t\tlet locationURL = null;\r\n\t\t\t\ttry {\r\n\t\t\t\t\tlocationURL = location === null ? null : new URL(location, request.url);\r\n\t\t\t\t} catch {\r\n\t\t\t\t\t// error here can only be invalid URL in Location: header\r\n\t\t\t\t\t// do not throw when options.redirect == manual\r\n\t\t\t\t\t// let the user extract the errorneous redirect URL\r\n\t\t\t\t\tif (request.redirect !== 'manual') {\r\n\t\t\t\t\t\treject(new FetchError(`uri requested responds with an invalid redirect URL: ${location}`, 'invalid-redirect'));\r\n\t\t\t\t\t\tfinalize();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// HTTP fetch step 5.5\r\n\t\t\t\tswitch (request.redirect) {\r\n\t\t\t\t\tcase 'error':\r\n\t\t\t\t\t\treject(new FetchError(`uri requested responds with a redirect, redirect mode is set to error: ${request.url}`, 'no-redirect'));\r\n\t\t\t\t\t\tfinalize();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tcase 'manual':\r\n\t\t\t\t\t\t// Nothing to do\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'follow': {\r\n\t\t\t\t\t\t// HTTP-redirect fetch step 2\r\n\t\t\t\t\t\tif (locationURL === null) {\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// HTTP-redirect fetch step 5\r\n\t\t\t\t\t\tif (request.counter >= request.follow) {\r\n\t\t\t\t\t\t\treject(new FetchError(`maximum redirect reached at: ${request.url}`, 'max-redirect'));\r\n\t\t\t\t\t\t\tfinalize();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// HTTP-redirect fetch step 6 (counter increment)\r\n\t\t\t\t\t\t// Create a new Request object.\r\n\t\t\t\t\t\tconst requestOptions = {\r\n\t\t\t\t\t\t\theaders: new Headers(request.headers),\r\n\t\t\t\t\t\t\tfollow: request.follow,\r\n\t\t\t\t\t\t\tcounter: request.counter + 1,\r\n\t\t\t\t\t\t\tagent: request.agent,\r\n\t\t\t\t\t\t\tcompress: request.compress,\r\n\t\t\t\t\t\t\tmethod: request.method,\r\n\t\t\t\t\t\t\tbody: clone(request),\r\n\t\t\t\t\t\t\tsignal: request.signal,\r\n\t\t\t\t\t\t\tsize: request.size,\r\n\t\t\t\t\t\t\treferrer: request.referrer,\r\n\t\t\t\t\t\t\treferrerPolicy: request.referrerPolicy\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t// when forwarding sensitive headers like \"Authorization\",\r\n\t\t\t\t\t\t// \"WWW-Authenticate\", and \"Cookie\" to untrusted targets,\r\n\t\t\t\t\t\t// headers will be ignored when following a redirect to a domain\r\n\t\t\t\t\t\t// that is not a subdomain match or exact match of the initial domain.\r\n\t\t\t\t\t\t// For example, a redirect from \"foo.com\" to either \"foo.com\" or \"sub.foo.com\"\r\n\t\t\t\t\t\t// will forward the sensitive headers, but a redirect to \"bar.com\" will not.\r\n\t\t\t\t\t\t// headers will also be ignored when following a redirect to a domain using\r\n\t\t\t\t\t\t// a different protocol. For example, a redirect from \"https://foo.com\" to \"http://foo.com\"\r\n\t\t\t\t\t\t// will not forward the sensitive headers\r\n\t\t\t\t\t\tif (!isDomainOrSubdomain(request.url, locationURL) || !isSameProtocol(request.url, locationURL)) {\r\n\t\t\t\t\t\t\tfor (const name of ['authorization', 'www-authenticate', 'cookie', 'cookie2']) {\r\n\t\t\t\t\t\t\t\trequestOptions.headers.delete(name);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// HTTP-redirect fetch step 9\r\n\t\t\t\t\t\tif (response_.statusCode !== 303 && request.body && options_.body instanceof Stream.Readable) {\r\n\t\t\t\t\t\t\treject(new FetchError('Cannot follow redirect with body being a readable stream', 'unsupported-redirect'));\r\n\t\t\t\t\t\t\tfinalize();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// HTTP-redirect fetch step 11\r\n\t\t\t\t\t\tif (response_.statusCode === 303 || ((response_.statusCode === 301 || response_.statusCode === 302) && request.method === 'POST')) {\r\n\t\t\t\t\t\t\trequestOptions.method = 'GET';\r\n\t\t\t\t\t\t\trequestOptions.body = undefined;\r\n\t\t\t\t\t\t\trequestOptions.headers.delete('content-length');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// HTTP-redirect fetch step 14\r\n\t\t\t\t\t\tconst responseReferrerPolicy = parseReferrerPolicyFromHeader(headers);\r\n\t\t\t\t\t\tif (responseReferrerPolicy) {\r\n\t\t\t\t\t\t\trequestOptions.referrerPolicy = responseReferrerPolicy;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// HTTP-redirect fetch step 15\r\n\t\t\t\t\t\tresolve(fetch(new Request(locationURL, requestOptions)));\r\n\t\t\t\t\t\tfinalize();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\treturn reject(new TypeError(`Redirect option '${request.redirect}' is not a valid value of RequestRedirect`));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Prepare response\r\n\t\t\tif (signal) {\r\n\t\t\t\tresponse_.once('end', () => {\r\n\t\t\t\t\tsignal.removeEventListener('abort', abortAndFinalize);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tlet body = pump(response_, new PassThrough(), error => {\r\n\t\t\t\tif (error) {\r\n\t\t\t\t\treject(error);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t// see https://github.com/nodejs/node/pull/29376\r\n\t\t\t/* c8 ignore next 3 */\r\n\t\t\tif (process.version < 'v12.10') {\r\n\t\t\t\tresponse_.on('aborted', abortAndFinalize);\r\n\t\t\t}\r\n\r\n\t\t\tconst responseOptions = {\r\n\t\t\t\turl: request.url,\r\n\t\t\t\tstatus: response_.statusCode,\r\n\t\t\t\tstatusText: response_.statusMessage,\r\n\t\t\t\theaders,\r\n\t\t\t\tsize: request.size,\r\n\t\t\t\tcounter: request.counter,\r\n\t\t\t\thighWaterMark: request.highWaterMark\r\n\t\t\t};\r\n\r\n\t\t\t// HTTP-network fetch step 12.1.1.3\r\n\t\t\tconst codings = headers.get('Content-Encoding');\r\n\r\n\t\t\t// HTTP-network fetch step 12.1.1.4: handle content codings\r\n\r\n\t\t\t// in following scenarios we ignore compression support\r\n\t\t\t// 1. compression support is disabled\r\n\t\t\t// 2. HEAD request\r\n\t\t\t// 3. no Content-Encoding header\r\n\t\t\t// 4. no content response (204)\r\n\t\t\t// 5. content not modified response (304)\r\n\t\t\tif (!request.compress || request.method === 'HEAD' || codings === null || response_.statusCode === 204 || response_.statusCode === 304) {\r\n\t\t\t\tresponse = new Response(body, responseOptions);\r\n\t\t\t\tresolve(response);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// For Node v6+\r\n\t\t\t// Be less strict when decoding compressed responses, since sometimes\r\n\t\t\t// servers send slightly invalid responses that are still accepted\r\n\t\t\t// by common browsers.\r\n\t\t\t// Always using Z_SYNC_FLUSH is what cURL does.\r\n\t\t\tconst zlibOptions = {\r\n\t\t\t\tflush: zlib.Z_SYNC_FLUSH,\r\n\t\t\t\tfinishFlush: zlib.Z_SYNC_FLUSH\r\n\t\t\t};\r\n\r\n\t\t\t// For gzip\r\n\t\t\tif (codings === 'gzip' || codings === 'x-gzip') {\r\n\t\t\t\tbody = pump(body, zlib.createGunzip(zlibOptions), error => {\r\n\t\t\t\t\tif (error) {\r\n\t\t\t\t\t\treject(error);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tresponse = new Response(body, responseOptions);\r\n\t\t\t\tresolve(response);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// For deflate\r\n\t\t\tif (codings === 'deflate' || codings === 'x-deflate') {\r\n\t\t\t\t// Handle the infamous raw deflate response from old servers\r\n\t\t\t\t// a hack for old IIS and Apache servers\r\n\t\t\t\tconst raw = pump(response_, new PassThrough(), error => {\r\n\t\t\t\t\tif (error) {\r\n\t\t\t\t\t\treject(error);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\traw.once('data', chunk => {\r\n\t\t\t\t\t// See http://stackoverflow.com/questions/37519828\r\n\t\t\t\t\tif ((chunk[0] & 0x0F) === 0x08) {\r\n\t\t\t\t\t\tbody = pump(body, zlib.createInflate(), error => {\r\n\t\t\t\t\t\t\tif (error) {\r\n\t\t\t\t\t\t\t\treject(error);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbody = pump(body, zlib.createInflateRaw(), error => {\r\n\t\t\t\t\t\t\tif (error) {\r\n\t\t\t\t\t\t\t\treject(error);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tresponse = new Response(body, responseOptions);\r\n\t\t\t\t\tresolve(response);\r\n\t\t\t\t});\r\n\t\t\t\traw.once('end', () => {\r\n\t\t\t\t\t// Some old IIS servers return zero-length OK deflate responses, so\r\n\t\t\t\t\t// 'data' is never emitted. See https://github.com/node-fetch/node-fetch/pull/903\r\n\t\t\t\t\tif (!response) {\r\n\t\t\t\t\t\tresponse = new Response(body, responseOptions);\r\n\t\t\t\t\t\tresolve(response);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// For br\r\n\t\t\tif (codings === 'br') {\r\n\t\t\t\tbody = pump(body, zlib.createBrotliDecompress(), error => {\r\n\t\t\t\t\tif (error) {\r\n\t\t\t\t\t\treject(error);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tresponse = new Response(body, responseOptions);\r\n\t\t\t\tresolve(response);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Otherwise, use response as-is\r\n\t\t\tresponse = new Response(body, responseOptions);\r\n\t\t\tresolve(response);\r\n\t\t});\r\n\r\n\t\t// eslint-disable-next-line promise/prefer-await-to-then\r\n\t\twriteToStream(request_, request).catch(reject);\r\n\t});\r\n}\r\n\r\nfunction fixResponseChunkedTransferBadEnding(request, errorCallback) {\r\n\tconst LAST_CHUNK = Buffer.from('0\\r\\n\\r\\n');\r\n\r\n\tlet isChunkedTransfer = false;\r\n\tlet properLastChunkReceived = false;\r\n\tlet previousChunk;\r\n\r\n\trequest.on('response', response => {\r\n\t\tconst {headers} = response;\r\n\t\tisChunkedTransfer = headers['transfer-encoding'] === 'chunked' && !headers['content-length'];\r\n\t});\r\n\r\n\trequest.on('socket', socket => {\r\n\t\tconst onSocketClose = () => {\r\n\t\t\tif (isChunkedTransfer && !properLastChunkReceived) {\r\n\t\t\t\tconst error = new Error('Premature close');\r\n\t\t\t\terror.code = 'ERR_STREAM_PREMATURE_CLOSE';\r\n\t\t\t\terrorCallback(error);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tconst onData = buf => {\r\n\t\t\tproperLastChunkReceived = Buffer.compare(buf.slice(-5), LAST_CHUNK) === 0;\r\n\r\n\t\t\t// Sometimes final 0-length chunk and end of message code are in separate packets\r\n\t\t\tif (!properLastChunkReceived && previousChunk) {\r\n\t\t\t\tproperLastChunkReceived = (\r\n\t\t\t\t\tBuffer.compare(previousChunk.slice(-3), LAST_CHUNK.slice(0, 3)) === 0 &&\r\n\t\t\t\t\tBuffer.compare(buf.slice(-2), LAST_CHUNK.slice(3)) === 0\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\tpreviousChunk = buf;\r\n\t\t};\r\n\r\n\t\tsocket.prependListener('close', onSocketClose);\r\n\t\tsocket.on('data', onData);\r\n\r\n\t\trequest.on('close', () => {\r\n\t\t\tsocket.removeListener('close', onSocketClose);\r\n\t\t\tsocket.removeListener('data', onData);\r\n\t\t});\r\n\t});\r\n}\r\n", "export interface MimeBuffer extends Buffer {\r\n\ttype: string;\r\n\ttypeFull: string;\r\n\tcharset: string;\r\n}\r\n\r\n/**\r\n * Returns a `Buffer` instance from the given data URI `uri`.\r\n *\r\n * @param {String} uri Data URI to turn into a Buffer instance\r\n * @returns {Buffer} Buffer instance from Data URI\r\n * @api public\r\n */\r\nexport function dataUriToBuffer(uri: string): MimeBuffer {\r\n\tif (!/^data:/i.test(uri)) {\r\n\t\tthrow new TypeError(\r\n\t\t\t'`uri` does not appear to be a Data URI (must begin with \"data:\")'\r\n\t\t);\r\n\t}\r\n\r\n\t// strip newlines\r\n\turi = uri.replace(/\\r?\\n/g, '');\r\n\r\n\t// split the URI up into the \"metadata\" and the \"data\" portions\r\n\tconst firstComma = uri.indexOf(',');\r\n\tif (firstComma === -1 || firstComma <= 4) {\r\n\t\tthrow new TypeError('malformed data: URI');\r\n\t}\r\n\r\n\t// remove the \"data:\" scheme and parse the metadata\r\n\tconst meta = uri.substring(5, firstComma).split(';');\r\n\r\n\tlet charset = '';\r\n\tlet base64 = false;\r\n\tconst type = meta[0] || 'text/plain';\r\n\tlet typeFull = type;\r\n\tfor (let i = 1; i < meta.length; i++) {\r\n\t\tif (meta[i] === 'base64') {\r\n\t\t\tbase64 = true;\r\n\t\t} else if(meta[i]) {\r\n\t\t\ttypeFull += `;${  meta[i]}`;\r\n\t\t\tif (meta[i].indexOf('charset=') === 0) {\r\n\t\t\t\tcharset = meta[i].substring(8);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t// defaults to US-ASCII only if type is not provided\r\n\tif (!meta[0] && !charset.length) {\r\n\t\ttypeFull += ';charset=US-ASCII';\r\n\t\tcharset = 'US-ASCII';\r\n\t}\r\n\r\n\t// get the encoded data portion and decode URI-encoded chars\r\n\tconst encoding = base64 ? 'base64' : 'ascii';\r\n\tconst data = unescape(uri.substring(firstComma + 1));\r\n\tconst buffer = Buffer.from(data, encoding) as MimeBuffer;\r\n\r\n\t// set `.type` and `.typeFull` properties to MIME type\r\n\tbuffer.type = type;\r\n\tbuffer.typeFull = typeFull;\r\n\r\n\t// set the `.charset` property\r\n\tbuffer.charset = charset;\r\n\r\n\treturn buffer;\r\n}\r\n\r\nexport default dataUriToBuffer;\r\n", "\r\n/**\r\n * Body.js\r\n *\r\n * Body interface provides common methods for Request and Response\r\n */\r\n\r\nimport Stream, {PassThrough} from 'node:stream';\r\nimport {types, deprecate, promisify} from 'node:util';\r\nimport {Buffer} from 'node:buffer';\r\n\r\nimport Blob from 'fetch-blob';\r\nimport {FormData, formDataToBlob} from 'formdata-polyfill/esm.min.js';\r\n\r\nimport {FetchError} from './errors/fetch-error.js';\r\nimport {FetchBaseError} from './errors/base.js';\r\nimport {isBlob, isURLSearchParameters} from './utils/is.js';\r\n\r\nconst pipeline = promisify(Stream.pipeline);\r\nconst INTERNALS = Symbol('Body internals');\r\n\r\n/**\r\n * Body mixin\r\n *\r\n * Ref: https://fetch.spec.whatwg.org/#body\r\n *\r\n * @param   Stream  body  Readable stream\r\n * @param   Object  opts  Response options\r\n * @return  Void\r\n */\r\nexport default class Body {\r\n\tconstructor(body, {\r\n\t\tsize = 0\r\n\t} = {}) {\r\n\t\tlet boundary = null;\r\n\r\n\t\tif (body === null) {\r\n\t\t\t// Body is undefined or null\r\n\t\t\tbody = null;\r\n\t\t} else if (isURLSearchParameters(body)) {\r\n\t\t\t// Body is a URLSearchParams\r\n\t\t\tbody = Buffer.from(body.toString());\r\n\t\t} else if (isBlob(body)) {\r\n\t\t\t// Body is blob\r\n\t\t} else if (Buffer.isBuffer(body)) {\r\n\t\t\t// Body is Buffer\r\n\t\t} else if (types.isAnyArrayBuffer(body)) {\r\n\t\t\t// Body is ArrayBuffer\r\n\t\t\tbody = Buffer.from(body);\r\n\t\t} else if (ArrayBuffer.isView(body)) {\r\n\t\t\t// Body is ArrayBufferView\r\n\t\t\tbody = Buffer.from(body.buffer, body.byteOffset, body.byteLength);\r\n\t\t} else if (body instanceof Stream) {\r\n\t\t\t// Body is stream\r\n\t\t} else if (body instanceof FormData) {\r\n\t\t\t// Body is FormData\r\n\t\t\tbody = formDataToBlob(body);\r\n\t\t\tboundary = body.type.split('=')[1];\r\n\t\t} else {\r\n\t\t\t// None of the above\r\n\t\t\t// coerce to string then buffer\r\n\t\t\tbody = Buffer.from(String(body));\r\n\t\t}\r\n\r\n\t\tlet stream = body;\r\n\r\n\t\tif (Buffer.isBuffer(body)) {\r\n\t\t\tstream = Stream.Readable.from(body);\r\n\t\t} else if (isBlob(body)) {\r\n\t\t\tstream = Stream.Readable.from(body.stream());\r\n\t\t}\r\n\r\n\t\tthis[INTERNALS] = {\r\n\t\t\tbody,\r\n\t\t\tstream,\r\n\t\t\tboundary,\r\n\t\t\tdisturbed: false,\r\n\t\t\terror: null\r\n\t\t};\r\n\t\tthis.size = size;\r\n\r\n\t\tif (body instanceof Stream) {\r\n\t\t\tbody.on('error', error_ => {\r\n\t\t\t\tconst error = error_ instanceof FetchBaseError ?\r\n\t\t\t\t\terror_ :\r\n\t\t\t\t\tnew FetchError(`Invalid response body while trying to fetch ${this.url}: ${error_.message}`, 'system', error_);\r\n\t\t\t\tthis[INTERNALS].error = error;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tget body() {\r\n\t\treturn this[INTERNALS].stream;\r\n\t}\r\n\r\n\tget bodyUsed() {\r\n\t\treturn this[INTERNALS].disturbed;\r\n\t}\r\n\r\n\t/**\r\n\t * Decode response as ArrayBuffer\r\n\t *\r\n\t * @return  Promise\r\n\t */\r\n\tasync arrayBuffer() {\r\n\t\tconst {buffer, byteOffset, byteLength} = await consumeBody(this);\r\n\t\treturn buffer.slice(byteOffset, byteOffset + byteLength);\r\n\t}\r\n\r\n\tasync formData() {\r\n\t\tconst ct = this.headers.get('content-type');\r\n\r\n\t\tif (ct.startsWith('application/x-www-form-urlencoded')) {\r\n\t\t\tconst formData = new FormData();\r\n\t\t\tconst parameters = new URLSearchParams(await this.text());\r\n\r\n\t\t\tfor (const [name, value] of parameters) {\r\n\t\t\t\tformData.append(name, value);\r\n\t\t\t}\r\n\r\n\t\t\treturn formData;\r\n\t\t}\r\n\r\n\t\tconst {toFormData} = await import('./utils/multipart-parser.js');\r\n\t\treturn toFormData(this.body, ct);\r\n\t}\r\n\r\n\t/**\r\n\t * Return raw response as Blob\r\n\t *\r\n\t * @return Promise\r\n\t */\r\n\tasync blob() {\r\n\t\tconst ct = (this.headers && this.headers.get('content-type')) || (this[INTERNALS].body && this[INTERNALS].body.type) || '';\r\n\t\tconst buf = await this.arrayBuffer();\r\n\r\n\t\treturn new Blob([buf], {\r\n\t\t\ttype: ct\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Decode response as json\r\n\t *\r\n\t * @return  Promise\r\n\t */\r\n\tasync json() {\r\n\t\tconst text = await this.text();\r\n\t\treturn JSON.parse(text);\r\n\t}\r\n\r\n\t/**\r\n\t * Decode response as text\r\n\t *\r\n\t * @return  Promise\r\n\t */\r\n\tasync text() {\r\n\t\tconst buffer = await consumeBody(this);\r\n\t\treturn new TextDecoder().decode(buffer);\r\n\t}\r\n\r\n\t/**\r\n\t * Decode response as buffer (non-spec api)\r\n\t *\r\n\t * @return  Promise\r\n\t */\r\n\tbuffer() {\r\n\t\treturn consumeBody(this);\r\n\t}\r\n}\r\n\r\nBody.prototype.buffer = deprecate(Body.prototype.buffer, 'Please use \\'response.arrayBuffer()\\' instead of \\'response.buffer()\\'', 'node-fetch#buffer');\r\n\r\n// In browsers, all properties are enumerable.\r\nObject.defineProperties(Body.prototype, {\r\n\tbody: {enumerable: true},\r\n\tbodyUsed: {enumerable: true},\r\n\tarrayBuffer: {enumerable: true},\r\n\tblob: {enumerable: true},\r\n\tjson: {enumerable: true},\r\n\ttext: {enumerable: true},\r\n\tdata: {get: deprecate(() => {},\r\n\t\t'data doesn\\'t exist, use json(), text(), arrayBuffer(), or body instead',\r\n\t\t'https://github.com/node-fetch/node-fetch/issues/1000 (response)')}\r\n});\r\n\r\n/**\r\n * Consume and convert an entire Body to a Buffer.\r\n *\r\n * Ref: https://fetch.spec.whatwg.org/#concept-body-consume-body\r\n *\r\n * @return Promise\r\n */\r\nasync function consumeBody(data) {\r\n\tif (data[INTERNALS].disturbed) {\r\n\t\tthrow new TypeError(`body used already for: ${data.url}`);\r\n\t}\r\n\r\n\tdata[INTERNALS].disturbed = true;\r\n\r\n\tif (data[INTERNALS].error) {\r\n\t\tthrow data[INTERNALS].error;\r\n\t}\r\n\r\n\tconst {body} = data;\r\n\r\n\t// Body is null\r\n\tif (body === null) {\r\n\t\treturn Buffer.alloc(0);\r\n\t}\r\n\r\n\t/* c8 ignore next 3 */\r\n\tif (!(body instanceof Stream)) {\r\n\t\treturn Buffer.alloc(0);\r\n\t}\r\n\r\n\t// Body is stream\r\n\t// get ready to actually consume the body\r\n\tconst accum = [];\r\n\tlet accumBytes = 0;\r\n\r\n\ttry {\r\n\t\tfor await (const chunk of body) {\r\n\t\t\tif (data.size > 0 && accumBytes + chunk.length > data.size) {\r\n\t\t\t\tconst error = new FetchError(`content size at ${data.url} over limit: ${data.size}`, 'max-size');\r\n\t\t\t\tbody.destroy(error);\r\n\t\t\t\tthrow error;\r\n\t\t\t}\r\n\r\n\t\t\taccumBytes += chunk.length;\r\n\t\t\taccum.push(chunk);\r\n\t\t}\r\n\t} catch (error) {\r\n\t\tconst error_ = error instanceof FetchBaseError ? error : new FetchError(`Invalid response body while trying to fetch ${data.url}: ${error.message}`, 'system', error);\r\n\t\tthrow error_;\r\n\t}\r\n\r\n\tif (body.readableEnded === true || body._readableState.ended === true) {\r\n\t\ttry {\r\n\t\t\tif (accum.every(c => typeof c === 'string')) {\r\n\t\t\t\treturn Buffer.from(accum.join(''));\r\n\t\t\t}\r\n\r\n\t\t\treturn Buffer.concat(accum, accumBytes);\r\n\t\t} catch (error) {\r\n\t\t\tthrow new FetchError(`Could not create Buffer from response body for ${data.url}: ${error.message}`, 'system', error);\r\n\t\t}\r\n\t} else {\r\n\t\tthrow new FetchError(`Premature close of server response while trying to fetch ${data.url}`);\r\n\t}\r\n}\r\n\r\n/**\r\n * Clone body given Res/Req instance\r\n *\r\n * @param   Mixed   instance       Response or Request instance\r\n * @param   String  highWaterMark  highWaterMark for both PassThrough body streams\r\n * @return  Mixed\r\n */\r\nexport const clone = (instance, highWaterMark) => {\r\n\tlet p1;\r\n\tlet p2;\r\n\tlet {body} = instance[INTERNALS];\r\n\r\n\t// Don't allow cloning a used body\r\n\tif (instance.bodyUsed) {\r\n\t\tthrow new Error('cannot clone body after it is used');\r\n\t}\r\n\r\n\t// Check that body is a stream and not form-data object\r\n\t// note: we can't clone the form-data object without having it as a dependency\r\n\tif ((body instanceof Stream) && (typeof body.getBoundary !== 'function')) {\r\n\t\t// Tee instance body\r\n\t\tp1 = new PassThrough({highWaterMark});\r\n\t\tp2 = new PassThrough({highWaterMark});\r\n\t\tbody.pipe(p1);\r\n\t\tbody.pipe(p2);\r\n\t\t// Set instance body to teed body and return the other teed body\r\n\t\tinstance[INTERNALS].stream = p1;\r\n\t\tbody = p2;\r\n\t}\r\n\r\n\treturn body;\r\n};\r\n\r\nconst getNonSpecFormDataBoundary = deprecate(\r\n\tbody => body.getBoundary(),\r\n\t'form-data doesn\\'t follow the spec and requires special treatment. Use alternative package',\r\n\t'https://github.com/node-fetch/node-fetch/issues/1167'\r\n);\r\n\r\n/**\r\n * Performs the operation \"extract a `Content-Type` value from |object|\" as\r\n * specified in the specification:\r\n * https://fetch.spec.whatwg.org/#concept-bodyinit-extract\r\n *\r\n * This function assumes that instance.body is present.\r\n *\r\n * @param {any} body Any options.body input\r\n * @returns {string | null}\r\n */\r\nexport const extractContentType = (body, request) => {\r\n\t// Body is null or undefined\r\n\tif (body === null) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// Body is string\r\n\tif (typeof body === 'string') {\r\n\t\treturn 'text/plain;charset=UTF-8';\r\n\t}\r\n\r\n\t// Body is a URLSearchParams\r\n\tif (isURLSearchParameters(body)) {\r\n\t\treturn 'application/x-www-form-urlencoded;charset=UTF-8';\r\n\t}\r\n\r\n\t// Body is blob\r\n\tif (isBlob(body)) {\r\n\t\treturn body.type || null;\r\n\t}\r\n\r\n\t// Body is a Buffer (Buffer, ArrayBuffer or ArrayBufferView)\r\n\tif (Buffer.isBuffer(body) || types.isAnyArrayBuffer(body) || ArrayBuffer.isView(body)) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tif (body instanceof FormData) {\r\n\t\treturn `multipart/form-data; boundary=${request[INTERNALS].boundary}`;\r\n\t}\r\n\r\n\t// Detect form data input from form-data module\r\n\tif (body && typeof body.getBoundary === 'function') {\r\n\t\treturn `multipart/form-data;boundary=${getNonSpecFormDataBoundary(body)}`;\r\n\t}\r\n\r\n\t// Body is stream - can't really do much about this\r\n\tif (body instanceof Stream) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// Body constructor defaults other things to string\r\n\treturn 'text/plain;charset=UTF-8';\r\n};\r\n\r\n/**\r\n * The Fetch Standard treats this as if \"total bytes\" is a property on the body.\r\n * For us, we have to explicitly get it with a function.\r\n *\r\n * ref: https://fetch.spec.whatwg.org/#concept-body-total-bytes\r\n *\r\n * @param {any} obj.body Body object from the Body instance.\r\n * @returns {number | null}\r\n */\r\nexport const getTotalBytes = request => {\r\n\tconst {body} = request[INTERNALS];\r\n\r\n\t// Body is null or undefined\r\n\tif (body === null) {\r\n\t\treturn 0;\r\n\t}\r\n\r\n\t// Body is Blob\r\n\tif (isBlob(body)) {\r\n\t\treturn body.size;\r\n\t}\r\n\r\n\t// Body is Buffer\r\n\tif (Buffer.isBuffer(body)) {\r\n\t\treturn body.length;\r\n\t}\r\n\r\n\t// Detect form data input from form-data module\r\n\tif (body && typeof body.getLengthSync === 'function') {\r\n\t\treturn body.hasKnownLength && body.hasKnownLength() ? body.getLengthSync() : null;\r\n\t}\r\n\r\n\t// Body is stream\r\n\treturn null;\r\n};\r\n\r\n/**\r\n * Write a Body to a Node.js WritableStream (e.g. http.Request) object.\r\n *\r\n * @param {Stream.Writable} dest The stream to write to.\r\n * @param obj.body Body object from the Body instance.\r\n * @returns {Promise<void>}\r\n */\r\nexport const writeToStream = async (dest, {body}) => {\r\n\tif (body === null) {\r\n\t\t// Body is null\r\n\t\tdest.end();\r\n\t} else {\r\n\t\t// Body is stream\r\n\t\tawait pipeline(body, dest);\r\n\t}\r\n};\r\n", "export class FetchBaseError extends Error {\r\n\tconstructor(message, type) {\r\n\t\tsuper(message);\r\n\t\t// Hide custom error implementation details from end-users\r\n\t\tError.captureStackTrace(this, this.constructor);\r\n\r\n\t\tthis.type = type;\r\n\t}\r\n\r\n\tget name() {\r\n\t\treturn this.constructor.name;\r\n\t}\r\n\r\n\tget [Symbol.toStringTag]() {\r\n\t\treturn this.constructor.name;\r\n\t}\r\n}\r\n", "\r\nimport {FetchBaseError} from './base.js';\r\n\r\n/**\r\n * @typedef {{ address?: string, code: string, dest?: string, errno: number, info?: object, message: string, path?: string, port?: number, syscall: string}} SystemError\r\n*/\r\n\r\n/**\r\n * FetchError interface for operational errors\r\n */\r\nexport class FetchError extends FetchBaseError {\r\n\t/**\r\n\t * @param  {string} message -      Error message for human\r\n\t * @param  {string} [type] -        Error type for machine\r\n\t * @param  {SystemError} [systemError] - For Node.js system error\r\n\t */\r\n\tconstructor(message, type, systemError) {\r\n\t\tsuper(message, type);\r\n\t\t// When err.type is `system`, err.erroredSysCall contains system error and err.code contains system error code\r\n\t\tif (systemError) {\r\n\t\t\t// eslint-disable-next-line no-multi-assign\r\n\t\t\tthis.code = this.errno = systemError.code;\r\n\t\t\tthis.erroredSysCall = systemError.syscall;\r\n\t\t}\r\n\t}\r\n}\r\n", "/**\r\n * Is.js\r\n *\r\n * Object type checks.\r\n */\r\n\r\nconst NAME = Symbol.toStringTag;\r\n\r\n/**\r\n * Check if `obj` is a URLSearchParams object\r\n * ref: https://github.com/node-fetch/node-fetch/issues/296#issuecomment-307598143\r\n * @param {*} object - Object to check for\r\n * @return {boolean}\r\n */\r\nexport const isURLSearchParameters = object => {\r\n\treturn (\r\n\t\ttypeof object === 'object' &&\r\n\t\ttypeof object.append === 'function' &&\r\n\t\ttypeof object.delete === 'function' &&\r\n\t\ttypeof object.get === 'function' &&\r\n\t\ttypeof object.getAll === 'function' &&\r\n\t\ttypeof object.has === 'function' &&\r\n\t\ttypeof object.set === 'function' &&\r\n\t\ttypeof object.sort === 'function' &&\r\n\t\tobject[NAME] === 'URLSearchParams'\r\n\t);\r\n};\r\n\r\n/**\r\n * Check if `object` is a W3C `Blob` object (which `File` inherits from)\r\n * @param {*} object - Object to check for\r\n * @return {boolean}\r\n */\r\nexport const isBlob = object => {\r\n\treturn (\r\n\t\tobject &&\r\n\t\ttypeof object === 'object' &&\r\n\t\ttypeof object.arrayBuffer === 'function' &&\r\n\t\ttypeof object.type === 'string' &&\r\n\t\ttypeof object.stream === 'function' &&\r\n\t\ttypeof object.constructor === 'function' &&\r\n\t\t/^(Blob|File)$/.test(object[NAME])\r\n\t);\r\n};\r\n\r\n/**\r\n * Check if `obj` is an instance of AbortSignal.\r\n * @param {*} object - Object to check for\r\n * @return {boolean}\r\n */\r\nexport const isAbortSignal = object => {\r\n\treturn (\r\n\t\ttypeof object === 'object' && (\r\n\t\t\tobject[NAME] === 'AbortSignal' ||\r\n\t\t\tobject[NAME] === 'EventTarget'\r\n\t\t)\r\n\t);\r\n};\r\n\r\n/**\r\n * isDomainOrSubdomain reports whether sub is a subdomain (or exact match) of\r\n * the parent domain.\r\n *\r\n * Both domains must already be in canonical form.\r\n * @param {string|URL} original\r\n * @param {string|URL} destination\r\n */\r\nexport const isDomainOrSubdomain = (destination, original) => {\r\n\tconst orig = new URL(original).hostname;\r\n\tconst dest = new URL(destination).hostname;\r\n\r\n\treturn orig === dest || orig.endsWith(`.${dest}`);\r\n};\r\n\r\n/**\r\n * isSameProtocol reports whether the two provided URLs use the same protocol.\r\n *\r\n * Both domains must already be in canonical form.\r\n * @param {string|URL} original\r\n * @param {string|URL} destination\r\n */\r\nexport const isSameProtocol = (destination, original) => {\r\n\tconst orig = new URL(original).protocol;\r\n\tconst dest = new URL(destination).protocol;\r\n\r\n\treturn orig === dest;\r\n};\r\n", "/**\r\n * Headers.js\r\n *\r\n * Headers class offers convenient helpers\r\n */\r\n\r\nimport {types} from 'node:util';\r\nimport http from 'node:http';\r\n\r\n/* c8 ignore next 9 */\r\nconst validateHeaderName = typeof http.validateHeaderName === 'function' ?\r\n\thttp.validateHeaderName :\r\n\tname => {\r\n\t\tif (!/^[\\^`\\-\\w!#$%&'*+.|~]+$/.test(name)) {\r\n\t\t\tconst error = new TypeError(`Header name must be a valid HTTP token [${name}]`);\r\n\t\t\tObject.defineProperty(error, 'code', {value: 'ERR_INVALID_HTTP_TOKEN'});\r\n\t\t\tthrow error;\r\n\t\t}\r\n\t};\r\n\r\n/* c8 ignore next 9 */\r\nconst validateHeaderValue = typeof http.validateHeaderValue === 'function' ?\r\n\thttp.validateHeaderValue :\r\n\t(name, value) => {\r\n\t\tif (/[^\\t\\u0020-\\u007E\\u0080-\\u00FF]/.test(value)) {\r\n\t\t\tconst error = new TypeError(`Invalid character in header content [\"${name}\"]`);\r\n\t\t\tObject.defineProperty(error, 'code', {value: 'ERR_INVALID_CHAR'});\r\n\t\t\tthrow error;\r\n\t\t}\r\n\t};\r\n\r\n/**\r\n * @typedef {Headers | Record<string, string> | Iterable<readonly [string, string]> | Iterable<Iterable<string>>} HeadersInit\r\n */\r\n\r\n/**\r\n * This Fetch API interface allows you to perform various actions on HTTP request and response headers.\r\n * These actions include retrieving, setting, adding to, and removing.\r\n * A Headers object has an associated header list, which is initially empty and consists of zero or more name and value pairs.\r\n * You can add to this using methods like append() (see Examples.)\r\n * In all methods of this interface, header names are matched by case-insensitive byte sequence.\r\n *\r\n */\r\nexport default class Headers extends URLSearchParams {\r\n\t/**\r\n\t * Headers class\r\n\t *\r\n\t * @constructor\r\n\t * @param {HeadersInit} [init] - Response headers\r\n\t */\r\n\tconstructor(init) {\r\n\t\t// Validate and normalize init object in [name, value(s)][]\r\n\t\t/** @type {string[][]} */\r\n\t\tlet result = [];\r\n\t\tif (init instanceof Headers) {\r\n\t\t\tconst raw = init.raw();\r\n\t\t\tfor (const [name, values] of Object.entries(raw)) {\r\n\t\t\t\tresult.push(...values.map(value => [name, value]));\r\n\t\t\t}\r\n\t\t} else if (init == null) { // eslint-disable-line no-eq-null, eqeqeq\r\n\t\t\t// No op\r\n\t\t} else if (typeof init === 'object' && !types.isBoxedPrimitive(init)) {\r\n\t\t\tconst method = init[Symbol.iterator];\r\n\t\t\t// eslint-disable-next-line no-eq-null, eqeqeq\r\n\t\t\tif (method == null) {\r\n\t\t\t\t// Record<ByteString, ByteString>\r\n\t\t\t\tresult.push(...Object.entries(init));\r\n\t\t\t} else {\r\n\t\t\t\tif (typeof method !== 'function') {\r\n\t\t\t\t\tthrow new TypeError('Header pairs must be iterable');\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Sequence<sequence<ByteString>>\r\n\t\t\t\t// Note: per spec we have to first exhaust the lists then process them\r\n\t\t\t\tresult = [...init]\r\n\t\t\t\t\t.map(pair => {\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\ttypeof pair !== 'object' || types.isBoxedPrimitive(pair)\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tthrow new TypeError('Each header pair must be an iterable object');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn [...pair];\r\n\t\t\t\t\t}).map(pair => {\r\n\t\t\t\t\t\tif (pair.length !== 2) {\r\n\t\t\t\t\t\t\tthrow new TypeError('Each header pair must be a name/value tuple');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn [...pair];\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthrow new TypeError('Failed to construct \\'Headers\\': The provided value is not of type \\'(sequence<sequence<ByteString>> or record<ByteString, ByteString>)');\r\n\t\t}\r\n\r\n\t\t// Validate and lowercase\r\n\t\tresult =\r\n\t\t\tresult.length > 0 ?\r\n\t\t\t\tresult.map(([name, value]) => {\r\n\t\t\t\t\tvalidateHeaderName(name);\r\n\t\t\t\t\tvalidateHeaderValue(name, String(value));\r\n\t\t\t\t\treturn [String(name).toLowerCase(), String(value)];\r\n\t\t\t\t}) :\r\n\t\t\t\tundefined;\r\n\r\n\t\tsuper(result);\r\n\r\n\t\t// Returning a Proxy that will lowercase key names, validate parameters and sort keys\r\n\t\t// eslint-disable-next-line no-constructor-return\r\n\t\treturn new Proxy(this, {\r\n\t\t\tget(target, p, receiver) {\r\n\t\t\t\tswitch (p) {\r\n\t\t\t\t\tcase 'append':\r\n\t\t\t\t\tcase 'set':\r\n\t\t\t\t\t\treturn (name, value) => {\r\n\t\t\t\t\t\t\tvalidateHeaderName(name);\r\n\t\t\t\t\t\t\tvalidateHeaderValue(name, String(value));\r\n\t\t\t\t\t\t\treturn URLSearchParams.prototype[p].call(\r\n\t\t\t\t\t\t\t\ttarget,\r\n\t\t\t\t\t\t\t\tString(name).toLowerCase(),\r\n\t\t\t\t\t\t\t\tString(value)\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\tcase 'delete':\r\n\t\t\t\t\tcase 'has':\r\n\t\t\t\t\tcase 'getAll':\r\n\t\t\t\t\t\treturn name => {\r\n\t\t\t\t\t\t\tvalidateHeaderName(name);\r\n\t\t\t\t\t\t\treturn URLSearchParams.prototype[p].call(\r\n\t\t\t\t\t\t\t\ttarget,\r\n\t\t\t\t\t\t\t\tString(name).toLowerCase()\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\tcase 'keys':\r\n\t\t\t\t\t\treturn () => {\r\n\t\t\t\t\t\t\ttarget.sort();\r\n\t\t\t\t\t\t\treturn new Set(URLSearchParams.prototype.keys.call(target)).keys();\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\treturn Reflect.get(target, p, receiver);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\t/* c8 ignore next */\r\n\t}\r\n\r\n\tget [Symbol.toStringTag]() {\r\n\t\treturn this.constructor.name;\r\n\t}\r\n\r\n\ttoString() {\r\n\t\treturn Object.prototype.toString.call(this);\r\n\t}\r\n\r\n\tget(name) {\r\n\t\tconst values = this.getAll(name);\r\n\t\tif (values.length === 0) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tlet value = values.join(', ');\r\n\t\tif (/^content-encoding$/i.test(name)) {\r\n\t\t\tvalue = value.toLowerCase();\r\n\t\t}\r\n\r\n\t\treturn value;\r\n\t}\r\n\r\n\tforEach(callback, thisArg = undefined) {\r\n\t\tfor (const name of this.keys()) {\r\n\t\t\tReflect.apply(callback, thisArg, [this.get(name), name, this]);\r\n\t\t}\r\n\t}\r\n\r\n\t* values() {\r\n\t\tfor (const name of this.keys()) {\r\n\t\t\tyield this.get(name);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @type {() => IterableIterator<[string, string]>}\r\n\t */\r\n\t* entries() {\r\n\t\tfor (const name of this.keys()) {\r\n\t\t\tyield [name, this.get(name)];\r\n\t\t}\r\n\t}\r\n\r\n\t[Symbol.iterator]() {\r\n\t\treturn this.entries();\r\n\t}\r\n\r\n\t/**\r\n\t * Node-fetch non-spec method\r\n\t * returning all headers and their values as array\r\n\t * @returns {Record<string, string[]>}\r\n\t */\r\n\traw() {\r\n\t\treturn [...this.keys()].reduce((result, key) => {\r\n\t\t\tresult[key] = this.getAll(key);\r\n\t\t\treturn result;\r\n\t\t}, {});\r\n\t}\r\n\r\n\t/**\r\n\t * For better console.log(headers) and also to convert Headers into Node.js Request compatible format\r\n\t */\r\n\t[Symbol.for('nodejs.util.inspect.custom')]() {\r\n\t\treturn [...this.keys()].reduce((result, key) => {\r\n\t\t\tconst values = this.getAll(key);\r\n\t\t\t// Http.request() only supports string as Host header.\r\n\t\t\t// This hack makes specifying custom Host header possible.\r\n\t\t\tif (key === 'host') {\r\n\t\t\t\tresult[key] = values[0];\r\n\t\t\t} else {\r\n\t\t\t\tresult[key] = values.length > 1 ? values : values[0];\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\t\t}, {});\r\n\t}\r\n}\r\n\r\n/**\r\n * Re-shaping object for Web IDL tests\r\n * Only need to do it for overridden methods\r\n */\r\nObject.defineProperties(\r\n\tHeaders.prototype,\r\n\t['get', 'entries', 'forEach', 'values'].reduce((result, property) => {\r\n\t\tresult[property] = {enumerable: true};\r\n\t\treturn result;\r\n\t}, {})\r\n);\r\n\r\n/**\r\n * Create a Headers object from an http.IncomingMessage.rawHeaders, ignoring those that do\r\n * not conform to HTTP grammar productions.\r\n * @param {import('http').IncomingMessage['rawHeaders']} headers\r\n */\r\nexport function fromRawHeaders(headers = []) {\r\n\treturn new Headers(\r\n\t\theaders\r\n\t\t\t// Split into pairs\r\n\t\t\t.reduce((result, value, index, array) => {\r\n\t\t\t\tif (index % 2 === 0) {\r\n\t\t\t\t\tresult.push(array.slice(index, index + 2));\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn result;\r\n\t\t\t}, [])\r\n\t\t\t.filter(([name, value]) => {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tvalidateHeaderName(name);\r\n\t\t\t\t\tvalidateHeaderValue(name, String(value));\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t} catch {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t);\r\n}\r\n", "const redirectStatus = new Set([301, 302, 303, 307, 308]);\r\n\r\n/**\r\n * Redirect code matching\r\n *\r\n * @param {number} code - Status code\r\n * @return {boolean}\r\n */\r\nexport const isRedirect = code => {\r\n\treturn redirectStatus.has(code);\r\n};\r\n", "/**\r\n * Response.js\r\n *\r\n * Response class provides content decoding\r\n */\r\n\r\nimport Headers from './headers.js';\r\nimport Body, {clone, extractContentType} from './body.js';\r\nimport {isRedirect} from './utils/is-redirect.js';\r\n\r\nconst INTERNALS = Symbol('Response internals');\r\n\r\n/**\r\n * Response class\r\n *\r\n * Ref: https://fetch.spec.whatwg.org/#response-class\r\n *\r\n * @param   Stream  body  Readable stream\r\n * @param   Object  opts  Response options\r\n * @return  Void\r\n */\r\nexport default class Response extends Body {\r\n\tconstructor(body = null, options = {}) {\r\n\t\tsuper(body, options);\r\n\r\n\t\t// eslint-disable-next-line no-eq-null, eqeqeq, no-negated-condition\r\n\t\tconst status = options.status != null ? options.status : 200;\r\n\r\n\t\tconst headers = new Headers(options.headers);\r\n\r\n\t\tif (body !== null && !headers.has('Content-Type')) {\r\n\t\t\tconst contentType = extractContentType(body, this);\r\n\t\t\tif (contentType) {\r\n\t\t\t\theaders.append('Content-Type', contentType);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis[INTERNALS] = {\r\n\t\t\ttype: 'default',\r\n\t\t\turl: options.url,\r\n\t\t\tstatus,\r\n\t\t\tstatusText: options.statusText || '',\r\n\t\t\theaders,\r\n\t\t\tcounter: options.counter,\r\n\t\t\thighWaterMark: options.highWaterMark\r\n\t\t};\r\n\t}\r\n\r\n\tget type() {\r\n\t\treturn this[INTERNALS].type;\r\n\t}\r\n\r\n\tget url() {\r\n\t\treturn this[INTERNALS].url || '';\r\n\t}\r\n\r\n\tget status() {\r\n\t\treturn this[INTERNALS].status;\r\n\t}\r\n\r\n\t/**\r\n\t * Convenience property representing if the request ended normally\r\n\t */\r\n\tget ok() {\r\n\t\treturn this[INTERNALS].status >= 200 && this[INTERNALS].status < 300;\r\n\t}\r\n\r\n\tget redirected() {\r\n\t\treturn this[INTERNALS].counter > 0;\r\n\t}\r\n\r\n\tget statusText() {\r\n\t\treturn this[INTERNALS].statusText;\r\n\t}\r\n\r\n\tget headers() {\r\n\t\treturn this[INTERNALS].headers;\r\n\t}\r\n\r\n\tget highWaterMark() {\r\n\t\treturn this[INTERNALS].highWaterMark;\r\n\t}\r\n\r\n\t/**\r\n\t * Clone this response\r\n\t *\r\n\t * @return  Response\r\n\t */\r\n\tclone() {\r\n\t\treturn new Response(clone(this, this.highWaterMark), {\r\n\t\t\ttype: this.type,\r\n\t\t\turl: this.url,\r\n\t\t\tstatus: this.status,\r\n\t\t\tstatusText: this.statusText,\r\n\t\t\theaders: this.headers,\r\n\t\t\tok: this.ok,\r\n\t\t\tredirected: this.redirected,\r\n\t\t\tsize: this.size,\r\n\t\t\thighWaterMark: this.highWaterMark\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} url    The URL that the new response is to originate from.\r\n\t * @param {number} status An optional status code for the response (e.g., 302.)\r\n\t * @returns {Response}    A Response object.\r\n\t */\r\n\tstatic redirect(url, status = 302) {\r\n\t\tif (!isRedirect(status)) {\r\n\t\t\tthrow new RangeError('Failed to execute \"redirect\" on \"response\": Invalid status code');\r\n\t\t}\r\n\r\n\t\treturn new Response(null, {\r\n\t\t\theaders: {\r\n\t\t\t\tlocation: new URL(url).toString()\r\n\t\t\t},\r\n\t\t\tstatus\r\n\t\t});\r\n\t}\r\n\r\n\tstatic error() {\r\n\t\tconst response = new Response(null, {status: 0, statusText: ''});\r\n\t\tresponse[INTERNALS].type = 'error';\r\n\t\treturn response;\r\n\t}\r\n\r\n\tstatic json(data = undefined, init = {}) {\r\n\t\tconst body = JSON.stringify(data);\r\n\r\n\t\tif (body === undefined) {\r\n\t\t\tthrow new TypeError('data is not JSON serializable');\r\n\t\t}\r\n\r\n\t\tconst headers = new Headers(init && init.headers);\r\n\r\n\t\tif (!headers.has('content-type')) {\r\n\t\t\theaders.set('content-type', 'application/json');\r\n\t\t}\r\n\r\n\t\treturn new Response(body, {\r\n\t\t\t...init,\r\n\t\t\theaders\r\n\t\t});\r\n\t}\r\n\r\n\tget [Symbol.toStringTag]() {\r\n\t\treturn 'Response';\r\n\t}\r\n}\r\n\r\nObject.defineProperties(Response.prototype, {\r\n\ttype: {enumerable: true},\r\n\turl: {enumerable: true},\r\n\tstatus: {enumerable: true},\r\n\tok: {enumerable: true},\r\n\tredirected: {enumerable: true},\r\n\tstatusText: {enumerable: true},\r\n\theaders: {enumerable: true},\r\n\tclone: {enumerable: true}\r\n});\r\n", "/**\r\n * Request.js\r\n *\r\n * Request class contains server only options\r\n *\r\n * All spec algorithm step numbers are based on https://fetch.spec.whatwg.org/commit-snapshots/ae716822cb3a61843226cd090eefc6589446c1d2/.\r\n */\r\n\r\nimport {format as formatUrl} from 'node:url';\r\nimport {deprecate} from 'node:util';\r\nimport Headers from './headers.js';\r\nimport Body, {clone, extractContentType, getTotalBytes} from './body.js';\r\nimport {isAbortSignal} from './utils/is.js';\r\nimport {getSearch} from './utils/get-search.js';\r\nimport {\r\n\tvalidateReferrerPolicy, determineRequestsReferrer, DEFAULT_REFERRER_POLICY\r\n} from './utils/referrer.js';\r\n\r\nconst INTERNALS = Symbol('Request internals');\r\n\r\n/**\r\n * Check if `obj` is an instance of Request.\r\n *\r\n * @param  {*} object\r\n * @return {boolean}\r\n */\r\nconst isRequest = object => {\r\n\treturn (\r\n\t\ttypeof object === 'object' &&\r\n\t\ttypeof object[INTERNALS] === 'object'\r\n\t);\r\n};\r\n\r\nconst doBadDataWarn = deprecate(() => {},\r\n\t'.data is not a valid RequestInit property, use .body instead',\r\n\t'https://github.com/node-fetch/node-fetch/issues/1000 (request)');\r\n\r\n/**\r\n * Request class\r\n *\r\n * Ref: https://fetch.spec.whatwg.org/#request-class\r\n *\r\n * @param   Mixed   input  Url or Request instance\r\n * @param   Object  init   Custom options\r\n * @return  Void\r\n */\r\nexport default class Request extends Body {\r\n\tconstructor(input, init = {}) {\r\n\t\tlet parsedURL;\r\n\r\n\t\t// Normalize input and force URL to be encoded as UTF-8 (https://github.com/node-fetch/node-fetch/issues/245)\r\n\t\tif (isRequest(input)) {\r\n\t\t\tparsedURL = new URL(input.url);\r\n\t\t} else {\r\n\t\t\tparsedURL = new URL(input);\r\n\t\t\tinput = {};\r\n\t\t}\r\n\r\n\t\tif (parsedURL.username !== '' || parsedURL.password !== '') {\r\n\t\t\tthrow new TypeError(`${parsedURL} is an url with embedded credentials.`);\r\n\t\t}\r\n\r\n\t\tlet method = init.method || input.method || 'GET';\r\n\t\tif (/^(delete|get|head|options|post|put)$/i.test(method)) {\r\n\t\t\tmethod = method.toUpperCase();\r\n\t\t}\r\n\r\n\t\tif (!isRequest(init) && 'data' in init) {\r\n\t\t\tdoBadDataWarn();\r\n\t\t}\r\n\r\n\t\t// eslint-disable-next-line no-eq-null, eqeqeq\r\n\t\tif ((init.body != null || (isRequest(input) && input.body !== null)) &&\r\n\t\t\t(method === 'GET' || method === 'HEAD')) {\r\n\t\t\tthrow new TypeError('Request with GET/HEAD method cannot have body');\r\n\t\t}\r\n\r\n\t\tconst inputBody = init.body ?\r\n\t\t\tinit.body :\r\n\t\t\t(isRequest(input) && input.body !== null ?\r\n\t\t\t\tclone(input) :\r\n\t\t\t\tnull);\r\n\r\n\t\tsuper(inputBody, {\r\n\t\t\tsize: init.size || input.size || 0\r\n\t\t});\r\n\r\n\t\tconst headers = new Headers(init.headers || input.headers || {});\r\n\r\n\t\tif (inputBody !== null && !headers.has('Content-Type')) {\r\n\t\t\tconst contentType = extractContentType(inputBody, this);\r\n\t\t\tif (contentType) {\r\n\t\t\t\theaders.set('Content-Type', contentType);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet signal = isRequest(input) ?\r\n\t\t\tinput.signal :\r\n\t\t\tnull;\r\n\t\tif ('signal' in init) {\r\n\t\t\tsignal = init.signal;\r\n\t\t}\r\n\r\n\t\t// eslint-disable-next-line no-eq-null, eqeqeq\r\n\t\tif (signal != null && !isAbortSignal(signal)) {\r\n\t\t\tthrow new TypeError('Expected signal to be an instanceof AbortSignal or EventTarget');\r\n\t\t}\r\n\r\n\t\t// \u00A75.4, Request constructor steps, step 15.1\r\n\t\t// eslint-disable-next-line no-eq-null, eqeqeq\r\n\t\tlet referrer = init.referrer == null ? input.referrer : init.referrer;\r\n\t\tif (referrer === '') {\r\n\t\t\t// \u00A75.4, Request constructor steps, step 15.2\r\n\t\t\treferrer = 'no-referrer';\r\n\t\t} else if (referrer) {\r\n\t\t\t// \u00A75.4, Request constructor steps, step 15.3.1, 15.3.2\r\n\t\t\tconst parsedReferrer = new URL(referrer);\r\n\t\t\t// \u00A75.4, Request constructor steps, step 15.3.3, 15.3.4\r\n\t\t\treferrer = /^about:(\\/\\/)?client$/.test(parsedReferrer) ? 'client' : parsedReferrer;\r\n\t\t} else {\r\n\t\t\treferrer = undefined;\r\n\t\t}\r\n\r\n\t\tthis[INTERNALS] = {\r\n\t\t\tmethod,\r\n\t\t\tredirect: init.redirect || input.redirect || 'follow',\r\n\t\t\theaders,\r\n\t\t\tparsedURL,\r\n\t\t\tsignal,\r\n\t\t\treferrer\r\n\t\t};\r\n\r\n\t\t// Node-fetch-only options\r\n\t\tthis.follow = init.follow === undefined ? (input.follow === undefined ? 20 : input.follow) : init.follow;\r\n\t\tthis.compress = init.compress === undefined ? (input.compress === undefined ? true : input.compress) : init.compress;\r\n\t\tthis.counter = init.counter || input.counter || 0;\r\n\t\tthis.agent = init.agent || input.agent;\r\n\t\tthis.highWaterMark = init.highWaterMark || input.highWaterMark || 16384;\r\n\t\tthis.insecureHTTPParser = init.insecureHTTPParser || input.insecureHTTPParser || false;\r\n\r\n\t\t// \u00A75.4, Request constructor steps, step 16.\r\n\t\t// Default is empty string per https://fetch.spec.whatwg.org/#concept-request-referrer-policy\r\n\t\tthis.referrerPolicy = init.referrerPolicy || input.referrerPolicy || '';\r\n\t}\r\n\r\n\t/** @returns {string} */\r\n\tget method() {\r\n\t\treturn this[INTERNALS].method;\r\n\t}\r\n\r\n\t/** @returns {string} */\r\n\tget url() {\r\n\t\treturn formatUrl(this[INTERNALS].parsedURL);\r\n\t}\r\n\r\n\t/** @returns {Headers} */\r\n\tget headers() {\r\n\t\treturn this[INTERNALS].headers;\r\n\t}\r\n\r\n\tget redirect() {\r\n\t\treturn this[INTERNALS].redirect;\r\n\t}\r\n\r\n\t/** @returns {AbortSignal} */\r\n\tget signal() {\r\n\t\treturn this[INTERNALS].signal;\r\n\t}\r\n\r\n\t// https://fetch.spec.whatwg.org/#dom-request-referrer\r\n\tget referrer() {\r\n\t\tif (this[INTERNALS].referrer === 'no-referrer') {\r\n\t\t\treturn '';\r\n\t\t}\r\n\r\n\t\tif (this[INTERNALS].referrer === 'client') {\r\n\t\t\treturn 'about:client';\r\n\t\t}\r\n\r\n\t\tif (this[INTERNALS].referrer) {\r\n\t\t\treturn this[INTERNALS].referrer.toString();\r\n\t\t}\r\n\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tget referrerPolicy() {\r\n\t\treturn this[INTERNALS].referrerPolicy;\r\n\t}\r\n\r\n\tset referrerPolicy(referrerPolicy) {\r\n\t\tthis[INTERNALS].referrerPolicy = validateReferrerPolicy(referrerPolicy);\r\n\t}\r\n\r\n\t/**\r\n\t * Clone this request\r\n\t *\r\n\t * @return  Request\r\n\t */\r\n\tclone() {\r\n\t\treturn new Request(this);\r\n\t}\r\n\r\n\tget [Symbol.toStringTag]() {\r\n\t\treturn 'Request';\r\n\t}\r\n}\r\n\r\nObject.defineProperties(Request.prototype, {\r\n\tmethod: {enumerable: true},\r\n\turl: {enumerable: true},\r\n\theaders: {enumerable: true},\r\n\tredirect: {enumerable: true},\r\n\tclone: {enumerable: true},\r\n\tsignal: {enumerable: true},\r\n\treferrer: {enumerable: true},\r\n\treferrerPolicy: {enumerable: true}\r\n});\r\n\r\n/**\r\n * Convert a Request to Node.js http request options.\r\n *\r\n * @param {Request} request - A Request instance\r\n * @return The options object to be passed to http.request\r\n */\r\nexport const getNodeRequestOptions = request => {\r\n\tconst {parsedURL} = request[INTERNALS];\r\n\tconst headers = new Headers(request[INTERNALS].headers);\r\n\r\n\t// Fetch step 1.3\r\n\tif (!headers.has('Accept')) {\r\n\t\theaders.set('Accept', '*/*');\r\n\t}\r\n\r\n\t// HTTP-network-or-cache fetch steps 2.4-2.7\r\n\tlet contentLengthValue = null;\r\n\tif (request.body === null && /^(post|put)$/i.test(request.method)) {\r\n\t\tcontentLengthValue = '0';\r\n\t}\r\n\r\n\tif (request.body !== null) {\r\n\t\tconst totalBytes = getTotalBytes(request);\r\n\t\t// Set Content-Length if totalBytes is a number (that is not NaN)\r\n\t\tif (typeof totalBytes === 'number' && !Number.isNaN(totalBytes)) {\r\n\t\t\tcontentLengthValue = String(totalBytes);\r\n\t\t}\r\n\t}\r\n\r\n\tif (contentLengthValue) {\r\n\t\theaders.set('Content-Length', contentLengthValue);\r\n\t}\r\n\r\n\t// 4.1. Main fetch, step 2.6\r\n\t// > If request's referrer policy is the empty string, then set request's referrer policy to the\r\n\t// > default referrer policy.\r\n\tif (request.referrerPolicy === '') {\r\n\t\trequest.referrerPolicy = DEFAULT_REFERRER_POLICY;\r\n\t}\r\n\r\n\t// 4.1. Main fetch, step 2.7\r\n\t// > If request's referrer is not \"no-referrer\", set request's referrer to the result of invoking\r\n\t// > determine request's referrer.\r\n\tif (request.referrer && request.referrer !== 'no-referrer') {\r\n\t\trequest[INTERNALS].referrer = determineRequestsReferrer(request);\r\n\t} else {\r\n\t\trequest[INTERNALS].referrer = 'no-referrer';\r\n\t}\r\n\r\n\t// 4.5. HTTP-network-or-cache fetch, step 6.9\r\n\t// > If httpRequest's referrer is a URL, then append `Referer`/httpRequest's referrer, serialized\r\n\t// >  and isomorphic encoded, to httpRequest's header list.\r\n\tif (request[INTERNALS].referrer instanceof URL) {\r\n\t\theaders.set('Referer', request.referrer);\r\n\t}\r\n\r\n\t// HTTP-network-or-cache fetch step 2.11\r\n\tif (!headers.has('User-Agent')) {\r\n\t\theaders.set('User-Agent', 'node-fetch');\r\n\t}\r\n\r\n\t// HTTP-network-or-cache fetch step 2.15\r\n\tif (request.compress && !headers.has('Accept-Encoding')) {\r\n\t\theaders.set('Accept-Encoding', 'gzip, deflate, br');\r\n\t}\r\n\r\n\tlet {agent} = request;\r\n\tif (typeof agent === 'function') {\r\n\t\tagent = agent(parsedURL);\r\n\t}\r\n\r\n\t// HTTP-network fetch step 4.2\r\n\t// chunked encoding is handled by Node.js\r\n\r\n\tconst search = getSearch(parsedURL);\r\n\r\n\t// Pass the full URL directly to request(), but overwrite the following\r\n\t// options:\r\n\tconst options = {\r\n\t\t// Overwrite search to retain trailing ? (issue #776)\r\n\t\tpath: parsedURL.pathname + search,\r\n\t\t// The following options are not expressed in the URL\r\n\t\tmethod: request.method,\r\n\t\theaders: headers[Symbol.for('nodejs.util.inspect.custom')](),\r\n\t\tinsecureHTTPParser: request.insecureHTTPParser,\r\n\t\tagent\r\n\t};\r\n\r\n\treturn {\r\n\t\t/** @type {URL} */\r\n\t\tparsedURL,\r\n\t\toptions\r\n\t};\r\n};\r\n", "export const getSearch = parsedURL => {\r\n\tif (parsedURL.search) {\r\n\t\treturn parsedURL.search;\r\n\t}\r\n\r\n\tconst lastOffset = parsedURL.href.length - 1;\r\n\tconst hash = parsedURL.hash || (parsedURL.href[lastOffset] === '#' ? '#' : '');\r\n\treturn parsedURL.href[lastOffset - hash.length] === '?' ? '?' : '';\r\n};\r\n", "import {isIP} from 'node:net';\r\n\r\n/**\r\n * @external URL\r\n * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/URL|URL}\r\n */\r\n\r\n/**\r\n * @module utils/referrer\r\n * @private\r\n */\r\n\r\n/**\r\n * @see {@link https://w3c.github.io/webappsec-referrer-policy/#strip-url|Referrer Policy \u00A78.4. Strip url for use as a referrer}\r\n * @param {string} URL\r\n * @param {boolean} [originOnly=false]\r\n */\r\nexport function stripURLForUseAsAReferrer(url, originOnly = false) {\r\n\t// 1. If url is null, return no referrer.\r\n\tif (url == null) { // eslint-disable-line no-eq-null, eqeqeq\r\n\t\treturn 'no-referrer';\r\n\t}\r\n\r\n\turl = new URL(url);\r\n\r\n\t// 2. If url's scheme is a local scheme, then return no referrer.\r\n\tif (/^(about|blob|data):$/.test(url.protocol)) {\r\n\t\treturn 'no-referrer';\r\n\t}\r\n\r\n\t// 3. Set url's username to the empty string.\r\n\turl.username = '';\r\n\r\n\t// 4. Set url's password to null.\r\n\t// Note: `null` appears to be a mistake as this actually results in the password being `\"null\"`.\r\n\turl.password = '';\r\n\r\n\t// 5. Set url's fragment to null.\r\n\t// Note: `null` appears to be a mistake as this actually results in the fragment being `\"#null\"`.\r\n\turl.hash = '';\r\n\r\n\t// 6. If the origin-only flag is true, then:\r\n\tif (originOnly) {\r\n\t\t// 6.1. Set url's path to null.\r\n\t\t// Note: `null` appears to be a mistake as this actually results in the path being `\"/null\"`.\r\n\t\turl.pathname = '';\r\n\r\n\t\t// 6.2. Set url's query to null.\r\n\t\t// Note: `null` appears to be a mistake as this actually results in the query being `\"?null\"`.\r\n\t\turl.search = '';\r\n\t}\r\n\r\n\t// 7. Return url.\r\n\treturn url;\r\n}\r\n\r\n/**\r\n * @see {@link https://w3c.github.io/webappsec-referrer-policy/#enumdef-referrerpolicy|enum ReferrerPolicy}\r\n */\r\nexport const ReferrerPolicy = new Set([\r\n\t'',\r\n\t'no-referrer',\r\n\t'no-referrer-when-downgrade',\r\n\t'same-origin',\r\n\t'origin',\r\n\t'strict-origin',\r\n\t'origin-when-cross-origin',\r\n\t'strict-origin-when-cross-origin',\r\n\t'unsafe-url'\r\n]);\r\n\r\n/**\r\n * @see {@link https://w3c.github.io/webappsec-referrer-policy/#default-referrer-policy|default referrer policy}\r\n */\r\nexport const DEFAULT_REFERRER_POLICY = 'strict-origin-when-cross-origin';\r\n\r\n/**\r\n * @see {@link https://w3c.github.io/webappsec-referrer-policy/#referrer-policies|Referrer Policy \u00A73. Referrer Policies}\r\n * @param {string} referrerPolicy\r\n * @returns {string} referrerPolicy\r\n */\r\nexport function validateReferrerPolicy(referrerPolicy) {\r\n\tif (!ReferrerPolicy.has(referrerPolicy)) {\r\n\t\tthrow new TypeError(`Invalid referrerPolicy: ${referrerPolicy}`);\r\n\t}\r\n\r\n\treturn referrerPolicy;\r\n}\r\n\r\n/**\r\n * @see {@link https://w3c.github.io/webappsec-secure-contexts/#is-origin-trustworthy|Referrer Policy \u00A73.2. Is origin potentially trustworthy?}\r\n * @param {external:URL} url\r\n * @returns `true`: \"Potentially Trustworthy\", `false`: \"Not Trustworthy\"\r\n */\r\nexport function isOriginPotentiallyTrustworthy(url) {\r\n\t// 1. If origin is an opaque origin, return \"Not Trustworthy\".\r\n\t// Not applicable\r\n\r\n\t// 2. Assert: origin is a tuple origin.\r\n\t// Not for implementations\r\n\r\n\t// 3. If origin's scheme is either \"https\" or \"wss\", return \"Potentially Trustworthy\".\r\n\tif (/^(http|ws)s:$/.test(url.protocol)) {\r\n\t\treturn true;\r\n\t}\r\n\r\n\t// 4. If origin's host component matches one of the CIDR notations 127.0.0.0/8 or ::1/128 [RFC4632], return \"Potentially Trustworthy\".\r\n\tconst hostIp = url.host.replace(/(^\\[)|(]$)/g, '');\r\n\tconst hostIPVersion = isIP(hostIp);\r\n\r\n\tif (hostIPVersion === 4 && /^127\\./.test(hostIp)) {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tif (hostIPVersion === 6 && /^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(hostIp)) {\r\n\t\treturn true;\r\n\t}\r\n\r\n\t// 5. If origin's host component is \"localhost\" or falls within \".localhost\", and the user agent conforms to the name resolution rules in [let-localhost-be-localhost], return \"Potentially Trustworthy\".\r\n\t// We are returning FALSE here because we cannot ensure conformance to\r\n\t// let-localhost-be-loalhost (https://tools.ietf.org/html/draft-west-let-localhost-be-localhost)\r\n\tif (url.host === 'localhost' || url.host.endsWith('.localhost')) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// 6. If origin's scheme component is file, return \"Potentially Trustworthy\".\r\n\tif (url.protocol === 'file:') {\r\n\t\treturn true;\r\n\t}\r\n\r\n\t// 7. If origin's scheme component is one which the user agent considers to be authenticated, return \"Potentially Trustworthy\".\r\n\t// Not supported\r\n\r\n\t// 8. If origin has been configured as a trustworthy origin, return \"Potentially Trustworthy\".\r\n\t// Not supported\r\n\r\n\t// 9. Return \"Not Trustworthy\".\r\n\treturn false;\r\n}\r\n\r\n/**\r\n * @see {@link https://w3c.github.io/webappsec-secure-contexts/#is-url-trustworthy|Referrer Policy \u00A73.3. Is url potentially trustworthy?}\r\n * @param {external:URL} url\r\n * @returns `true`: \"Potentially Trustworthy\", `false`: \"Not Trustworthy\"\r\n */\r\nexport function isUrlPotentiallyTrustworthy(url) {\r\n\t// 1. If url is \"about:blank\" or \"about:srcdoc\", return \"Potentially Trustworthy\".\r\n\tif (/^about:(blank|srcdoc)$/.test(url)) {\r\n\t\treturn true;\r\n\t}\r\n\r\n\t// 2. If url's scheme is \"data\", return \"Potentially Trustworthy\".\r\n\tif (url.protocol === 'data:') {\r\n\t\treturn true;\r\n\t}\r\n\r\n\t// Note: The origin of blob: and filesystem: URLs is the origin of the context in which they were\r\n\t// created. Therefore, blobs created in a trustworthy origin will themselves be potentially\r\n\t// trustworthy.\r\n\tif (/^(blob|filesystem):$/.test(url.protocol)) {\r\n\t\treturn true;\r\n\t}\r\n\r\n\t// 3. Return the result of executing \u00A73.2 Is origin potentially trustworthy? on url's origin.\r\n\treturn isOriginPotentiallyTrustworthy(url);\r\n}\r\n\r\n/**\r\n * Modifies the referrerURL to enforce any extra security policy considerations.\r\n * @see {@link https://w3c.github.io/webappsec-referrer-policy/#determine-requests-referrer|Referrer Policy \u00A78.3. Determine request's Referrer}, step 7\r\n * @callback module:utils/referrer~referrerURLCallback\r\n * @param {external:URL} referrerURL\r\n * @returns {external:URL} modified referrerURL\r\n */\r\n\r\n/**\r\n * Modifies the referrerOrigin to enforce any extra security policy considerations.\r\n * @see {@link https://w3c.github.io/webappsec-referrer-policy/#determine-requests-referrer|Referrer Policy \u00A78.3. Determine request's Referrer}, step 7\r\n * @callback module:utils/referrer~referrerOriginCallback\r\n * @param {external:URL} referrerOrigin\r\n * @returns {external:URL} modified referrerOrigin\r\n */\r\n\r\n/**\r\n * @see {@link https://w3c.github.io/webappsec-referrer-policy/#determine-requests-referrer|Referrer Policy \u00A78.3. Determine request's Referrer}\r\n * @param {Request} request\r\n * @param {object} o\r\n * @param {module:utils/referrer~referrerURLCallback} o.referrerURLCallback\r\n * @param {module:utils/referrer~referrerOriginCallback} o.referrerOriginCallback\r\n * @returns {external:URL} Request's referrer\r\n */\r\nexport function determineRequestsReferrer(request, {referrerURLCallback, referrerOriginCallback} = {}) {\r\n\t// There are 2 notes in the specification about invalid pre-conditions.  We return null, here, for\r\n\t// these cases:\r\n\t// > Note: If request's referrer is \"no-referrer\", Fetch will not call into this algorithm.\r\n\t// > Note: If request's referrer policy is the empty string, Fetch will not call into this\r\n\t// > algorithm.\r\n\tif (request.referrer === 'no-referrer' || request.referrerPolicy === '') {\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// 1. Let policy be request's associated referrer policy.\r\n\tconst policy = request.referrerPolicy;\r\n\r\n\t// 2. Let environment be request's client.\r\n\t// not applicable to node.js\r\n\r\n\t// 3. Switch on request's referrer:\r\n\tif (request.referrer === 'about:client') {\r\n\t\treturn 'no-referrer';\r\n\t}\r\n\r\n\t// \"a URL\": Let referrerSource be request's referrer.\r\n\tconst referrerSource = request.referrer;\r\n\r\n\t// 4. Let request's referrerURL be the result of stripping referrerSource for use as a referrer.\r\n\tlet referrerURL = stripURLForUseAsAReferrer(referrerSource);\r\n\r\n\t// 5. Let referrerOrigin be the result of stripping referrerSource for use as a referrer, with the\r\n\t//    origin-only flag set to true.\r\n\tlet referrerOrigin = stripURLForUseAsAReferrer(referrerSource, true);\r\n\r\n\t// 6. If the result of serializing referrerURL is a string whose length is greater than 4096, set\r\n\t//    referrerURL to referrerOrigin.\r\n\tif (referrerURL.toString().length > 4096) {\r\n\t\treferrerURL = referrerOrigin;\r\n\t}\r\n\r\n\t// 7. The user agent MAY alter referrerURL or referrerOrigin at this point to enforce arbitrary\r\n\t//    policy considerations in the interests of minimizing data leakage. For example, the user\r\n\t//    agent could strip the URL down to an origin, modify its host, replace it with an empty\r\n\t//    string, etc.\r\n\tif (referrerURLCallback) {\r\n\t\treferrerURL = referrerURLCallback(referrerURL);\r\n\t}\r\n\r\n\tif (referrerOriginCallback) {\r\n\t\treferrerOrigin = referrerOriginCallback(referrerOrigin);\r\n\t}\r\n\r\n\t// 8.Execute the statements corresponding to the value of policy:\r\n\tconst currentURL = new URL(request.url);\r\n\r\n\tswitch (policy) {\r\n\t\tcase 'no-referrer':\r\n\t\t\treturn 'no-referrer';\r\n\r\n\t\tcase 'origin':\r\n\t\t\treturn referrerOrigin;\r\n\r\n\t\tcase 'unsafe-url':\r\n\t\t\treturn referrerURL;\r\n\r\n\t\tcase 'strict-origin':\r\n\t\t\t// 1. If referrerURL is a potentially trustworthy URL and request's current URL is not a\r\n\t\t\t//    potentially trustworthy URL, then return no referrer.\r\n\t\t\tif (isUrlPotentiallyTrustworthy(referrerURL) && !isUrlPotentiallyTrustworthy(currentURL)) {\r\n\t\t\t\treturn 'no-referrer';\r\n\t\t\t}\r\n\r\n\t\t\t// 2. Return referrerOrigin.\r\n\t\t\treturn referrerOrigin.toString();\r\n\r\n\t\tcase 'strict-origin-when-cross-origin':\r\n\t\t\t// 1. If the origin of referrerURL and the origin of request's current URL are the same, then\r\n\t\t\t//    return referrerURL.\r\n\t\t\tif (referrerURL.origin === currentURL.origin) {\r\n\t\t\t\treturn referrerURL;\r\n\t\t\t}\r\n\r\n\t\t\t// 2. If referrerURL is a potentially trustworthy URL and request's current URL is not a\r\n\t\t\t//    potentially trustworthy URL, then return no referrer.\r\n\t\t\tif (isUrlPotentiallyTrustworthy(referrerURL) && !isUrlPotentiallyTrustworthy(currentURL)) {\r\n\t\t\t\treturn 'no-referrer';\r\n\t\t\t}\r\n\r\n\t\t\t// 3. Return referrerOrigin.\r\n\t\t\treturn referrerOrigin;\r\n\r\n\t\tcase 'same-origin':\r\n\t\t\t// 1. If the origin of referrerURL and the origin of request's current URL are the same, then\r\n\t\t\t//    return referrerURL.\r\n\t\t\tif (referrerURL.origin === currentURL.origin) {\r\n\t\t\t\treturn referrerURL;\r\n\t\t\t}\r\n\r\n\t\t\t// 2. Return no referrer.\r\n\t\t\treturn 'no-referrer';\r\n\r\n\t\tcase 'origin-when-cross-origin':\r\n\t\t\t// 1. If the origin of referrerURL and the origin of request's current URL are the same, then\r\n\t\t\t//    return referrerURL.\r\n\t\t\tif (referrerURL.origin === currentURL.origin) {\r\n\t\t\t\treturn referrerURL;\r\n\t\t\t}\r\n\r\n\t\t\t// Return referrerOrigin.\r\n\t\t\treturn referrerOrigin;\r\n\r\n\t\tcase 'no-referrer-when-downgrade':\r\n\t\t\t// 1. If referrerURL is a potentially trustworthy URL and request's current URL is not a\r\n\t\t\t//    potentially trustworthy URL, then return no referrer.\r\n\t\t\tif (isUrlPotentiallyTrustworthy(referrerURL) && !isUrlPotentiallyTrustworthy(currentURL)) {\r\n\t\t\t\treturn 'no-referrer';\r\n\t\t\t}\r\n\r\n\t\t\t// 2. Return referrerURL.\r\n\t\t\treturn referrerURL;\r\n\r\n\t\tdefault:\r\n\t\t\tthrow new TypeError(`Invalid referrerPolicy: ${policy}`);\r\n\t}\r\n}\r\n\r\n/**\r\n * @see {@link https://w3c.github.io/webappsec-referrer-policy/#parse-referrer-policy-from-header|Referrer Policy \u00A78.1. Parse a referrer policy from a Referrer-Policy header}\r\n * @param {Headers} headers Response headers\r\n * @returns {string} policy\r\n */\r\nexport function parseReferrerPolicyFromHeader(headers) {\r\n\t// 1. Let policy-tokens be the result of extracting header list values given `Referrer-Policy`\r\n\t//    and response\u2019s header list.\r\n\tconst policyTokens = (headers.get('referrer-policy') || '').split(/[,\\s]+/);\r\n\r\n\t// 2. Let policy be the empty string.\r\n\tlet policy = '';\r\n\r\n\t// 3. For each token in policy-tokens, if token is a referrer policy and token is not the empty\r\n\t//    string, then set policy to token.\r\n\t// Note: This algorithm loops over multiple policy values to allow deployment of new policy\r\n\t// values with fallbacks for older user agents, as described in \u00A7 11.1 Unknown Policy Values.\r\n\tfor (const token of policyTokens) {\r\n\t\tif (token && ReferrerPolicy.has(token)) {\r\n\t\t\tpolicy = token;\r\n\t\t}\r\n\t}\r\n\r\n\t// 4. Return policy.\r\n\treturn policy;\r\n}\r\n", "import {FetchBaseError} from './base.js';\r\n\r\n/**\r\n * AbortError interface for cancelled requests\r\n */\r\nexport class AbortError extends FetchBaseError {\r\n\tconstructor(message, type = 'aborted') {\r\n\t\tsuper(message, type);\r\n\t}\r\n}\r\n", "export { Request, Response } from \"@buttercup/fetch\";\r\nexport var AuthType;\r\n(function (AuthType) {\r\n    AuthType[\"Auto\"] = \"auto\";\r\n    AuthType[\"Digest\"] = \"digest\";\r\n    AuthType[\"None\"] = \"none\";\r\n    AuthType[\"Password\"] = \"password\";\r\n    AuthType[\"Token\"] = \"token\";\r\n})(AuthType || (AuthType = {}));\r\nexport var ErrorCode;\r\n(function (ErrorCode) {\r\n    ErrorCode[\"DataTypeNoLength\"] = \"data-type-no-length\";\r\n    ErrorCode[\"InvalidAuthType\"] = \"invalid-auth-type\";\r\n    ErrorCode[\"InvalidOutputFormat\"] = \"invalid-output-format\";\r\n    ErrorCode[\"LinkUnsupportedAuthType\"] = \"link-unsupported-auth\";\r\n    ErrorCode[\"InvalidUpdateRange\"] = \"invalid-update-range\";\r\n    ErrorCode[\"NotSupported\"] = \"not-supported\";\r\n})(ErrorCode || (ErrorCode = {}));\r\n", "import { Layerr } from \"layerr\";\r\nimport { createDigestContext } from \"./digest.js\";\r\nimport { generateBasicAuthHeader } from \"./basic.js\";\r\nimport { generateTokenAuthHeader } from \"./oauth.js\";\r\nimport { AuthType, ErrorCode } from \"../types.js\";\r\nexport function setupAuth(context, username, password, oauthToken, ha1) {\r\n    switch (context.authType) {\r\n        case AuthType.Auto:\r\n            if (username && password) {\r\n                context.headers.Authorization = generateBasicAuthHeader(username, password);\r\n            }\r\n            break;\r\n        case AuthType.Digest:\r\n            context.digest = createDigestContext(username, password, ha1);\r\n            break;\r\n        case AuthType.None:\r\n            // Do nothing\r\n            break;\r\n        case AuthType.Password:\r\n            context.headers.Authorization = generateBasicAuthHeader(username, password);\r\n            break;\r\n        case AuthType.Token:\r\n            context.headers.Authorization = generateTokenAuthHeader(oauthToken);\r\n            break;\r\n        default:\r\n            throw new Layerr({\r\n                info: {\r\n                    code: ErrorCode.InvalidAuthType\r\n                }\r\n            }, `Invalid auth type: ${context.authType}`);\r\n    }\r\n}\r\n", "import { Agent as HTTPAgent } from \"http\";\r\nimport { Agent as HTTPSAgent } from \"https\";\r\nimport { fetch } from \"@buttercup/fetch\";\r\nimport { getPatcher } from \"./compat/patcher.js\";\r\nimport { isReactNative, isWeb } from \"./compat/env.js\";\r\nimport { generateDigestAuthHeader, parseDigestAuth, responseIndicatesDigestAuth } from \"./auth/digest.js\";\r\nimport { cloneShallow, merge } from \"./tools/merge.js\";\r\nimport { mergeHeaders } from \"./tools/headers.js\";\r\nimport { requestDataToFetchBody } from \"./tools/body.js\";\r\nimport { AuthType } from \"./types.js\";\r\nimport { setupAuth } from \"./auth/index.js\";\r\nfunction getFetchOptions(requestOptions) {\r\n    let headers = {};\r\n    // Handle standard options\r\n    const opts = {\r\n        method: requestOptions.method\r\n    };\r\n    if (requestOptions.headers) {\r\n        headers = mergeHeaders(headers, requestOptions.headers);\r\n    }\r\n    if (typeof requestOptions.data !== \"undefined\") {\r\n        const [body, newHeaders] = requestDataToFetchBody(requestOptions.data);\r\n        opts.body = body;\r\n        headers = mergeHeaders(headers, newHeaders);\r\n    }\r\n    if (requestOptions.signal) {\r\n        opts.signal = requestOptions.signal;\r\n    }\r\n    if (requestOptions.withCredentials) {\r\n        opts.credentials = \"include\";\r\n    }\r\n    // Check for node-specific options\r\n    if (!isWeb() && !isReactNative()) {\r\n        if (requestOptions.httpAgent || requestOptions.httpsAgent) {\r\n            opts.agent = (parsedURL) => {\r\n                if (parsedURL.protocol === \"http:\") {\r\n                    return requestOptions.httpAgent || new HTTPAgent();\r\n                }\r\n                return requestOptions.httpsAgent || new HTTPSAgent();\r\n            };\r\n        }\r\n    }\r\n    // Attach headers\r\n    opts.headers = headers;\r\n    return opts;\r\n}\r\nexport function prepareRequestOptions(requestOptions, context, userOptions) {\r\n    const finalOptions = cloneShallow(requestOptions);\r\n    finalOptions.headers = mergeHeaders(context.headers, finalOptions.headers || {}, userOptions.headers || {});\r\n    if (typeof userOptions.data !== \"undefined\") {\r\n        finalOptions.data = userOptions.data;\r\n    }\r\n    if (userOptions.signal) {\r\n        finalOptions.signal = userOptions.signal;\r\n    }\r\n    if (context.httpAgent) {\r\n        finalOptions.httpAgent = context.httpAgent;\r\n    }\r\n    if (context.httpsAgent) {\r\n        finalOptions.httpsAgent = context.httpsAgent;\r\n    }\r\n    if (context.digest) {\r\n        finalOptions._digest = context.digest;\r\n    }\r\n    if (typeof context.withCredentials === \"boolean\") {\r\n        finalOptions.withCredentials = context.withCredentials;\r\n    }\r\n    return finalOptions;\r\n}\r\nexport async function request(requestOptions, context) {\r\n    if (context.authType === AuthType.Auto) {\r\n        return requestAuto(requestOptions, context);\r\n    }\r\n    if (requestOptions._digest) {\r\n        return requestDigest(requestOptions);\r\n    }\r\n    return requestStandard(requestOptions);\r\n}\r\nasync function requestAuto(requestOptions, context) {\r\n    const response = await requestStandard(requestOptions);\r\n    if (response.ok) {\r\n        context.authType = AuthType.Password;\r\n        return response;\r\n    }\r\n    if (response.status == 401 && responseIndicatesDigestAuth(response)) {\r\n        context.authType = AuthType.Digest;\r\n        setupAuth(context, context.username, context.password, undefined, undefined);\r\n        requestOptions._digest = context.digest;\r\n        return requestDigest(requestOptions);\r\n    }\r\n    return response;\r\n}\r\nasync function requestDigest(requestOptions) {\r\n    // Remove client's digest authentication object from request options\r\n    const _digest = requestOptions._digest;\r\n    delete requestOptions._digest;\r\n    // If client is already using digest authentication, include the digest authorization header\r\n    if (_digest.hasDigestAuth) {\r\n        requestOptions = merge(requestOptions, {\r\n            headers: {\r\n                Authorization: generateDigestAuthHeader(requestOptions, _digest)\r\n            }\r\n        });\r\n    }\r\n    // Perform digest request + check\r\n    const response = await requestStandard(requestOptions);\r\n    if (response.status == 401) {\r\n        _digest.hasDigestAuth = parseDigestAuth(response, _digest);\r\n        if (_digest.hasDigestAuth) {\r\n            requestOptions = merge(requestOptions, {\r\n                headers: {\r\n                    Authorization: generateDigestAuthHeader(requestOptions, _digest)\r\n                }\r\n            });\r\n            const response2 = await requestStandard(requestOptions);\r\n            if (response2.status == 401) {\r\n                _digest.hasDigestAuth = false;\r\n            }\r\n            else {\r\n                _digest.nc++;\r\n            }\r\n            return response2;\r\n        }\r\n    }\r\n    else {\r\n        _digest.nc++;\r\n    }\r\n    return response;\r\n}\r\nfunction requestStandard(requestOptions) {\r\n    const patcher = getPatcher();\r\n    return patcher.patchInline(\"request\", (options) => patcher.patchInline(\"fetch\", fetch, options.url, getFetchOptions(options)), requestOptions);\r\n}\r\n", "export function sequence(...methods) {\r\n    if (methods.length === 0) {\r\n        throw new Error(\"Failed creating sequence: No functions provided\");\r\n    }\r\n    return function __executeSequence(...args) {\r\n        let result = args;\r\n        const _this = this;\r\n        while (methods.length > 0) {\r\n            const method = methods.shift();\r\n            result = [method.apply(_this, result)];\r\n        }\r\n        return result[0];\r\n    };\r\n}\r\n", "import { sequence } from \"./functions.js\";\r\nconst HOT_PATCHER_TYPE = \"@@HOTPATCHER\";\r\nconst NOOP = () => { };\r\nfunction createNewItem(method) {\r\n    return {\r\n        original: method,\r\n        methods: [method],\r\n        final: false\r\n    };\r\n}\r\n/**\r\n * Hot patching manager class\r\n */\r\nexport class HotPatcher {\r\n    constructor() {\r\n        this._configuration = {\r\n            registry: {},\r\n            getEmptyAction: \"null\"\r\n        };\r\n        this.__type__ = HOT_PATCHER_TYPE;\r\n    }\r\n    /**\r\n     * Configuration object reference\r\n     * @readonly\r\n     */\r\n    get configuration() {\r\n        return this._configuration;\r\n    }\r\n    /**\r\n     * The action to take when a non-set method is requested\r\n     * Possible values: null/throw\r\n     */\r\n    get getEmptyAction() {\r\n        return this.configuration.getEmptyAction;\r\n    }\r\n    set getEmptyAction(newAction) {\r\n        this.configuration.getEmptyAction = newAction;\r\n    }\r\n    /**\r\n     * Control another hot-patcher instance\r\n     * Force the remote instance to use patched methods from calling instance\r\n     * @param target The target instance to control\r\n     * @param allowTargetOverrides Allow the target to override patched methods on\r\n     * the controller (default is false)\r\n     * @returns Returns self\r\n     * @throws {Error} Throws if the target is invalid\r\n     */\r\n    control(target, allowTargetOverrides = false) {\r\n        if (!target || target.__type__ !== HOT_PATCHER_TYPE) {\r\n            throw new Error(\"Failed taking control of target HotPatcher instance: Invalid type or object\");\r\n        }\r\n        Object.keys(target.configuration.registry).forEach(foreignKey => {\r\n            if (this.configuration.registry.hasOwnProperty(foreignKey)) {\r\n                if (allowTargetOverrides) {\r\n                    this.configuration.registry[foreignKey] = Object.assign({}, target.configuration.registry[foreignKey]);\r\n                }\r\n            }\r\n            else {\r\n                this.configuration.registry[foreignKey] = Object.assign({}, target.configuration.registry[foreignKey]);\r\n            }\r\n        });\r\n        target._configuration = this.configuration;\r\n        return this;\r\n    }\r\n    /**\r\n     * Execute a patched method\r\n     * @param key The method key\r\n     * @param args Arguments to pass to the method (optional)\r\n     * @see HotPatcher#get\r\n     * @returns The output of the called method\r\n     */\r\n    execute(key, ...args) {\r\n        const method = this.get(key) || NOOP;\r\n        return method(...args);\r\n    }\r\n    /**\r\n     * Get a method for a key\r\n     * @param key The method key\r\n     * @returns Returns the requested function or null if the function\r\n     * does not exist and the host is configured to return null (and not throw)\r\n     * @throws {Error} Throws if the configuration specifies to throw and the method\r\n     * does not exist\r\n     * @throws {Error} Throws if the `getEmptyAction` value is invalid\r\n     */\r\n    get(key) {\r\n        const item = this.configuration.registry[key];\r\n        if (!item) {\r\n            switch (this.getEmptyAction) {\r\n                case \"null\":\r\n                    return null;\r\n                case \"throw\":\r\n                    throw new Error(`Failed handling method request: No method provided for override: ${key}`);\r\n                default:\r\n                    throw new Error(`Failed handling request which resulted in an empty method: Invalid empty-action specified: ${this.getEmptyAction}`);\r\n            }\r\n        }\r\n        return sequence(...item.methods);\r\n    }\r\n    /**\r\n     * Check if a method has been patched\r\n     * @param key The function key\r\n     * @returns True if already patched\r\n     */\r\n    isPatched(key) {\r\n        return !!this.configuration.registry[key];\r\n    }\r\n    /**\r\n     * Patch a method name\r\n     * @param key The method key to patch\r\n     * @param method The function to set\r\n     * @param opts Patch options\r\n     * @returns Returns self\r\n     */\r\n    patch(key, method, opts = {}) {\r\n        const { chain = false } = opts;\r\n        if (this.configuration.registry[key] && this.configuration.registry[key].final) {\r\n            throw new Error(`Failed patching '${key}': Method marked as being final`);\r\n        }\r\n        if (typeof method !== \"function\") {\r\n            throw new Error(`Failed patching '${key}': Provided method is not a function`);\r\n        }\r\n        if (chain) {\r\n            // Add new method to the chain\r\n            if (!this.configuration.registry[key]) {\r\n                // New key, create item\r\n                this.configuration.registry[key] = createNewItem(method);\r\n            }\r\n            else {\r\n                // Existing, push the method\r\n                this.configuration.registry[key].methods.push(method);\r\n            }\r\n        }\r\n        else {\r\n            // Replace the original\r\n            if (this.isPatched(key)) {\r\n                const { original } = this.configuration.registry[key];\r\n                this.configuration.registry[key] = Object.assign(createNewItem(method), {\r\n                    original\r\n                });\r\n            }\r\n            else {\r\n                this.configuration.registry[key] = createNewItem(method);\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Patch a method inline, execute it and return the value\r\n     * Used for patching contents of functions. This method will not apply a patched\r\n     * function if it has already been patched, allowing for external overrides to\r\n     * function. It also means that the function is cached so that it is not\r\n     * instantiated every time the outer function is invoked.\r\n     * @param key The function key to use\r\n     * @param method The function to patch (once, only if not patched)\r\n     * @param args Arguments to pass to the function\r\n     * @returns The output of the patched function\r\n     * @example\r\n     *  function mySpecialFunction(a, b) {\r\n     *      return hotPatcher.patchInline(\"func\", (a, b) => {\r\n     *          return a + b;\r\n     *      }, a, b);\r\n     *  }\r\n     */\r\n    patchInline(key, method, ...args) {\r\n        if (!this.isPatched(key)) {\r\n            this.patch(key, method);\r\n        }\r\n        return this.execute(key, ...args);\r\n    }\r\n    /**\r\n     * Patch a method (or methods) in sequential-mode\r\n     * See `patch()` with the option `chain: true`\r\n     * @see patch\r\n     * @param key The key to patch\r\n     * @param methods The methods to patch\r\n     * @returns Returns self\r\n     */\r\n    plugin(key, ...methods) {\r\n        methods.forEach(method => {\r\n            this.patch(key, method, { chain: true });\r\n        });\r\n        return this;\r\n    }\r\n    /**\r\n     * Restore a patched method if it has been overridden\r\n     * @param key The method key\r\n     * @returns Returns self\r\n     */\r\n    restore(key) {\r\n        if (!this.isPatched(key)) {\r\n            throw new Error(`Failed restoring method: No method present for key: ${key}`);\r\n        }\r\n        else if (typeof this.configuration.registry[key].original !== \"function\") {\r\n            throw new Error(`Failed restoring method: Original method not found or of invalid type for key: ${key}`);\r\n        }\r\n        this.configuration.registry[key].methods = [this.configuration.registry[key].original];\r\n        return this;\r\n    }\r\n    /**\r\n     * Set a method as being final\r\n     * This sets a method as having been finally overridden. Attempts at overriding\r\n     * again will fail with an error.\r\n     * @param key The key to make final\r\n     * @returns Returns self\r\n     */\r\n    setFinal(key) {\r\n        if (!this.configuration.registry.hasOwnProperty(key)) {\r\n            throw new Error(`Failed marking '${key}' as final: No method found for key`);\r\n        }\r\n        this.configuration.registry[key].final = true;\r\n        return this;\r\n    }\r\n}\r\n", "import { HotPatcher } from \"hot-patcher\";\r\nlet __patcher = null;\r\nexport function getPatcher() {\r\n    if (!__patcher) {\r\n        __patcher = new HotPatcher();\r\n    }\r\n    return __patcher;\r\n}\r\n", "export function cloneShallow(obj) {\r\n    return isPlainObject(obj)\r\n        ? Object.assign({}, obj)\r\n        : Object.setPrototypeOf(Object.assign({}, obj), Object.getPrototypeOf(obj));\r\n}\r\nfunction isPlainObject(obj) {\r\n    if (typeof obj !== \"object\" ||\r\n        obj === null ||\r\n        Object.prototype.toString.call(obj) != \"[object Object]\") {\r\n        // Not an object\r\n        return false;\r\n    }\r\n    if (Object.getPrototypeOf(obj) === null) {\r\n        return true;\r\n    }\r\n    let proto = obj;\r\n    // Find the prototype\r\n    while (Object.getPrototypeOf(proto) !== null) {\r\n        proto = Object.getPrototypeOf(proto);\r\n    }\r\n    return Object.getPrototypeOf(obj) === proto;\r\n}\r\nexport function merge(...args) {\r\n    let output = null, items = [...args];\r\n    while (items.length > 0) {\r\n        const nextItem = items.shift();\r\n        if (!output) {\r\n            output = cloneShallow(nextItem);\r\n        }\r\n        else {\r\n            output = mergeObjects(output, nextItem);\r\n        }\r\n    }\r\n    return output;\r\n}\r\nfunction mergeObjects(obj1, obj2) {\r\n    const output = cloneShallow(obj1);\r\n    Object.keys(obj2).forEach(key => {\r\n        if (!output.hasOwnProperty(key)) {\r\n            output[key] = obj2[key];\r\n            return;\r\n        }\r\n        if (Array.isArray(obj2[key])) {\r\n            output[key] = Array.isArray(output[key])\r\n                ? [...output[key], ...obj2[key]]\r\n                : [...obj2[key]];\r\n        }\r\n        else if (typeof obj2[key] === \"object\" && !!obj2[key]) {\r\n            output[key] =\r\n                typeof output[key] === \"object\" && !!output[key]\r\n                    ? mergeObjects(output[key], obj2[key])\r\n                    : cloneShallow(obj2[key]);\r\n        }\r\n        else {\r\n            output[key] = obj2[key];\r\n        }\r\n    });\r\n    return output;\r\n}\r\n", "export function convertResponseHeaders(headers) {\r\n    const output = {};\r\n    for (const key of headers.keys()) {\r\n        output[key] = headers.get(key);\r\n    }\r\n    return output;\r\n}\r\nexport function mergeHeaders(...headerPayloads) {\r\n    if (headerPayloads.length === 0)\r\n        return {};\r\n    const headerKeys = {};\r\n    return headerPayloads.reduce((output, headers) => {\r\n        Object.keys(headers).forEach(header => {\r\n            const lowerHeader = header.toLowerCase();\r\n            if (headerKeys.hasOwnProperty(lowerHeader)) {\r\n                output[headerKeys[lowerHeader]] = headers[header];\r\n            }\r\n            else {\r\n                headerKeys[lowerHeader] = header;\r\n                output[header] = headers[header];\r\n            }\r\n        });\r\n        return output;\r\n    }, {});\r\n}\r\n", "import Stream from \"stream\";\r\nimport { isArrayBuffer } from \"../compat/arrayBuffer.js\";\r\nimport { isBuffer } from \"../compat/buffer.js\";\r\nimport { isReactNative, isWeb } from \"../compat/env.js\";\r\nexport function requestDataToFetchBody(data) {\r\n    if (!isWeb() && !isReactNative() && data instanceof Stream.Readable) {\r\n        // @ts-ignore\r\n        return [data, {}];\r\n    }\r\n    if (typeof data === \"string\") {\r\n        return [data, {}];\r\n    }\r\n    else if (isBuffer(data)) {\r\n        return [data, {}];\r\n    }\r\n    else if (isArrayBuffer(data)) {\r\n        return [data, {}];\r\n    }\r\n    else if (data && typeof data === \"object\") {\r\n        return [\r\n            JSON.stringify(data),\r\n            {\r\n                \"content-type\": \"application/json\"\r\n            }\r\n        ];\r\n    }\r\n    throw new Error(`Unable to convert request body: Unexpected body type: ${typeof data}`);\r\n}\r\n", "const hasArrayBuffer = typeof ArrayBuffer === \"function\";\r\nconst { toString: objToString } = Object.prototype;\r\n// Taken from: https://github.com/fengyuanchen/is-array-buffer/blob/master/src/index.js\r\nexport function isArrayBuffer(value) {\r\n    return (hasArrayBuffer &&\r\n        (value instanceof ArrayBuffer || objToString.call(value) === \"[object ArrayBuffer]\"));\r\n}\r\n", "export function isBuffer(value) {\r\n    return (value != null &&\r\n        value.constructor != null &&\r\n        typeof value.constructor.isBuffer === \"function\" &&\r\n        value.constructor.isBuffer(value));\r\n}\r\n", "import expand from 'brace-expansion'\nimport { assertValidPattern } from './assert-valid-pattern.js'\nimport { AST, ExtglobType } from './ast.js'\nimport { escape } from './escape.js'\nimport { unescape } from './unescape.js'\n\ntype Platform =\n  | 'aix'\n  | 'android'\n  | 'darwin'\n  | 'freebsd'\n  | 'haiku'\n  | 'linux'\n  | 'openbsd'\n  | 'sunos'\n  | 'win32'\n  | 'cygwin'\n  | 'netbsd'\n\nexport interface MinimatchOptions {\n  nobrace?: boolean\n  nocomment?: boolean\n  nonegate?: boolean\n  debug?: boolean\n  noglobstar?: boolean\n  noext?: boolean\n  nonull?: boolean\n  windowsPathsNoEscape?: boolean\n  allowWindowsEscape?: boolean\n  partial?: boolean\n  dot?: boolean\n  nocase?: boolean\n  nocaseMagicOnly?: boolean\n  magicalBraces?: boolean\n  matchBase?: boolean\n  flipNegate?: boolean\n  preserveMultipleSlashes?: boolean\n  optimizationLevel?: number\n  platform?: Platform\n  windowsNoMagicRoot?: boolean\n}\n\nexport const minimatch = (\n  p: string,\n  pattern: string,\n  options: MinimatchOptions = {}\n) => {\n  assertValidPattern(pattern)\n\n  // shortcut: comments match nothing.\n  if (!options.nocomment && pattern.charAt(0) === '#') {\n    return false\n  }\n\n  return new Minimatch(pattern, options).match(p)\n}\n\n// Optimized checking for the most common glob patterns.\nconst starDotExtRE = /^\\*+([^+@!?\\*\\[\\(]*)$/\nconst starDotExtTest = (ext: string) => (f: string) =>\n  !f.startsWith('.') && f.endsWith(ext)\nconst starDotExtTestDot = (ext: string) => (f: string) => f.endsWith(ext)\nconst starDotExtTestNocase = (ext: string) => {\n  ext = ext.toLowerCase()\n  return (f: string) => !f.startsWith('.') && f.toLowerCase().endsWith(ext)\n}\nconst starDotExtTestNocaseDot = (ext: string) => {\n  ext = ext.toLowerCase()\n  return (f: string) => f.toLowerCase().endsWith(ext)\n}\nconst starDotStarRE = /^\\*+\\.\\*+$/\nconst starDotStarTest = (f: string) => !f.startsWith('.') && f.includes('.')\nconst starDotStarTestDot = (f: string) =>\n  f !== '.' && f !== '..' && f.includes('.')\nconst dotStarRE = /^\\.\\*+$/\nconst dotStarTest = (f: string) => f !== '.' && f !== '..' && f.startsWith('.')\nconst starRE = /^\\*+$/\nconst starTest = (f: string) => f.length !== 0 && !f.startsWith('.')\nconst starTestDot = (f: string) => f.length !== 0 && f !== '.' && f !== '..'\nconst qmarksRE = /^\\?+([^+@!?\\*\\[\\(]*)?$/\nconst qmarksTestNocase = ([$0, ext = '']: RegExpMatchArray) => {\n  const noext = qmarksTestNoExt([$0])\n  if (!ext) return noext\n  ext = ext.toLowerCase()\n  return (f: string) => noext(f) && f.toLowerCase().endsWith(ext)\n}\nconst qmarksTestNocaseDot = ([$0, ext = '']: RegExpMatchArray) => {\n  const noext = qmarksTestNoExtDot([$0])\n  if (!ext) return noext\n  ext = ext.toLowerCase()\n  return (f: string) => noext(f) && f.toLowerCase().endsWith(ext)\n}\nconst qmarksTestDot = ([$0, ext = '']: RegExpMatchArray) => {\n  const noext = qmarksTestNoExtDot([$0])\n  return !ext ? noext : (f: string) => noext(f) && f.endsWith(ext)\n}\nconst qmarksTest = ([$0, ext = '']: RegExpMatchArray) => {\n  const noext = qmarksTestNoExt([$0])\n  return !ext ? noext : (f: string) => noext(f) && f.endsWith(ext)\n}\nconst qmarksTestNoExt = ([$0]: RegExpMatchArray) => {\n  const len = $0.length\n  return (f: string) => f.length === len && !f.startsWith('.')\n}\nconst qmarksTestNoExtDot = ([$0]: RegExpMatchArray) => {\n  const len = $0.length\n  return (f: string) => f.length === len && f !== '.' && f !== '..'\n}\n\n/* c8 ignore start */\nconst defaultPlatform: Platform = (\n  typeof process === 'object' && process\n    ? (typeof process.env === 'object' &&\n        process.env &&\n        process.env.__MINIMATCH_TESTING_PLATFORM__) ||\n      process.platform\n    : 'posix'\n) as Platform\ntype Sep = '\\\\' | '/'\nconst path: { [k: string]: { sep: Sep } } = {\n  win32: { sep: '\\\\' },\n  posix: { sep: '/' },\n}\n/* c8 ignore stop */\n\nexport const sep = defaultPlatform === 'win32' ? path.win32.sep : path.posix.sep\nminimatch.sep = sep\n\nexport const GLOBSTAR = Symbol('globstar **')\nminimatch.GLOBSTAR = GLOBSTAR\n\n// any single thing other than /\n// don't need to escape / when using new RegExp()\nconst qmark = '[^/]'\n\n// * => any number of characters\nconst star = qmark + '*?'\n\n// ** when dots are allowed.  Anything goes, except .. and .\n// not (^ or / followed by one or two dots followed by $ or /),\n// followed by anything, any number of times.\nconst twoStarDot = '(?:(?!(?:\\\\/|^)(?:\\\\.{1,2})($|\\\\/)).)*?'\n\n// not a ^ or / followed by a dot,\n// followed by anything, any number of times.\nconst twoStarNoDot = '(?:(?!(?:\\\\/|^)\\\\.).)*?'\n\nexport const filter =\n  (pattern: string, options: MinimatchOptions = {}) =>\n  (p: string) =>\n    minimatch(p, pattern, options)\nminimatch.filter = filter\n\nconst ext = (a: MinimatchOptions, b: MinimatchOptions = {}) =>\n  Object.assign({}, a, b)\n\nexport const defaults = (def: MinimatchOptions): typeof minimatch => {\n  if (!def || typeof def !== 'object' || !Object.keys(def).length) {\n    return minimatch\n  }\n\n  const orig = minimatch\n\n  const m = (p: string, pattern: string, options: MinimatchOptions = {}) =>\n    orig(p, pattern, ext(def, options))\n\n  return Object.assign(m, {\n    Minimatch: class Minimatch extends orig.Minimatch {\n      constructor(pattern: string, options: MinimatchOptions = {}) {\n        super(pattern, ext(def, options))\n      }\n      static defaults(options: MinimatchOptions) {\n        return orig.defaults(ext(def, options)).Minimatch\n      }\n    },\n\n    AST: class AST extends orig.AST {\n      /* c8 ignore start */\n      constructor(\n        type: ExtglobType | null,\n        parent?: AST,\n        options: MinimatchOptions = {}\n      ) {\n        super(type, parent, ext(def, options))\n      }\n      /* c8 ignore stop */\n\n      static fromGlob(pattern: string, options: MinimatchOptions = {}) {\n        return orig.AST.fromGlob(pattern, ext(def, options))\n      }\n    },\n\n    unescape: (\n      s: string,\n      options: Pick<MinimatchOptions, 'windowsPathsNoEscape'> = {}\n    ) => orig.unescape(s, ext(def, options)),\n\n    escape: (\n      s: string,\n      options: Pick<MinimatchOptions, 'windowsPathsNoEscape'> = {}\n    ) => orig.escape(s, ext(def, options)),\n\n    filter: (pattern: string, options: MinimatchOptions = {}) =>\n      orig.filter(pattern, ext(def, options)),\n\n    defaults: (options: MinimatchOptions) => orig.defaults(ext(def, options)),\n\n    makeRe: (pattern: string, options: MinimatchOptions = {}) =>\n      orig.makeRe(pattern, ext(def, options)),\n\n    braceExpand: (pattern: string, options: MinimatchOptions = {}) =>\n      orig.braceExpand(pattern, ext(def, options)),\n\n    match: (list: string[], pattern: string, options: MinimatchOptions = {}) =>\n      orig.match(list, pattern, ext(def, options)),\n\n    sep: orig.sep,\n    GLOBSTAR: GLOBSTAR as typeof GLOBSTAR,\n  })\n}\nminimatch.defaults = defaults\n\n// Brace expansion:\n// a{b,c}d -> abd acd\n// a{b,}c -> abc ac\n// a{0..3}d -> a0d a1d a2d a3d\n// a{b,c{d,e}f}g -> abg acdfg acefg\n// a{b,c}d{e,f}g -> abdeg acdeg abdeg abdfg\n//\n// Invalid sets are not expanded.\n// a{2..}b -> a{2..}b\n// a{b}c -> a{b}c\nexport const braceExpand = (\n  pattern: string,\n  options: MinimatchOptions = {}\n) => {\n  assertValidPattern(pattern)\n\n  // Thanks to Yeting Li <https://github.com/yetingli> for\n  // improving this regexp to avoid a ReDOS vulnerability.\n  if (options.nobrace || !/\\{(?:(?!\\{).)*\\}/.test(pattern)) {\n    // shortcut. no need to expand.\n    return [pattern]\n  }\n\n  return expand(pattern)\n}\nminimatch.braceExpand = braceExpand\n\n// parse a component of the expanded set.\n// At this point, no pattern may contain \"/\" in it\n// so we're going to return a 2d array, where each entry is the full\n// pattern, split on '/', and then turned into a regular expression.\n// A regexp is made at the end which joins each array with an\n// escaped /, and another full one which joins each regexp with |.\n//\n// Following the lead of Bash 4.1, note that \"**\" only has special meaning\n// when it is the *only* thing in a path portion.  Otherwise, any series\n// of * is equivalent to a single *.  Globstar behavior is enabled by\n// default, and can be disabled by setting options.noglobstar.\n\nexport const makeRe = (pattern: string, options: MinimatchOptions = {}) =>\n  new Minimatch(pattern, options).makeRe()\nminimatch.makeRe = makeRe\n\nexport const match = (\n  list: string[],\n  pattern: string,\n  options: MinimatchOptions = {}\n) => {\n  const mm = new Minimatch(pattern, options)\n  list = list.filter(f => mm.match(f))\n  if (mm.options.nonull && !list.length) {\n    list.push(pattern)\n  }\n  return list\n}\nminimatch.match = match\n\n// replace stuff like \\* with *\nconst globMagic = /[?*]|[+@!]\\(.*?\\)|\\[|\\]/\nconst regExpEscape = (s: string) =>\n  s.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, '\\\\$&')\n\nexport type MMRegExp = RegExp & {\n  _src?: string\n  _glob?: string\n}\n\nexport type ParseReturnFiltered = string | MMRegExp | typeof GLOBSTAR\nexport type ParseReturn = ParseReturnFiltered | false\n\nexport class Minimatch {\n  options: MinimatchOptions\n  set: ParseReturnFiltered[][]\n  pattern: string\n\n  windowsPathsNoEscape: boolean\n  nonegate: boolean\n  negate: boolean\n  comment: boolean\n  empty: boolean\n  preserveMultipleSlashes: boolean\n  partial: boolean\n  globSet: string[]\n  globParts: string[][]\n  nocase: boolean\n\n  isWindows: boolean\n  platform: Platform\n  windowsNoMagicRoot: boolean\n\n  regexp: false | null | MMRegExp\n  constructor(pattern: string, options: MinimatchOptions = {}) {\n    assertValidPattern(pattern)\n\n    options = options || {}\n    this.options = options\n    this.pattern = pattern\n    this.platform = options.platform || defaultPlatform\n    this.isWindows = this.platform === 'win32'\n    this.windowsPathsNoEscape =\n      !!options.windowsPathsNoEscape || options.allowWindowsEscape === false\n    if (this.windowsPathsNoEscape) {\n      this.pattern = this.pattern.replace(/\\\\/g, '/')\n    }\n    this.preserveMultipleSlashes = !!options.preserveMultipleSlashes\n    this.regexp = null\n    this.negate = false\n    this.nonegate = !!options.nonegate\n    this.comment = false\n    this.empty = false\n    this.partial = !!options.partial\n    this.nocase = !!this.options.nocase\n    this.windowsNoMagicRoot =\n      options.windowsNoMagicRoot !== undefined\n        ? options.windowsNoMagicRoot\n        : !!(this.isWindows && this.nocase)\n\n    this.globSet = []\n    this.globParts = []\n    this.set = []\n\n    // make the set of regexps etc.\n    this.make()\n  }\n\n  hasMagic(): boolean {\n    if (this.options.magicalBraces && this.set.length > 1) {\n      return true\n    }\n    for (const pattern of this.set) {\n      for (const part of pattern) {\n        if (typeof part !== 'string') return true\n      }\n    }\n    return false\n  }\n\n  debug(..._: any[]) {}\n\n  make() {\n    const pattern = this.pattern\n    const options = this.options\n\n    // empty patterns and comments match nothing.\n    if (!options.nocomment && pattern.charAt(0) === '#') {\n      this.comment = true\n      return\n    }\n\n    if (!pattern) {\n      this.empty = true\n      return\n    }\n\n    // step 1: figure out negation, etc.\n    this.parseNegate()\n\n    // step 2: expand braces\n    this.globSet = [...new Set(this.braceExpand())]\n\n    if (options.debug) {\n      this.debug = (...args: any[]) => console.error(...args)\n    }\n\n    this.debug(this.pattern, this.globSet)\n\n    // step 3: now we have a set, so turn each one into a series of\n    // path-portion matching patterns.\n    // These will be regexps, except in the case of \"**\", which is\n    // set to the GLOBSTAR object for globstar behavior,\n    // and will not contain any / characters\n    //\n    // First, we preprocess to make the glob pattern sets a bit simpler\n    // and deduped.  There are some perf-killing patterns that can cause\n    // problems with a glob walk, but we can simplify them down a bit.\n    const rawGlobParts = this.globSet.map(s => this.slashSplit(s))\n    this.globParts = this.preprocess(rawGlobParts)\n    this.debug(this.pattern, this.globParts)\n\n    // glob --> regexps\n    let set = this.globParts.map((s, _, __) => {\n      if (this.isWindows && this.windowsNoMagicRoot) {\n        // check if it's a drive or unc path.\n        const isUNC =\n          s[0] === '' &&\n          s[1] === '' &&\n          (s[2] === '?' || !globMagic.test(s[2])) &&\n          !globMagic.test(s[3])\n        const isDrive = /^[a-z]:/i.test(s[0])\n        if (isUNC) {\n          return [...s.slice(0, 4), ...s.slice(4).map(ss => this.parse(ss))]\n        } else if (isDrive) {\n          return [s[0], ...s.slice(1).map(ss => this.parse(ss))]\n        }\n      }\n      return s.map(ss => this.parse(ss))\n    })\n\n    this.debug(this.pattern, set)\n\n    // filter out everything that didn't compile properly.\n    this.set = set.filter(\n      s => s.indexOf(false) === -1\n    ) as ParseReturnFiltered[][]\n\n    // do not treat the ? in UNC paths as magic\n    if (this.isWindows) {\n      for (let i = 0; i < this.set.length; i++) {\n        const p = this.set[i]\n        if (\n          p[0] === '' &&\n          p[1] === '' &&\n          this.globParts[i][2] === '?' &&\n          typeof p[3] === 'string' &&\n          /^[a-z]:$/i.test(p[3])\n        ) {\n          p[2] = '?'\n        }\n      }\n    }\n\n    this.debug(this.pattern, this.set)\n  }\n\n  // various transforms to equivalent pattern sets that are\n  // faster to process in a filesystem walk.  The goal is to\n  // eliminate what we can, and push all ** patterns as far\n  // to the right as possible, even if it increases the number\n  // of patterns that we have to process.\n  preprocess(globParts: string[][]) {\n    // if we're not in globstar mode, then turn all ** into *\n    if (this.options.noglobstar) {\n      for (let i = 0; i < globParts.length; i++) {\n        for (let j = 0; j < globParts[i].length; j++) {\n          if (globParts[i][j] === '**') {\n            globParts[i][j] = '*'\n          }\n        }\n      }\n    }\n\n    const { optimizationLevel = 1 } = this.options\n\n    if (optimizationLevel >= 2) {\n      // aggressive optimization for the purpose of fs walking\n      globParts = this.firstPhasePreProcess(globParts)\n      globParts = this.secondPhasePreProcess(globParts)\n    } else if (optimizationLevel >= 1) {\n      // just basic optimizations to remove some .. parts\n      globParts = this.levelOneOptimize(globParts)\n    } else {\n      // just collapse multiple ** portions into one\n      globParts = this.adjascentGlobstarOptimize(globParts)\n    }\n\n    return globParts\n  }\n\n  // just get rid of adjascent ** portions\n  adjascentGlobstarOptimize(globParts: string[][]) {\n    return globParts.map(parts => {\n      let gs: number = -1\n      while (-1 !== (gs = parts.indexOf('**', gs + 1))) {\n        let i = gs\n        while (parts[i + 1] === '**') {\n          i++\n        }\n        if (i !== gs) {\n          parts.splice(gs, i - gs)\n        }\n      }\n      return parts\n    })\n  }\n\n  // get rid of adjascent ** and resolve .. portions\n  levelOneOptimize(globParts: string[][]) {\n    return globParts.map(parts => {\n      parts = parts.reduce((set: string[], part) => {\n        const prev = set[set.length - 1]\n        if (part === '**' && prev === '**') {\n          return set\n        }\n        if (part === '..') {\n          if (prev && prev !== '..' && prev !== '.' && prev !== '**') {\n            set.pop()\n            return set\n          }\n        }\n        set.push(part)\n        return set\n      }, [])\n      return parts.length === 0 ? [''] : parts\n    })\n  }\n\n  levelTwoFileOptimize(parts: string | string[]) {\n    if (!Array.isArray(parts)) {\n      parts = this.slashSplit(parts)\n    }\n    let didSomething: boolean = false\n    do {\n      didSomething = false\n      // <pre>/<e>/<rest> -> <pre>/<rest>\n      if (!this.preserveMultipleSlashes) {\n        for (let i = 1; i < parts.length - 1; i++) {\n          const p = parts[i]\n          // don't squeeze out UNC patterns\n          if (i === 1 && p === '' && parts[0] === '') continue\n          if (p === '.' || p === '') {\n            didSomething = true\n            parts.splice(i, 1)\n            i--\n          }\n        }\n        if (\n          parts[0] === '.' &&\n          parts.length === 2 &&\n          (parts[1] === '.' || parts[1] === '')\n        ) {\n          didSomething = true\n          parts.pop()\n        }\n      }\n\n      // <pre>/<p>/../<rest> -> <pre>/<rest>\n      let dd: number = 0\n      while (-1 !== (dd = parts.indexOf('..', dd + 1))) {\n        const p = parts[dd - 1]\n        if (p && p !== '.' && p !== '..' && p !== '**') {\n          didSomething = true\n          parts.splice(dd - 1, 2)\n          dd -= 2\n        }\n      }\n    } while (didSomething)\n    return parts.length === 0 ? [''] : parts\n  }\n\n  // First phase: single-pattern processing\n  // <pre> is 1 or more portions\n  // <rest> is 1 or more portions\n  // <p> is any portion other than ., .., '', or **\n  // <e> is . or ''\n  //\n  // **/.. is *brutal* for filesystem walking performance, because\n  // it effectively resets the recursive walk each time it occurs,\n  // and ** cannot be reduced out by a .. pattern part like a regexp\n  // or most strings (other than .., ., and '') can be.\n  //\n  // <pre>/**/../<p>/<p>/<rest> -> {<pre>/../<p>/<p>/<rest>,<pre>/**/<p>/<p>/<rest>}\n  // <pre>/<e>/<rest> -> <pre>/<rest>\n  // <pre>/<p>/../<rest> -> <pre>/<rest>\n  // **/**/<rest> -> **/<rest>\n  //\n  // **/*/<rest> -> */**/<rest> <== not valid because ** doesn't follow\n  // this WOULD be allowed if ** did follow symlinks, or * didn't\n  firstPhasePreProcess(globParts: string[][]) {\n    let didSomething = false\n    do {\n      didSomething = false\n      // <pre>/**/../<p>/<p>/<rest> -> {<pre>/../<p>/<p>/<rest>,<pre>/**/<p>/<p>/<rest>}\n      for (let parts of globParts) {\n        let gs: number = -1\n        while (-1 !== (gs = parts.indexOf('**', gs + 1))) {\n          let gss: number = gs\n          while (parts[gss + 1] === '**') {\n            // <pre>/**/**/<rest> -> <pre>/**/<rest>\n            gss++\n          }\n          // eg, if gs is 2 and gss is 4, that means we have 3 **\n          // parts, and can remove 2 of them.\n          if (gss > gs) {\n            parts.splice(gs + 1, gss - gs)\n          }\n\n          let next = parts[gs + 1]\n          const p = parts[gs + 2]\n          const p2 = parts[gs + 3]\n          if (next !== '..') continue\n          if (\n            !p ||\n            p === '.' ||\n            p === '..' ||\n            !p2 ||\n            p2 === '.' ||\n            p2 === '..'\n          ) {\n            continue\n          }\n          didSomething = true\n          // edit parts in place, and push the new one\n          parts.splice(gs, 1)\n          const other = parts.slice(0)\n          other[gs] = '**'\n          globParts.push(other)\n          gs--\n        }\n\n        // <pre>/<e>/<rest> -> <pre>/<rest>\n        if (!this.preserveMultipleSlashes) {\n          for (let i = 1; i < parts.length - 1; i++) {\n            const p = parts[i]\n            // don't squeeze out UNC patterns\n            if (i === 1 && p === '' && parts[0] === '') continue\n            if (p === '.' || p === '') {\n              didSomething = true\n              parts.splice(i, 1)\n              i--\n            }\n          }\n          if (\n            parts[0] === '.' &&\n            parts.length === 2 &&\n            (parts[1] === '.' || parts[1] === '')\n          ) {\n            didSomething = true\n            parts.pop()\n          }\n        }\n\n        // <pre>/<p>/../<rest> -> <pre>/<rest>\n        let dd: number = 0\n        while (-1 !== (dd = parts.indexOf('..', dd + 1))) {\n          const p = parts[dd - 1]\n          if (p && p !== '.' && p !== '..' && p !== '**') {\n            didSomething = true\n            const needDot = dd === 1 && parts[dd + 1] === '**'\n            const splin = needDot ? ['.'] : []\n            parts.splice(dd - 1, 2, ...splin)\n            if (parts.length === 0) parts.push('')\n            dd -= 2\n          }\n        }\n      }\n    } while (didSomething)\n\n    return globParts\n  }\n\n  // second phase: multi-pattern dedupes\n  // {<pre>/*/<rest>,<pre>/<p>/<rest>} -> <pre>/*/<rest>\n  // {<pre>/<rest>,<pre>/<rest>} -> <pre>/<rest>\n  // {<pre>/**/<rest>,<pre>/<rest>} -> <pre>/**/<rest>\n  //\n  // {<pre>/**/<rest>,<pre>/**/<p>/<rest>} -> <pre>/**/<rest>\n  // ^-- not valid because ** doens't follow symlinks\n  secondPhasePreProcess(globParts: string[][]): string[][] {\n    for (let i = 0; i < globParts.length - 1; i++) {\n      for (let j = i + 1; j < globParts.length; j++) {\n        const matched = this.partsMatch(\n          globParts[i],\n          globParts[j],\n          !this.preserveMultipleSlashes\n        )\n        if (matched) {\n          globParts[i] = []\n          globParts[j] = matched\n          break\n        }\n      }\n    }\n    return globParts.filter(gs => gs.length)\n  }\n\n  partsMatch(\n    a: string[],\n    b: string[],\n    emptyGSMatch: boolean = false\n  ): false | string[] {\n    let ai = 0\n    let bi = 0\n    let result: string[] = []\n    let which: string = ''\n    while (ai < a.length && bi < b.length) {\n      if (a[ai] === b[bi]) {\n        result.push(which === 'b' ? b[bi] : a[ai])\n        ai++\n        bi++\n      } else if (emptyGSMatch && a[ai] === '**' && b[bi] === a[ai + 1]) {\n        result.push(a[ai])\n        ai++\n      } else if (emptyGSMatch && b[bi] === '**' && a[ai] === b[bi + 1]) {\n        result.push(b[bi])\n        bi++\n      } else if (\n        a[ai] === '*' &&\n        b[bi] &&\n        (this.options.dot || !b[bi].startsWith('.')) &&\n        b[bi] !== '**'\n      ) {\n        if (which === 'b') return false\n        which = 'a'\n        result.push(a[ai])\n        ai++\n        bi++\n      } else if (\n        b[bi] === '*' &&\n        a[ai] &&\n        (this.options.dot || !a[ai].startsWith('.')) &&\n        a[ai] !== '**'\n      ) {\n        if (which === 'a') return false\n        which = 'b'\n        result.push(b[bi])\n        ai++\n        bi++\n      } else {\n        return false\n      }\n    }\n    // if we fall out of the loop, it means they two are identical\n    // as long as their lengths match\n    return a.length === b.length && result\n  }\n\n  parseNegate() {\n    if (this.nonegate) return\n\n    const pattern = this.pattern\n    let negate = false\n    let negateOffset = 0\n\n    for (let i = 0; i < pattern.length && pattern.charAt(i) === '!'; i++) {\n      negate = !negate\n      negateOffset++\n    }\n\n    if (negateOffset) this.pattern = pattern.slice(negateOffset)\n    this.negate = negate\n  }\n\n  // set partial to true to test if, for example,\n  // \"/a/b\" matches the start of \"/*/b/*/d\"\n  // Partial means, if you run out of file before you run\n  // out of pattern, then that's fine, as long as all\n  // the parts match.\n  matchOne(file: string[], pattern: ParseReturn[], partial: boolean = false) {\n    const options = this.options\n\n    // UNC paths like //?/X:/... can match X:/... and vice versa\n    // Drive letters in absolute drive or unc paths are always compared\n    // case-insensitively.\n    if (this.isWindows) {\n      const fileDrive = typeof file[0] === 'string' && /^[a-z]:$/i.test(file[0])\n      const fileUNC =\n        !fileDrive &&\n        file[0] === '' &&\n        file[1] === '' &&\n        file[2] === '?' &&\n        /^[a-z]:$/i.test(file[3])\n\n      const patternDrive =\n        typeof pattern[0] === 'string' && /^[a-z]:$/i.test(pattern[0])\n      const patternUNC =\n        !patternDrive &&\n        pattern[0] === '' &&\n        pattern[1] === '' &&\n        pattern[2] === '?' &&\n        typeof pattern[3] === 'string' &&\n        /^[a-z]:$/i.test(pattern[3])\n\n      const fdi = fileUNC ? 3 : fileDrive ? 0 : undefined\n      const pdi = patternUNC ? 3 : patternDrive ? 0 : undefined\n      if (typeof fdi === 'number' && typeof pdi === 'number') {\n        const [fd, pd]: [string, string] = [file[fdi], pattern[pdi] as string]\n        if (fd.toLowerCase() === pd.toLowerCase()) {\n          pattern[pdi] = fd\n          if (pdi > fdi) {\n            pattern = pattern.slice(pdi)\n          } else if (fdi > pdi) {\n            file = file.slice(fdi)\n          }\n        }\n      }\n    }\n\n    // resolve and reduce . and .. portions in the file as well.\n    // dont' need to do the second phase, because it's only one string[]\n    const { optimizationLevel = 1 } = this.options\n    if (optimizationLevel >= 2) {\n      file = this.levelTwoFileOptimize(file)\n    }\n\n    this.debug('matchOne', this, { file, pattern })\n    this.debug('matchOne', file.length, pattern.length)\n\n    for (\n      var fi = 0, pi = 0, fl = file.length, pl = pattern.length;\n      fi < fl && pi < pl;\n      fi++, pi++\n    ) {\n      this.debug('matchOne loop')\n      var p = pattern[pi]\n      var f = file[fi]\n\n      this.debug(pattern, p, f)\n\n      // should be impossible.\n      // some invalid regexp stuff in the set.\n      /* c8 ignore start */\n      if (p === false) {\n        return false\n      }\n      /* c8 ignore stop */\n\n      if (p === GLOBSTAR) {\n        this.debug('GLOBSTAR', [pattern, p, f])\n\n        // \"**\"\n        // a/**/b/**/c would match the following:\n        // a/b/x/y/z/c\n        // a/x/y/z/b/c\n        // a/b/x/b/x/c\n        // a/b/c\n        // To do this, take the rest of the pattern after\n        // the **, and see if it would match the file remainder.\n        // If so, return success.\n        // If not, the ** \"swallows\" a segment, and try again.\n        // This is recursively awful.\n        //\n        // a/**/b/**/c matching a/b/x/y/z/c\n        // - a matches a\n        // - doublestar\n        //   - matchOne(b/x/y/z/c, b/**/c)\n        //     - b matches b\n        //     - doublestar\n        //       - matchOne(x/y/z/c, c) -> no\n        //       - matchOne(y/z/c, c) -> no\n        //       - matchOne(z/c, c) -> no\n        //       - matchOne(c, c) yes, hit\n        var fr = fi\n        var pr = pi + 1\n        if (pr === pl) {\n          this.debug('** at the end')\n          // a ** at the end will just swallow the rest.\n          // We have found a match.\n          // however, it will not swallow /.x, unless\n          // options.dot is set.\n          // . and .. are *never* matched by **, for explosively\n          // exponential reasons.\n          for (; fi < fl; fi++) {\n            if (\n              file[fi] === '.' ||\n              file[fi] === '..' ||\n              (!options.dot && file[fi].charAt(0) === '.')\n            )\n              return false\n          }\n          return true\n        }\n\n        // ok, let's see if we can swallow whatever we can.\n        while (fr < fl) {\n          var swallowee = file[fr]\n\n          this.debug('\\nglobstar while', file, fr, pattern, pr, swallowee)\n\n          // XXX remove this slice.  Just pass the start index.\n          if (this.matchOne(file.slice(fr), pattern.slice(pr), partial)) {\n            this.debug('globstar found match!', fr, fl, swallowee)\n            // found a match.\n            return true\n          } else {\n            // can't swallow \".\" or \"..\" ever.\n            // can only swallow \".foo\" when explicitly asked.\n            if (\n              swallowee === '.' ||\n              swallowee === '..' ||\n              (!options.dot && swallowee.charAt(0) === '.')\n            ) {\n              this.debug('dot detected!', file, fr, pattern, pr)\n              break\n            }\n\n            // ** swallows a segment, and continue.\n            this.debug('globstar swallow a segment, and continue')\n            fr++\n          }\n        }\n\n        // no match was found.\n        // However, in partial mode, we can't say this is necessarily over.\n        /* c8 ignore start */\n        if (partial) {\n          // ran out of file\n          this.debug('\\n>>> no match, partial?', file, fr, pattern, pr)\n          if (fr === fl) {\n            return true\n          }\n        }\n        /* c8 ignore stop */\n        return false\n      }\n\n      // something other than **\n      // non-magic patterns just have to match exactly\n      // patterns with magic have been turned into regexps.\n      let hit: boolean\n      if (typeof p === 'string') {\n        hit = f === p\n        this.debug('string match', p, f, hit)\n      } else {\n        hit = p.test(f)\n        this.debug('pattern match', p, f, hit)\n      }\n\n      if (!hit) return false\n    }\n\n    // Note: ending in / means that we'll get a final \"\"\n    // at the end of the pattern.  This can only match a\n    // corresponding \"\" at the end of the file.\n    // If the file ends in /, then it can only match a\n    // a pattern that ends in /, unless the pattern just\n    // doesn't have any more for it. But, a/b/ should *not*\n    // match \"a/b/*\", even though \"\" matches against the\n    // [^/]*? pattern, except in partial mode, where it might\n    // simply not be reached yet.\n    // However, a/b/ should still satisfy a/*\n\n    // now either we fell off the end of the pattern, or we're done.\n    if (fi === fl && pi === pl) {\n      // ran out of pattern and filename at the same time.\n      // an exact hit!\n      return true\n    } else if (fi === fl) {\n      // ran out of file, but still had pattern left.\n      // this is ok if we're doing the match as part of\n      // a glob fs traversal.\n      return partial\n    } else if (pi === pl) {\n      // ran out of pattern, still have file left.\n      // this is only acceptable if we're on the very last\n      // empty segment of a file with a trailing slash.\n      // a/* should match a/b/\n      return fi === fl - 1 && file[fi] === ''\n\n      /* c8 ignore start */\n    } else {\n      // should be unreachable.\n      throw new Error('wtf?')\n    }\n    /* c8 ignore stop */\n  }\n\n  braceExpand() {\n    return braceExpand(this.pattern, this.options)\n  }\n\n  parse(pattern: string): ParseReturn {\n    assertValidPattern(pattern)\n\n    const options = this.options\n\n    // shortcuts\n    if (pattern === '**') return GLOBSTAR\n    if (pattern === '') return ''\n\n    // far and away, the most common glob pattern parts are\n    // *, *.*, and *.<ext>  Add a fast check method for those.\n    let m: RegExpMatchArray | null\n    let fastTest: null | ((f: string) => boolean) = null\n    if ((m = pattern.match(starRE))) {\n      fastTest = options.dot ? starTestDot : starTest\n    } else if ((m = pattern.match(starDotExtRE))) {\n      fastTest = (\n        options.nocase\n          ? options.dot\n            ? starDotExtTestNocaseDot\n            : starDotExtTestNocase\n          : options.dot\n          ? starDotExtTestDot\n          : starDotExtTest\n      )(m[1])\n    } else if ((m = pattern.match(qmarksRE))) {\n      fastTest = (\n        options.nocase\n          ? options.dot\n            ? qmarksTestNocaseDot\n            : qmarksTestNocase\n          : options.dot\n          ? qmarksTestDot\n          : qmarksTest\n      )(m)\n    } else if ((m = pattern.match(starDotStarRE))) {\n      fastTest = options.dot ? starDotStarTestDot : starDotStarTest\n    } else if ((m = pattern.match(dotStarRE))) {\n      fastTest = dotStarTest\n    }\n\n    const re = AST.fromGlob(pattern, this.options).toMMPattern()\n    if (fastTest && typeof re === 'object') {\n      // Avoids overriding in frozen environments\n      Reflect.defineProperty(re, 'test', { value: fastTest })\n    }\n    return re\n  }\n\n  makeRe() {\n    if (this.regexp || this.regexp === false) return this.regexp\n\n    // at this point, this.set is a 2d array of partial\n    // pattern strings, or \"**\".\n    //\n    // It's better to use .match().  This function shouldn't\n    // be used, really, but it's pretty convenient sometimes,\n    // when you just want to work with a regex.\n    const set = this.set\n\n    if (!set.length) {\n      this.regexp = false\n      return this.regexp\n    }\n    const options = this.options\n\n    const twoStar = options.noglobstar\n      ? star\n      : options.dot\n      ? twoStarDot\n      : twoStarNoDot\n    const flags = new Set(options.nocase ? ['i'] : [])\n\n    // regexpify non-globstar patterns\n    // if ** is only item, then we just do one twoStar\n    // if ** is first, and there are more, prepend (\\/|twoStar\\/)? to next\n    // if ** is last, append (\\/twoStar|) to previous\n    // if ** is in the middle, append (\\/|\\/twoStar\\/) to previous\n    // then filter out GLOBSTAR symbols\n    let re = set\n      .map(pattern => {\n        const pp: (string | typeof GLOBSTAR)[] = pattern.map(p => {\n          if (p instanceof RegExp) {\n            for (const f of p.flags.split('')) flags.add(f)\n          }\n          return typeof p === 'string'\n            ? regExpEscape(p)\n            : p === GLOBSTAR\n            ? GLOBSTAR\n            : p._src\n        }) as (string | typeof GLOBSTAR)[]\n        pp.forEach((p, i) => {\n          const next = pp[i + 1]\n          const prev = pp[i - 1]\n          if (p !== GLOBSTAR || prev === GLOBSTAR) {\n            return\n          }\n          if (prev === undefined) {\n            if (next !== undefined && next !== GLOBSTAR) {\n              pp[i + 1] = '(?:\\\\/|' + twoStar + '\\\\/)?' + next\n            } else {\n              pp[i] = twoStar\n            }\n          } else if (next === undefined) {\n            pp[i - 1] = prev + '(?:\\\\/|' + twoStar + ')?'\n          } else if (next !== GLOBSTAR) {\n            pp[i - 1] = prev + '(?:\\\\/|\\\\/' + twoStar + '\\\\/)' + next\n            pp[i + 1] = GLOBSTAR\n          }\n        })\n        return pp.filter(p => p !== GLOBSTAR).join('/')\n      })\n      .join('|')\n\n    // need to wrap in parens if we had more than one thing with |,\n    // otherwise only the first will be anchored to ^ and the last to $\n    const [open, close] = set.length > 1 ? ['(?:', ')'] : ['', '']\n    // must match entire pattern\n    // ending in a * or ** will make it less strict.\n    re = '^' + open + re + close + '$'\n\n    // can match anything, as long as it's not this.\n    if (this.negate) re = '^(?!' + re + ').+$'\n\n    try {\n      this.regexp = new RegExp(re, [...flags].join(''))\n      /* c8 ignore start */\n    } catch (ex) {\n      // should be impossible\n      this.regexp = false\n    }\n    /* c8 ignore stop */\n    return this.regexp\n  }\n\n  slashSplit(p: string) {\n    // if p starts with // on windows, we preserve that\n    // so that UNC paths aren't broken.  Otherwise, any number of\n    // / characters are coalesced into one, unless\n    // preserveMultipleSlashes is set to true.\n    if (this.preserveMultipleSlashes) {\n      return p.split('/')\n    } else if (this.isWindows && /^\\/\\/[^\\/]+/.test(p)) {\n      // add an extra '' for the one we lose\n      return ['', ...p.split(/\\/+/)]\n    } else {\n      return p.split(/\\/+/)\n    }\n  }\n\n  match(f: string, partial = this.partial) {\n    this.debug('match', f, this.pattern)\n    // short-circuit in the case of busted things.\n    // comments, etc.\n    if (this.comment) {\n      return false\n    }\n    if (this.empty) {\n      return f === ''\n    }\n\n    if (f === '/' && partial) {\n      return true\n    }\n\n    const options = this.options\n\n    // windows: need to use /, not \\\n    if (this.isWindows) {\n      f = f.split('\\\\').join('/')\n    }\n\n    // treat the test path as a set of pathparts.\n    const ff = this.slashSplit(f)\n    this.debug(this.pattern, 'split', ff)\n\n    // just ONE of the pattern sets in this.set needs to match\n    // in order for it to be valid.  If negating, then just one\n    // match means that we have failed.\n    // Either way, return on the first hit.\n\n    const set = this.set\n    this.debug(this.pattern, 'set', set)\n\n    // Find the basename of the path by looking for the last non-empty segment\n    let filename: string = ff[ff.length - 1]\n    if (!filename) {\n      for (let i = ff.length - 2; !filename && i >= 0; i--) {\n        filename = ff[i]\n      }\n    }\n\n    for (let i = 0; i < set.length; i++) {\n      const pattern = set[i]\n      let file = ff\n      if (options.matchBase && pattern.length === 1) {\n        file = [filename]\n      }\n      const hit = this.matchOne(file, pattern, partial)\n      if (hit) {\n        if (options.flipNegate) {\n          return true\n        }\n        return !this.negate\n      }\n    }\n\n    // didn't get any hits.  this is success if it's a negative\n    // pattern, failure otherwise.\n    if (options.flipNegate) {\n      return false\n    }\n    return this.negate\n  }\n\n  static defaults(def: MinimatchOptions) {\n    return minimatch.defaults(def).Minimatch\n  }\n}\n/* c8 ignore start */\nexport { AST } from './ast.js'\nexport { escape } from './escape.js'\nexport { unescape } from './unescape.js'\n/* c8 ignore stop */\nminimatch.AST = AST\nminimatch.Minimatch = Minimatch\nminimatch.escape = escape\nminimatch.unescape = unescape\n", "const MAX_PATTERN_LENGTH = 1024 * 64\nexport const assertValidPattern: (pattern: any) => void = (\n  pattern: any\n): asserts pattern is string => {\n  if (typeof pattern !== 'string') {\n    throw new TypeError('invalid pattern')\n  }\n\n  if (pattern.length > MAX_PATTERN_LENGTH) {\n    throw new TypeError('pattern is too long')\n  }\n}\n", "// translate the various posix character classes into unicode properties\n// this works across all unicode locales\n\n// { <posix class>: [<translation>, /u flag required, negated]\nconst posixClasses: { [k: string]: [e: string, u: boolean, n?: boolean] } = {\n  '[:alnum:]': ['\\\\p{L}\\\\p{Nl}\\\\p{Nd}', true],\n  '[:alpha:]': ['\\\\p{L}\\\\p{Nl}', true],\n  '[:ascii:]': ['\\\\x' + '00-\\\\x' + '7f', false],\n  '[:blank:]': ['\\\\p{Zs}\\\\t', true],\n  '[:cntrl:]': ['\\\\p{Cc}', true],\n  '[:digit:]': ['\\\\p{Nd}', true],\n  '[:graph:]': ['\\\\p{Z}\\\\p{C}', true, true],\n  '[:lower:]': ['\\\\p{Ll}', true],\n  '[:print:]': ['\\\\p{C}', true],\n  '[:punct:]': ['\\\\p{P}', true],\n  '[:space:]': ['\\\\p{Z}\\\\t\\\\r\\\\n\\\\v\\\\f', true],\n  '[:upper:]': ['\\\\p{Lu}', true],\n  '[:word:]': ['\\\\p{L}\\\\p{Nl}\\\\p{Nd}\\\\p{Pc}', true],\n  '[:xdigit:]': ['A-Fa-f0-9', false],\n}\n\n// only need to escape a few things inside of brace expressions\n// escapes: [ \\ ] -\nconst braceEscape = (s: string) => s.replace(/[[\\]\\\\-]/g, '\\\\$&')\n// escape all regexp magic characters\nconst regexpEscape = (s: string) =>\n  s.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, '\\\\$&')\n\n// everything has already been escaped, we just have to join\nconst rangesToString = (ranges: string[]): string => ranges.join('')\n\nexport type ParseClassResult = [\n  src: string,\n  uFlag: boolean,\n  consumed: number,\n  hasMagic: boolean\n]\n\n// takes a glob string at a posix brace expression, and returns\n// an equivalent regular expression source, and boolean indicating\n// whether the /u flag needs to be applied, and the number of chars\n// consumed to parse the character class.\n// This also removes out of order ranges, and returns ($.) if the\n// entire class just no good.\nexport const parseClass = (\n  glob: string,\n  position: number\n): ParseClassResult => {\n  const pos = position\n  /* c8 ignore start */\n  if (glob.charAt(pos) !== '[') {\n    throw new Error('not in a brace expression')\n  }\n  /* c8 ignore stop */\n  const ranges: string[] = []\n  const negs: string[] = []\n\n  let i = pos + 1\n  let sawStart = false\n  let uflag = false\n  let escaping = false\n  let negate = false\n  let endPos = pos\n  let rangeStart = ''\n  WHILE: while (i < glob.length) {\n    const c = glob.charAt(i)\n    if ((c === '!' || c === '^') && i === pos + 1) {\n      negate = true\n      i++\n      continue\n    }\n\n    if (c === ']' && sawStart && !escaping) {\n      endPos = i + 1\n      break\n    }\n\n    sawStart = true\n    if (c === '\\\\') {\n      if (!escaping) {\n        escaping = true\n        i++\n        continue\n      }\n      // escaped \\ char, fall through and treat like normal char\n    }\n    if (c === '[' && !escaping) {\n      // either a posix class, a collation equivalent, or just a [\n      for (const [cls, [unip, u, neg]] of Object.entries(posixClasses)) {\n        if (glob.startsWith(cls, i)) {\n          // invalid, [a-[] is fine, but not [a-[:alpha]]\n          if (rangeStart) {\n            return ['$.', false, glob.length - pos, true]\n          }\n          i += cls.length\n          if (neg) negs.push(unip)\n          else ranges.push(unip)\n          uflag = uflag || u\n          continue WHILE\n        }\n      }\n    }\n\n    // now it's just a normal character, effectively\n    escaping = false\n    if (rangeStart) {\n      // throw this range away if it's not valid, but others\n      // can still match.\n      if (c > rangeStart) {\n        ranges.push(braceEscape(rangeStart) + '-' + braceEscape(c))\n      } else if (c === rangeStart) {\n        ranges.push(braceEscape(c))\n      }\n      rangeStart = ''\n      i++\n      continue\n    }\n\n    // now might be the start of a range.\n    // can be either c-d or c-] or c<more...>] or c] at this point\n    if (glob.startsWith('-]', i + 1)) {\n      ranges.push(braceEscape(c + '-'))\n      i += 2\n      continue\n    }\n    if (glob.startsWith('-', i + 1)) {\n      rangeStart = c\n      i += 2\n      continue\n    }\n\n    // not the start of a range, just a single character\n    ranges.push(braceEscape(c))\n    i++\n  }\n\n  if (endPos < i) {\n    // didn't see the end of the class, not a valid class,\n    // but might still be valid as a literal match.\n    return ['', false, 0, false]\n  }\n\n  // if we got no ranges and no negates, then we have a range that\n  // cannot possibly match anything, and that poisons the whole glob\n  if (!ranges.length && !negs.length) {\n    return ['$.', false, glob.length - pos, true]\n  }\n\n  // if we got one positive range, and it's a single character, then that's\n  // not actually a magic pattern, it's just that one literal character.\n  // we should not treat that as \"magic\", we should just return the literal\n  // character. [_] is a perfectly valid way to escape glob magic chars.\n  if (\n    negs.length === 0 &&\n    ranges.length === 1 &&\n    /^\\\\?.$/.test(ranges[0]) &&\n    !negate\n  ) {\n    const r = ranges[0].length === 2 ? ranges[0].slice(-1) : ranges[0]\n    return [regexpEscape(r), false, endPos - pos, false]\n  }\n\n  const sranges = '[' + (negate ? '^' : '') + rangesToString(ranges) + ']'\n  const snegs = '[' + (negate ? '' : '^') + rangesToString(negs) + ']'\n  const comb =\n    ranges.length && negs.length\n      ? '(' + sranges + '|' + snegs + ')'\n      : ranges.length\n      ? sranges\n      : snegs\n\n  return [comb, uflag, endPos - pos, true]\n}\n", "import { MinimatchOptions } from './index.js'\n/**\n * Un-escape a string that has been escaped with {@link escape}.\n *\n * If the {@link windowsPathsNoEscape} option is used, then square-brace\n * escapes are removed, but not backslash escapes.  For example, it will turn\n * the string `'[*]'` into `*`, but it will not turn `'\\\\*'` into `'*'`,\n * becuase `\\` is a path separator in `windowsPathsNoEscape` mode.\n *\n * When `windowsPathsNoEscape` is not set, then both brace escapes and\n * backslash escapes are removed.\n *\n * Slashes (and backslashes in `windowsPathsNoEscape` mode) cannot be escaped\n * or unescaped.\n */\nexport const unescape = (\n  s: string,\n  {\n    windowsPathsNoEscape = false,\n  }: Pick<MinimatchOptions, 'windowsPathsNoEscape'> = {}\n) => {\n  return windowsPathsNoEscape\n    ? s.replace(/\\[([^\\/\\\\])\\]/g, '$1')\n    : s.replace(/((?!\\\\).|^)\\[([^\\/\\\\])\\]/g, '$1$2').replace(/\\\\([^\\/])/g, '$1')\n}\n", "// parse a single path portion\n\nimport { parseClass } from './brace-expressions.js'\nimport { MinimatchOptions, MMRegExp } from './index.js'\nimport { unescape } from './unescape.js'\n\n// classes [] are handled by the parseClass method\n// for positive extglobs, we sub-parse the contents, and combine,\n// with the appropriate regexp close.\n// for negative extglobs, we sub-parse the contents, but then\n// have to include the rest of the pattern, then the parent, etc.,\n// as the thing that cannot be because RegExp negative lookaheads\n// are different from globs.\n//\n// So for example:\n// a@(i|w!(x|y)z|j)b => ^a(i|w((!?(x|y)zb).*)z|j)b$\n//   1   2 3   4 5 6      1   2    3   46      5 6\n//\n// Assembling the extglob requires not just the negated patterns themselves,\n// but also anything following the negative patterns up to the boundary\n// of the current pattern, plus anything following in the parent pattern.\n//\n//\n// So, first, we parse the string into an AST of extglobs, without turning\n// anything into regexps yet.\n//\n// ['a', {@ [['i'], ['w', {!['x', 'y']}, 'z'], ['j']]}, 'b']\n//\n// Then, for all the negative extglobs, we append whatever comes after in\n// each parent as their tail\n//\n// ['a', {@ [['i'], ['w', {!['x', 'y'], 'z', 'b'}, 'z'], ['j']]}, 'b']\n//\n// Lastly, we turn each of these pieces into a regexp, and join\n//\n//                                 v----- .* because there's more following,\n//                                 v    v  otherwise, .+ because it must be\n//                                 v    v  *something* there.\n// ['^a', {@ ['i', 'w(?:(!?(?:x|y).*zb$).*)z', 'j' ]}, 'b$']\n//   copy what follows into here--^^^^^\n// ['^a', '(?:i|w(?:(?!(?:x|y).*zb$).*)z|j)', 'b$']\n// ['^a(?:i|w(?:(?!(?:x|y).*zb$).*)z|j)b$']\n\nexport type ExtglobType = '!' | '?' | '+' | '*' | '@'\nconst types = new Set<ExtglobType>(['!', '?', '+', '*', '@'])\nconst isExtglobType = (c: string): c is ExtglobType =>\n  types.has(c as ExtglobType)\n\n// Patterns that get prepended to bind to the start of either the\n// entire string, or just a single path portion, to prevent dots\n// and/or traversal patterns, when needed.\n// Exts don't need the ^ or / bit, because the root binds that already.\nconst startNoTraversal = '(?!(?:^|/)\\\\.\\\\.?(?:$|/))'\nconst startNoDot = '(?!\\\\.)'\n\n// characters that indicate a start of pattern needs the \"no dots\" bit,\n// because a dot *might* be matched. ( is not in the list, because in\n// the case of a child extglob, it will handle the prevention itself.\nconst addPatternStart = new Set(['[', '.'])\n// cases where traversal is A-OK, no dot prevention needed\nconst justDots = new Set(['..', '.'])\nconst reSpecials = new Set('().*{}+?[]^$\\\\!')\nconst regExpEscape = (s: string) =>\n  s.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, '\\\\$&')\n\n// any single thing other than /\nconst qmark = '[^/]'\n\n// * => any number of characters\nconst star = qmark + '*?'\n// use + when we need to ensure that *something* matches, because the * is\n// the only thing in the path portion.\nconst starNoEmpty = qmark + '+?'\n\n// remove the \\ chars that we added if we end up doing a nonmagic compare\n// const deslash = (s: string) => s.replace(/\\\\(.)/g, '$1')\n\nexport class AST {\n  type: ExtglobType | null\n  readonly #root: AST\n\n  #hasMagic?: boolean\n  #uflag: boolean = false\n  #parts: (string | AST)[] = []\n  readonly #parent?: AST\n  readonly #parentIndex: number\n  #negs: AST[]\n  #filledNegs: boolean = false\n  #options: MinimatchOptions\n  #toString?: string\n  // set to true if it's an extglob with no children\n  // (which really means one child of '')\n  #emptyExt: boolean = false\n\n  constructor(\n    type: ExtglobType | null,\n    parent?: AST,\n    options: MinimatchOptions = {}\n  ) {\n    this.type = type\n    // extglobs are inherently magical\n    if (type) this.#hasMagic = true\n    this.#parent = parent\n    this.#root = this.#parent ? this.#parent.#root : this\n    this.#options = this.#root === this ? options : this.#root.#options\n    this.#negs = this.#root === this ? [] : this.#root.#negs\n    if (type === '!' && !this.#root.#filledNegs) this.#negs.push(this)\n    this.#parentIndex = this.#parent ? this.#parent.#parts.length : 0\n  }\n\n  get hasMagic(): boolean | undefined {\n    /* c8 ignore start */\n    if (this.#hasMagic !== undefined) return this.#hasMagic\n    /* c8 ignore stop */\n    for (const p of this.#parts) {\n      if (typeof p === 'string') continue\n      if (p.type || p.hasMagic) return (this.#hasMagic = true)\n    }\n    // note: will be undefined until we generate the regexp src and find out\n    return this.#hasMagic\n  }\n\n  // reconstructs the pattern\n  toString(): string {\n    if (this.#toString !== undefined) return this.#toString\n    if (!this.type) {\n      return (this.#toString = this.#parts.map(p => String(p)).join(''))\n    } else {\n      return (this.#toString =\n        this.type + '(' + this.#parts.map(p => String(p)).join('|') + ')')\n    }\n  }\n\n  #fillNegs() {\n    /* c8 ignore start */\n    if (this !== this.#root) throw new Error('should only call on root')\n    if (this.#filledNegs) return this\n    /* c8 ignore stop */\n\n    // call toString() once to fill this out\n    this.toString()\n    this.#filledNegs = true\n    let n: AST | undefined\n    while ((n = this.#negs.pop())) {\n      if (n.type !== '!') continue\n      // walk up the tree, appending everthing that comes AFTER parentIndex\n      let p: AST | undefined = n\n      let pp = p.#parent\n      while (pp) {\n        for (\n          let i = p.#parentIndex + 1;\n          !pp.type && i < pp.#parts.length;\n          i++\n        ) {\n          for (const part of n.#parts) {\n            /* c8 ignore start */\n            if (typeof part === 'string') {\n              throw new Error('string part in extglob AST??')\n            }\n            /* c8 ignore stop */\n            part.copyIn(pp.#parts[i])\n          }\n        }\n        p = pp\n        pp = p.#parent\n      }\n    }\n    return this\n  }\n\n  push(...parts: (string | AST)[]) {\n    for (const p of parts) {\n      if (p === '') continue\n      /* c8 ignore start */\n      if (typeof p !== 'string' && !(p instanceof AST && p.#parent === this)) {\n        throw new Error('invalid part: ' + p)\n      }\n      /* c8 ignore stop */\n      this.#parts.push(p)\n    }\n  }\n\n  toJSON() {\n    const ret: any[] =\n      this.type === null\n        ? this.#parts.slice().map(p => (typeof p === 'string' ? p : p.toJSON()))\n        : [this.type, ...this.#parts.map(p => (p as AST).toJSON())]\n    if (this.isStart() && !this.type) ret.unshift([])\n    if (\n      this.isEnd() &&\n      (this === this.#root ||\n        (this.#root.#filledNegs && this.#parent?.type === '!'))\n    ) {\n      ret.push({})\n    }\n    return ret\n  }\n\n  isStart(): boolean {\n    if (this.#root === this) return true\n    // if (this.type) return !!this.#parent?.isStart()\n    if (!this.#parent?.isStart()) return false\n    if (this.#parentIndex === 0) return true\n    // if everything AHEAD of this is a negation, then it's still the \"start\"\n    const p = this.#parent\n    for (let i = 0; i < this.#parentIndex; i++) {\n      const pp = p.#parts[i]\n      if (!(pp instanceof AST && pp.type === '!')) {\n        return false\n      }\n    }\n    return true\n  }\n\n  isEnd(): boolean {\n    if (this.#root === this) return true\n    if (this.#parent?.type === '!') return true\n    if (!this.#parent?.isEnd()) return false\n    if (!this.type) return this.#parent?.isEnd()\n    // if not root, it'll always have a parent\n    /* c8 ignore start */\n    const pl = this.#parent ? this.#parent.#parts.length : 0\n    /* c8 ignore stop */\n    return this.#parentIndex === pl - 1\n  }\n\n  copyIn(part: AST | string) {\n    if (typeof part === 'string') this.push(part)\n    else this.push(part.clone(this))\n  }\n\n  clone(parent: AST) {\n    const c = new AST(this.type, parent)\n    for (const p of this.#parts) {\n      c.copyIn(p)\n    }\n    return c\n  }\n\n  static #parseAST(\n    str: string,\n    ast: AST,\n    pos: number,\n    opt: MinimatchOptions\n  ): number {\n    let escaping = false\n    let inBrace = false\n    let braceStart = -1\n    let braceNeg = false\n    if (ast.type === null) {\n      // outside of a extglob, append until we find a start\n      let i = pos\n      let acc = ''\n      while (i < str.length) {\n        const c = str.charAt(i++)\n        // still accumulate escapes at this point, but we do ignore\n        // starts that are escaped\n        if (escaping || c === '\\\\') {\n          escaping = !escaping\n          acc += c\n          continue\n        }\n\n        if (inBrace) {\n          if (i === braceStart + 1) {\n            if (c === '^' || c === '!') {\n              braceNeg = true\n            }\n          } else if (c === ']' && !(i === braceStart + 2 && braceNeg)) {\n            inBrace = false\n          }\n          acc += c\n          continue\n        } else if (c === '[') {\n          inBrace = true\n          braceStart = i\n          braceNeg = false\n          acc += c\n          continue\n        }\n\n        if (!opt.noext && isExtglobType(c) && str.charAt(i) === '(') {\n          ast.push(acc)\n          acc = ''\n          const ext = new AST(c, ast)\n          i = AST.#parseAST(str, ext, i, opt)\n          ast.push(ext)\n          continue\n        }\n        acc += c\n      }\n      ast.push(acc)\n      return i\n    }\n\n    // some kind of extglob, pos is at the (\n    // find the next | or )\n    let i = pos + 1\n    let part = new AST(null, ast)\n    const parts: AST[] = []\n    let acc = ''\n    while (i < str.length) {\n      const c = str.charAt(i++)\n      // still accumulate escapes at this point, but we do ignore\n      // starts that are escaped\n      if (escaping || c === '\\\\') {\n        escaping = !escaping\n        acc += c\n        continue\n      }\n\n      if (inBrace) {\n        if (i === braceStart + 1) {\n          if (c === '^' || c === '!') {\n            braceNeg = true\n          }\n        } else if (c === ']' && !(i === braceStart + 2 && braceNeg)) {\n          inBrace = false\n        }\n        acc += c\n        continue\n      } else if (c === '[') {\n        inBrace = true\n        braceStart = i\n        braceNeg = false\n        acc += c\n        continue\n      }\n\n      if (isExtglobType(c) && str.charAt(i) === '(') {\n        part.push(acc)\n        acc = ''\n        const ext = new AST(c, part)\n        part.push(ext)\n        i = AST.#parseAST(str, ext, i, opt)\n        continue\n      }\n      if (c === '|') {\n        part.push(acc)\n        acc = ''\n        parts.push(part)\n        part = new AST(null, ast)\n        continue\n      }\n      if (c === ')') {\n        if (acc === '' && ast.#parts.length === 0) {\n          ast.#emptyExt = true\n        }\n        part.push(acc)\n        acc = ''\n        ast.push(...parts, part)\n        return i\n      }\n      acc += c\n    }\n\n    // unfinished extglob\n    // if we got here, it was a malformed extglob! not an extglob, but\n    // maybe something else in there.\n    ast.type = null\n    ast.#hasMagic = undefined\n    ast.#parts = [str.substring(pos - 1)]\n    return i\n  }\n\n  static fromGlob(pattern: string, options: MinimatchOptions = {}) {\n    const ast = new AST(null, undefined, options)\n    AST.#parseAST(pattern, ast, 0, options)\n    return ast\n  }\n\n  // returns the regular expression if there's magic, or the unescaped\n  // string if not.\n  toMMPattern(): MMRegExp | string {\n    // should only be called on root\n    /* c8 ignore start */\n    if (this !== this.#root) return this.#root.toMMPattern()\n    /* c8 ignore stop */\n    const glob = this.toString()\n    const [re, body, hasMagic, uflag] = this.toRegExpSource()\n    // if we're in nocase mode, and not nocaseMagicOnly, then we do\n    // still need a regular expression if we have to case-insensitively\n    // match capital/lowercase characters.\n    const anyMagic =\n      hasMagic ||\n      this.#hasMagic ||\n      (this.#options.nocase &&\n        !this.#options.nocaseMagicOnly &&\n        glob.toUpperCase() !== glob.toLowerCase())\n    if (!anyMagic) {\n      return body\n    }\n\n    const flags = (this.#options.nocase ? 'i' : '') + (uflag ? 'u' : '')\n    return Object.assign(new RegExp(`^${re}$`, flags), {\n      _src: re,\n      _glob: glob,\n    })\n  }\n\n  get options() {\n    return this.#options\n  }\n\n  // returns the string match, the regexp source, whether there's magic\n  // in the regexp (so a regular expression is required) and whether or\n  // not the uflag is needed for the regular expression (for posix classes)\n  // TODO: instead of injecting the start/end at this point, just return\n  // the BODY of the regexp, along with the start/end portions suitable\n  // for binding the start/end in either a joined full-path makeRe context\n  // (where we bind to (^|/), or a standalone matchPart context (where\n  // we bind to ^, and not /).  Otherwise slashes get duped!\n  //\n  // In part-matching mode, the start is:\n  // - if not isStart: nothing\n  // - if traversal possible, but not allowed: ^(?!\\.\\.?$)\n  // - if dots allowed or not possible: ^\n  // - if dots possible and not allowed: ^(?!\\.)\n  // end is:\n  // - if not isEnd(): nothing\n  // - else: $\n  //\n  // In full-path matching mode, we put the slash at the START of the\n  // pattern, so start is:\n  // - if first pattern: same as part-matching mode\n  // - if not isStart(): nothing\n  // - if traversal possible, but not allowed: /(?!\\.\\.?(?:$|/))\n  // - if dots allowed or not possible: /\n  // - if dots possible and not allowed: /(?!\\.)\n  // end is:\n  // - if last pattern, same as part-matching mode\n  // - else nothing\n  //\n  // Always put the (?:$|/) on negated tails, though, because that has to be\n  // there to bind the end of the negated pattern portion, and it's easier to\n  // just stick it in now rather than try to inject it later in the middle of\n  // the pattern.\n  //\n  // We can just always return the same end, and leave it up to the caller\n  // to know whether it's going to be used joined or in parts.\n  // And, if the start is adjusted slightly, can do the same there:\n  // - if not isStart: nothing\n  // - if traversal possible, but not allowed: (?:/|^)(?!\\.\\.?$)\n  // - if dots allowed or not possible: (?:/|^)\n  // - if dots possible and not allowed: (?:/|^)(?!\\.)\n  //\n  // But it's better to have a simpler binding without a conditional, for\n  // performance, so probably better to return both start options.\n  //\n  // Then the caller just ignores the end if it's not the first pattern,\n  // and the start always gets applied.\n  //\n  // But that's always going to be $ if it's the ending pattern, or nothing,\n  // so the caller can just attach $ at the end of the pattern when building.\n  //\n  // So the todo is:\n  // - better detect what kind of start is needed\n  // - return both flavors of starting pattern\n  // - attach $ at the end of the pattern when creating the actual RegExp\n  //\n  // Ah, but wait, no, that all only applies to the root when the first pattern\n  // is not an extglob. If the first pattern IS an extglob, then we need all\n  // that dot prevention biz to live in the extglob portions, because eg\n  // +(*|.x*) can match .xy but not .yx.\n  //\n  // So, return the two flavors if it's #root and the first child is not an\n  // AST, otherwise leave it to the child AST to handle it, and there,\n  // use the (?:^|/) style of start binding.\n  //\n  // Even simplified further:\n  // - Since the start for a join is eg /(?!\\.) and the start for a part\n  // is ^(?!\\.), we can just prepend (?!\\.) to the pattern (either root\n  // or start or whatever) and prepend ^ or / at the Regexp construction.\n  toRegExpSource(\n    allowDot?: boolean\n  ): [re: string, body: string, hasMagic: boolean, uflag: boolean] {\n    const dot = allowDot ?? !!this.#options.dot\n    if (this.#root === this) this.#fillNegs()\n    if (!this.type) {\n      const noEmpty = this.isStart() && this.isEnd()\n      const src = this.#parts\n        .map(p => {\n          const [re, _, hasMagic, uflag] =\n            typeof p === 'string'\n              ? AST.#parseGlob(p, this.#hasMagic, noEmpty)\n              : p.toRegExpSource(allowDot)\n          this.#hasMagic = this.#hasMagic || hasMagic\n          this.#uflag = this.#uflag || uflag\n          return re\n        })\n        .join('')\n\n      let start = ''\n      if (this.isStart()) {\n        if (typeof this.#parts[0] === 'string') {\n          // this is the string that will match the start of the pattern,\n          // so we need to protect against dots and such.\n\n          // '.' and '..' cannot match unless the pattern is that exactly,\n          // even if it starts with . or dot:true is set.\n          const dotTravAllowed =\n            this.#parts.length === 1 && justDots.has(this.#parts[0])\n          if (!dotTravAllowed) {\n            const aps = addPatternStart\n            // check if we have a possibility of matching . or ..,\n            // and prevent that.\n            const needNoTrav =\n              // dots are allowed, and the pattern starts with [ or .\n              (dot && aps.has(src.charAt(0))) ||\n              // the pattern starts with \\., and then [ or .\n              (src.startsWith('\\\\.') && aps.has(src.charAt(2))) ||\n              // the pattern starts with \\.\\., and then [ or .\n              (src.startsWith('\\\\.\\\\.') && aps.has(src.charAt(4)))\n            // no need to prevent dots if it can't match a dot, or if a\n            // sub-pattern will be preventing it anyway.\n            const needNoDot = !dot && !allowDot && aps.has(src.charAt(0))\n\n            start = needNoTrav ? startNoTraversal : needNoDot ? startNoDot : ''\n          }\n        }\n      }\n\n      // append the \"end of path portion\" pattern to negation tails\n      let end = ''\n      if (\n        this.isEnd() &&\n        this.#root.#filledNegs &&\n        this.#parent?.type === '!'\n      ) {\n        end = '(?:$|\\\\/)'\n      }\n      const final = start + src + end\n      return [\n        final,\n        unescape(src),\n        (this.#hasMagic = !!this.#hasMagic),\n        this.#uflag,\n      ]\n    }\n\n    // We need to calculate the body *twice* if it's a repeat pattern\n    // at the start, once in nodot mode, then again in dot mode, so a\n    // pattern like *(?) can match 'x.y'\n\n    const repeated = this.type === '*' || this.type === '+'\n    // some kind of extglob\n    const start = this.type === '!' ? '(?:(?!(?:' : '(?:'\n    let body = this.#partsToRegExp(dot)\n\n    if (this.isStart() && this.isEnd() && !body && this.type !== '!') {\n      // invalid extglob, has to at least be *something* present, if it's\n      // the entire path portion.\n      const s = this.toString()\n      this.#parts = [s]\n      this.type = null\n      this.#hasMagic = undefined\n      return [s, unescape(this.toString()), false, false]\n    }\n\n    // XXX abstract out this map method\n    let bodyDotAllowed =\n      !repeated || allowDot || dot || !startNoDot\n        ? ''\n        : this.#partsToRegExp(true)\n    if (bodyDotAllowed === body) {\n      bodyDotAllowed = ''\n    }\n    if (bodyDotAllowed) {\n      body = `(?:${body})(?:${bodyDotAllowed})*?`\n    }\n\n    // an empty !() is exactly equivalent to a starNoEmpty\n    let final = ''\n    if (this.type === '!' && this.#emptyExt) {\n      final = (this.isStart() && !dot ? startNoDot : '') + starNoEmpty\n    } else {\n      const close =\n        this.type === '!'\n          ? // !() must match something,but !(x) can match ''\n            '))' +\n            (this.isStart() && !dot && !allowDot ? startNoDot : '') +\n            star +\n            ')'\n          : this.type === '@'\n          ? ')'\n          : this.type === '?'\n          ? ')?'\n          : this.type === '+' && bodyDotAllowed\n          ? ')'\n          : this.type === '*' && bodyDotAllowed\n          ? `)?`\n          : `)${this.type}`\n      final = start + body + close\n    }\n    return [\n      final,\n      unescape(body),\n      (this.#hasMagic = !!this.#hasMagic),\n      this.#uflag,\n    ]\n  }\n\n  #partsToRegExp(dot: boolean) {\n    return this.#parts\n      .map(p => {\n        // extglob ASTs should only contain parent ASTs\n        /* c8 ignore start */\n        if (typeof p === 'string') {\n          throw new Error('string type in extglob ast??')\n        }\n        /* c8 ignore stop */\n        // can ignore hasMagic, because extglobs are already always magic\n        const [re, _, _hasMagic, uflag] = p.toRegExpSource(dot)\n        this.#uflag = this.#uflag || uflag\n        return re\n      })\n      .filter(p => !(this.isStart() && this.isEnd()) || !!p)\n      .join('|')\n  }\n\n  static #parseGlob(\n    glob: string,\n    hasMagic: boolean | undefined,\n    noEmpty: boolean = false\n  ): [re: string, body: string, hasMagic: boolean, uflag: boolean] {\n    let escaping = false\n    let re = ''\n    let uflag = false\n    for (let i = 0; i < glob.length; i++) {\n      const c = glob.charAt(i)\n      if (escaping) {\n        escaping = false\n        re += (reSpecials.has(c) ? '\\\\' : '') + c\n        continue\n      }\n      if (c === '\\\\') {\n        if (i === glob.length - 1) {\n          re += '\\\\\\\\'\n        } else {\n          escaping = true\n        }\n        continue\n      }\n      if (c === '[') {\n        const [src, needUflag, consumed, magic] = parseClass(glob, i)\n        if (consumed) {\n          re += src\n          uflag = uflag || needUflag\n          i += consumed - 1\n          hasMagic = hasMagic || magic\n          continue\n        }\n      }\n      if (c === '*') {\n        if (noEmpty && glob === '*') re += starNoEmpty\n        else re += star\n        hasMagic = true\n        continue\n      }\n      if (c === '?') {\n        re += qmark\n        hasMagic = true\n        continue\n      }\n      re += regExpEscape(c)\n    }\n    return [re, unescape(glob), !!hasMagic, uflag]\n  }\n}\n", "import { MinimatchOptions } from './index.js'\n/**\n * Escape all magic characters in a glob pattern.\n *\n * If the {@link windowsPathsNoEscape | GlobOptions.windowsPathsNoEscape}\n * option is used, then characters are escaped by wrapping in `[]`, because\n * a magic character wrapped in a character class can only be satisfied by\n * that exact character.  In this mode, `\\` is _not_ escaped, because it is\n * not interpreted as a magic character, but instead as a path separator.\n */\nexport const escape = (\n  s: string,\n  {\n    windowsPathsNoEscape = false,\n  }: Pick<MinimatchOptions, 'windowsPathsNoEscape'> = {}\n) => {\n  // don't need to escape +@! because we escape the parens\n  // that make those magic, and escaping ! as [!] isn't valid,\n  // because [!]] is a valid glob class meaning not ']'.\n  return windowsPathsNoEscape\n    ? s.replace(/[?*()[\\]]/g, '[$&]')\n    : s.replace(/[?*()[\\]\\\\]/g, '\\\\$&')\n}\n", "import { minimatch } from \"minimatch\";\r\nimport { convertResponseHeaders } from \"./tools/headers.js\";\r\nexport function createErrorFromResponse(response, prefix = \"\") {\r\n    const err = new Error(`${prefix}Invalid response: ${response.status} ${response.statusText}`);\r\n    err.status = response.status;\r\n    err.response = response;\r\n    return err;\r\n}\r\nexport function handleResponseCode(context, response) {\r\n    const { status } = response;\r\n    if (status === 401 && context.digest)\r\n        return response;\r\n    if (status >= 400) {\r\n        const err = createErrorFromResponse(response);\r\n        throw err;\r\n    }\r\n    return response;\r\n}\r\nexport function processGlobFilter(files, glob) {\r\n    return files.filter(file => minimatch(file.filename, glob, { matchBase: true }));\r\n}\r\n/**\r\n * Process a response payload (eg. from `customRequest`) and\r\n *  prepare it for further processing. Exposed for custom\r\n *  request handling.\r\n * @param response The response for a request\r\n * @param data The data returned\r\n * @param isDetailed Whether or not a detailed result is\r\n *  requested\r\n * @returns The response data, or a detailed response object\r\n *  if required\r\n */\r\nexport function processResponsePayload(response, data, isDetailed = false) {\r\n    return isDetailed\r\n        ? {\r\n            data,\r\n            headers: response.headers ? convertResponseHeaders(response.headers) : {},\r\n            status: response.status,\r\n            statusText: response.statusText\r\n        }\r\n        : data;\r\n}\r\n", "import { joinURL } from \"../tools/url.js\";\r\nimport { encodePath } from \"../tools/path.js\";\r\nimport { request, prepareRequestOptions } from \"../request.js\";\r\nimport { handleResponseCode } from \"../response.js\";\r\nexport async function copyFile(context, filename, destination, options = {}) {\r\n    const requestOptions = prepareRequestOptions({\r\n        url: joinURL(context.remoteURL, encodePath(filename)),\r\n        method: \"COPY\",\r\n        headers: {\r\n            Destination: joinURL(context.remoteURL, encodePath(destination)),\r\n            /**\r\n             * From RFC4918 section 10.6: If the overwrite header is not included in a COPY or MOVE request,\r\n             * then the resource MUST treat the request as if it has an overwrite header of value \"T\".\r\n             *\r\n             * Meaning the overwrite header is always set to \"T\" EXCEPT the option is explicitly set to false.\r\n             */\r\n            Overwrite: options.overwrite === false ? \"F\" : \"T\",\r\n            /**\r\n             * From RFC4918 section 9.8.3: A client may submit a Depth header on a COPY on a collection with a value of \"0\"\r\n             * or \"infinity\". The COPY method on a collection without a Depth header MUST act as if\r\n             * a Depth header with value \"infinity\" was included.\r\n             */\r\n            Depth: options.shallow ? \"0\" : \"infinity\"\r\n        }\r\n    }, context, options);\r\n    const response = await request(requestOptions, context);\r\n    handleResponseCode(context, response);\r\n}\r\n", "import path from \"path-posix\";\r\nimport { XMLParser } from \"fast-xml-parser\";\r\nimport nestedProp from \"nested-property\";\r\nimport { encodePath, normalisePath } from \"./path.js\";\r\nvar PropertyType;\r\n(function (PropertyType) {\r\n    PropertyType[\"Array\"] = \"array\";\r\n    PropertyType[\"Object\"] = \"object\";\r\n    PropertyType[\"Original\"] = \"original\";\r\n})(PropertyType || (PropertyType = {}));\r\nfunction getParser() {\r\n    return new XMLParser({\r\n        allowBooleanAttributes: true,\r\n        attributeNamePrefix: \"\",\r\n        textNodeName: \"text\",\r\n        ignoreAttributes: false,\r\n        removeNSPrefix: true,\r\n        numberParseOptions: {\r\n            hex: true,\r\n            leadingZeros: false\r\n        },\r\n        attributeValueProcessor(attrName, attrValue, jPath) {\r\n            // handle boolean attributes\r\n            if (attrValue === \"true\" || attrValue === \"false\") {\r\n                return attrValue === \"true\";\r\n            }\r\n            return attrValue;\r\n        },\r\n        tagValueProcessor(tagName, tagValue, jPath) {\r\n            if (jPath.endsWith(\"propstat.prop.displayname\")) {\r\n                // Do not parse the display name, because this causes e.g. '2024.10' to result in number 2024.1\r\n                return;\r\n            }\r\n            return tagValue;\r\n        }\r\n        // We don't use the processors here as decoding is done manually\r\n        // later on - decoding early would break some path checks.\r\n    });\r\n}\r\nfunction getPropertyOfType(obj, prop, type = PropertyType.Original) {\r\n    const val = nestedProp.get(obj, prop);\r\n    if (type === \"array\" && Array.isArray(val) === false) {\r\n        return [val];\r\n    }\r\n    else if (type === \"object\" && Array.isArray(val)) {\r\n        return val[0];\r\n    }\r\n    return val;\r\n}\r\nfunction normaliseResponse(response) {\r\n    const output = Object.assign({}, response);\r\n    // Only either status OR propstat is allowed\r\n    if (output.status) {\r\n        nestedProp.set(output, \"status\", getPropertyOfType(output, \"status\", PropertyType.Object));\r\n    }\r\n    else {\r\n        nestedProp.set(output, \"propstat\", getPropertyOfType(output, \"propstat\", PropertyType.Object));\r\n        nestedProp.set(output, \"propstat.prop\", getPropertyOfType(output, \"propstat.prop\", PropertyType.Object));\r\n    }\r\n    return output;\r\n}\r\nfunction normaliseResult(result) {\r\n    const { multistatus } = result;\r\n    if (multistatus === \"\") {\r\n        return {\r\n            multistatus: {\r\n                response: []\r\n            }\r\n        };\r\n    }\r\n    if (!multistatus) {\r\n        throw new Error(\"Invalid response: No root multistatus found\");\r\n    }\r\n    const output = {\r\n        multistatus: Array.isArray(multistatus) ? multistatus[0] : multistatus\r\n    };\r\n    nestedProp.set(output, \"multistatus.response\", getPropertyOfType(output, \"multistatus.response\", PropertyType.Array));\r\n    nestedProp.set(output, \"multistatus.response\", nestedProp.get(output, \"multistatus.response\").map(response => normaliseResponse(response)));\r\n    return output;\r\n}\r\n/**\r\n * Parse an XML response from a WebDAV service,\r\n *  converting it to an internal DAV result\r\n * @param xml The raw XML string\r\n * @returns A parsed and processed DAV result\r\n */\r\nexport function parseXML(xml) {\r\n    return new Promise(resolve => {\r\n        const result = getParser().parse(xml);\r\n        resolve(normaliseResult(result));\r\n    });\r\n}\r\n/**\r\n * Get a file stat result from given DAV properties\r\n * @param props DAV properties\r\n * @param filename The filename for the file stat\r\n * @param isDetailed Whether or not the raw props of the resource should be returned\r\n * @returns A file stat result\r\n */\r\nexport function prepareFileFromProps(props, filename, isDetailed = false) {\r\n    // Last modified time, raw size, item type and mime\r\n    const { getlastmodified: lastMod = null, getcontentlength: rawSize = \"0\", resourcetype: resourceType = null, getcontenttype: mimeType = null, getetag: etag = null } = props;\r\n    const type = resourceType &&\r\n        typeof resourceType === \"object\" &&\r\n        typeof resourceType.collection !== \"undefined\"\r\n        ? \"directory\"\r\n        : \"file\";\r\n    const stat = {\r\n        filename,\r\n        basename: path.basename(filename),\r\n        lastmod: lastMod,\r\n        size: parseInt(rawSize, 10),\r\n        type,\r\n        etag: typeof etag === \"string\" ? etag.replace(/\"/g, \"\") : null\r\n    };\r\n    if (type === \"file\") {\r\n        stat.mime = mimeType && typeof mimeType === \"string\" ? mimeType.split(\";\")[0] : \"\";\r\n    }\r\n    if (isDetailed) {\r\n        // The XML parser tries to interpret values, but the display name is required to be a string\r\n        if (typeof props.displayname !== \"undefined\") {\r\n            props.displayname = String(props.displayname);\r\n        }\r\n        stat.props = props;\r\n    }\r\n    return stat;\r\n}\r\n/**\r\n * Parse a DAV result for file stats\r\n * @param result The resulting DAV response\r\n * @param filename The filename that was stat'd\r\n * @param isDetailed Whether or not the raw props of\r\n *  the resource should be returned\r\n * @returns A file stat result\r\n */\r\nexport function parseStat(result, filename, isDetailed = false) {\r\n    let responseItem = null;\r\n    try {\r\n        // should be a propstat response, if not the if below will throw an error\r\n        if (result.multistatus.response[0].propstat) {\r\n            responseItem = result.multistatus.response[0];\r\n        }\r\n    }\r\n    catch (e) {\r\n        /* ignore */\r\n    }\r\n    if (!responseItem) {\r\n        throw new Error(\"Failed getting item stat: bad response\");\r\n    }\r\n    const { propstat: { prop: props, status: statusLine } } = responseItem;\r\n    // As defined in https://tools.ietf.org/html/rfc2068#section-6.1\r\n    const [_, statusCodeStr, statusText] = statusLine.split(\" \", 3);\r\n    const statusCode = parseInt(statusCodeStr, 10);\r\n    if (statusCode >= 400) {\r\n        const err = new Error(`Invalid response: ${statusCode} ${statusText}`);\r\n        err.status = statusCode;\r\n        throw err;\r\n    }\r\n    const filePath = normalisePath(filename);\r\n    return prepareFileFromProps(props, filePath, isDetailed);\r\n}\r\n/**\r\n * Parse a DAV result for a search request\r\n *\r\n * @param result The resulting DAV response\r\n * @param searchArbiter The collection path that was searched\r\n * @param isDetailed Whether or not the raw props of the resource should be returned\r\n */\r\nexport function parseSearch(result, searchArbiter, isDetailed) {\r\n    const response = {\r\n        truncated: false,\r\n        results: []\r\n    };\r\n    response.truncated = result.multistatus.response.some(v => {\r\n        return ((v.status || v.propstat?.status).split(\" \", 3)?.[1] === \"507\" &&\r\n            v.href.replace(/\\/$/, \"\").endsWith(encodePath(searchArbiter).replace(/\\/$/, \"\")));\r\n    });\r\n    result.multistatus.response.forEach(result => {\r\n        if (result.propstat === undefined) {\r\n            return;\r\n        }\r\n        const filename = result.href.split(\"/\").map(decodeURIComponent).join(\"/\");\r\n        response.results.push(prepareFileFromProps(result.propstat.prop, filename, isDetailed));\r\n    });\r\n    return response;\r\n}\r\n/**\r\n * Translate a disk quota indicator to a recognised\r\n *  value (includes \"unlimited\" and \"unknown\")\r\n * @param value The quota indicator, eg. \"-3\"\r\n * @returns The value in bytes, or another indicator\r\n */\r\nexport function translateDiskSpace(value) {\r\n    switch (String(value)) {\r\n        case \"-3\":\r\n            return \"unlimited\";\r\n        case \"-2\":\r\n        /* falls-through */\r\n        case \"-1\":\r\n            // -1 is non-computed\r\n            return \"unknown\";\r\n        default:\r\n            return parseInt(String(value), 10);\r\n    }\r\n}\r\n", "import { parseStat, parseXML } from \"../tools/dav.js\";\r\nimport { joinURL } from \"../tools/url.js\";\r\nimport { encodePath } from \"../tools/path.js\";\r\nimport { request, prepareRequestOptions } from \"../request.js\";\r\nimport { handleResponseCode, processResponsePayload } from \"../response.js\";\r\nexport async function getStat(context, filename, options = {}) {\r\n    const { details: isDetailed = false } = options;\r\n    const requestOptions = prepareRequestOptions({\r\n        url: joinURL(context.remoteURL, encodePath(filename)),\r\n        method: \"PROPFIND\",\r\n        headers: {\r\n            Accept: \"text/plain,application/xml\",\r\n            Depth: \"0\"\r\n        }\r\n    }, context, options);\r\n    const response = await request(requestOptions, context);\r\n    handleResponseCode(context, response);\r\n    const responseData = await response.text();\r\n    const result = await parseXML(responseData);\r\n    const stat = parseStat(result, filename, isDetailed);\r\n    return processResponsePayload(response, stat, isDetailed);\r\n}\r\n", "import { joinURL } from \"../tools/url.js\";\r\nimport { encodePath, getAllDirectories, normalisePath } from \"../tools/path.js\";\r\nimport { request, prepareRequestOptions } from \"../request.js\";\r\nimport { handleResponseCode } from \"../response.js\";\r\nimport { getStat } from \"./stat.js\";\r\nexport async function createDirectory(context, dirPath, options = {}) {\r\n    if (options.recursive === true)\r\n        return createDirectoryRecursively(context, dirPath, options);\r\n    const requestOptions = prepareRequestOptions({\r\n        url: joinURL(context.remoteURL, ensureCollectionPath(encodePath(dirPath))),\r\n        method: \"MKCOL\"\r\n    }, context, options);\r\n    const response = await request(requestOptions, context);\r\n    handleResponseCode(context, response);\r\n}\r\n/**\r\n * Ensure the path is a proper \"collection\" path by ensuring it has a trailing \"/\".\r\n * The proper format of collection according to the specification does contain the trailing slash.\r\n * http://www.webdav.org/specs/rfc4918.html#rfc.section.5.2\r\n * @param path Path of the collection\r\n * @return string Path of the collection with appended trailing \"/\" in case the `path` does not have it.\r\n */\r\nfunction ensureCollectionPath(path) {\r\n    if (!path.endsWith(\"/\")) {\r\n        return path + \"/\";\r\n    }\r\n    return path;\r\n}\r\nasync function createDirectoryRecursively(context, dirPath, options = {}) {\r\n    const paths = getAllDirectories(normalisePath(dirPath));\r\n    paths.sort((a, b) => {\r\n        if (a.length > b.length) {\r\n            return 1;\r\n        }\r\n        else if (b.length > a.length) {\r\n            return -1;\r\n        }\r\n        return 0;\r\n    });\r\n    let creating = false;\r\n    for (const testPath of paths) {\r\n        if (creating) {\r\n            await createDirectory(context, testPath, {\r\n                ...options,\r\n                recursive: false\r\n            });\r\n            continue;\r\n        }\r\n        try {\r\n            const testStat = (await getStat(context, testPath));\r\n            if (testStat.type !== \"directory\") {\r\n                throw new Error(`Path includes a file: ${dirPath}`);\r\n            }\r\n        }\r\n        catch (err) {\r\n            const error = err;\r\n            if (error.status === 404) {\r\n                creating = true;\r\n                await createDirectory(context, testPath, {\r\n                    ...options,\r\n                    recursive: false\r\n                });\r\n            }\r\n            else {\r\n                throw err;\r\n            }\r\n        }\r\n    }\r\n}\r\n", "import Stream from \"stream\";\r\nimport { joinURL } from \"../tools/url.js\";\r\nimport { encodePath } from \"../tools/path.js\";\r\nimport { request, prepareRequestOptions } from \"../request.js\";\r\nimport { handleResponseCode } from \"../response.js\";\r\nconst NOOP = () => { };\r\nexport function createReadStream(context, filePath, options = {}) {\r\n    const PassThroughStream = Stream.PassThrough;\r\n    const outStream = new PassThroughStream();\r\n    getFileStream(context, filePath, options)\r\n        .then(stream => {\r\n        stream.pipe(outStream);\r\n    })\r\n        .catch(err => {\r\n        outStream.emit(\"error\", err);\r\n    });\r\n    return outStream;\r\n}\r\nexport function createWriteStream(context, filePath, options = {}, callback = NOOP) {\r\n    const PassThroughStream = Stream.PassThrough;\r\n    const writeStream = new PassThroughStream();\r\n    const headers = {};\r\n    if (options.overwrite === false) {\r\n        headers[\"If-None-Match\"] = \"*\";\r\n    }\r\n    const requestOptions = prepareRequestOptions({\r\n        url: joinURL(context.remoteURL, encodePath(filePath)),\r\n        method: \"PUT\",\r\n        headers,\r\n        data: writeStream,\r\n        maxRedirects: 0\r\n    }, context, options);\r\n    request(requestOptions, context)\r\n        .then(response => handleResponseCode(context, response))\r\n        .then(response => {\r\n        // Fire callback asynchronously to avoid errors\r\n        setTimeout(() => {\r\n            callback(response);\r\n        }, 0);\r\n    })\r\n        .catch(err => {\r\n        writeStream.emit(\"error\", err);\r\n    });\r\n    return writeStream;\r\n}\r\nasync function getFileStream(context, filePath, options = {}) {\r\n    const headers = {};\r\n    if (typeof options.range === \"object\" && typeof options.range.start === \"number\") {\r\n        let rangeHeader = `bytes=${options.range.start}-`;\r\n        if (typeof options.range.end === \"number\") {\r\n            rangeHeader = `${rangeHeader}${options.range.end}`;\r\n        }\r\n        headers.Range = rangeHeader;\r\n    }\r\n    const requestOptions = prepareRequestOptions({\r\n        url: joinURL(context.remoteURL, encodePath(filePath)),\r\n        method: \"GET\",\r\n        headers\r\n    }, context, options);\r\n    const response = await request(requestOptions, context);\r\n    handleResponseCode(context, response);\r\n    if (headers.Range && response.status !== 206) {\r\n        const responseError = new Error(`Invalid response code for partial request: ${response.status}`);\r\n        responseError.status = response.status;\r\n        throw responseError;\r\n    }\r\n    if (options.callback) {\r\n        setTimeout(() => {\r\n            options.callback(response);\r\n        }, 0);\r\n    }\r\n    // @ts-ignore\r\n    return response.body;\r\n}\r\n", "import { joinURL } from \"../tools/url.js\";\r\nimport { encodePath } from \"../tools/path.js\";\r\nimport { request, prepareRequestOptions } from \"../request.js\";\r\nimport { handleResponseCode } from \"../response.js\";\r\nexport async function customRequest(context, remotePath, requestOptions) {\r\n    if (!requestOptions.url) {\r\n        requestOptions.url = joinURL(context.remoteURL, encodePath(remotePath));\r\n    }\r\n    const finalOptions = prepareRequestOptions(requestOptions, context, {});\r\n    const response = await request(finalOptions, context);\r\n    handleResponseCode(context, response);\r\n    return response;\r\n}\r\n", "import { joinURL } from \"../tools/url.js\";\r\nimport { encodePath } from \"../tools/path.js\";\r\nimport { request, prepareRequestOptions } from \"../request.js\";\r\nimport { handleResponseCode } from \"../response.js\";\r\nexport async function deleteFile(context, filename, options = {}) {\r\n    const requestOptions = prepareRequestOptions({\r\n        url: joinURL(context.remoteURL, encodePath(filename)),\r\n        method: \"DELETE\"\r\n    }, context, options);\r\n    const response = await request(requestOptions, context);\r\n    handleResponseCode(context, response);\r\n}\r\n", "import { getStat } from \"./stat.js\";\r\nexport async function exists(context, remotePath, options = {}) {\r\n    try {\r\n        await getStat(context, remotePath, options);\r\n        return true;\r\n    }\r\n    catch (err) {\r\n        if (err.status === 404) {\r\n            return false;\r\n        }\r\n        throw err;\r\n    }\r\n}\r\n", "import pathPosix from \"path-posix\";\r\nimport { joinURL, normaliseHREF } from \"../tools/url.js\";\r\nimport { encodePath, makePathAbsolute, normalisePath } from \"../tools/path.js\";\r\nimport { parseXML, prepareFileFromProps } from \"../tools/dav.js\";\r\nimport { request, prepareRequestOptions } from \"../request.js\";\r\nimport { handleResponseCode, processGlobFilter, processResponsePayload } from \"../response.js\";\r\nexport async function getDirectoryContents(context, remotePath, options = {}) {\r\n    const requestOptions = prepareRequestOptions({\r\n        url: joinURL(context.remoteURL, encodePath(remotePath), \"/\"),\r\n        method: \"PROPFIND\",\r\n        headers: {\r\n            Accept: \"text/plain,application/xml\",\r\n            Depth: options.deep ? \"infinity\" : \"1\"\r\n        }\r\n    }, context, options);\r\n    const response = await request(requestOptions, context);\r\n    handleResponseCode(context, response);\r\n    const responseData = await response.text();\r\n    if (!responseData) {\r\n        throw new Error(\"Failed parsing directory contents: Empty response\");\r\n    }\r\n    const davResp = await parseXML(responseData);\r\n    const _remotePath = makePathAbsolute(remotePath);\r\n    const remoteBasePath = makePathAbsolute(context.remoteBasePath || context.remotePath);\r\n    let files = getDirectoryFiles(davResp, remoteBasePath, _remotePath, options.details, options.includeSelf);\r\n    if (options.glob) {\r\n        files = processGlobFilter(files, options.glob);\r\n    }\r\n    return processResponsePayload(response, files, options.details);\r\n}\r\nfunction getDirectoryFiles(result, serverremoteBasePath, requestPath, isDetailed = false, includeSelf = false) {\r\n    const serverBase = pathPosix.join(serverremoteBasePath, \"/\");\r\n    // Extract the response items (directory contents)\r\n    const { multistatus: { response: responseItems } } = result;\r\n    // Map all items to a consistent output structure (results)\r\n    const nodes = responseItems.map(item => {\r\n        // HREF is the file path (in full) - The href is already XML entities decoded (e.g. foo&amp;bar is reverted to foo&bar)\r\n        const href = normaliseHREF(item.href);\r\n        // Each item should contain a stat object\r\n        const { propstat: { prop: props } } = item;\r\n        // Process the true full filename (minus the base server path)\r\n        const filename = serverBase === \"/\"\r\n            ? decodeURIComponent(normalisePath(href))\r\n            : normalisePath(pathPosix.relative(decodeURIComponent(serverBase), decodeURIComponent(href)));\r\n        return prepareFileFromProps(props, filename, isDetailed);\r\n    });\r\n    // If specified, also return the current directory\r\n    if (includeSelf) {\r\n        return nodes;\r\n    }\r\n    // Else, filter out the item pointing to the current directory (not needed)\r\n    return nodes.filter(item => item.basename &&\r\n        (item.type === \"file\" || item.filename !== requestPath.replace(/\\/$/, \"\")));\r\n}\r\n", "import { Layerr } from \"layerr\";\r\nimport { joinURL } from \"../tools/url.js\";\r\nimport { encodePath } from \"../tools/path.js\";\r\nimport { fromBase64 } from \"../tools/encode.js\";\r\nimport { isReactNative, isWeb } from \"../compat/env.js\";\r\nimport { request, prepareRequestOptions } from \"../request.js\";\r\nimport { handleResponseCode, processResponsePayload } from \"../response.js\";\r\nimport { AuthType, ErrorCode } from \"../types.js\";\r\nconst TRANSFORM_RETAIN_FORMAT = (v) => v;\r\nexport async function getFileContents(context, filePath, options = {}) {\r\n    const { format = \"binary\" } = options;\r\n    if (format !== \"binary\" && format !== \"text\") {\r\n        throw new Layerr({\r\n            info: {\r\n                code: ErrorCode.InvalidOutputFormat\r\n            }\r\n        }, `Invalid output format: ${format}`);\r\n    }\r\n    return format === \"text\"\r\n        ? getFileContentsString(context, filePath, options)\r\n        : getFileContentsBuffer(context, filePath, options);\r\n}\r\nasync function getFileContentsBuffer(context, filePath, options = {}) {\r\n    const requestOptions = prepareRequestOptions({\r\n        url: joinURL(context.remoteURL, encodePath(filePath)),\r\n        method: \"GET\"\r\n    }, context, options);\r\n    const response = await request(requestOptions, context);\r\n    handleResponseCode(context, response);\r\n    let body;\r\n    if (isWeb() || isReactNative()) {\r\n        body = await response.arrayBuffer();\r\n    }\r\n    else {\r\n        body = Buffer.from(await response.arrayBuffer());\r\n    }\r\n    return processResponsePayload(response, body, options.details);\r\n}\r\nasync function getFileContentsString(context, filePath, options = {}) {\r\n    const requestOptions = prepareRequestOptions({\r\n        url: joinURL(context.remoteURL, encodePath(filePath)),\r\n        method: \"GET\",\r\n        headers: {\r\n            Accept: \"text/plain\"\r\n        },\r\n        transformResponse: [TRANSFORM_RETAIN_FORMAT]\r\n    }, context, options);\r\n    const response = await request(requestOptions, context);\r\n    handleResponseCode(context, response);\r\n    const body = await response.text();\r\n    return processResponsePayload(response, body, options.details);\r\n}\r\nexport function getFileDownloadLink(context, filePath) {\r\n    let url = joinURL(context.remoteURL, encodePath(filePath));\r\n    const protocol = /^https:/i.test(url) ? \"https\" : \"http\";\r\n    switch (context.authType) {\r\n        case AuthType.None:\r\n            // Do nothing\r\n            break;\r\n        case AuthType.Password: {\r\n            const authPart = context.headers.Authorization.replace(/^Basic /i, \"\").trim();\r\n            const authContents = fromBase64(authPart);\r\n            url = url.replace(/^https?:\\/\\//, `${protocol}://${authContents}@`);\r\n            break;\r\n        }\r\n        default:\r\n            throw new Layerr({\r\n                info: {\r\n                    code: ErrorCode.LinkUnsupportedAuthType\r\n                }\r\n            }, `Unsupported auth type for file link: ${context.authType}`);\r\n    }\r\n    return url;\r\n}\r\n", "import nestedProp from \"nested-property\";\r\nimport { joinURL } from \"../tools/url.js\";\r\nimport { encodePath } from \"../tools/path.js\";\r\nimport { generateLockXML, parseGenericResponse } from \"../tools/xml.js\";\r\nimport { request, prepareRequestOptions } from \"../request.js\";\r\nimport { createErrorFromResponse, handleResponseCode } from \"../response.js\";\r\nconst DEFAULT_TIMEOUT = \"Infinite, Second-4100000000\";\r\nexport async function lock(context, path, options = {}) {\r\n    const { refreshToken, timeout = DEFAULT_TIMEOUT } = options;\r\n    const headers = {\r\n        Accept: \"text/plain,application/xml\",\r\n        Timeout: timeout\r\n    };\r\n    if (refreshToken) {\r\n        headers.If = refreshToken;\r\n    }\r\n    const requestOptions = prepareRequestOptions({\r\n        url: joinURL(context.remoteURL, encodePath(path)),\r\n        method: \"LOCK\",\r\n        headers,\r\n        data: generateLockXML(context.contactHref)\r\n    }, context, options);\r\n    const response = await request(requestOptions, context);\r\n    handleResponseCode(context, response);\r\n    const responseData = await response.text();\r\n    const lockPayload = parseGenericResponse(responseData);\r\n    const token = nestedProp.get(lockPayload, \"prop.lockdiscovery.activelock.locktoken.href\");\r\n    const serverTimeout = nestedProp.get(lockPayload, \"prop.lockdiscovery.activelock.timeout\");\r\n    if (!token) {\r\n        const err = createErrorFromResponse(response, \"No lock token received: \");\r\n        throw err;\r\n    }\r\n    return {\r\n        token,\r\n        serverTimeout\r\n    };\r\n}\r\nexport async function unlock(context, path, token, options = {}) {\r\n    const requestOptions = prepareRequestOptions({\r\n        url: joinURL(context.remoteURL, encodePath(path)),\r\n        method: \"UNLOCK\",\r\n        headers: {\r\n            \"Lock-Token\": token\r\n        }\r\n    }, context, options);\r\n    const response = await request(requestOptions, context);\r\n    handleResponseCode(context, response);\r\n    if (response.status !== 204 && response.status !== 200) {\r\n        const err = createErrorFromResponse(response);\r\n        throw err;\r\n    }\r\n}\r\n", "import { XMLParser, XMLBuilder } from \"fast-xml-parser\";\r\nexport function generateLockXML(ownerHREF) {\r\n    return getBuilder().build(namespace({\r\n        lockinfo: {\r\n            \"@_xmlns:d\": \"DAV:\",\r\n            lockscope: {\r\n                exclusive: {}\r\n            },\r\n            locktype: {\r\n                write: {}\r\n            },\r\n            owner: {\r\n                href: ownerHREF\r\n            }\r\n        }\r\n    }, \"d\"));\r\n}\r\nfunction getBuilder() {\r\n    return new XMLBuilder({\r\n        attributeNamePrefix: \"@_\",\r\n        format: true,\r\n        ignoreAttributes: false,\r\n        suppressEmptyNode: true\r\n    });\r\n}\r\nfunction getParser() {\r\n    return new XMLParser({\r\n        removeNSPrefix: true,\r\n        parseAttributeValue: true,\r\n        parseTagValue: true\r\n    });\r\n}\r\nfunction namespace(obj, ns) {\r\n    const copy = { ...obj };\r\n    for (const key in copy) {\r\n        if (!copy.hasOwnProperty(key)) {\r\n            continue;\r\n        }\r\n        if (copy[key] && typeof copy[key] === \"object\" && key.indexOf(\":\") === -1) {\r\n            copy[`${ns}:${key}`] = namespace(copy[key], ns);\r\n            delete copy[key];\r\n        }\r\n        else if (/^@_/.test(key) === false) {\r\n            copy[`${ns}:${key}`] = copy[key];\r\n            delete copy[key];\r\n        }\r\n    }\r\n    return copy;\r\n}\r\nexport function parseGenericResponse(xml) {\r\n    return getParser().parse(xml);\r\n}\r\n", "import { translateDiskSpace } from \"./dav.js\";\r\nexport function parseQuota(result) {\r\n    try {\r\n        const [responseItem] = result.multistatus.response;\r\n        const { propstat: { prop: { \"quota-used-bytes\": quotaUsed, \"quota-available-bytes\": quotaAvail } } } = responseItem;\r\n        return typeof quotaUsed !== \"undefined\" && typeof quotaAvail !== \"undefined\"\r\n            ? {\r\n                // As it could be both a string or a number ensure we are working with a number\r\n                used: parseInt(String(quotaUsed), 10),\r\n                available: translateDiskSpace(quotaAvail)\r\n            }\r\n            : null;\r\n    }\r\n    catch (err) {\r\n        /* ignore */\r\n    }\r\n    return null;\r\n}\r\n", "import { prepareRequestOptions, request } from \"../request.js\";\r\nimport { handleResponseCode, processResponsePayload } from \"../response.js\";\r\nimport { parseXML } from \"../tools/dav.js\";\r\nimport { joinURL } from \"../tools/url.js\";\r\nimport { parseQuota } from \"../tools/quota.js\";\r\nexport async function getQuota(context, options = {}) {\r\n    const path = options.path || \"/\";\r\n    const requestOptions = prepareRequestOptions({\r\n        url: joinURL(context.remoteURL, path),\r\n        method: \"PROPFIND\",\r\n        headers: {\r\n            Accept: \"text/plain,application/xml\",\r\n            Depth: \"0\"\r\n        }\r\n    }, context, options);\r\n    const response = await request(requestOptions, context);\r\n    handleResponseCode(context, response);\r\n    const responseData = await response.text();\r\n    const result = await parseXML(responseData);\r\n    const quota = parseQuota(result);\r\n    return processResponsePayload(response, quota, options.details);\r\n}\r\n", "import { parseSearch, parseXML } from \"../tools/dav.js\";\r\nimport { joinURL } from \"../tools/url.js\";\r\nimport { encodePath } from \"../tools/path.js\";\r\nimport { request, prepareRequestOptions } from \"../request.js\";\r\nimport { handleResponseCode, processResponsePayload } from \"../response.js\";\r\nexport async function getSearch(context, searchArbiter, options = {}) {\r\n    const { details: isDetailed = false } = options;\r\n    const requestOptions = prepareRequestOptions({\r\n        url: joinURL(context.remoteURL, encodePath(searchArbiter)),\r\n        method: \"SEARCH\",\r\n        headers: {\r\n            Accept: \"text/plain,application/xml\",\r\n            // Ensure a Content-Type header is set was this is required by e.g. sabre/dav\r\n            \"Content-Type\": context.headers[\"Content-Type\"] || \"application/xml; charset=utf-8\"\r\n        }\r\n    }, context, options);\r\n    const response = await request(requestOptions, context);\r\n    handleResponseCode(context, response);\r\n    const responseText = await response.text();\r\n    const responseData = await parseXML(responseText);\r\n    const results = parseSearch(responseData, searchArbiter, isDetailed);\r\n    return processResponsePayload(response, results, isDetailed);\r\n}\r\n", "import { joinURL } from \"../tools/url.js\";\r\nimport { encodePath } from \"../tools/path.js\";\r\nimport { request, prepareRequestOptions } from \"../request.js\";\r\nimport { handleResponseCode } from \"../response.js\";\r\nexport async function moveFile(context, filename, destination, options = {}) {\r\n    const requestOptions = prepareRequestOptions({\r\n        url: joinURL(context.remoteURL, encodePath(filename)),\r\n        method: \"MOVE\",\r\n        headers: {\r\n            Destination: joinURL(context.remoteURL, encodePath(destination)),\r\n            /**\r\n             * From RFC4918 section 10.6: If the overwrite header is not included in a COPY or MOVE request,\r\n             * then the resource MUST treat the request as if it has an overwrite header of value \"T\".\r\n             *\r\n             * Meaning the overwrite header is always set to \"T\" EXCEPT the option is explicitly set to false.\r\n             */\r\n            Overwrite: options.overwrite === false ? \"F\" : \"T\"\r\n        }\r\n    }, context, options);\r\n    const response = await request(requestOptions, context);\r\n    handleResponseCode(context, response);\r\n}\r\n", "import { Layerr } from \"layerr\";\r\nimport Stream from \"stream\";\r\nimport { fromBase64 } from \"../tools/encode.js\";\r\nimport { joinURL } from \"../tools/url.js\";\r\nimport { encodePath } from \"../tools/path.js\";\r\nimport { calculateDataLength } from \"../tools/size.js\";\r\nimport { isReactNative, isWeb } from \"../compat/env.js\";\r\nimport { request, prepareRequestOptions } from \"../request.js\";\r\nimport { handleResponseCode } from \"../response.js\";\r\nimport { AuthType, ErrorCode } from \"../types.js\";\r\nexport async function putFileContents(context, filePath, data, options = {}) {\r\n    const { contentLength = true, overwrite = true } = options;\r\n    const headers = {\r\n        \"Content-Type\": \"application/octet-stream\"\r\n    };\r\n    if (!isWeb() &&\r\n        !isReactNative() &&\r\n        typeof Stream !== \"undefined\" &&\r\n        typeof Stream?.Readable !== \"undefined\" &&\r\n        data instanceof Stream.Readable) {\r\n        // Skip, no content-length\r\n    }\r\n    else if (contentLength === false) {\r\n        // Skip, disabled\r\n    }\r\n    else if (typeof contentLength === \"number\") {\r\n        headers[\"Content-Length\"] = `${contentLength}`;\r\n    }\r\n    else {\r\n        headers[\"Content-Length\"] = `${calculateDataLength(data)}`;\r\n    }\r\n    if (!overwrite) {\r\n        headers[\"If-None-Match\"] = \"*\";\r\n    }\r\n    const requestOptions = prepareRequestOptions({\r\n        url: joinURL(context.remoteURL, encodePath(filePath)),\r\n        method: \"PUT\",\r\n        headers,\r\n        data\r\n    }, context, options);\r\n    const response = await request(requestOptions, context);\r\n    try {\r\n        handleResponseCode(context, response);\r\n    }\r\n    catch (err) {\r\n        const error = err;\r\n        if (error.status === 412 && !overwrite) {\r\n            return false;\r\n        }\r\n        else {\r\n            throw error;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nexport function getFileUploadLink(context, filePath) {\r\n    let url = `${joinURL(context.remoteURL, encodePath(filePath))}?Content-Type=application/octet-stream`;\r\n    const protocol = /^https:/i.test(url) ? \"https\" : \"http\";\r\n    switch (context.authType) {\r\n        case AuthType.None:\r\n            // Do nothing\r\n            break;\r\n        case AuthType.Password: {\r\n            const authPart = context.headers.Authorization.replace(/^Basic /i, \"\").trim();\r\n            const authContents = fromBase64(authPart);\r\n            url = url.replace(/^https?:\\/\\//, `${protocol}://${authContents}@`);\r\n            break;\r\n        }\r\n        default:\r\n            throw new Layerr({\r\n                info: {\r\n                    code: ErrorCode.LinkUnsupportedAuthType\r\n                }\r\n            }, `Unsupported auth type for file link: ${context.authType}`);\r\n    }\r\n    return url;\r\n}\r\n", "import { Layerr } from \"layerr\";\r\nimport { byteLength } from \"byte-length\";\r\nimport { isArrayBuffer } from \"../compat/arrayBuffer.js\";\r\nimport { isBuffer } from \"../compat/buffer.js\";\r\nimport { ErrorCode } from \"../types.js\";\r\nexport function calculateDataLength(data) {\r\n    if (isArrayBuffer(data)) {\r\n        return data.byteLength;\r\n    }\r\n    else if (isBuffer(data)) {\r\n        return data.length;\r\n    }\r\n    else if (typeof data === \"string\") {\r\n        return byteLength(data);\r\n    }\r\n    throw new Layerr({\r\n        info: {\r\n            code: ErrorCode.DataTypeNoLength\r\n        }\r\n    }, \"Cannot calculate data length: Invalid type\");\r\n}\r\n", "import { joinURL } from \"../tools/url.js\";\r\nimport { encodePath } from \"../tools/path.js\";\r\nimport { request, prepareRequestOptions } from \"../request.js\";\r\nimport { handleResponseCode } from \"../response.js\";\r\nexport async function getDAVCompliance(context, filePath, options = {}) {\r\n    const requestOptions = prepareRequestOptions({\r\n        url: joinURL(context.remoteURL, encodePath(filePath)),\r\n        method: \"OPTIONS\"\r\n    }, context, options);\r\n    const response = await request(requestOptions, context);\r\n    try {\r\n        handleResponseCode(context, response);\r\n    }\r\n    catch (err) {\r\n        const error = err;\r\n        throw error;\r\n    }\r\n    const davHeader = response.headers.get(\"DAV\") ?? \"\";\r\n    const compliance = davHeader.split(\",\").map(item => item.trim());\r\n    const server = response.headers.get(\"Server\") ?? \"\";\r\n    return {\r\n        compliance,\r\n        server\r\n    };\r\n}\r\n", "import { Layerr } from \"layerr\";\r\nimport { joinURL } from \"../tools/url.js\";\r\nimport { encodePath } from \"../tools/path.js\";\r\nimport { request, prepareRequestOptions } from \"../request.js\";\r\nimport { handleResponseCode } from \"../response.js\";\r\nimport { getDAVCompliance } from \"./getDAVCompliance.js\";\r\nimport { ErrorCode } from \"../types.js\";\r\nexport async function partialUpdateFileContents(context, filePath, start, end, data, options = {}) {\r\n    const compliance = await getDAVCompliance(context, filePath, options);\r\n    if (compliance.compliance.includes(\"sabredav-partialupdate\")) {\r\n        return await partialUpdateFileContentsSabredav(context, filePath, start, end, data, options);\r\n    }\r\n    if (compliance.server.includes(\"Apache\") &&\r\n        compliance.compliance.includes(\"<http://apache.org/dav/propset/fs/1>\")) {\r\n        return await partialUpdateFileContentsApache(context, filePath, start, end, data, options);\r\n    }\r\n    throw new Layerr({\r\n        info: {\r\n            code: ErrorCode.NotSupported\r\n        }\r\n    }, \"Not supported\");\r\n}\r\nasync function partialUpdateFileContentsSabredav(context, filePath, start, end, data, options = {}) {\r\n    if (start > end || start < 0) {\r\n        // Actually, SabreDAV support negative start value,\r\n        // Do not support here for compatibility with Apache-style way\r\n        throw new Layerr({\r\n            info: {\r\n                code: ErrorCode.InvalidUpdateRange\r\n            }\r\n        }, `Invalid update range ${start} for partial update`);\r\n    }\r\n    const headers = {\r\n        \"Content-Type\": \"application/x-sabredav-partialupdate\",\r\n        \"Content-Length\": `${end - start + 1}`,\r\n        \"X-Update-Range\": `bytes=${start}-${end}`\r\n    };\r\n    const requestOptions = prepareRequestOptions({\r\n        url: joinURL(context.remoteURL, encodePath(filePath)),\r\n        method: \"PATCH\",\r\n        headers,\r\n        data\r\n    }, context, options);\r\n    const response = await request(requestOptions, context);\r\n    handleResponseCode(context, response);\r\n}\r\nasync function partialUpdateFileContentsApache(context, filePath, start, end, data, options = {}) {\r\n    if (start > end || start < 0) {\r\n        throw new Layerr({\r\n            info: {\r\n                code: ErrorCode.InvalidUpdateRange\r\n            }\r\n        }, `Invalid update range ${start} for partial update`);\r\n    }\r\n    const headers = {\r\n        \"Content-Type\": \"application/octet-stream\",\r\n        \"Content-Length\": `${end - start + 1}`,\r\n        \"Content-Range\": `bytes ${start}-${end}/*`\r\n    };\r\n    const requestOptions = prepareRequestOptions({\r\n        url: joinURL(context.remoteURL, encodePath(filePath)),\r\n        method: \"PUT\",\r\n        headers,\r\n        data\r\n    }, context, options);\r\n    const response = await request(requestOptions, context);\r\n    handleResponseCode(context, response);\r\n}\r\n", "import { extractURLPath } from \"./tools/url.js\";\r\nimport { setupAuth } from \"./auth/index.js\";\r\nimport { copyFile } from \"./operations/copyFile.js\";\r\nimport { createDirectory } from \"./operations/createDirectory.js\";\r\nimport { createReadStream, createWriteStream } from \"./operations/createStream.js\";\r\nimport { customRequest } from \"./operations/customRequest.js\";\r\nimport { deleteFile } from \"./operations/deleteFile.js\";\r\nimport { exists } from \"./operations/exists.js\";\r\nimport { getDirectoryContents } from \"./operations/directoryContents.js\";\r\nimport { getFileContents, getFileDownloadLink } from \"./operations/getFileContents.js\";\r\nimport { lock, unlock } from \"./operations/lock.js\";\r\nimport { getQuota } from \"./operations/getQuota.js\";\r\nimport { getStat } from \"./operations/stat.js\";\r\nimport { getSearch } from \"./operations/search.js\";\r\nimport { moveFile } from \"./operations/moveFile.js\";\r\nimport { getFileUploadLink, putFileContents } from \"./operations/putFileContents.js\";\r\nimport { partialUpdateFileContents } from \"./operations/partialUpdateFileContents.js\";\r\nimport { getDAVCompliance } from \"./operations/getDAVCompliance.js\";\r\nimport { AuthType } from \"./types.js\";\r\nconst DEFAULT_CONTACT_HREF = \"https://github.com/perry-mitchell/webdav-client/blob/master/LOCK_CONTACT.md\";\r\nexport function createClient(remoteURL, options = {}) {\r\n    const { authType: authTypeRaw = null, remoteBasePath, contactHref = DEFAULT_CONTACT_HREF, ha1, headers = {}, httpAgent, httpsAgent, password, token, username, withCredentials } = options;\r\n    let authType = authTypeRaw;\r\n    if (!authType) {\r\n        authType = username || password ? AuthType.Password : AuthType.None;\r\n    }\r\n    const context = {\r\n        authType,\r\n        remoteBasePath,\r\n        contactHref,\r\n        ha1,\r\n        headers: Object.assign({}, headers),\r\n        httpAgent,\r\n        httpsAgent,\r\n        password,\r\n        remotePath: extractURLPath(remoteURL),\r\n        remoteURL,\r\n        token,\r\n        username,\r\n        withCredentials\r\n    };\r\n    setupAuth(context, username, password, token, ha1);\r\n    return {\r\n        copyFile: (filename, destination, options) => copyFile(context, filename, destination, options),\r\n        createDirectory: (path, options) => createDirectory(context, path, options),\r\n        createReadStream: (filename, options) => createReadStream(context, filename, options),\r\n        createWriteStream: (filename, options, callback) => createWriteStream(context, filename, options, callback),\r\n        customRequest: (path, requestOptions) => customRequest(context, path, requestOptions),\r\n        deleteFile: (filename, options) => deleteFile(context, filename, options),\r\n        exists: (path, options) => exists(context, path, options),\r\n        getDirectoryContents: (path, options) => getDirectoryContents(context, path, options),\r\n        getFileContents: (filename, options) => getFileContents(context, filename, options),\r\n        getFileDownloadLink: (filename) => getFileDownloadLink(context, filename),\r\n        getFileUploadLink: (filename) => getFileUploadLink(context, filename),\r\n        getHeaders: () => Object.assign({}, context.headers),\r\n        getQuota: (options) => getQuota(context, options),\r\n        lock: (path, options) => lock(context, path, options),\r\n        moveFile: (filename, destinationFilename, options) => moveFile(context, filename, destinationFilename, options),\r\n        putFileContents: (filename, data, options) => putFileContents(context, filename, data, options),\r\n        partialUpdateFileContents: (filePath, start, end, data, options) => partialUpdateFileContents(context, filePath, start, end, data, options),\r\n        getDAVCompliance: (path) => getDAVCompliance(context, path),\r\n        search: (path, options) => getSearch(context, path, options),\r\n        setHeaders: (headers) => {\r\n            context.headers = Object.assign({}, headers);\r\n        },\r\n        stat: (path, options) => getStat(context, path, options),\r\n        unlock: (path, token, options) => unlock(context, path, token, options)\r\n    };\r\n}\r\n", "// src/i18n.ts\r\n\r\n// \u5B9A\u4E49\u8BED\u8A00\u7C7B\u578B\r\nexport type Locale = 'zh' | 'en';\r\n\r\n// \u5B9A\u4E49\u8BBE\u7F6E\u9879\u7684\u7C7B\u578B\r\nexport interface SettingItem {\r\n\tname: string;\r\n\tdesc: string;\r\n}\r\n\r\n// \u5B9A\u4E49\u6BCF\u79CD\u8BED\u8A00\u7684\u7FFB\u8BD1\u5305\u7ED3\u6784\r\nexport interface LangPack {\r\n\tdisplayName: string;\r\n\tsettings: {\r\n\t\ttitle: string;\r\n\t\taddServer: string;\r\n\t\tnoServers: string;\r\n\t\turl: SettingItem;\r\n\t\tusername: string;\r\n\t\tpassword: string;\r\n\t\tremoteDir: SettingItem;\r\n\t\tdeleteServer: string;\r\n\t\tdefaultServer: string;\r\n\t\tdefaultServerDesc: string;\r\n\t\tnoServersAvailable: string;\r\n\t\tserverName: string;\r\n\t\tdeleteNotice: string;\r\n\t\tserverList: string;\r\n\t\tserverListEmpty: string;\r\n\t};\r\n\tview: {\r\n\t\tpleaseConfigure: string;\r\n\t\tconnectionFailed: string;\r\n\t\tlistFailed: string;\r\n\t\trefreshFailed: string;\r\n\t\terror: string;\r\n\t\temptyDir: string;\r\n\t\tcurrentPath: string;\r\n\t\trefreshing: string;\r\n\t\topening: string;\r\n\t\topenFailed: string;\r\n\t\trootDirectory: string;\r\n\t\tloading: string;\r\n\t\tretry: string;\r\n\t\tretryPrompt: string;\r\n\t\trefresh: string;\r\n\t\tsort: string;\r\n\t\tsortByNameAsc: string;\r\n\t\tsortByNameDesc: string;\r\n\t\tsortByTypeAsc: string;\r\n\t\tsortByTypeDesc: string;\r\n\t\tsortBySizeAsc: string;\r\n\t\tsortBySizeDesc: string;\r\n\t\tsortByDateAsc: string;\r\n\t\tsortByDateDesc: string;\r\n\t};\r\n}\r\n\r\nconst en: LangPack = {\r\n\tdisplayName: 'WebDAV Explorer',\r\n\tsettings: {\r\n\t\ttitle: 'WebDAV Settings',\r\n\t\taddServer: 'Add WebDAV Server',\r\n\t\tnoServers: 'No WebDAV servers configured. Click the \"+\" button to add one.',\r\n\t\turl: {\r\n\t\t\tname: 'WebDAV Server URL',\r\n\t\t\tdesc: 'The full URL of your WebDAV server'\r\n\t\t},\r\n\t\tusername: 'Username',\r\n\t\tpassword: 'Password',\r\n\t\tremoteDir: {\r\n\t\t\tname: 'Remote Directory',\r\n\t\t\tdesc: 'Remote directory path (e.g., /notes)'\r\n\t\t},\r\n\t\tdeleteServer: 'Delete Server',\r\n\t\tdefaultServer: 'Default Server',\r\n\t\tdefaultServerDesc: 'Select the default server to use when opening WebDAV Explorer',\r\n\t\tnoServersAvailable: 'No servers available',\r\n\t\tserverName: 'Server Name',\r\n\t\tdeleteNotice: 'Cannot delete the last server. At least one server is required.',\r\n\t\tserverList: 'WebDAV Servers List',\r\n\t\tserverListEmpty: 'Please configure at least one WebDAV server in settings',\r\n\t},\r\n\tview: {\r\n\t\tpleaseConfigure: 'Please configure WebDAV settings in plugin preferences',\r\n\t\tconnectionFailed: 'Connection failed',\r\n\t\tlistFailed: 'Failed to list directory',\r\n\t\trefreshFailed: 'Refresh failed',\r\n\t\terror: 'Error',\r\n\t\temptyDir: 'Empty directory',\r\n\t\tcurrentPath: 'Current path',\r\n\t\trefreshing: 'Refreshing...',\r\n\t\topening: 'Opening file...',\r\n\t\topenFailed: 'Failed to open file',\r\n\t\trootDirectory: 'Home directory',\r\n\t\tloading: 'Loading...',\r\n\t\tretry: 'Retry',\r\n\t\tretryPrompt: 'Loading failed, click to retry',\r\n\t\trefresh: 'Refresh',\r\n\t\tsort: 'Sort',\r\n\t\tsortByNameAsc: 'Name (A-Z)',\r\n\t\tsortByNameDesc: 'Name (Z-A)',\r\n\t\tsortByTypeAsc: 'Type (A-Z)',\r\n\t\tsortByTypeDesc: 'Type (Z-A)',\r\n\t\tsortBySizeAsc: 'Size (Small-Large)',\r\n\t\tsortBySizeDesc: 'Size (Large-Small)',\r\n\t\tsortByDateAsc: 'Date (Old-New)',\r\n\t\tsortByDateDesc: 'Date (New-Old)',\r\n\t}\r\n};\r\n\r\nconst zh: LangPack = {\r\n\tdisplayName: 'Webdav \u8D44\u6E90\u7BA1\u7406\u5668',\r\n\tsettings: {\r\n\t\ttitle: 'WebDAV \u8BBE\u7F6E',\r\n\t\taddServer: '\u6DFB\u52A0 WebDAV \u670D\u52A1\u5668',\r\n\t\tnoServers: '\u672A\u914D\u7F6E WebDAV \u670D\u52A1\u5668\u3002\u70B9\u51FB\"+\"\u6309\u94AE\u6DFB\u52A0\u4E00\u4E2A\u3002',\r\n\t\turl: {\r\n\t\t\tname: 'WebDAV \u670D\u52A1\u5668\u5730\u5740',\r\n\t\t\tdesc: 'WebDAV \u670D\u52A1\u5668\u7684\u5B8C\u6574 URL'\r\n\t\t},\r\n\t\tusername: '\u7528\u6237\u540D',\r\n\t\tpassword: '\u5BC6\u7801',\r\n\t\tremoteDir: {\r\n\t\t\tname: '\u8FDC\u7A0B\u76EE\u5F55',\r\n\t\t\tdesc: '\u8FDC\u7A0B\u76EE\u5F55\u8DEF\u5F84\uFF08\u4F8B\u5982\uFF1A/notes\uFF09'\r\n\t\t},\r\n\t\tdeleteServer: '\u5220\u9664\u670D\u52A1\u5668',\r\n\t\tdefaultServer: '\u9ED8\u8BA4\u670D\u52A1\u5668',\r\n\t\tdefaultServerDesc: '\u9009\u62E9\u6253\u5F00 WebDAV \u8D44\u6E90\u7BA1\u7406\u5668\u65F6\u4F7F\u7528\u7684\u9ED8\u8BA4\u670D\u52A1\u5668',\r\n\t\tnoServersAvailable: '\u65E0\u53EF\u7528\u670D\u52A1\u5668',\r\n\t\tserverName: '\u670D\u52A1\u5668\u540D\u79F0',\r\n\t\tdeleteNotice: '\u65E0\u6CD5\u5220\u9664\u6700\u540E\u4E00\u4E2A\u670D\u52A1\u5668\u3002\u81F3\u5C11\u9700\u8981\u4E00\u4E2A\u670D\u52A1\u5668\u3002',\r\n\t\tserverList: 'WebDAV \u670D\u52A1\u5668\u5217\u8868',\r\n\t\tserverListEmpty: '\u8BF7\u5728\u8BBE\u7F6E\u4E2D\u914D\u7F6E\u81F3\u5C11\u4E00\u4E2A WebDAV \u670D\u52A1\u5668',\r\n\t},\r\n\tview: {\r\n\t\tpleaseConfigure: '\u8BF7\u5728\u63D2\u4EF6\u8BBE\u7F6E\u4E2D\u914D\u7F6E WebDAV \u8FDE\u63A5\u4FE1\u606F',\r\n\t\tconnectionFailed: '\u8FDE\u63A5\u5931\u8D25',\r\n\t\tlistFailed: '\u83B7\u53D6\u76EE\u5F55\u5217\u8868\u5931\u8D25',\r\n\t\trefreshFailed: '\u5237\u65B0\u5931\u8D25',\r\n\t\terror: '\u9519\u8BEF',\r\n\t\temptyDir: '\u7A7A\u6587\u4EF6\u5939',\r\n\t\tcurrentPath: '\u5F53\u524D\u8DEF\u5F84',\r\n\t\trefreshing: '\u5237\u65B0\u4E2D...',\r\n\t\topening: '\u6B63\u5728\u6253\u5F00\u6587\u4EF6...',\r\n\t\topenFailed: '\u6253\u5F00\u6587\u4EF6\u5931\u8D25',\r\n\t\trootDirectory: '\u6839\u76EE\u5F55',\r\n\t\tloading: '\u52A0\u8F7D\u4E2D...',\r\n\t\tretry: '\u91CD\u8BD5',\r\n\t\tretryPrompt: '\u52A0\u8F7D\u5931\u8D25\uFF0C\u70B9\u51FB\u91CD\u8BD5',\r\n\t\trefresh: '\u5237\u65B0',\r\n\t\tsort: '\u6392\u5E8F',\r\n\t\tsortByNameAsc: '\u540D\u79F0\uFF08A-Z\uFF09',\r\n\t\tsortByNameDesc: '\u540D\u79F0\uFF08Z-A\uFF09',\r\n\t\tsortByTypeAsc: '\u7C7B\u578B\uFF08A-Z\uFF09',\r\n\t\tsortByTypeDesc: '\u7C7B\u578B\uFF08Z-A\uFF09',\r\n\t\tsortBySizeAsc: '\u5927\u5C0F\uFF08\u5C0F-\u5927\uFF09',\r\n\t\tsortBySizeDesc: '\u5927\u5C0F\uFF08\u5927-\u5C0F\uFF09',\r\n\t\tsortByDateAsc: '\u65E5\u671F\uFF08\u65E7-\u65B0\uFF09',\r\n\t\tsortByDateDesc: '\u65E5\u671F\uFF08\u65B0-\u65E7\uFF09',\r\n\r\n\t}\r\n};\r\n\r\n// \u5F53\u524D\u8BED\u8A00\r\nlet currentLocale: Locale = 'en';\r\n\r\n// \u8BBE\u7F6E\u8BED\u8A00\r\nexport function setI18n(locale: Locale) {\r\n\tcurrentLocale = locale;\r\n}\r\n\r\nexport function i18n(): LangPack {\r\n\treturn currentLocale === 'zh' ? zh : en;\r\n}\r\n"],
  "mappings": "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",
  "names": ["exports", "module", "exports", "e", "exports", "module", "match", "path", "i", "exports", "module", "x", "i", "path", "ext", "f", "exports", "module", "i", "base64", "exports", "module", "i", "exports", "module", "isBuffer", "exports", "module", "isBuffer", "md5", "m", "i", "x", "s", "t", "exports", "module", "base64", "noop", "x", "_a", "F", "i", "e", "queueMicrotask", "byteLength", "r", "request", "isAbortSignal", "streamBrandCheckException", "defaultControllerBrandCheckException", "DOMException", "isError", "ReadableStream", "POOL_SIZE", "process", "Blob", "clone", "Blob", "size", "File", "F", "f", "e", "FormData", "m", "exports", "module", "fs", "m", "match", "Body", "f", "i", "clear", "exports", "module", "r", "m", "i", "exports", "module", "m", "expand", "i", "x", "exports", "match", "i", "exports", "i", "t", "match", "exports", "exports", "module", "exports", "module", "i", "exports", "module", "match", "exports", "module", "exports", "module", "i", "result", "exports", "i", "exports", "module", "XMLParser", "exports", "module", "i", "attStr", "exports", "module", "i", "exports", "module", "XMLParser", "XMLBuilder", "exports", "module", "_typeof", "obj", "self", "_wrapNativeSuper", "Class", "_construct", "Parent", "args", "e", "_setPrototypeOf", "o", "p", "_getPrototypeOf", "ObjectPrototypeMutationError", "path", "_loop", "idx", "byteLength", "i", "exports", "import_obsidian", "i18n", "t", "s", "import_obsidian", "i", "path", "URL", "import_md5", "md5", "md5", "i", "match", "CharCodes", "BinTrieFlags", "EntityDecoderState", "DecodingMode", "EntityLevel", "EncodingMode", "base64", "import_node_http", "import_node_stream", "import_node_buffer", "base64", "i", "NAME", "Stream", "byteLength", "toFormData", "request", "import_node_util", "http", "INTERNALS", "import_node_util", "request", "INTERNALS", "formatUrl", "request", "request", "response", "https", "http", "Stream", "s", "pump", "zlib", "AuthType", "ErrorCode", "Stream", "HTTPAgent", "HTTPSAgent", "s", "i", "r", "unescape", "s", "types", "s", "i", "_a", "acc", "ext", "start", "final", "unescape", "escape", "s", "ext", "f", "path", "qmark", "star", "m", "s", "expand", "regExpEscape", "i", "escape", "unescape", "import_path_posix", "PropertyType", "nestedProp", "stat", "path", "e", "_a", "result", "stat", "path", "import_stream", "NOOP", "createReadStream", "Stream", "import_path_posix", "pathPosix", "import_nested_property", "import_fast_xml_parser", "getParser", "path", "nestedProp", "path", "getSearch", "import_stream", "_a", "Stream", "options", "path", "createReadStream", "getSearch", "headers", "token", "t", "path", "i", "sep", "_a", "ext", "s", "t", "e"]
}
